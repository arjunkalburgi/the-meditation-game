var Lo=Object.defineProperty;var Uo=(u,r,s)=>r in u?Lo(u,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[r]=s;var Si=(u,r,s)=>Uo(u,typeof r!="symbol"?r+"":r,s);import{B as Vo,s as xt,n as Ve,d as R,Z as Vt,r as Fr,b as Re,c as fe,e as j,U as ht,i as Yo,w as N,x as wt,f as X,g as ie,h as ae,j as ye,k as $,t as se,l as _e,q as Lr,_ as Ho,$ as zo,a0 as Hn,a1 as zn,a2 as ro,m as Qn,a3 as Go,y as Ur,C as kt,a4 as Vr,a5 as Ue,P as Ut,o as Jn,a6 as Ii,a7 as Wo}from"../chunks/Dos4Qhqc.js";import{S as Tt,i as Et,f as Yr,d as St,t as Ge,h as Qe,a as Fe,m as It,e as Ct,b as Ot,g as vn,c as yn}from"../chunks/CCf6JmRs.js";import{p as Me}from"../chunks/CmP4wuhm.js";import{d as Ci,w as $n}from"../chunks/DrzPv_hY.js";function tt(u){return(u==null?void 0:u.length)!==void 0?u:Array.from(u)}function Je(u,{delay:r=0,duration:s=400,easing:o=Vo}={}){const l=+getComputedStyle(u).opacity;return{delay:r,duration:s,easing:o,css:f=>`opacity: ${f*l}`}}var Le=(u=>(u[u.ONE_MINUTE=60]="ONE_MINUTE",u[u.TWO_MINUTES=120]="TWO_MINUTES",u[u.FIVE_MINUTES=300]="FIVE_MINUTES",u[u.TEN_MINUTES=600]="TEN_MINUTES",u[u.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",u[u.THIRTY_MINUTES=1800]="THIRTY_MINUTES",u[u.SIXTY_MINUTES=3600]="SIXTY_MINUTES",u))(Le||{});const Nr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xo(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var io={exports:{}};(function(u,r){(function(s,o){u.exports=o()})(Oi,function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function l(e,t,n){for(var i,a=0,c=t.length;a<c;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Oi,d=Object.keys,b=Array.isArray;function A(e,t){return typeof t!="object"||d(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var T=Object.getPrototypeOf,I={}.hasOwnProperty;function P(e,t){return I.call(e,t)}function x(e,t){typeof t=="function"&&(t=t(T(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(n){J(e,n,t[n])})}var M=Object.defineProperty;function J(e,t,n,i){M(e,t,A(n&&P(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function ue(e){return{from:function(t){return e.prototype=Object.create(t.prototype),J(e.prototype,"constructor",e),{extend:x.bind(null,e.prototype)}}}}var z=Object.getOwnPropertyDescriptor,B=[].slice;function ee(e,t,n){return B.call(e,t,n)}function U(e,t){return t(e)}function V(e){if(!e)throw new Error("Assertion Failed")}function le(e){f.setImmediate?setImmediate(e):setTimeout(e,0)}function re(e,t){if(typeof t=="string"&&P(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],i=0,a=t.length;i<a;++i){var c=re(e,t[i]);n.push(c)}return n}var h=t.indexOf(".");if(h!==-1){var p=e[t.substr(0,h)];return p==null?void 0:re(p,t.substr(h+1))}}function Z(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){V(typeof n!="string"&&"length"in n);for(var i=0,a=t.length;i<a;++i)Z(e,t[i],n[i])}else{var c,h,p=t.indexOf(".");p!==-1?(c=t.substr(0,p),(h=t.substr(p+1))===""?n===void 0?b(e)&&!isNaN(parseInt(c))?e.splice(c,1):delete e[c]:e[c]=n:Z(p=!(p=e[c])||!P(e,c)?e[c]={}:p,h,n)):n===void 0?b(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function te(e){var t,n={};for(t in e)P(e,t)&&(n[t]=e[t]);return n}var Ce=[].concat;function Se(e){return Ce.apply([],e)}var At="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Se([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return f[e]}),Te=new Set(At.map(function(e){return f[e]})),de=null;function ce(e){return de=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var i=de.get(n);if(i)return i;if(b(n)){i=[],de.set(n,i);for(var a=0,c=n.length;a<c;++a)i.push(t(n[a]))}else if(Te.has(n.constructor))i=n;else{var h,p=T(n);for(h in i=p===Object.prototype?{}:Object.create(p),de.set(n,i),n)P(n,h)&&(i[h]=t(n[h]))}return i}(e),de=null,e}var Ye={}.toString;function Ze(e){return Ye.call(e).slice(8,-1)}var ge=typeof Symbol<"u"?Symbol.iterator:"@@iterator",De=typeof ge=="symbol"?function(e){var t;return e!=null&&(t=e[ge])&&t.apply(e)}:function(){return null};function Ae(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var je={};function Ie(e){var t,n,i,a;if(arguments.length===1){if(b(e))return e.slice();if(this===je&&typeof e=="string")return[e];if(a=De(e)){for(n=[];!(i=a.next()).done;)n.push(i.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var qe=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},en=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],it=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(en),me={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ve(e,t){this.name=e,this.message=t}function Ke(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,i,a){return a.indexOf(n)===i}).join(`
`)}function ot(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=Ke(e,t)}function ct(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Ke(e,this.failures)}ue(ve).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ue(ot).from(ve),ue(ct).from(ve);var Pt=it.reduce(function(e,t){return e[t]=t+"Error",e},{}),lo=ve,oe=it.reduce(function(e,t){var n=t+"Error";function i(a,c){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(c?`
 `+c:""),this.inner=c||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=me[t]||n,this.inner=null)}return ue(i).from(lo),e[t]=i,e},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var zr=en.reduce(function(e,t){return e[t+"Error"]=oe[t],e},{}),_n=it.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=oe[t]),e},{});function Ee(){}function Jt(e){return e}function co(e,t){return e==null||e===Jt?t:function(n){return t(e(n))}}function Dt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function fo(e,t){return e===Ee?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Dt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Dt(a,this.onerror):a),c!==void 0?c:n}}function ho(e,t){return e===Ee?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Dt(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Dt(i,this.onerror):i)}}function po(e,t){return e===Ee?t:function(n){var i=e.apply(this,arguments);A(n,i);var a=this.onsuccess,c=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?Dt(a,this.onsuccess):a),c&&(this.onerror=this.onerror?Dt(c,this.onerror):c),i===void 0?n===void 0?void 0:n:A(i,n)}}function mo(e,t){return e===Ee?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function tr(e,t){return e===Ee?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,a=arguments.length,c=new Array(a);a--;)c[a]=arguments[a];return n.then(function(){return t.apply(i,c)})}return t.apply(this,arguments)}}_n.ModifyError=ot,_n.DexieError=ve,_n.BulkError=ct;var at=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Gr(e){at=e}var Zt={},Wr=100,At=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,T(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,T(t),e]}(),en=At[0],it=At[1],At=At[2],it=it&&it.then,jt=en&&en.constructor,nr=!!At,tn=function(e,t){nn.push([e,t]),gn&&(queueMicrotask(yo),gn=!1)},rr=!0,gn=!0,Kt=[],bn=[],ir=Jt,pt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ee,pgp:!1,env:{},finalize:Ee},ne=pt,nn=[],Rt=0,wn=[];function W(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ne;if(typeof e!="function"){if(e!==Zt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ar(this,this._value))}this._state=null,this._value=null,++t.ref,function n(i,a){try{a(function(c){if(i._state===null){if(c===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Yt();c&&typeof c.then=="function"?n(i,function(p,v){c instanceof W?c._then(p,v):c.then(p,v)}):(i._state=!0,i._value=c,$r(i)),h&&Ht()}},ar.bind(null,i))}catch(c){ar(i,c)}}(this,e)}var or={get:function(){var e=ne,t=En;function n(i,a){var c=this,h=!e.global&&(e!==ne||t!==En),p=h&&!vt(),v=new W(function(_,k){sr(c,new Xr(Jr(i,e,h,p),Jr(a,e,h,p),_,k,e))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return n.prototype=Zt,n},set:function(e){J(this,"then",e&&e.prototype===Zt?or:{get:function(){return e},set:or.set})}};function Xr(e,t,n,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=i,this.psd=a}function ar(e,t){var n,i;bn.push(t),e._state===null&&(n=e._lib&&Yt(),t=ir(t),e._state=!1,e._value=t,i=e,Kt.some(function(a){return a._value===i._value})||Kt.push(i),$r(e),n&&Ht())}function $r(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)sr(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),Rt===0&&(++Rt,tn(function(){--Rt==0&&ur()},[]))}function sr(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Rt,tn(vo,[n,e,t])}else e._listeners.push(t)}function vo(e,t,n){try{var i,a=t._value;!t._state&&bn.length&&(bn=[]),i=at&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||bn.indexOf(a)!==-1||function(c){for(var h=Kt.length;h;)if(Kt[--h]._value===c._value)return Kt.splice(h,1)}(t),n.resolve(i)}catch(c){n.reject(c)}finally{--Rt==0&&ur(),--n.psd.ref||n.psd.finalize()}}function yo(){Mt(pt,function(){Yt()&&Ht()})}function Yt(){var e=rr;return gn=rr=!1,e}function Ht(){var e,t,n;do for(;0<nn.length;)for(e=nn,nn=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}while(0<nn.length);gn=rr=!0}function ur(){var e=Kt;Kt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=wn.slice(0),n=t.length;n;)t[--n]()}function kn(e){return new W(Zt,!1,e)}function Pe(e,t){var n=ne;return function(){var i=Yt(),a=ne;try{return yt(n,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{yt(a,!1),i&&Ht()}}}x(W.prototype,{then:or,_then:function(e,t){sr(this,new Xr(null,null,e,t,ne))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?n:kn)(i)}):this.then(null,function(i){return(i&&i.name===t?n:kn)(i)})},finally:function(e){return this.then(function(t){return W.resolve(e()).then(function(){return t})},function(t){return W.resolve(e()).then(function(){return kn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new W(function(i,a){var c=setTimeout(function(){return a(new oe.Timeout(t))},e);n.then(i,a).finally(clearTimeout.bind(null,c))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&J(W.prototype,Symbol.toStringTag,"Dexie.Promise"),pt.env=Qr(),x(W,{all:function(){var e=Ie.apply(null,arguments).map(Sn);return new W(function(t,n){e.length===0&&t([]);var i=e.length;e.forEach(function(a,c){return W.resolve(a).then(function(h){e[c]=h,--i||t(e)},n)})})},resolve:function(e){return e instanceof W?e:e&&typeof e.then=="function"?new W(function(t,n){e.then(t,n)}):new W(Zt,!0,e)},reject:kn,race:function(){var e=Ie.apply(null,arguments).map(Sn);return new W(function(t,n){e.map(function(i){return W.resolve(i).then(t,n)})})},PSD:{get:function(){return ne},set:function(e){return ne=e}},totalEchoes:{get:function(){return En}},newPSD:mt,usePSD:Mt,scheduler:{get:function(){return tn},set:function(e){tn=e}},rejectionMapper:{get:function(){return ir},set:function(e){ir=e}},follow:function(e,t){return new W(function(n,i){return mt(function(a,c){var h=ne;h.unhandleds=[],h.onunhandled=c,h.finalize=Dt(function(){var p,v=this;p=function(){v.unhandleds.length===0?a():c(v.unhandleds[0])},wn.push(function _(){p(),wn.splice(wn.indexOf(_),1)}),++Rt,tn(function(){--Rt==0&&ur()},[])},h.finalize),e()},t,n,i)})}}),jt&&(jt.allSettled&&J(W,"allSettled",function(){var e=Ie.apply(null,arguments).map(Sn);return new W(function(t){e.length===0&&t([]);var n=e.length,i=new Array(n);e.forEach(function(a,c){return W.resolve(a).then(function(h){return i[c]={status:"fulfilled",value:h}},function(h){return i[c]={status:"rejected",reason:h}}).then(function(){return--n||t(i)})})})}),jt.any&&typeof AggregateError<"u"&&J(W,"any",function(){var e=Ie.apply(null,arguments).map(Sn);return new W(function(t,n){e.length===0&&n(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(c,h){return W.resolve(c).then(function(p){return t(p)},function(p){a[h]=p,--i||n(new AggregateError(a))})})})}),jt.withResolvers&&(W.withResolvers=jt.withResolvers));var He={awaits:0,echoes:0,id:0},_o=0,xn=[],Tn=0,En=0,go=0;function mt(e,t,n,i){var a=ne,c=Object.create(a);return c.parent=a,c.ref=0,c.global=!1,c.id=++go,pt.env,c.env=nr?{Promise:W,PromiseProp:{value:W,configurable:!0,writable:!0},all:W.all,race:W.race,allSettled:W.allSettled,any:W.any,resolve:W.resolve,reject:W.reject}:{},t&&A(c,t),++a.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Mt(c,e,n,i),c.ref===0&&c.finalize(),i}function zt(){return He.id||(He.id=++_o),++He.awaits,He.echoes+=Wr,He.id}function vt(){return!!He.awaits&&(--He.awaits==0&&(He.id=0),He.echoes=He.awaits*Wr,!0)}function Sn(e){return He.echoes&&e&&e.constructor===jt?(zt(),e.then(function(t){return vt(),t},function(t){return vt(),Ne(t)})):e}function bo(){var e=xn[xn.length-1];xn.pop(),yt(e,!1)}function yt(e,t){var n,i=ne;(t?!He.echoes||Tn++&&e===ne:!Tn||--Tn&&e===ne)||queueMicrotask(t?(function(a){++En,He.echoes&&--He.echoes!=0||(He.echoes=He.awaits=He.id=0),xn.push(ne),yt(a,!0)}).bind(null,e):bo),e!==ne&&(ne=e,i===pt&&(pt.env=Qr()),nr&&(n=pt.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(f,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Qr(){var e=f.Promise;return nr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Mt(e,t,n,i,a){var c=ne;try{return yt(e,!0),t(n,i,a)}finally{yt(c,!1)}}function Jr(e,t,n,i){return typeof e!="function"?e:function(){var a=ne;n&&zt(),yt(t,!0);try{return e.apply(this,arguments)}finally{yt(a,!1),i&&queueMicrotask(vt)}}}function lr(e){Promise===jt&&He.echoes===0?Tn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+it).indexOf("[native code]")===-1&&(zt=vt=Ee);var Ne=W.reject,Nt="￿",ft="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Zr="String expected.",Gt=[],In="__dbnames",cr="readonly",fr="readwrite";function Bt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ei={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Cn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=ce(t))[e],t}}function ti(){throw oe.Type()}function ke(e,t){try{var n=ni(e),i=ni(t);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,c){for(var h=a.length,p=c.length,v=h<p?h:p,_=0;_<v;++_)if(a[_]!==c[_])return a[_]<c[_]?-1:1;return h===p?0:h<p?-1:1}(ri(e),ri(t));case"Array":return function(a,c){for(var h=a.length,p=c.length,v=h<p?h:p,_=0;_<v;++_){var k=ke(a[_],c[_]);if(k!==0)return k}return h===p?0:h<p?-1:1}(e,t)}}catch{}return NaN}function ni(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Ze(e),e==="ArrayBuffer"?"binary":e)}function ri(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ii=(Oe.prototype._trans=function(e,t,n){var i=this._tx||ne.trans,a=this.name,c=at&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(_,k,m){if(!m.schema[a])throw new oe.NotFound("Table "+a+" not part of transaction");return t(m.idbtrans,m)}var p=Yt();try{var v=i&&i.db._novip===this.db._novip?i===ne.trans?i._promise(e,h,n):mt(function(){return i._promise(e,h,n)},{trans:i,transless:ne.transless||ne}):function _(k,m,S,y){if(k.idbdb&&(k._state.openComplete||ne.letThrough||k._vip)){var w=k._createTransaction(m,S,k._dbSchema);try{w.create(),k._state.PR1398_maxLoop=3}catch(E){return E.name===Pt.InvalidState&&k.isOpen()&&0<--k._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),k.close({disableAutoOpen:!1}),k.open().then(function(){return _(k,m,S,y)})):Ne(E)}return w._promise(m,function(E,g){return mt(function(){return ne.trans=w,y(E,g,w)})}).then(function(E){if(m==="readwrite")try{w.idbtrans.commit()}catch{}return m==="readonly"?E:w._completion.then(function(){return E})})}if(k._state.openComplete)return Ne(new oe.DatabaseClosed(k._state.dbOpenError));if(!k._state.isBeingOpened){if(!k._state.autoOpen)return Ne(new oe.DatabaseClosed);k.open().catch(Ee)}return k._state.dbReadyPromise.then(function(){return _(k,m,S,y)})}(this.db,e,[this.name],h);return c&&(v._consoleTask=c,v=v.catch(function(_){return console.trace(_),Ne(_)})),v}finally{p&&Ht()}},Oe.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Ne(new oe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return n.core.get({trans:i,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},Oe.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(b(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(p){if(p.compound&&t.every(function(_){return 0<=p.keyPath.indexOf(_)})){for(var v=0;v<t.length;++v)if(t.indexOf(p.keyPath[v])===-1)return!1;return!0}return!1}).sort(function(p,v){return p.keyPath.length-v.keyPath.length})[0];if(n&&this.db._maxKey!==Nt){var c=n.keyPath.slice(0,t.length);return this.where(c).equals(c.map(function(v){return e[v]}))}!n&&at&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(p,v){return ke(p,v)===0}var h=t.reduce(function(m,v){var _=m[0],k=m[1],m=i[v],S=e[v];return[_||m,_||!m?Bt(k,m&&m.multi?function(y){return y=re(y,v),b(y)&&y.some(function(w){return a(S,w)})}:function(y){return a(S,re(y,v))}):k]},[null,null]),c=h[0],h=h[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(h):n?this.filter(h):this.where(t).equals("")},Oe.prototype.filter=function(e){return this.toCollection().and(e)},Oe.prototype.count=function(e){return this.toCollection().count(e)},Oe.prototype.offset=function(e){return this.toCollection().offset(e)},Oe.prototype.limit=function(e){return this.toCollection().limit(e)},Oe.prototype.each=function(e){return this.toCollection().each(e)},Oe.prototype.toArray=function(e){return this.toCollection().toArray(e)},Oe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Oe.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,b(e)?"[".concat(e.join("+"),"]"):e))},Oe.prototype.reverse=function(){return this.toCollection().reverse()},Oe.prototype.mapToClass=function(e){var t,n=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ti&&(function(v,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function k(){this.constructor=v}s(v,_),v.prototype=_===null?Object.create(_):(k.prototype=_.prototype,new k)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var c=new Set,h=e.prototype;h;h=T(h))Object.getOwnPropertyNames(h).forEach(function(v){return c.add(v)});function p(v){if(!v)return v;var _,k=Object.create(e.prototype);for(_ in v)if(!c.has(_))try{k[_]=v[_]}catch{}return k}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),e},Oe.prototype.defineClass=function(){return this.mapToClass(function(e){A(this,e)})},Oe.prototype.add=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,c=i.keyPath,h=e;return c&&a&&(h=Cn(c)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(p){return p.numFailures?W.reject(p.failures[0]):p.lastResult}).then(function(p){if(c)try{Z(e,c,p)}catch{}return p})},Oe.prototype.update=function(e,t){return typeof e!="object"||b(e)?this.where(":id").equals(e).modify(t):(e=re(e,this.schema.primKey.keyPath),e===void 0?Ne(new oe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Oe.prototype.put=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,c=i.keyPath,h=e;return c&&a&&(h=Cn(c)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(p){return p.numFailures?W.reject(p.failures[0]):p.lastResult}).then(function(p){if(c)try{Z(e,c,p)}catch{}return p})},Oe.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?W.reject(n.failures[0]):void 0})},Oe.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:ei})}).then(function(t){return t.numFailures?W.reject(t.failures[0]):void 0})},Oe.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},Oe.prototype.bulkAdd=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,c=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var _=i.schema.primKey,p=_.auto,_=_.keyPath;if(_&&a)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,_=_&&p?e.map(Cn(_)):e;return i.core.mutate({trans:h,type:"add",keys:a,values:_,wantResults:c}).then(function(w){var m=w.numFailures,S=w.results,y=w.lastResult,w=w.failures;if(m===0)return c?S:y;throw new ct("".concat(i.name,".bulkAdd(): ").concat(m," of ").concat(v," operations failed"),w)})})},Oe.prototype.bulkPut=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,c=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var _=i.schema.primKey,p=_.auto,_=_.keyPath;if(_&&a)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,_=_&&p?e.map(Cn(_)):e;return i.core.mutate({trans:h,type:"put",keys:a,values:_,wantResults:c}).then(function(w){var m=w.numFailures,S=w.results,y=w.lastResult,w=w.failures;if(m===0)return c?S:y;throw new ct("".concat(i.name,".bulkPut(): ").concat(m," of ").concat(v," operations failed"),w)})})},Oe.prototype.bulkUpdate=function(e){var t=this,n=this.core,i=e.map(function(h){return h.key}),a=e.map(function(h){return h.changes}),c=[];return this._trans("readwrite",function(h){return n.getMany({trans:h,keys:i,cache:"clone"}).then(function(p){var v=[],_=[];e.forEach(function(m,S){var y=m.key,w=m.changes,E=p[S];if(E){for(var g=0,C=Object.keys(w);g<C.length;g++){var O=C[g],D=w[O];if(O===t.schema.primKey.keyPath){if(ke(D,y)!==0)throw new oe.Constraint("Cannot update primary key in bulkUpdate()")}else Z(E,O,D)}c.push(S),v.push(y),_.push(E)}});var k=v.length;return n.mutate({trans:h,type:"put",keys:v,values:_,updates:{keys:i,changeSpecs:a}}).then(function(m){var S=m.numFailures,y=m.failures;if(S===0)return k;for(var w=0,E=Object.keys(y);w<E.length;w++){var g,C=E[w],O=c[Number(C)];O!=null&&(g=y[C],delete y[C],y[O]=g)}throw new ct("".concat(t.name,".bulkUpdate(): ").concat(S," of ").concat(k," operations failed"),y)})})})},Oe.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var a=h.numFailures,c=h.lastResult,h=h.failures;if(a===0)return c;throw new ct("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),h)})},Oe);function Oe(){}function rn(e){function t(h,p){if(p){for(var v=arguments.length,_=new Array(v-1);--v;)_[v-1]=arguments[v];return n[h].subscribe.apply(null,_),e}if(typeof h=="string")return n[h]}var n={};t.addEventType=c;for(var i=1,a=arguments.length;i<a;++i)c(arguments[i]);return t;function c(h,p,v){if(typeof h!="object"){var _;p=p||mo;var k={subscribers:[],fire:v=v||Ee,subscribe:function(m){k.subscribers.indexOf(m)===-1&&(k.subscribers.push(m),k.fire=p(k.fire,m))},unsubscribe:function(m){k.subscribers=k.subscribers.filter(function(S){return S!==m}),k.fire=k.subscribers.reduce(p,v)}};return n[h]=t[h]=k}d(_=h).forEach(function(m){var S=_[m];if(b(S))c(m,_[m][0],_[m][1]);else{if(S!=="asap")throw new oe.InvalidArgument("Invalid event config");var y=c(m,Jt,function(){for(var w=arguments.length,E=new Array(w);w--;)E[w]=arguments[w];y.subscribers.forEach(function(g){le(function(){g.apply(null,E)})})})}})}}function on(e,t){return ue(t).from({prototype:e}),t}function Wt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function dr(e,t){e.filter=Bt(e.filter,t)}function hr(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return Bt(i(),t())}:t,e.justLimit=n&&!i}function On(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new oe.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function oi(e,t,n){var i=On(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function Pn(e,t,n,i){var a=e.replayFilter?Bt(e.filter,e.replayFilter()):e.filter;if(e.or){var c={},h=function(p,v,_){var k,m;a&&!a(v,_,function(S){return v.stop(S)},function(S){return v.fail(S)})||((m=""+(k=v.primaryKey))=="[object ArrayBuffer]"&&(m=""+new Uint8Array(k)),P(c,m)||(c[m]=!0,t(p,v,_)))};return Promise.all([e.or._iterate(h,n),ai(oi(e,i,n),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ai(oi(e,i,n),Bt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function ai(e,t,n,i){var a=Pe(i?function(c,h,p){return n(i(c),h,p)}:n);return e.then(function(c){if(c)return c.start(function(){var h=function(){return c.continue()};t&&!t(c,function(p){return h=p},function(p){c.stop(p),h=Ee},function(p){c.fail(p),h=Ee})||a(c.value,c,function(p){return h=p}),h()})})}var an=(si.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(b(n))return l(l([],b(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var i=t.remove;if(b(i))return b(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},si);function si(e){this["@@propmod"]=e}var wo=(xe.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Ne.bind(null,n.error)):n.table._trans("readonly",e).then(t)},xe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ne.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},xe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Bt(t.algorithm,e)},xe.prototype._iterate=function(e,t){return Pn(this._ctx,e,t,this._ctx.table.core)},xe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&A(n,e),t._ctx=n,t},xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},xe.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Pn(t,e,n,t.table.core)})},xe.prototype.count=function(e){var t=this;return this._read(function(n){var i=t._ctx,a=i.table.core;if(Wt(i,!0))return a.count({trans:n,query:{index:On(i,a.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var c=0;return Pn(i,function(){return++c,!1},n,a).then(function(){return c})}).then(e)},xe.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],a=n.length-1;function c(v,_){return _?c(v[n[_]],_-1):v[i]}var h=this._ctx.dir==="next"?1:-1;function p(v,_){return ke(c(v,a),c(_,a))*h}return this.toArray(function(v){return v.sort(p)}).then(t)},xe.prototype.toArray=function(e){var t=this;return this._read(function(n){var i=t._ctx;if(i.dir==="next"&&Wt(i,!0)&&0<i.limit){var a=i.valueMapper,c=On(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:c,range:i.range}}).then(function(p){return p=p.result,a?p.map(a):p})}var h=[];return Pn(i,function(p){return h.push(p)},n,i.table.core).then(function(){return h})},e)},xe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Wt(t)?hr(t,function(){var n=e;return function(i,a){return n===0||(n===1?--n:a(function(){i.advance(n),n=0}),!1)}}):hr(t,function(){var n=e;return function(){return--n<0}})),this},xe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),hr(this._ctx,function(){var t=e;return function(n,i,a){return--t<=0&&i(a),0<=t}},!0),this},xe.prototype.until=function(e,t){return dr(this._ctx,function(n,i,a){return!e(n.value)||(i(a),t)}),this},xe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},xe.prototype.last=function(e){return this.reverse().first(e)},xe.prototype.filter=function(e){var t;return dr(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=Bt(t.isMatch,e),this},xe.prototype.and=function(e){return this.filter(e)},xe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xe.prototype.desc=function(){return this.reverse()},xe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.key,i)})},xe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.primaryKey,i)})},xe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.key)}).then(function(){return n}).then(e)},xe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Wt(t,!0)&&0<t.limit)return this._read(function(i){var a=On(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},xe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},xe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return dr(this._ctx,function(a){var i=a.primaryKey.toString(),a=P(t,i);return t[i]=!0,!a}),this},xe.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(i){var a,c,h;h=typeof e=="function"?e:(a=d(e),c=a.length,function(g){for(var C=!1,O=0;O<c;++O){var D=a[O],K=e[D],q=re(g,D);K instanceof an?(Z(g,D,K.execute(q)),C=!0):q!==K&&(Z(g,D,K),C=!0)}return C});var p=n.table.core,m=p.schema.primaryKey,v=m.outbound,_=m.extractKey,k=200,m=t.db._options.modifyChunkSize;m&&(k=typeof m=="object"?m[p.name]||m["*"]||200:m);function S(g,D){var O=D.failures,D=D.numFailures;w+=g-D;for(var K=0,q=d(O);K<q.length;K++){var H=q[K];y.push(O[H])}}var y=[],w=0,E=[];return t.clone().primaryKeys().then(function(g){function C(D){var K=Math.min(k,g.length-D);return p.getMany({trans:i,keys:g.slice(D,D+K),cache:"immutable"}).then(function(q){for(var H=[],F=[],L=v?[]:null,G=[],Y=0;Y<K;++Y){var Q=q[Y],pe={value:ce(Q),primKey:g[D+Y]};h.call(pe,pe.value,pe)!==!1&&(pe.value==null?G.push(g[D+Y]):v||ke(_(Q),_(pe.value))===0?(F.push(pe.value),v&&L.push(g[D+Y])):(G.push(g[D+Y]),H.push(pe.value)))}return Promise.resolve(0<H.length&&p.mutate({trans:i,type:"add",values:H}).then(function(be){for(var we in be.failures)G.splice(parseInt(we),1);S(H.length,be)})).then(function(){return(0<F.length||O&&typeof e=="object")&&p.mutate({trans:i,type:"put",keys:L,values:F,criteria:O,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<D}).then(function(be){return S(F.length,be)})}).then(function(){return(0<G.length||O&&e===pr)&&p.mutate({trans:i,type:"delete",keys:G,criteria:O,isAdditionalChunk:0<D}).then(function(be){return S(G.length,be)})}).then(function(){return g.length>D+K&&C(D+k)})})}var O=Wt(n)&&n.limit===1/0&&(typeof e!="function"||e===pr)&&{index:n.index,range:n.range};return C(0).then(function(){if(0<y.length)throw new ot("Error modifying one or more objects",y,w,E);return g.length})})})},xe.prototype.delete=function(){var e=this._ctx,t=e.range;return Wt(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:i,range:a}}).then(function(c){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(h){var p=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new ot("Could not delete some values",Object.keys(p).map(function(v){return p[v]}),c-h);return c-h})})}):this.modify(pr)},xe);function xe(){}var pr=function(e,t){return t.value=null};function ko(e,t){return e<t?-1:e===t?0:1}function xo(e,t){return t<e?-1:e===t?0:1}function nt(e,t,n){return e=e instanceof li?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function Xt(e){return new e.Collection(e,function(){return ui("")}).limit(0)}function Dn(e,t,n,i){var a,c,h,p,v,_,k,m=n.length;if(!n.every(function(w){return typeof w=="string"}))return nt(e,Zr);function S(w){a=w==="next"?function(g){return g.toUpperCase()}:function(g){return g.toLowerCase()},c=w==="next"?function(g){return g.toLowerCase()}:function(g){return g.toUpperCase()},h=w==="next"?ko:xo;var E=n.map(function(g){return{lower:c(g),upper:a(g)}}).sort(function(g,C){return h(g.lower,C.lower)});p=E.map(function(g){return g.upper}),v=E.map(function(g){return g.lower}),k=(_=w)==="next"?"":i}S("next"),e=new e.Collection(e,function(){return _t(p[0],v[m-1]+i)}),e._ondirectionchange=function(w){S(w)};var y=0;return e._addAlgorithm(function(w,E,g){var C=w.key;if(typeof C!="string")return!1;var O=c(C);if(t(O,v,y))return!0;for(var D=null,K=y;K<m;++K){var q=function(H,F,L,G,Y,Q){for(var pe=Math.min(H.length,G.length),be=-1,we=0;we<pe;++we){var rt=F[we];if(rt!==G[we])return Y(H[we],L[we])<0?H.substr(0,we)+L[we]+L.substr(we+1):Y(H[we],G[we])<0?H.substr(0,we)+G[we]+L.substr(we+1):0<=be?H.substr(0,be)+F[be]+L.substr(be+1):null;Y(H[we],rt)<0&&(be=we)}return pe<G.length&&Q==="next"?H+L.substr(H.length):pe<H.length&&Q==="prev"?H.substr(0,L.length):be<0?null:H.substr(0,be)+G[be]+L.substr(be+1)}(C,O,p[K],v[K],h,_);q===null&&D===null?y=K+1:(D===null||0<h(D,q))&&(D=q)}return E(D!==null?function(){w.continue(D+k)}:g),!1}),e}function _t(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function ui(e){return{type:1,lower:e,upper:e}}var li=(Object.defineProperty(ze.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ze.prototype.between=function(e,t,n,i){n=n!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||i)&&(!n||!i)?Xt(this):new this.Collection(this,function(){return _t(e,t,!n,!i)})}catch{return nt(this,ft)}},ze.prototype.equals=function(e){return e==null?nt(this,ft):new this.Collection(this,function(){return ui(e)})},ze.prototype.above=function(e){return e==null?nt(this,ft):new this.Collection(this,function(){return _t(e,void 0,!0)})},ze.prototype.aboveOrEqual=function(e){return e==null?nt(this,ft):new this.Collection(this,function(){return _t(e,void 0,!1)})},ze.prototype.below=function(e){return e==null?nt(this,ft):new this.Collection(this,function(){return _t(void 0,e,!1,!0)})},ze.prototype.belowOrEqual=function(e){return e==null?nt(this,ft):new this.Collection(this,function(){return _t(void 0,e)})},ze.prototype.startsWith=function(e){return typeof e!="string"?nt(this,Zr):this.between(e,e+Nt,!0,!0)},ze.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Dn(this,function(t,n){return t.indexOf(n[0])===0},[e],Nt)},ze.prototype.equalsIgnoreCase=function(e){return Dn(this,function(t,n){return t===n[0]},[e],"")},ze.prototype.anyOfIgnoreCase=function(){var e=Ie.apply(je,arguments);return e.length===0?Xt(this):Dn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},ze.prototype.startsWithAnyOfIgnoreCase=function(){var e=Ie.apply(je,arguments);return e.length===0?Xt(this):Dn(this,function(t,n){return n.some(function(i){return t.indexOf(i)===0})},e,Nt)},ze.prototype.anyOf=function(){var e=this,t=Ie.apply(je,arguments),n=this._cmp;try{t.sort(n)}catch{return nt(this,ft)}if(t.length===0)return Xt(this);var i=new this.Collection(this,function(){return _t(t[0],t[t.length-1])});i._ondirectionchange=function(c){n=c==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return i._addAlgorithm(function(c,h,p){for(var v=c.key;0<n(v,t[a]);)if(++a===t.length)return h(p),!1;return n(v,t[a])===0||(h(function(){c.continue(t[a])}),!1)}),i},ze.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ze.prototype.noneOf=function(){var e=Ie.apply(je,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return nt(this,ft)}var t=e.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},ze.prototype.inAnyRange=function(C,t){var n=this,i=this._cmp,a=this._ascending,c=this._descending,h=this._min,p=this._max;if(C.length===0)return Xt(this);if(!C.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&a(O[0],O[1])<=0}))return nt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);var v=!t||t.includeLowers!==!1,_=t&&t.includeUppers===!0,k,m=a;function S(O,D){return m(O[0],D[0])}try{(k=C.reduce(function(O,D){for(var K=0,q=O.length;K<q;++K){var H=O[K];if(i(D[0],H[1])<0&&0<i(D[1],H[0])){H[0]=h(H[0],D[0]),H[1]=p(H[1],D[1]);break}}return K===q&&O.push(D),O},[])).sort(S)}catch{return nt(this,ft)}var y=0,w=_?function(O){return 0<a(O,k[y][1])}:function(O){return 0<=a(O,k[y][1])},E=v?function(O){return 0<c(O,k[y][0])}:function(O){return 0<=c(O,k[y][0])},g=w,C=new this.Collection(this,function(){return _t(k[0][0],k[k.length-1][1],!v,!_)});return C._ondirectionchange=function(O){m=O==="next"?(g=w,a):(g=E,c),k.sort(S)},C._addAlgorithm(function(O,D,K){for(var q,H=O.key;g(H);)if(++y===k.length)return D(K),!1;return!w(q=H)&&!E(q)||(n._cmp(H,k[y][1])===0||n._cmp(H,k[y][0])===0||D(function(){m===a?O.continue(k[y][0]):O.continue(k[y][1])}),!1)}),C},ze.prototype.startsWithAnyOf=function(){var e=Ie.apply(je,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Xt(this):this.inAnyRange(e.map(function(t){return[t,t+Nt]})):nt(this,"startsWithAnyOf() only works with strings")},ze);function ze(){}function st(e){return Pe(function(t){return sn(t),e(t.target.error),!1})}function sn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var un="storagemutated",mr="x-storagemutated-1",gt=rn(null,un),To=(ut.prototype._lock=function(){return V(!ne.global),++this._reculock,this._reculock!==1||ne.global||(ne.lockOwnerFor=this),this},ut.prototype._unlock=function(){if(V(!ne.global),--this._reculock==0)for(ne.global||(ne.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Mt(e[1],e[0])}catch{}}return this},ut.prototype._locked=function(){return this._reculock&&ne.lockOwnerFor!==this},ut.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(V(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(i);case"MissingAPIError":throw new oe.MissingAPI(i.message,i);default:throw new oe.OpenFailed(i)}if(!this.active)throw new oe.TransactionInactive;return V(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Pe(function(a){sn(a),t._reject(e.error)}),e.onabort=Pe(function(a){sn(a),t.active&&t._reject(new oe.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=Pe(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&gt.storagemutated.fire(e.mutatedParts)}),this},ut.prototype._promise=function(e,t,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return Ne(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new oe.TransactionInactive);if(this._locked())return new W(function(c,h){i._blockedFuncs.push([function(){i._promise(e,t,n).then(c,h)},ne])});if(n)return mt(function(){var c=new W(function(h,p){i._lock();var v=t(h,p,i);v&&v.then&&v.then(h,p)});return c.finally(function(){return i._unlock()}),c._lib=!0,c});var a=new W(function(c,h){var p=t(c,h,i);p&&p.then&&p.then(c,h)});return a._lib=!0,a},ut.prototype._root=function(){return this.parent?this.parent._root():this},ut.prototype.waitFor=function(e){var t,n=this._root(),i=W.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return i}):(n._waitingFor=i,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function c(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=c)}());var a=n._waitingFor;return new W(function(c,h){i.then(function(p){return n._waitingQueue.push(Pe(c.bind(null,p)))},function(p){return n._waitingQueue.push(Pe(h.bind(null,p)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},ut.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))},ut.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(P(t,e))return t[e];var n=this.schema[e];if(!n)throw new oe.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},ut);function ut(){}function vr(e,t,n,i,a,c,h){return{name:e,keyPath:t,unique:n,multi:i,auto:a,compound:c,src:(n&&!h?"&":"")+(i?"*":"")+(a?"++":"")+ci(t)}}function ci(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function yr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},n.reduce(function(a,c,h){return h=i(c,h),h&&(a[h[0]]=h[1]),a},{}))};var i}var ln=function(e){try{return e.only([[]]),ln=function(){return[[]]},[[]]}catch{return ln=function(){return Nt},Nt}};function _r(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return re(n,t)}:function(n){return re(n,e)};var t}function fi(e){return[].slice.call(e)}var Eo=0;function cn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function So(e,t,v){function i(g){if(g.type===3)return null;if(g.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=g.lower,w=g.upper,E=g.lowerOpen,g=g.upperOpen;return y===void 0?w===void 0?null:t.upperBound(w,!!g):w===void 0?t.lowerBound(y,!!E):t.bound(y,w,!!E,!!g)}function a(S){var y,w=S.name;return{name:w,schema:S,mutate:function(E){var g=E.trans,C=E.type,O=E.keys,D=E.values,K=E.range;return new Promise(function(q,H){q=Pe(q);var F=g.objectStore(w),L=F.keyPath==null,G=C==="put"||C==="add";if(!G&&C!=="delete"&&C!=="deleteRange")throw new Error("Invalid operation type: "+C);var Y,Q=(O||D||{length:1}).length;if(O&&D&&O.length!==D.length)throw new Error("Given keys array must have same length as given values array.");if(Q===0)return q({numFailures:0,failures:{},results:[],lastResult:void 0});function pe(et){++rt,sn(et)}var be=[],we=[],rt=0;if(C==="deleteRange"){if(K.type===4)return q({numFailures:rt,failures:we,results:[],lastResult:void 0});K.type===3?be.push(Y=F.clear()):be.push(Y=F.delete(i(K)))}else{var L=G?L?[D,O]:[D,null]:[O,null],he=L[0],Xe=L[1];if(G)for(var $e=0;$e<Q;++$e)be.push(Y=Xe&&Xe[$e]!==void 0?F[C](he[$e],Xe[$e]):F[C](he[$e])),Y.onerror=pe;else for($e=0;$e<Q;++$e)be.push(Y=F[C](he[$e])),Y.onerror=pe}function Yn(et){et=et.target.result,be.forEach(function(Lt,Mr){return Lt.error!=null&&(we[Mr]=Lt.error)}),q({numFailures:rt,failures:we,results:C==="delete"?O:be.map(function(Lt){return Lt.result}),lastResult:et})}Y.onerror=function(et){pe(et),Yn(et)},Y.onsuccess=Yn})},getMany:function(E){var g=E.trans,C=E.keys;return new Promise(function(O,D){O=Pe(O);for(var K,q=g.objectStore(w),H=C.length,F=new Array(H),L=0,G=0,Y=function(be){be=be.target,F[be._pos]=be.result,++G===L&&O(F)},Q=st(D),pe=0;pe<H;++pe)C[pe]!=null&&((K=q.get(C[pe]))._pos=pe,K.onsuccess=Y,K.onerror=Q,++L);L===0&&O(F)})},get:function(E){var g=E.trans,C=E.key;return new Promise(function(O,D){O=Pe(O);var K=g.objectStore(w).get(C);K.onsuccess=function(q){return O(q.target.result)},K.onerror=st(D)})},query:(y=_,function(E){return new Promise(function(g,C){g=Pe(g);var O,D,K,L=E.trans,q=E.values,H=E.limit,Y=E.query,F=H===1/0?void 0:H,G=Y.index,Y=Y.range,L=L.objectStore(w),G=G.isPrimaryKey?L:L.index(G.name),Y=i(Y);if(H===0)return g({result:[]});y?((F=q?G.getAll(Y,F):G.getAllKeys(Y,F)).onsuccess=function(Q){return g({result:Q.target.result})},F.onerror=st(C)):(O=0,D=!q&&"openKeyCursor"in G?G.openKeyCursor(Y):G.openCursor(Y),K=[],D.onsuccess=function(Q){var pe=D.result;return pe?(K.push(q?pe.value:pe.primaryKey),++O===H?g({result:K}):void pe.continue()):g({result:K})},D.onerror=st(C))})}),openCursor:function(E){var g=E.trans,C=E.values,O=E.query,D=E.reverse,K=E.unique;return new Promise(function(q,H){q=Pe(q);var G=O.index,F=O.range,L=g.objectStore(w),L=G.isPrimaryKey?L:L.index(G.name),G=D?K?"prevunique":"prev":K?"nextunique":"next",Y=!C&&"openKeyCursor"in L?L.openKeyCursor(i(F),G):L.openCursor(i(F),G);Y.onerror=st(H),Y.onsuccess=Pe(function(Q){var pe,be,we,rt,he=Y.result;he?(he.___id=++Eo,he.done=!1,pe=he.continue.bind(he),be=(be=he.continuePrimaryKey)&&be.bind(he),we=he.advance.bind(he),rt=function(){throw new Error("Cursor not stopped")},he.trans=g,he.stop=he.continue=he.continuePrimaryKey=he.advance=function(){throw new Error("Cursor not started")},he.fail=Pe(H),he.next=function(){var Xe=this,$e=1;return this.start(function(){return $e--?Xe.continue():Xe.stop()}).then(function(){return Xe})},he.start=function(Xe){function $e(){if(Y.result)try{Xe()}catch(et){he.fail(et)}else he.done=!0,he.start=function(){throw new Error("Cursor behind last entry")},he.stop()}var Yn=new Promise(function(et,Lt){et=Pe(et),Y.onerror=st(Lt),he.fail=Lt,he.stop=function(Mr){he.stop=he.continue=he.continuePrimaryKey=he.advance=rt,et(Mr)}});return Y.onsuccess=Pe(function(et){Y.onsuccess=$e,$e()}),he.continue=pe,he.continuePrimaryKey=be,he.advance=we,$e(),Yn},q(he)):q(null)},H)})},count:function(E){var g=E.query,C=E.trans,O=g.index,D=g.range;return new Promise(function(K,q){var H=C.objectStore(w),F=O.isPrimaryKey?H:H.index(O.name),H=i(D),F=H?F.count(H):F.count();F.onsuccess=Pe(function(L){return K(L.target.result)}),F.onerror=st(q)})}}}var c,h,p,k=(h=v,p=fi((c=e).objectStoreNames),{schema:{name:c.name,tables:p.map(function(S){return h.objectStore(S)}).map(function(S){var y=S.keyPath,g=S.autoIncrement,w=b(y),E={},g={name:S.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:w,keyPath:y,autoIncrement:g,unique:!0,extractKey:_r(y)},indexes:fi(S.indexNames).map(function(C){return S.index(C)}).map(function(K){var O=K.name,D=K.unique,q=K.multiEntry,K=K.keyPath,q={name:O,compound:b(K),keyPath:K,unique:D,multiEntry:q,extractKey:_r(K)};return E[cn(K)]=q}),getIndexByKeyPath:function(C){return E[cn(C)]}};return E[":id"]=g.primaryKey,y!=null&&(E[cn(y)]=g.primaryKey),g})},hasGetAll:0<p.length&&"getAll"in h.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),v=k.schema,_=k.hasGetAll,k=v.tables.map(a),m={};return k.forEach(function(S){return m[S.name]=S}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(S){if(!m[S])throw new Error("Table '".concat(S,"' not found"));return m[S]},MIN_KEY:-1/0,MAX_KEY:ln(t),schema:v}}function Io(e,t,n,i){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(i=So(t,a,i),e.dbcore.reduce(function(c,h){return h=h.create,o(o({},c),h(c))},i))}}function An(e,i){var n=i.db,i=Io(e._middlewares,n,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var c=a.name;e.core.schema.tables.some(function(h){return h.name===c})&&(a.core=e.core.table(c),e[c]instanceof e.Table&&(e[c].core=a.core))})}function jn(e,t,n,i){n.forEach(function(a){var c=i[a];t.forEach(function(h){var p=function v(_,k){return z(_,k)||(_=T(_))&&v(_,k)}(h,a);(!p||"value"in p&&p.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?J(h,a,{get:function(){return this.table(a)},set:function(v){M(this,a,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):h[a]=new e.Table(a,c))})})}function gr(e,t){t.forEach(function(n){for(var i in n)n[i]instanceof e.Table&&delete n[i]})}function Co(e,t){return e._cfg.version-t._cfg.version}function Oo(e,t,n,i){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=yr("$meta",hi("")[0],[]),e._storeNames.push("$meta"));var c=e._createTransaction("readwrite",e._storeNames,a);c.create(n),c._completion.catch(i);var h=c._reject.bind(c),p=ne.transless||ne;mt(function(){return ne.trans=c,ne.transless=p,t!==0?(An(e,n),_=t,((v=c).storeNames.includes("$meta")?v.table("$meta").get("version").then(function(k){return k??_}):W.resolve(_)).then(function(k){return S=k,y=c,w=n,E=[],k=(m=e)._versions,g=m._dbSchema=Rn(0,m.idbdb,w),(k=k.filter(function(C){return C._cfg.version>=S})).length!==0?(k.forEach(function(C){E.push(function(){var O=g,D=C._cfg.dbschema;Mn(m,O,w),Mn(m,D,w),g=m._dbSchema=D;var K=br(O,D);K.add.forEach(function(G){wr(w,G[0],G[1].primKey,G[1].indexes)}),K.change.forEach(function(G){if(G.recreate)throw new oe.Upgrade("Not yet support for changing primary key");var Y=w.objectStore(G.name);G.add.forEach(function(Q){return Kn(Y,Q)}),G.change.forEach(function(Q){Y.deleteIndex(Q.name),Kn(Y,Q)}),G.del.forEach(function(Q){return Y.deleteIndex(Q)})});var q=C._cfg.contentUpgrade;if(q&&C._cfg.version>S){An(m,w),y._memoizedTables={};var H=te(D);K.del.forEach(function(G){H[G]=O[G]}),gr(m,[m.Transaction.prototype]),jn(m,[m.Transaction.prototype],d(H),H),y.schema=H;var F,L=qe(q);return L&&zt(),K=W.follow(function(){var G;(F=q(y))&&L&&(G=vt.bind(null,null),F.then(G,G))}),F&&typeof F.then=="function"?W.resolve(F):K.then(function(){return F})}}),E.push(function(O){var D,K,q=C._cfg.dbschema;D=q,K=O,[].slice.call(K.db.objectStoreNames).forEach(function(H){return D[H]==null&&K.db.deleteObjectStore(H)}),gr(m,[m.Transaction.prototype]),jn(m,[m.Transaction.prototype],m._storeNames,m._dbSchema),y.schema=m._dbSchema}),E.push(function(O){m.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(m.idbdb.version/10)===C._cfg.version?(m.idbdb.deleteObjectStore("$meta"),delete m._dbSchema.$meta,m._storeNames=m._storeNames.filter(function(D){return D!=="$meta"})):O.objectStore("$meta").put(C._cfg.version,"version"))})}),function C(){return E.length?W.resolve(E.shift()(y.idbtrans)).then(C):W.resolve()}().then(function(){di(g,w)})):W.resolve();var m,S,y,w,E,g}).catch(h)):(d(a).forEach(function(k){wr(n,k,a[k].primKey,a[k].indexes)}),An(e,n),void W.follow(function(){return e.on.populate.fire(c)}).catch(h));var v,_})}function Po(e,t){di(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Rn(0,e.idbdb,t);Mn(e,e._dbSchema,t);for(var i=0,a=br(n,e._dbSchema).change;i<a.length;i++){var c=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var p=t.objectStore(h.name);h.add.forEach(function(v){at&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(v.src)),Kn(p,v)})}(a[i]);if(typeof c=="object")return c.value}}function br(e,t){var n,i={del:[],add:[],change:[]};for(n in e)t[n]||i.del.push(n);for(n in t){var a=e[n],c=t[n];if(a){var h={name:n,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||a.primKey.auto!==c.primKey.auto)h.recreate=!0,i.change.push(h);else{var p=a.idxByName,v=c.idxByName,_=void 0;for(_ in p)v[_]||h.del.push(_);for(_ in v){var k=p[_],m=v[_];k?k.src!==m.src&&h.change.push(m):h.add.push(m)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([n,c])}return i}function wr(e,t,n,i){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(c){return Kn(a,c)}),a}function di(e,t){d(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(at&&console.debug("Dexie: Creating missing table",n),wr(t,n,e[n].primKey,e[n].indexes))})}function Kn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Rn(e,t,n){var i={};return ee(t.objectStoreNames,0).forEach(function(a){for(var c=n.objectStore(a),h=vr(ci(_=c.keyPath),_||"",!0,!1,!!c.autoIncrement,_&&typeof _!="string",!0),p=[],v=0;v<c.indexNames.length;++v){var k=c.index(c.indexNames[v]),_=k.keyPath,k=vr(k.name,_,!!k.unique,!!k.multiEntry,!1,_&&typeof _!="string",!1);p.push(k)}i[a]=yr(a,h,p)}),i}function Mn(e,t,n){for(var i=n.db.objectStoreNames,a=0;a<i.length;++a){var c=i[a],h=n.objectStore(c);e._hasGetAll="getAll"in h;for(var p=0;p<h.indexNames.length;++p){var v=h.indexNames[p],_=h.index(v).keyPath,k=typeof _=="string"?_:"["+ee(_).join("+")+"]";!t[c]||(_=t[c].idxByName[k])&&(_.name=v,delete t[c].idxByName[k],t[c].idxByName[v]=_)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function hi(e){return e.split(",").map(function(t,n){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return vr(i,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),b(a),n===0)})}var Do=(Nn.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(n){if(e[n]!==null){var i=hi(e[n]),a=i.shift();if(a.unique=!0,a.multi)throw new oe.Schema("Primary key cannot be multi-valued");i.forEach(function(c){if(c.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),t[n]=yr(n,a,i)}})},Nn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?A(this._cfg.storesSource,n):n;var n=t._versions,i={},a={};return n.forEach(function(c){A(i,c._cfg.storesSource),a=c._cfg.dbschema={},c._parseStoresSpec(i,a)}),t._dbSchema=a,gr(t,[t._allTables,t,t.Transaction.prototype]),jn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},Nn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=tr(this._cfg.contentUpgrade||Ee,e),this},Nn);function Nn(){}function kr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new dt(In,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function xr(e){return e&&typeof e.databases=="function"}function Tr(e){return mt(function(){return ne.letThrough=!0,e()})}function Er(e){return!("from"in e)}var We=function(e,t){if(!this){var n=new We;return e&&"d"in e&&A(n,e),n}A(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function fn(e,t,n){var i=ke(t,n);if(!isNaN(i)){if(0<i)throw RangeError();if(Er(e))return A(e,{from:t,to:n,d:1});var a=e.l,i=e.r;if(ke(n,e.from)<0)return a?fn(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},mi(e);if(0<ke(t,e.to))return i?fn(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},mi(e);ke(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<ke(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&dn(e,a),i&&n&&dn(e,i)}}function dn(e,t){Er(t)||function n(i,v){var c=v.from,h=v.to,p=v.l,v=v.r;fn(i,c,h),p&&n(i,p),v&&n(i,v)}(e,t)}function pi(e,t){var n=Bn(t),i=n.next();if(i.done)return!1;for(var a=i.value,c=Bn(e),h=c.next(a.from),p=h.value;!i.done&&!h.done;){if(ke(p.from,a.to)<=0&&0<=ke(p.to,a.from))return!0;ke(a.from,p.from)<0?a=(i=n.next(p.from)).value:p=(h=c.next(a.from)).value}return!1}function Bn(e){var t=Er(e)?null:{s:0,n:e};return{next:function(n){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&ke(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||ke(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mi(e){var t,n,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",n=o({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],n[a]=i[t],(e[t]=n).d=vi(n)),e.d=vi(e)}function vi(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function qn(e,t){return d(t).forEach(function(n){e[n]?dn(e[n],t[n]):e[n]=function i(a){var c,h,p={};for(c in a)P(a,c)&&(h=a[c],p[c]=!h||typeof h!="object"||Te.has(h.constructor)?h:i(h));return p}(t[n])}),e}function Sr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&pi(t[n],e[n])})}x(We.prototype,((it={add:function(e){return dn(this,e),this},addKey:function(e){return fn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return fn(t,n,n)}),this},hasKey:function(e){var t=Bn(this).next(e).value;return t&&ke(t.from,e)<=0&&0<=ke(t.to,e)}})[ge]=function(){return Bn(this)},it));var qt={},Ir={},Cr=!1;function Fn(e){qn(Ir,e),Cr||(Cr=!0,setTimeout(function(){Cr=!1,Or(Ir,!(Ir={}))},0))}function Or(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var i=0,a=Object.values(qt);i<a.length;i++)yi(h=a[i],e,n,t);else for(var c in e){var h,p=/^idb\:\/\/(.*)\/(.*)\//.exec(c);p&&(c=p[1],p=p[2],(h=qt["idb://".concat(c,"/").concat(p)])&&yi(h,e,n,t))}n.forEach(function(v){return v()})}function yi(e,t,n,i){for(var a=[],c=0,h=Object.entries(e.queries.query);c<h.length;c++){for(var p=h[c],v=p[0],_=[],k=0,m=p[1];k<m.length;k++){var S=m[k];Sr(t,S.obsSet)?S.subscribers.forEach(function(g){return n.add(g)}):i&&_.push(S)}i&&a.push([v,_])}if(i)for(var y=0,w=a;y<w.length;y++){var E=w[y],v=E[0],_=E[1];e.queries.query[v]=_}}function Ao(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ne(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),c=!1;function h(){if(t.openCanceller!==i)throw new oe.DatabaseClosed("db.open() was cancelled")}function p(){return new W(function(S,y){if(h(),!n)throw new oe.MissingAPI;var w=e.name,E=t.autoSchema||!a?n.open(w):n.open(w,a);if(!E)throw new oe.MissingAPI;E.onerror=st(y),E.onblocked=Pe(e._fireOnBlocked),E.onupgradeneeded=Pe(function(g){var C;k=E.transaction,t.autoSchema&&!e._options.allowEmptyDB?(E.onerror=sn,k.abort(),E.result.close(),(C=n.deleteDatabase(w)).onsuccess=C.onerror=Pe(function(){y(new oe.NoSuchDatabase("Database ".concat(w," doesnt exist")))})):(k.onerror=st(y),g=g.oldVersion>Math.pow(2,62)?0:g.oldVersion,m=g<1,e.idbdb=E.result,c&&Po(e,k),Oo(e,g/10,k,y))},y),E.onsuccess=Pe(function(){k=null;var g,C,O,D,K,q=e.idbdb=E.result,H=ee(q.objectStoreNames);if(0<H.length)try{var F=q.transaction((D=H).length===1?D[0]:D,"readonly");if(t.autoSchema)C=q,O=F,(g=e).verno=C.version/10,O=g._dbSchema=Rn(0,C,O),g._storeNames=ee(C.objectStoreNames,0),jn(g,[g._allTables],d(O),O);else if(Mn(e,e._dbSchema,F),((K=br(Rn(0,(K=e).idbdb,F),K._dbSchema)).add.length||K.change.some(function(L){return L.add.length||L.change.length}))&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),q.close(),a=q.version+1,c=!0,S(p());An(e,F)}catch{}Gt.push(e),q.onversionchange=Pe(function(L){t.vcFired=!0,e.on("versionchange").fire(L)}),q.onclose=Pe(function(L){e.on("close").fire(L)}),m&&(K=e._deps,F=w,q=K.indexedDB,K=K.IDBKeyRange,xr(q)||F===In||kr(q,K).put({name:F}).catch(Ee)),S()},y)}).catch(function(S){switch(S==null?void 0:S.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),p();break;case"VersionError":if(0<a)return a=0,p()}return W.reject(S)})}var v,_=t.dbReadyResolve,k=null,m=!1;return W.race([i,(typeof navigator>"u"?W.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(S){function y(){return indexedDB.databases().finally(S)}v=setInterval(y,100),y()}).finally(function(){return clearInterval(v)}):Promise.resolve()).then(p)]).then(function(){return h(),t.onReadyBeingFired=[],W.resolve(Tr(function(){return e.on.ready.fire(e.vip)})).then(function S(){if(0<t.onReadyBeingFired.length){var y=t.onReadyBeingFired.reduce(tr,Ee);return t.onReadyBeingFired=[],W.resolve(Tr(function(){return y(e.vip)})).then(S)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(S){t.dbOpenError=S;try{k&&k.abort()}catch{}return i===t.openCanceller&&e._close(),Ne(S)}).finally(function(){t.openComplete=!0,_()}).then(function(){var S;return m&&(S={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(w){w.name&&(S["idb://".concat(e.name,"/").concat(y.name,"/").concat(w.name)]=new We(-1/0,[[[]]]))}),S["idb://".concat(e.name,"/").concat(y.name,"/")]=S["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new We(-1/0,[[[]]])}),gt(un).fire(S),Or(S,!0)),e})}function Pr(e){function t(c){return e.next(c)}var n=a(t),i=a(function(c){return e.throw(c)});function a(c){return function(v){var p=c(v),v=p.value;return p.done?v:v&&typeof v.then=="function"?v.then(n,i):b(v)?Promise.all(v).then(n,i):n(v)}}return a(t)()}function Ln(e,t,n){for(var i=b(e)?e.slice():[e],a=0;a<n;++a)i.push(t);return i}var jo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema,a={},c=[];function h(m,S,y){var w=cn(m),E=a[w]=a[w]||[],g=m==null?0:typeof m=="string"?1:m.length,C=0<S,C=o(o({},y),{name:C?"".concat(w,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:C,keyTail:S,keyLength:g,extractKey:_r(m),unique:!C&&y.unique});return E.push(C),C.isPrimaryKey||c.push(C),1<g&&h(g===2?m[0]:m.slice(0,g-1),S+1,y),E.sort(function(O,D){return O.keyTail-D.keyTail}),C}t=h(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var p=0,v=i.indexes;p<v.length;p++){var _=v[p];h(_.keyPath,0,_)}function k(m){var S,y=m.query.index;return y.isVirtual?o(o({},m),{query:{index:y.lowLevelIndex,range:(S=m.query.range,y=y.keyTail,{type:S.type===1?2:S.type,lower:Ln(S.lower,S.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:Ln(S.upper,S.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):m}return o(o({},n),{schema:o(o({},i),{primaryKey:t,indexes:c,getIndexByKeyPath:function(m){return(m=a[cn(m)])&&m[0]}}),count:function(m){return n.count(k(m))},query:function(m){return n.query(k(m))},openCursor:function(m){var S=m.query.index,y=S.keyTail,w=S.isVirtual,E=S.keyLength;return w?n.openCursor(k(m)).then(function(C){return C&&g(C)}):n.openCursor(m);function g(C){return Object.create(C,{continue:{value:function(O){O!=null?C.continue(Ln(O,m.reverse?e.MAX_KEY:e.MIN_KEY,y)):m.unique?C.continue(C.key.slice(0,E).concat(m.reverse?e.MIN_KEY:e.MAX_KEY,y)):C.continue()}},continuePrimaryKey:{value:function(O,D){C.continuePrimaryKey(Ln(O,e.MAX_KEY,y),D)}},primaryKey:{get:function(){return C.primaryKey}},key:{get:function(){var O=C.key;return E===1?O[0]:O.slice(0,E)}},value:{get:function(){return C.value}}})}}})}})}};function Dr(e,t,n,i){return n=n||{},i=i||"",d(e).forEach(function(a){var c,h,p;P(t,a)?(c=e[a],h=t[a],typeof c=="object"&&typeof h=="object"&&c&&h?(p=Ze(c))!==Ze(h)?n[i+a]=t[a]:p==="Object"?Dr(c,h,n,i+a+"."):c!==h&&(n[i+a]=t[a]):c!==h&&(n[i+a]=t[a])):n[i+a]=void 0}),d(t).forEach(function(a){P(e,a)||(n[i+a]=t[a])}),n}function Ar(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ko={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return o(o({},n),{mutate:function(a){var c=ne.trans,h=c.table(t).hook,p=h.deleting,v=h.creating,_=h.updating;switch(a.type){case"add":if(v.fire===Ee)break;return c._promise("readwrite",function(){return k(a)},!0);case"put":if(v.fire===Ee&&_.fire===Ee)break;return c._promise("readwrite",function(){return k(a)},!0);case"delete":if(p.fire===Ee)break;return c._promise("readwrite",function(){return k(a)},!0);case"deleteRange":if(p.fire===Ee)break;return c._promise("readwrite",function(){return function m(S,y,w){return n.query({trans:S,values:!1,query:{index:i,range:y},limit:w}).then(function(E){var g=E.result;return k({type:"delete",keys:g,trans:S}).then(function(C){return 0<C.numFailures?Promise.reject(C.failures[0]):g.length<w?{failures:[],numFailures:0,lastResult:void 0}:m(S,o(o({},y),{lower:g[g.length-1],lowerOpen:!0}),w)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function k(m){var S,y,w,E=ne.trans,g=m.keys||Ar(i,m);if(!g)throw new Error("Keys missing");return(m=m.type==="add"||m.type==="put"?o(o({},m),{keys:g}):o({},m)).type!=="delete"&&(m.values=l([],m.values)),m.keys&&(m.keys=l([],m.keys)),S=n,w=g,((y=m).type==="add"?Promise.resolve([]):S.getMany({trans:y.trans,keys:w,cache:"immutable"})).then(function(C){var O=g.map(function(D,K){var q,H,F,L=C[K],G={onerror:null,onsuccess:null};return m.type==="delete"?p.fire.call(G,D,L,E):m.type==="add"||L===void 0?(q=v.fire.call(G,D,m.values[K],E),D==null&&q!=null&&(m.keys[K]=D=q,i.outbound||Z(m.values[K],i.keyPath,D))):(q=Dr(L,m.values[K]),(H=_.fire.call(G,q,D,L,E))&&(F=m.values[K],Object.keys(H).forEach(function(Y){P(F,Y)?F[Y]=H[Y]:Z(F,Y,H[Y])}))),G});return n.mutate(m).then(function(D){for(var K=D.failures,q=D.results,H=D.numFailures,D=D.lastResult,F=0;F<g.length;++F){var L=(q||g)[F],G=O[F];L==null?G.onerror&&G.onerror(K[F]):G.onsuccess&&G.onsuccess(m.type==="put"&&C[F]?m.values[F]:L)}return{failures:K,results:q,numFailures:H,lastResult:D}}).catch(function(D){return O.forEach(function(K){return K.onerror&&K.onerror(D)}),Promise.reject(D)})})}}})}})}};function _i(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,c=0;a<t.keys.length&&c<e.length;++a)ke(t.keys[a],e[c])===0&&(i.push(n?ce(t.values[a]):t.values[a]),++c);return i.length===e.length?i:null}catch{return null}}var Ro={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return o(o({},n),{getMany:function(i){if(!i.cache)return n.getMany(i);var a=_i(i.keys,i.trans._cache,i.cache==="clone");return a?W.resolve(a):n.getMany(i).then(function(c){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?ce(c):c},c})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),n.mutate(i)}})}}}};function gi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function bi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Mo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new We(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,a,c){if(ne.subscr&&a!=="readonly")throw new oe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ne.querier));return e.transaction(i,a,c)},table:function(i){var a=e.table(i),c=a.schema,h=c.primaryKey,m=c.indexes,p=h.extractKey,v=h.outbound,_=h.autoIncrement&&m.filter(function(y){return y.compound&&y.keyPath.includes(h.keyPath)}),k=o(o({},a),{mutate:function(y){function w(Y){return Y="idb://".concat(t,"/").concat(i,"/").concat(Y),D[Y]||(D[Y]=new We)}var E,g,C,O=y.trans,D=y.mutatedParts||(y.mutatedParts={}),K=w(""),q=w(":dels"),H=y.type,G=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[Ar(h,y).filter(function(Y){return Y}),y.values]:[],F=G[0],L=G[1],G=y.trans._cache;return b(F)?(K.addKeys(F),(G=H==="delete"||F.length===L.length?_i(F,G):null)||q.addKeys(F),(G||L)&&(E=w,g=G,C=L,c.indexes.forEach(function(Y){var Q=E(Y.name||"");function pe(we){return we!=null?Y.extractKey(we):null}function be(we){return Y.multiEntry&&b(we)?we.forEach(function(rt){return Q.addKey(rt)}):Q.addKey(we)}(g||C).forEach(function(we,Xe){var he=g&&pe(g[Xe]),Xe=C&&pe(C[Xe]);ke(he,Xe)!==0&&(he!=null&&be(he),Xe!=null&&be(Xe))})}))):F?(L={from:(L=F.lower)!==null&&L!==void 0?L:e.MIN_KEY,to:(L=F.upper)!==null&&L!==void 0?L:e.MAX_KEY},q.add(L),K.add(L)):(K.add(n),q.add(n),c.indexes.forEach(function(Y){return w(Y.name).add(n)})),a.mutate(y).then(function(Y){return!F||y.type!=="add"&&y.type!=="put"||(K.addKeys(Y.results),_&&_.forEach(function(Q){for(var pe=y.values.map(function(he){return Q.extractKey(he)}),be=Q.keyPath.findIndex(function(he){return he===h.keyPath}),we=0,rt=Y.results.length;we<rt;++we)pe[we][be]=Y.results[we];w(Q.name).addKeys(pe)})),O.mutatedParts=qn(O.mutatedParts||{},D),Y})}}),m=function(w){var E=w.query,w=E.index,E=E.range;return[w,new We((w=E.lower)!==null&&w!==void 0?w:e.MIN_KEY,(E=E.upper)!==null&&E!==void 0?E:e.MAX_KEY)]},S={get:function(y){return[h,new We(y.key)]},getMany:function(y){return[h,new We().addKeys(y.keys)]},count:m,query:m,openCursor:m};return d(S).forEach(function(y){k[y]=function(w){var E=ne.subscr,g=!!E,C=gi(ne,a)&&bi(y,w)?w.obsSet={}:E;if(g){var O=function(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),C[L]||(C[L]=new We)},D=O(""),K=O(":dels"),E=S[y](w),g=E[0],E=E[1];if((y==="query"&&g.isPrimaryKey&&!w.values?K:O(g.name||"")).add(E),!g.isPrimaryKey){if(y!=="count"){var q=y==="query"&&v&&w.values&&a.query(o(o({},w),{values:!1}));return a[y].apply(this,arguments).then(function(L){if(y==="query"){if(v&&w.values)return q.then(function(pe){return pe=pe.result,D.addKeys(pe),L});var G=w.values?L.result.map(p):L.result;(w.values?D:K).addKeys(G)}else if(y==="openCursor"){var Y=L,Q=w.values;return Y&&Object.create(Y,{key:{get:function(){return K.addKey(Y.primaryKey),Y.key}},primaryKey:{get:function(){var pe=Y.primaryKey;return K.addKey(pe),pe}},value:{get:function(){return Q&&D.addKey(Y.primaryKey),Y.value}}})}return L})}K.add(n)}}return a[y].apply(this,arguments)}}),k}})}};function wi(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===i?null:(t=o({},t),b(t.keys)&&(t.keys=t.keys.filter(function(a,c){return!(c in n.failures)})),"values"in t&&b(t.values)&&(t.values=t.values.filter(function(a,c){return!(c in n.failures)})),t)}function jr(e,t){return n=e,((i=t).lower===void 0||(i.lowerOpen?0<ke(n,i.lower):0<=ke(n,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ke(e,t.upper)<0:ke(e,t.upper)<=0));var n,i}function ki(e,t,S,i,a,c){if(!S||S.length===0)return e;var h=t.query.index,p=h.multiEntry,v=t.query.range,_=i.schema.primaryKey.extractKey,k=h.extractKey,m=(h.lowLevelIndex||h).extractKey,S=S.reduce(function(y,w){var E=y,g=[];if(w.type==="add"||w.type==="put")for(var C=new We,O=w.values.length-1;0<=O;--O){var D,K=w.values[O],q=_(K);C.hasKey(q)||(D=k(K),(p&&b(D)?D.some(function(Y){return jr(Y,v)}):jr(D,v))&&(C.addKey(q),g.push(K)))}switch(w.type){case"add":var H=new We().addKeys(t.values?y.map(function(Q){return _(Q)}):y),E=y.concat(t.values?g.filter(function(Q){return Q=_(Q),!H.hasKey(Q)&&(H.addKey(Q),!0)}):g.map(function(Q){return _(Q)}).filter(function(Q){return!H.hasKey(Q)&&(H.addKey(Q),!0)}));break;case"put":var F=new We().addKeys(w.values.map(function(Q){return _(Q)}));E=y.filter(function(Q){return!F.hasKey(t.values?_(Q):Q)}).concat(t.values?g:g.map(function(Q){return _(Q)}));break;case"delete":var L=new We().addKeys(w.keys);E=y.filter(function(Q){return!L.hasKey(t.values?_(Q):Q)});break;case"deleteRange":var G=w.range;E=y.filter(function(Q){return!jr(_(Q),G)})}return E},e);return S===e?e:(S.sort(function(y,w){return ke(m(y),m(w))||ke(_(y),_(w))}),t.limit&&t.limit<1/0&&(S.length>t.limit?S.length=t.limit:e.length===t.limit&&S.length<t.limit&&(a.dirty=!0)),c?Object.freeze(S):S)}function xi(e,t){return ke(e.lower,t.lower)===0&&ke(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function No(e,t){return function(n,i,a,c){if(n===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=ke(n,i))===0){if(a&&c)return 0;if(a)return 1;if(c)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,i,a,c){if(n===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=ke(n,i))===0){if(a&&c)return 0;if(a)return-1;if(c)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Bo(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",function(){var a,c;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,c=t,setTimeout(function(){a.subscribers.size===0&&Ae(c,a)},3e3))})}var qo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(n,i,a){var c,h,p=e.transaction(n,i,a);return i==="readwrite"&&(h=(c=new AbortController).signal,a=function(v){return function(){if(c.abort(),i==="readwrite"){for(var _=new Set,k=0,m=n;k<m.length;k++){var S=m[k],y=qt["idb://".concat(t,"/").concat(S)];if(y){var w=e.table(S),E=y.optimisticOps.filter(function(Q){return Q.trans===p});if(p._explicit&&v&&p.mutatedParts)for(var g=0,C=Object.values(y.queries.query);g<C.length;g++)for(var O=0,D=(H=C[g]).slice();O<D.length;O++)Sr((F=D[O]).obsSet,p.mutatedParts)&&(Ae(H,F),F.subscribers.forEach(function(Q){return _.add(Q)}));else if(0<E.length){y.optimisticOps=y.optimisticOps.filter(function(Q){return Q.trans!==p});for(var K=0,q=Object.values(y.queries.query);K<q.length;K++)for(var H,F,L,G=0,Y=(H=q[K]).slice();G<Y.length;G++)(F=Y[G]).res!=null&&p.mutatedParts&&(v&&!F.dirty?(L=Object.isFrozen(F.res),L=ki(F.res,F.req,E,w,F,L),F.dirty?(Ae(H,F),F.subscribers.forEach(function(Q){return _.add(Q)})):L!==F.res&&(F.res=L,F.promise=W.resolve({result:L}))):(F.dirty&&Ae(H,F),F.subscribers.forEach(function(Q){return _.add(Q)})))}}}_.forEach(function(Q){return Q()})}}},p.addEventListener("abort",a(!1),{signal:h}),p.addEventListener("error",a(!1),{signal:h}),p.addEventListener("complete",a(!0),{signal:h})),p},table:function(n){var i=e.table(n),a=i.schema.primaryKey;return o(o({},i),{mutate:function(c){var h=ne.trans;if(a.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(c);var p=qt["idb://".concat(t,"/").concat(n)];return p?(h=i.mutate(c),c.type!=="add"&&c.type!=="put"||!(50<=c.values.length||Ar(a,c).some(function(v){return v==null}))?(p.optimisticOps.push(c),c.mutatedParts&&Fn(c.mutatedParts),h.then(function(v){0<v.numFailures&&(Ae(p.optimisticOps,c),(v=wi(0,c,v))&&p.optimisticOps.push(v),c.mutatedParts&&Fn(c.mutatedParts))}),h.catch(function(){Ae(p.optimisticOps,c),c.mutatedParts&&Fn(c.mutatedParts)})):h.then(function(v){var _=wi(0,o(o({},c),{values:c.values.map(function(k,m){var S;return v.failures[m]?k:(k=(S=a.keyPath)!==null&&S!==void 0&&S.includes(".")?ce(k):o({},k),Z(k,a.keyPath,v.results[m]),k)})}),v);p.optimisticOps.push(_),queueMicrotask(function(){return c.mutatedParts&&Fn(c.mutatedParts)})}),h):i.mutate(c)},query:function(c){if(!gi(ne,i)||!bi("query",c))return i.query(c);var h=((_=ne.trans)===null||_===void 0?void 0:_.db._options.cache)==="immutable",m=ne,p=m.requery,v=m.signal,_=function(w,E,g,C){var O=qt["idb://".concat(w,"/").concat(E)];if(!O)return[];if(!(E=O.queries[g]))return[null,!1,O,null];var D=E[(C.query?C.query.index.name:null)||""];if(!D)return[null,!1,O,null];switch(g){case"query":var K=D.find(function(q){return q.req.limit===C.limit&&q.req.values===C.values&&xi(q.req.query.range,C.query.range)});return K?[K,!0,O,D]:[D.find(function(q){return("limit"in q.req?q.req.limit:1/0)>=C.limit&&(!C.values||q.req.values)&&No(q.req.query.range,C.query.range)}),!1,O,D];case"count":return K=D.find(function(q){return xi(q.req.query.range,C.query.range)}),[K,!!K,O,D]}}(t,n,"query",c),k=_[0],m=_[1],S=_[2],y=_[3];return k&&m?k.obsSet=c.obsSet:(m=i.query(c).then(function(w){var E=w.result;if(k&&(k.res=E),h){for(var g=0,C=E.length;g<C;++g)Object.freeze(E[g]);Object.freeze(E)}else w.result=ce(E);return w}).catch(function(w){return y&&k&&Ae(y,k),Promise.reject(w)}),k={obsSet:c.obsSet,promise:m,subscribers:new Set,type:"query",req:c,dirty:!1},y?y.push(k):(y=[k],(S=S||(qt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[c.query.index.name||""]=y)),Bo(k,y,p,v),k.promise.then(function(w){return{result:ki(w.result,c,S==null?void 0:S.optimisticOps,i,k,h)}})}})}})}};function Un(e,t){return new Proxy(e,{get:function(n,i,a){return i==="db"?t:Reflect.get(n,i,a)}})}var dt=(Be.prototype.version=function(e){if(isNaN(e)||e<.1)throw new oe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(i){return i._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Co),n.stores({}),this._state.autoSchema=!1,n)},Be.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ne.letThrough||this._vip)?e():new W(function(n,i){if(t._state.openComplete)return i(new oe.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new oe.DatabaseClosed);t.open().catch(Ee)}t._state.dbReadyPromise.then(n,i)}).then(e)},Be.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:i??10,name:a}),e.sort(function(c,h){return c.level-h.level}),this},Be.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!n&&a.name!==n})),this},Be.prototype.open=function(){var e=this;return Mt(pt,function(){return Ao(e)})},Be.prototype._close=function(){var e=this._state,t=Gt.indexOf(this);if(0<=t&&Gt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new W(function(n){e.dbReadyResolve=n}),e.openCanceller=new W(function(n,i){e.cancelOpen=i}))},Be.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new oe.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new oe.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Be.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new W(function(a,c){function h(){t.close(e);var p=t._deps.indexedDB.deleteDatabase(t.name);p.onsuccess=Pe(function(){var v,_,k;v=t._deps,_=t.name,k=v.indexedDB,v=v.IDBKeyRange,xr(k)||_===In||kr(k,v).delete(_).catch(Ee),a()}),p.onerror=st(c),p.onblocked=t._fireOnBlocked}if(n)throw new oe.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Be.prototype.backendDB=function(){return this.idbdb},Be.prototype.isOpen=function(){return this.idbdb!==null},Be.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Be.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Be.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Be.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Be.prototype.transaction=function(){var e=(function(t,n,i){var a=arguments.length;if(a<2)throw new oe.InvalidArgument("Too few arguments");for(var c=new Array(a-1);--a;)c[a-1]=arguments[a];return i=c.pop(),[t,Se(c),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Be.prototype._transaction=function(e,t,n){var i=this,a=ne.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var c,h,p=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(_){if(_=_ instanceof i.Table?_.name:_,typeof _!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return _}),e=="r"||e===cr)c=cr;else{if(e!="rw"&&e!=fr)throw new oe.InvalidArgument("Invalid transaction mode: "+e);c=fr}if(a){if(a.mode===cr&&c===fr){if(!p)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&h.forEach(function(_){if(a&&a.storeNames.indexOf(_)===-1){if(!p)throw new oe.SubTransaction("Table "+_+" not included in parent transaction.");a=null}}),p&&a&&!a.active&&(a=null)}}catch(_){return a?a._promise(null,function(k,m){m(_)}):Ne(_)}var v=(function _(k,m,S,y,w){return W.resolve().then(function(){var E=ne.transless||ne,g=k._createTransaction(m,S,k._dbSchema,y);if(g.explicit=!0,E={trans:g,transless:E},y)g.idbtrans=y.idbtrans;else try{g.create(),g.idbtrans._explicit=!0,k._state.PR1398_maxLoop=3}catch(D){return D.name===Pt.InvalidState&&k.isOpen()&&0<--k._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),k.close({disableAutoOpen:!1}),k.open().then(function(){return _(k,m,S,null,w)})):Ne(D)}var C,O=qe(w);return O&&zt(),E=W.follow(function(){var D;(C=w.call(g,g))&&(O?(D=vt.bind(null,null),C.then(D,D)):typeof C.next=="function"&&typeof C.throw=="function"&&(C=Pr(C)))},E),(C&&typeof C.then=="function"?W.resolve(C).then(function(D){return g.active?D:Ne(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):E.then(function(){return C})).then(function(D){return y&&g._resolve(),g._completion.then(function(){return D})}).catch(function(D){return g._reject(D),Ne(D)})})}).bind(null,this,c,h,a,n);return a?a._promise(c,v,"lock"):ne.trans?Mt(ne.transless,function(){return i._whenReady(v)}):this._whenReady(v)},Be.prototype.table=function(e){if(!P(this._allTables,e))throw new oe.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Be);function Be(e,t){var n=this;this._middlewares={},this.verno=0;var i=Be.dependencies;this._options=t=o({addons:Be.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,c,h,p,v,_={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ee,dbReadyPromise:null,cancelOpen:Ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};_.dbReadyPromise=new W(function(m){_.dbReadyResolve=m}),_.openCanceller=new W(function(m,S){_.cancelOpen=S}),this._state=_,this.name=e,this.on=rn(this,"populate","blocked","versionchange","close",{ready:[tr,Ee]}),this.on.ready.subscribe=U(this.on.ready.subscribe,function(m){return function(S,y){Be.vip(function(){var w,E=n._state;E.openComplete?(E.dbOpenError||W.resolve().then(S),y&&m(S)):E.onReadyBeingFired?(E.onReadyBeingFired.push(S),y&&m(S)):(m(S),w=n,y||m(function g(){w.on.ready.unsubscribe(S),w.on.ready.unsubscribe(g)}))})}}),this.Collection=(a=this,on(wo.prototype,function(C,g){this.db=a;var y=ei,w=null;if(g)try{y=g()}catch(O){w=O}var E=C._ctx,g=E.table,C=g.hook.reading.fire;this._ctx={table:g,index:E.index,isPrimKey:!E.index||g.schema.primKey.keyPath&&E.index===g.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:w,or:E.or,valueMapper:C!==Jt?C:null}})),this.Table=(c=this,on(ii.prototype,function(m,S,y){this.db=c,this._tx=y,this.name=m,this.schema=S,this.hook=c._allTables[m]?c._allTables[m].hook:rn(null,{creating:[fo,Ee],reading:[co,Jt],updating:[po,Ee],deleting:[ho,Ee]})})),this.Transaction=(h=this,on(To.prototype,function(m,S,y,w,E){var g=this;this.db=h,this.mode=m,this.storeNames=S,this.schema=y,this.chromeTransactionDurability=w,this.idbtrans=null,this.on=rn(this,"complete","error","abort"),this.parent=E||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new W(function(C,O){g._resolve=C,g._reject=O}),this._completion.then(function(){g.active=!1,g.on.complete.fire()},function(C){var O=g.active;return g.active=!1,g.on.error.fire(C),g.parent?g.parent._reject(C):O&&g.idbtrans&&g.idbtrans.abort(),Ne(C)})})),this.Version=(p=this,on(Do.prototype,function(m){this.db=p,this._cfg={version:m,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(v=this,on(li.prototype,function(m,S,y){if(this.db=v,this._ctx={table:m,index:S===":id"?null:S,or:y},this._cmp=this._ascending=ke,this._descending=function(w,E){return ke(E,w)},this._max=function(w,E){return 0<ke(w,E)?w:E},this._min=function(w,E){return ke(w,E)<0?w:E},this._IDBKeyRange=v._deps.IDBKeyRange,!this._IDBKeyRange)throw new oe.MissingAPI})),this.on("versionchange",function(m){0<m.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(m){!m.newVersion||m.newVersion<m.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(m.oldVersion/10))}),this._maxKey=ln(t.IDBKeyRange),this._createTransaction=function(m,S,y,w){return new n.Transaction(m,S,y,n._options.chromeTransactionDurability,w)},this._fireOnBlocked=function(m){n.on("blocked").fire(m),Gt.filter(function(S){return S.name===n.name&&S!==n&&!S._state.vcFired}).map(function(S){return S.on("versionchange").fire(m)})},this.use(Ro),this.use(qo),this.use(Mo),this.use(jo),this.use(Ko);var k=new Proxy(this,{get:function(m,S,y){if(S==="_vip")return!0;if(S==="table")return function(E){return Un(n.table(E),k)};var w=Reflect.get(m,S,y);return w instanceof ii?Un(w,k):S==="tables"?w.map(function(E){return Un(E,k)}):S==="_createTransaction"?function(){return Un(w.apply(this,arguments),k)}:w}});this.vip=k,i.forEach(function(m){return m(n)})}var Vn,it=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Fo=(Kr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},Kr.prototype[it]=function(){return this},Kr);function Kr(e){this._subscribe=e}try{Vn={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{Vn={indexedDB:null,IDBKeyRange:null}}function Ti(e){var t,n=!1,i=new Fo(function(a){var c=qe(e),h,p=!1,v={},_={},k={get closed(){return p},unsubscribe:function(){p||(p=!0,h&&h.abort(),m&&gt.storagemutated.unsubscribe(y))}};a.start&&a.start(k);var m=!1,S=function(){return lr(w)},y=function(E){qn(v,E),Sr(_,v)&&S()},w=function(){var E,g,C;!p&&Vn.indexedDB&&(v={},E={},h&&h.abort(),h=new AbortController,C=function(O){var D=Yt();try{c&&zt();var K=mt(e,O);return K=c?K.finally(vt):K}finally{D&&Ht()}}(g={subscr:E,signal:h.signal,requery:S,querier:e,trans:null}),Promise.resolve(C).then(function(O){n=!0,t=O,p||g.signal.aborted||(v={},function(D){for(var K in D)if(P(D,K))return;return 1}(_=E)||m||(gt(un,y),m=!0),lr(function(){return!p&&a.next&&a.next(O)}))},function(O){n=!1,["DatabaseClosedError","AbortError"].includes(O==null?void 0:O.name)||p||lr(function(){p||a.error&&a.error(O)})}))};return setTimeout(S,0),k});return i.hasValue=function(){return n},i.getValue=function(){return t},i}var Ft=dt;function Rr(e){var t=bt;try{bt=!0,gt.storagemutated.fire(e),Or(e,!0)}finally{bt=t}}x(Ft,o(o({},_n),{delete:function(e){return new Ft(e,{addons:[]}).delete()},exists:function(e){return new Ft(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Ft.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(xr(n)?Promise.resolve(n.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==In})}):kr(n,t).toCollection().primaryKeys()).then(e)}catch{return Ne(new oe.MissingAPI)}var t,n},defineClass:function(){return function(e){A(this,e)}},ignoreTransaction:function(e){return ne.trans?Mt(ne.transless,e):e()},vip:Tr,async:function(e){return function(){try{var t=Pr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:W.resolve(t)}catch(n){return Ne(n)}}},spawn:function(e,t,n){try{var i=Pr(e.apply(n,t||[]));return i&&typeof i.then=="function"?i:W.resolve(i)}catch(a){return Ne(a)}},currentTransaction:{get:function(){return ne.trans||null}},waitFor:function(e,t){return t=W.resolve(typeof e=="function"?Ft.ignoreTransaction(e):e).timeout(t||6e4),ne.trans?ne.trans.waitFor(t):t},Promise:W,debug:{get:function(){return at},set:function(e){Gr(e)}},derive:ue,extend:A,props:x,override:U,Events:rn,on:gt,liveQuery:Ti,extendObservabilitySet:qn,getByKeyPath:re,setByKeyPath:Z,delByKeyPath:function(e,t){typeof t=="string"?Z(e,t,void 0):"length"in t&&[].map.call(t,function(n){Z(e,n,void 0)})},shallowClone:te,deepClone:ce,getObjectDiff:Dr,cmp:ke,asap:le,minKey:-1/0,addons:[],connections:Gt,errnames:Pt,dependencies:Vn,cache:qt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Ft.maxKey=ln(Ft.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(gt(un,function(e){bt||(e=new CustomEvent(mr,{detail:e}),bt=!0,dispatchEvent(e),bt=!1)}),addEventListener(mr,function(e){e=e.detail,bt||Rr(e)}));var $t,bt=!1,Ei=function(){};return typeof BroadcastChannel<"u"&&((Ei=function(){($t=new BroadcastChannel(mr)).onmessage=function(e){return e.data&&Rr(e.data)}})(),typeof $t.unref=="function"&&$t.unref(),gt(un,function(e){bt||$t.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!dt.disableBfCache&&e.persisted){at&&console.debug("Dexie: handling persisted pagehide"),$t!=null&&$t.close();for(var t=0,n=Gt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!dt.disableBfCache&&e.persisted&&(at&&console.debug("Dexie: handling persisted pageshow"),Ei(),Rr({all:new We(-1/0,[[]])}))})),W.rejectionMapper=function(e,t){return!e||e instanceof ve||e instanceof TypeError||e instanceof SyntaxError||!e.name||!zr[e.name]?e:(t=new zr[e.name](t||e.message,e),"stack"in e&&J(t,"stack",{get:function(){return this.inner.stack}}),t)},Gr(at),o(dt,Object.freeze({__proto__:null,Dexie:dt,liveQuery:Ti,Entity:ti,cmp:ke,PropModification:an,replacePrefix:function(e,t){return new an({replacePrefix:[e,t]})},add:function(e){return new an({add:e})},remove:function(e){return new an({remove:e})},default:dt,RangeSet:We,mergeRanges:dn,rangesOverlap:pi}),{default:dt}),dt})})(io);var $o=io.exports;const Br=Xo($o),Pi=Symbol.for("Dexie"),Zn=globalThis[Pi]||(globalThis[Pi]=Br);if(Br.semVer!==Zn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Br.semVer} and ${Zn.semVer}`);const{liveQuery:Ja,mergeRanges:Za,rangesOverlap:es,RangeSet:ts,cmp:ns,Entity:rs,PropModification:is,replacePrefix:os,add:as,remove:ss}=Zn;class Qo extends Zn{constructor(){super("MeditationGameDB");Si(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const pn=new Qo,mn=[{id:"L1",name:"Level 1",minDuration:Le.ONE_MINUTE,maxDuration:Le.FIVE_MINUTES,description:"Sit. Breathe. Notice the mind.",instructions:["Sit comfortably","Focus on the feeling of breath through your nose","Tap when you notice the mind has wandered","Gently return to the breath each time"],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:Le.TWO_MINUTES,maxDuration:Le.TEN_MINUTES,description:"Let go of counting and images.",instructions:["Focus on the breath through your nose","Don’t count, visualize, or repeat words","Tap when your mind wanders","Return to the breath, without mental help"],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:Le.FIVE_MINUTES,maxDuration:Le.FIFTEEN_MINUTES,description:"Observe thoughts as they arise.",instructions:["Focus on the breath through your nose","Don’t use any counting or mental images","Tap when distracted, then silently observe the thought","Label it if you can (e.g. “planning,” “judging”)","Let it go and return to the breath"],completionTasks:[{id:"two_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]},{id:"L4",name:"Level 4",minDuration:Le.FIVE_MINUTES,maxDuration:Le.FIFTEEN_MINUTES,description:"Notice how you react to yourself.",instructions:["Keep observing the breath","No counting or images","Tap when distracted, observe the thought","Then notice how you feel about getting distracted","If there’s frustration or judgment, notice that too — and let it go"],completionTasks:[{id:"two_sessions_under_5_taps",description:"Have 2 sessions in a row with fewer than 5 taps"},{id:"one_min_no_taps_twice",description:"Go 1 minute without a tap in 2 separate sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions","max_duration"]}}]},{id:"L5",name:"Level 5",minDuration:Le.TEN_MINUTES,maxDuration:Le.THIRTY_MINUTES,description:"Everything changes. Keep observing.",instructions:["Keep observing breath and distractions","Tap when the mind wanders, observe the thought, notice your reaction","Then remember: everything changes — including this","Let the distraction and your reaction pass","Return to the breath with calm awareness"],completionTasks:[{id:"session_with_3_or_fewer_taps",description:"Have one session with 3 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"two_min_no_taps",description:"Go 2 minutes without tapping"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps","max_duration"]}}]},{id:"L6",name:"Level 6",minDuration:Le.FIFTEEN_MINUTES,maxDuration:Le.SIXTY_MINUTES,description:"Sit still. Stay with discomfort.",instructions:["Observe breath, distractions, and reactions as before","Sit still in your chosen posture for the full session","If discomfort arises, don’t shift — just observe it","Notice the discomfort, let it change, and return to breath","Everything will pass"],completionTasks:[{id:"three_min_no_taps",description:"Go 3 minutes without a tap"},{id:"session_with_2_or_fewer_taps",description:"Have a session with 2 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"distractions_early_on",description:"Finish a sit with multiple distractions early on"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions","distractions_early_on","max_duration"]}}]}];function Di(u,r,s){const o=u.slice();return o[9]=r[s],o[11]=s,o}function Ai(u){let r,s,o=u[9]+"";return{c(){r=$("p"),s=new zo(!1),this.h()},l(l){r=X(l,"P",{class:!0,style:!0});var f=ie(r);s=Ho(f,!1),f.forEach(R),this.h()},h(){s.a=null,N(r,"class","text-lg max-w-sm fade-in svelte-1quun7c"),wt(r,"animation-delay",u[11]+"s")},m(l,f){fe(l,r,f),s.m(o,r)},p:Ve,d(l){l&&R(r)}}}function Jo(u){let r,s,o,l,f,d,b,A,T,I,P,x=Nr[u[1]]+"",M,J,ue,z=tt(u[2]),B=[];for(let ee=0;ee<z.length;ee+=1)B[ee]=Ai(Di(u,z,ee));return{c(){r=$("div"),s=$("button"),o=se("Exit Meditation"),l=_e();for(let ee=0;ee<B.length;ee+=1)B[ee].c();f=_e(),d=$("div"),b=$("button"),A=se("Start meditation countdown"),T=_e(),I=$("i"),P=se("Meditating for "),M=se(x),this.h()},l(ee){r=X(ee,"DIV",{class:!0});var U=ie(r);s=X(U,"BUTTON",{class:!0,style:!0});var V=ie(s);o=ae(V,"Exit Meditation"),V.forEach(R),l=ye(U);for(let te=0;te<B.length;te+=1)B[te].l(U);f=ye(U),d=X(U,"DIV",{class:!0});var le=ie(d);b=X(le,"BUTTON",{class:!0,style:!0});var re=ie(b);A=ae(re,"Start meditation countdown"),re.forEach(R),T=ye(le),I=X(le,"I",{class:!0,style:!0});var Z=ie(I);P=ae(Z,"Meditating for "),M=ae(Z,x),Z.forEach(R),le.forEach(R),U.forEach(R),this.h()},h(){N(s,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 fade-in svelte-1quun7c"),wt(s,"animation-delay",u[2].length+"s"),N(b,"class","btn variant-filled px-4 py-2 mt-8 fade-in svelte-1quun7c"),wt(b,"animation-delay",u[2].length+"s"),N(I,"class","text-sm text-gray-500 fade-in svelte-1quun7c"),wt(I,"animation-delay",u[2].length+"s"),N(d,"class","flex flex-col items-center space-y-4"),N(r,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(ee,U){fe(ee,r,U),j(r,s),j(s,o),j(r,l);for(let V=0;V<B.length;V+=1)B[V]&&B[V].m(r,null);j(r,f),j(r,d),j(d,b),j(b,A),j(d,T),j(d,I),j(I,P),j(I,M),J||(ue=[ht(s,"click",u[3]),ht(b,"click",function(){Yo(u[0])&&u[0].apply(this,arguments)})],J=!0)},p(ee,[U]){if(u=ee,U&4){z=tt(u[2]);let V;for(V=0;V<z.length;V+=1){const le=Di(u,z,V);B[V]?B[V].p(le,U):(B[V]=Ai(le),B[V].c(),B[V].m(r,f))}for(;V<B.length;V+=1)B[V].d(1);B.length=z.length}U&2&&x!==(x=Nr[u[1]]+"")&&Re(M,x)},i:Ve,o:Ve,d(ee){ee&&R(r),Vt(B,ee),J=!1,Fr(ue)}}}function Zo(u,r,s){let{nextStep:o}=r,{closeModal:l}=r,{duration:f}=r,{levelId:d="L1"}=r;const b=mn.find(x=>x.id===d),A=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],T=(b==null?void 0:b.instructions)||A;let I=0;Lr(()=>{Me.capture("instructions_viewed",{level:d});const x=setInterval(()=>{I<T.length+1?I+=1:clearInterval(x)},1e3)});const P=()=>{Me.capture("instructions_exit",{instructions_viewed:I,level:d}),l()};return u.$$set=x=>{"nextStep"in x&&s(0,o=x.nextStep),"closeModal"in x&&s(4,l=x.closeModal),"duration"in x&&s(1,f=x.duration),"levelId"in x&&s(5,d=x.levelId)},[o,f,T,P,l,d]}class ea extends Tt{constructor(r){super(),Et(this,r,Zo,Jo,xt,{nextStep:0,closeModal:4,duration:1,levelId:5})}}const ta=u=>{const r=u%60;return(u/60>1?`${Math.floor(u/60)}:`:"")+`${r<10?"0":""}${r}`};function Qt(u){const r=u/60;return Number.isInteger(r)?r:Math.round(r*10)/10}let Gn=null,Wn=null;const ji="/sounds/gong.m4a";function Hr(){return Gn||(Gn=new(window.AudioContext||window.webkitAudioContext),Me.capture("audio_context_created",{state:Gn.state,user_agent:navigator.userAgent})),Gn}async function oo(){try{const u=Hr();u.state==="suspended"&&(await u.resume(),Me.capture("audio_context_resumed",{state:u.state,user_agent:navigator.userAgent}))}catch(u){Me.capture("audio_context_resume_failed",{error:String(u),user_agent:navigator.userAgent})}}async function ao(){if(Wn)return Wn;try{const u=Hr(),r=await fetch(ji),s=r.headers.get("Content-Type"),o=r.headers.get("Content-Length");Me.capture("audio_fetch_response",{status:r.status,ok:r.ok,content_type:s,content_length:o,user_agent:navigator.userAgent});const l=await r.arrayBuffer();Me.capture("audio_arraybuffer_fetched",{byte_length:l.byteLength,user_agent:navigator.userAgent});try{return Wn=await u.decodeAudioData(l),Me.capture("audio_buffer_loaded",{buffer_byte_length:l.byteLength,user_agent:navigator.userAgent}),Wn}catch(f){throw Me.capture("audio_buffer_decode_failed",{error:String(f),byte_length:l.byteLength,content_type:s,url:ji,user_agent:navigator.userAgent,language:navigator.language}),f}}catch(u){throw Me.capture("audio_buffer_load_failed",{error:String(u),user_agent:navigator.userAgent}),u}}async function na(){try{await oo(),await ao(),Me.capture("audio_preload_success",{user_agent:navigator.userAgent})}catch(u){Me.capture("audio_preload_failed",{error:String(u),user_agent:navigator.userAgent})}}function ra(u){let r,s,o,l,f,d;return{c(){r=zn("svg"),s=zn("circle"),o=zn("circle"),f=zn("text"),d=se(u[1]),this.h()},l(b){r=Hn(b,"svg",{class:!0,viewBox:!0});var A=ie(r);s=Hn(A,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),ie(s).forEach(R),o=Hn(A,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),ie(o).forEach(R),f=Hn(A,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var T=ie(f);d=ae(T,u[1]),T.forEach(R),A.forEach(R),this.h()},h(){N(s,"cx","50"),N(s,"cy","50"),N(s,"r","40"),N(s,"stroke","gray"),N(s,"stroke-width","5"),N(s,"fill","none"),N(o,"cx","50"),N(o,"cy","50"),N(o,"r","40"),N(o,"stroke","blue"),N(o,"stroke-width","5"),N(o,"fill","none"),N(o,"stroke-dasharray","251.2"),N(o,"stroke-dashoffset",l=251.2*u[0]),N(o,"transform","rotate(-90 50 50)"),N(f,"x","50"),N(f,"y","55"),N(f,"font-size","14"),N(f,"text-anchor","middle"),N(f,"fill","black"),N(r,"class","w-32 h-32"),N(r,"viewBox","0 0 100 100")},m(b,A){fe(b,r,A),j(r,s),j(r,o),j(r,f),j(f,d)},p(b,[A]){A&1&&l!==(l=251.2*b[0])&&N(o,"stroke-dashoffset",l),A&2&&Re(d,b[1])},i:Ve,o:Ve,d(b){b&&R(r)}}}function ia(u,r,s){let o,l,{duration:f}=r,{startTimestamp:d}=r;const b=ro();let A=$n(f),T=null,I;const P=Ci(A,z=>ta(z));Qn(u,P,z=>s(1,l=z));const x=Ci(A,z=>z/f);Qn(u,x,z=>s(0,o=z));const M=async()=>{try{const z=Hr();await oo();const B=await ao(),ee=z.createBufferSource();ee.buffer=B,ee.connect(z.destination),ee.start(0),Me.capture("audio_played_successfully",{context_state:z.state,user_agent:navigator.userAgent})}catch(z){Me.capture("audio_play_failed",{error:String(z),user_agent:navigator.userAgent,language:navigator.language})}},J=()=>{clearInterval(I),M(),b("complete")},ue=async z=>{try{if(!("wakeLock"in navigator))return;z?T=await navigator.wakeLock.request("screen"):T&&(await T.release(),T=null)}catch(B){console.error(`Wake Lock ${z?"request":"release"} failed:`,B)}};return Lr(()=>{s(4,d=Date.now()),I=setInterval(()=>{A.update(z=>z>0?z-1:(J(),0))},1e3),ue(!0)}),Go(()=>{clearInterval(I),ue(!1)}),u.$$set=z=>{"duration"in z&&s(5,f=z.duration),"startTimestamp"in z&&s(4,d=z.startTimestamp)},[o,l,P,x,d,f]}class so extends Tt{constructor(r){super(),Et(this,r,ia,ra,xt,{duration:5,startTimestamp:4})}}function oa(u){let r,s,o,l="Your meditation starts in:",f,d,b,A,T,I="Exit Meditation",P,x,M,J;function ue(B){u[6](B)}let z={duration:aa};return u[0]!==void 0&&(z.startTimestamp=u[0]),d=new so({props:z}),Ur.push(()=>Yr(d,"startTimestamp",ue)),d.$on("complete",u[1]),{c(){r=$("div"),s=$("div"),o=$("p"),o.textContent=l,f=_e(),Ot(d.$$.fragment),A=_e(),T=$("button"),T.textContent=I,this.h()},l(B){r=X(B,"DIV",{class:!0});var ee=ie(r);s=X(ee,"DIV",{class:!0});var U=ie(s);o=X(U,"P",{class:!0,"data-svelte-h":!0}),Ue(o)!=="svelte-1tp8zka"&&(o.textContent=l),f=ye(U),Ct(d.$$.fragment,U),U.forEach(R),A=ye(ee),T=X(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(T)!=="svelte-hy6wnc"&&(T.textContent=I),ee.forEach(R),this.h()},h(){N(o,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto"),N(T,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(B,ee){fe(B,r,ee),j(r,s),j(s,o),j(s,f),It(d,s,null),j(r,A),j(r,T),x=!0,M||(J=ht(T,"click",u[2]),M=!0)},p(B,[ee]){const U={};!b&&ee&1&&(b=!0,U.startTimestamp=B[0],Vr(()=>b=!1)),d.$set(U)},i(B){x||(Fe(d.$$.fragment,B),B&&kt(()=>{x&&(P||(P=Qe(T,Je,{},!0)),P.run(1))}),x=!0)},o(B){Ge(d.$$.fragment,B),B&&(P||(P=Qe(T,Je,{},!1)),P.run(0)),x=!1},d(B){B&&R(r),St(d),B&&P&&P.end(),M=!1,J()}}}const aa=10;function sa(u,r,s){let{nextStep:o}=r,{closeModal:l}=r,{levelId:f="L1"}=r,d=0;Me.capture("countdown_started",{level:f});const b=()=>{Me.capture("countdown_complete",{level:f}),o()},A=()=>{Me.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:f}),l()};function T(I){d=I,s(0,d)}return u.$$set=I=>{"nextStep"in I&&s(3,o=I.nextStep),"closeModal"in I&&s(4,l=I.closeModal),"levelId"in I&&s(5,f=I.levelId)},[d,b,A,o,l,f,T]}class ua extends Tt{constructor(r){super(),Et(this,r,sa,oa,xt,{nextStep:3,closeModal:4,levelId:5})}}function la(u){let r,s;return{c(){r=$("br"),s=$("br")},l(o){r=X(o,"BR",{}),s=X(o,"BR",{})},m(o,l){fe(o,r,l),fe(o,s,l)},p:Ve,d(o){o&&(R(r),R(s))}}}function ca(u){let r,s,o;return{c(){r=$("i"),s=se(u[2]),o=se(" distraction"),this.h()},l(l){r=X(l,"I",{class:!0});var f=ie(r);s=ae(f,u[2]),o=ae(f," distraction"),f.forEach(R),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(l,f){fe(l,r,f),j(r,s),j(r,o)},p(l,f){f&4&&Re(s,l[2])},d(l){l&&R(r)}}}function fa(u){let r,s,o;return{c(){r=$("i"),s=se(u[2]),o=se(" distractions"),this.h()},l(l){r=X(l,"I",{class:!0});var f=ie(r);s=ae(f,u[2]),o=ae(f," distractions"),f.forEach(R),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(l,f){fe(l,r,f),j(r,s),j(r,o)},p(l,f){f&4&&Re(s,l[2])},d(l){l&&R(r)}}}function Ki(u){let r;return{c(){r=$("div"),this.h()},l(s){r=X(s,"DIV",{class:!0,style:!0}),ie(r).forEach(R),this.h()},h(){N(r,"class","ripple svelte-1wv6db6"),wt(r,"top",u[3].y+"px"),wt(r,"left",u[3].x+"px")},m(s,o){fe(s,r,o)},p(s,o){o&8&&wt(r,"top",s[3].y+"px"),o&8&&wt(r,"left",s[3].x+"px")},d(s){s&&R(r)}}}function da(u){let r,s,o,l,f,d,b="Tap anywhere on the screen to record your distractions",A,T,I,P,x,M="Exit Meditation",J,ue,z,B;function ee(te){u[11](te)}let U={duration:u[0]};u[1]!==void 0&&(U.startTimestamp=u[1]),o=new so({props:U}),Ur.push(()=>Yr(o,"startTimestamp",ee)),o.$on("complete",u[8]);function V(te,Ce){return te[2]>1||te[2]==0?fa:te[2]==1?ca:la}let le=V(u),re=le(u),Z=u[3]&&Ki(u);return{c(){r=$("div"),s=$("div"),Ot(o.$$.fragment),f=_e(),d=$("p"),d.textContent=b,A=_e(),re.c(),T=_e(),I=$("button"),Z&&Z.c(),P=_e(),x=$("button"),x.textContent=M,this.h()},l(te){r=X(te,"DIV",{class:!0});var Ce=ie(r);s=X(Ce,"DIV",{class:!0});var Se=ie(s);Ct(o.$$.fragment,Se),f=ye(Se),d=X(Se,"P",{class:!0,"data-svelte-h":!0}),Ue(d)!=="svelte-1uyhl39"&&(d.textContent=b),A=ye(Se),re.l(Se),Se.forEach(R),T=ye(Ce),I=X(Ce,"BUTTON",{class:!0});var Te=ie(I);Z&&Z.l(Te),Te.forEach(R),P=ye(Ce),x=X(Ce,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(x)!=="svelte-hy6wnc"&&(x.textContent=M),Ce.forEach(R),this.h()},h(){N(d,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto p-6"),N(I,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),N(x,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(te,Ce){fe(te,r,Ce),j(r,s),It(o,s,null),j(s,f),j(s,d),j(s,A),re.m(s,null),j(r,T),j(r,I),Z&&Z.m(I,null),j(r,P),j(r,x),ue=!0,z||(B=[ht(I,"click",u[6]),ht(x,"click",u[7])],z=!0)},p(te,[Ce]){const Se={};Ce&1&&(Se.duration=te[0]),!l&&Ce&2&&(l=!0,Se.startTimestamp=te[1],Vr(()=>l=!1)),o.$set(Se),le===(le=V(te))&&re?re.p(te,Ce):(re.d(1),re=le(te),re&&(re.c(),re.m(s,null))),te[3]?Z?Z.p(te,Ce):(Z=Ki(te),Z.c(),Z.m(I,null)):Z&&(Z.d(1),Z=null)},i(te){ue||(Fe(o.$$.fragment,te),te&&kt(()=>{ue&&(J||(J=Qe(x,Je,{},!0)),J.run(1))}),ue=!0)},o(te){Ge(o.$$.fragment,te),te&&(J||(J=Qe(x,Je,{},!1)),J.run(0)),ue=!1},d(te){te&&R(r),St(o),re.d(),Z&&Z.d(),te&&J&&J.end(),z=!1,Fr(B)}}}function ha(u,r,s){let o,l,{nextStep:f}=r,{duration:d}=r,{levelId:b="L1"}=r;const A=ro();let T=0;const I=$n(0);Qn(u,I,B=>s(2,o=B));const P=$n([]),x=$n(null);Qn(u,x,B=>s(3,l=B));const M=B=>{const ee=(Date.now()-T)/1e3;I.update(Z=>Z+1),P.update(Z=>[...Z,ee]),console.log(`Click ${Ut(I)} recorded at ${ee} seconds`),Me.capture("game_tap",{timestamp:ee,total_taps:Ut(I),level:b,button:"distracted"});const{clientX:U,clientY:V,currentTarget:le}=B,re=le.getBoundingClientRect();x.set({x:U-re.left,y:V-re.top}),setTimeout(()=>x.set(null),600)},J=()=>{const B=(Date.now()-T)/1e3;Me.capture("meditation_exit",{duration_meditated:B,total_taps:Ut(P).length,level:b}),A("complete",{clickTimestamps:Ut(P),durationMeditated:B,completed:d-B<5}),f()},ue=()=>{console.log("Meditation complete! Click data:",Ut(P)),Me.capture("meditation_completed",{duration:d,total_taps:Ut(P).length,level:b}),A("complete",{clickTimestamps:Ut(P),durationMeditated:d,completed:!0}),f()};function z(B){T=B,s(1,T)}return u.$$set=B=>{"nextStep"in B&&s(9,f=B.nextStep),"duration"in B&&s(0,d=B.duration),"levelId"in B&&s(10,b=B.levelId)},[d,T,o,l,I,x,M,J,ue,f,b,z]}class pa extends Tt{constructor(r){super(),Et(this,r,ha,da,xt,{nextStep:9,duration:0,levelId:10})}}function ma(u){const r=Math.floor(u.durationMeditated/60),s=u.clickTimestamps.length,o=u.newStarRating-u.previousStarRating,l="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share",f=u.levelId.replace(/^\D+/g,""),d=Object.entries(u.completionTaskResults).map(b=>b[1]?"✅":"🔲").join("");return o>0?`Major win! 🧘‍♂️  I just earned a new ⭐ in The Meditation Game!
I did a ${r}‑min meditation with only ${s} distractions.
I'm at ${"⭐".repeat(u.newStarRating)} on Level ${f} (${d})!
Learn and practice meditation here: ${l}`:u.isNewPersonalBest?`Mini‑win in The Meditation Game: my new personal best!
${r}‑min sit • only ${s} ${s===1?"mind-wander":"mind-wanders"} • ${"⭐".repeat(u.newStarRating)} on Level ${f} (${d})
Learn and practice meditation here: ${l}`:`Sharing todays practice in The Meditation Game.
I did a ${r}‑min meditation with only ${s} distractions.
I'm at ${"⭐".repeat(u.newStarRating)} on Level ${f} (${d}).
Learn and practice meditation here: ${l}`}function va(u){return u.newStarRating-u.previousStarRating>0?"A":u.isNewPersonalBest?"B":"C"}function uo(u){return u.filter(r=>r.completed).sort((r,s)=>s.duration!==r.duration?s.duration-r.duration:r.tapCount!==s.tapCount?r.tapCount-s.tapCount:s.timestamp-r.timestamp)[0]??null}function ya(u,r,s){const{scope:o,requirement:l}=u;return o==="cumulative"?Ri(l,r):s.some(f=>Ri(l,f))}function Ri(u,r){if(u.type==="minTasks"){const{count:s,from:o}=u;return o==="all"?r.size>=s:o.filter(f=>r.has(f)).length>=s}return u.type==="specificTasks"?u.taskIds.every(s=>r.has(s)):!1}function qr(u,r,s){const o=[...u].sort((l,f)=>f.stars-l.stars);for(const l of o)if(ya(l,r,s))return l.stars;return 0}function _a(u){if(u.length<2)return 0;const r=[...u].sort((o,l)=>o.timestamp-l.timestamp);let s=0;for(let o=1;o<r.length;o++){const l=r[o-1],f=r[o],d=l.tapCount/Math.max(l.duration,1),b=f.tapCount/Math.max(f.duration,1);(b<d||Math.abs(b-d)<=.005&&f.duration>l.duration)&&s++}return s}function Xn(u){if(!u.tapTimestamps||u.tapTimestamps.length===0)return u.duration/60;const r=[];r.push(u.tapTimestamps[0]);for(let o=1;o<u.tapTimestamps.length;o++)r.push(u.tapTimestamps[o]-u.tapTimestamps[o-1]);const s=u.tapTimestamps[u.tapTimestamps.length-1];return r.push(u.duration-s),Math.max(...r)}const Mi=(u,r)=>u.filter(r).length,hn=(u,r)=>u.some(r),lt={tap_once:([u])=>({completed:(u==null?void 0:u.tapCount)>=1,info:""}),no_early_exit:([u])=>({completed:(u==null?void 0:u.completed)===!0,info:""}),session_under_5_taps:([u])=>({completed:(u==null?void 0:u.tapCount)<=5,info:""}),session_with_2_or_fewer_taps:u=>({completed:hn(u,r=>r.tapCount<=2),info:""}),session_with_3_or_fewer_taps:u=>({completed:hn(u,r=>r.tapCount<=3),info:""}),distractions_early_on:([u])=>{var r;return{completed:((r=u==null?void 0:u.tapTimestamps)==null?void 0:r.filter(s=>s<=60).length)>=2,info:""}},complete_2_sessions:u=>({completed:u.length>=2,info:u.length===0||u.length>=2?"":"(1/2 complete)"}),complete_3_sessions:u=>({completed:u.length>=3,info:u.length===0||u.length>=3?"":`(${u.length}/3 complete)`}),two_sessions_under_5_taps:u=>{let r=0;for(let s=u.length-1;s>=0;s--)if(u[s].tapCount<5){if(r++,r===2)break}else r=0;return{completed:r===2,info:u.length===0||r===2?"":`(${Math.min(r,1)}/2 complete)`}},two_sessions_under_8_taps:u=>{const r=Mi(u,s=>s.tapCount<=8);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},one_min_no_taps:u=>({completed:hn(u,r=>Xn(r)>=60),info:""}),one_min_no_taps_twice:u=>{const r=Mi(u,s=>Xn(s)>=60);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},two_min_no_taps:u=>({completed:hn(u,r=>Xn(r)>=120),info:""}),three_min_no_taps:u=>({completed:hn(u,r=>Xn(r)>=180),info:""}),improve_tap_count_2_sessions:u=>{const r=_a(u);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},max_duration:(u,r)=>({completed:u.some(s=>s.duration>=r.maxDuration),info:""})};async function er(u){const r=mn.find(l=>l.id===u);if(!r)return{};const s=await pn.sessions.where("levelId").equals(u).toArray(),o={};for(const l of r.completionTasks){const f=lt[l.id];if(!f){console.warn(`Missing evaluator for task '${l.id}' in level '${u}'`),o[l.id]={completed:!1};continue}o[l.id]={...l,...f(s,r)}}return o}async function ga(){var r;const u=[];for(let s=0;s<mn.length;s++){const o=mn[s],l=await pn.sessions.where("levelId").equals(o.id).toArray(),f=s===0||(((r=u[s-1])==null?void 0:r.starRating)??0)>1;let d=null,b,A=null;if(f){d=await er(o.id);const T=new Set(Object.entries(d).filter(([P,x])=>x.completed).map(([P])=>P)),I=l.map(P=>new Set(o.completionTasks.filter(x=>{var M;return(M=lt[x.id])==null?void 0:M.call(lt,[P],o).completed}).map(x=>x.id)));b=qr(o.starRules,T,I),A=uo(l)}u.push({level:o,isUnlocked:f,taskCompletion:d,starRating:b,bestSession:A})}return u}function Ni(u,r,s){const o=u.slice();return o[8]=r[s][0],o[9]=r[s][1],o}function Bi(u,r,s){const o=u.slice();return o[8]=r[s],o[13]=s,o}function qi(u){let r;function s(f,d){return f[0].newStarRating===3?wa:ba}let o=s(u),l=o(u);return{c(){r=$("p"),l.c(),this.h()},l(f){r=X(f,"P",{class:!0});var d=ie(r);l.l(d),d.forEach(R),this.h()},h(){N(r,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(f,d){fe(f,r,d),l.m(r,null)},p(f,d){o===(o=s(f))&&l?l.p(f,d):(l.d(1),l=o(f),l&&(l.c(),l.m(r,null)))},d(f){f&&R(r),l.d()}}}function ba(u){let r,s=u[0].newStarRating-u[0].previousStarRating+"",o,l;return{c(){r=se("You earned +"),o=se(s),l=se(" ⭐ — keep going!")},l(f){r=ae(f,"You earned +"),o=ae(f,s),l=ae(f," ⭐ — keep going!")},m(f,d){fe(f,r,d),fe(f,o,d),fe(f,l,d)},p(f,d){d&1&&s!==(s=f[0].newStarRating-f[0].previousStarRating+"")&&Re(o,s)},d(f){f&&(R(r),R(o),R(l))}}}function wa(u){let r;return{c(){r=se("Mastered this level! ✨")},l(s){r=ae(s,"Mastered this level! ✨")},m(s,o){fe(s,r,o)},p:Ve,d(s){s&&R(r)}}}function Fi(u){let r,s=u[13]<u[0].newStarRating?"⭐":"☆",o,l;return{c(){r=$("span"),o=se(s),l=_e(),this.h()},l(f){r=X(f,"SPAN",{class:!0});var d=ie(r);o=ae(d,s),l=ye(d),d.forEach(R),this.h()},h(){N(r,"class","text-xl")},m(f,d){fe(f,r,d),j(r,o),j(r,l)},p(f,d){d&1&&s!==(s=f[13]<f[0].newStarRating?"⭐":"☆")&&Re(o,s)},d(f){f&&R(r)}}}function ka(u){let r,s="You completed your meditation distraction-free!";return{c(){r=$("p"),r.textContent=s,this.h()},l(o){r=X(o,"P",{class:!0,"data-svelte-h":!0}),Ue(r)!=="svelte-j87uf1"&&(r.textContent=s),this.h()},h(){N(r,"class","text-lg mt-4")},m(o,l){fe(o,r,l)},p:Ve,d(o){o&&R(r)}}}function xa(u){let r,s,o=u[4](u[0].durationMeditated)+"",l,f,d,b,A=u[2]===1?"distraction":"distractions",T,I,P,x,M,J,ue,z=Number(u[3])===1?"distraction":"distractions",B,ee;return{c(){r=$("p"),s=se("You meditated for "),l=se(o),f=se(" and recorded "),d=se(u[2]),b=_e(),T=se(A),I=se("."),P=_e(),x=$("p"),M=se("That's about "),J=se(u[3]),ue=_e(),B=se(z),ee=se(" per minute."),this.h()},l(U){r=X(U,"P",{class:!0});var V=ie(r);s=ae(V,"You meditated for "),l=ae(V,o),f=ae(V," and recorded "),d=ae(V,u[2]),b=ye(V),T=ae(V,A),I=ae(V,"."),V.forEach(R),P=ye(U),x=X(U,"P",{class:!0});var le=ie(x);M=ae(le,"That's about "),J=ae(le,u[3]),ue=ye(le),B=ae(le,z),ee=ae(le," per minute."),le.forEach(R),this.h()},h(){N(r,"class","text-lg mt-4"),N(x,"class","text-lg mt-2")},m(U,V){fe(U,r,V),j(r,s),j(r,l),j(r,f),j(r,d),j(r,b),j(r,T),j(r,I),fe(U,P,V),fe(U,x,V),j(x,M),j(x,J),j(x,ue),j(x,B),j(x,ee)},p(U,V){V&1&&o!==(o=U[4](U[0].durationMeditated)+"")&&Re(l,o)},d(U){U&&(R(r),R(P),R(x))}}}function Ta(u){let r,s,o=u[0].personalBest.tapCount+"",l,f,d=Qt(u[0].personalBest.duration)+"",b,A;return{c(){r=$("p"),s=se("Best so far: "),l=se(o),f=se(" taps · "),b=se(d),A=se(" min."),this.h()},l(T){r=X(T,"P",{class:!0});var I=ie(r);s=ae(I,"Best so far: "),l=ae(I,o),f=ae(I," taps · "),b=ae(I,d),A=ae(I," min."),I.forEach(R),this.h()},h(){N(r,"class","mt-4 text-muted-foreground")},m(T,I){fe(T,r,I),j(r,s),j(r,l),j(r,f),j(r,b),j(r,A)},p(T,I){I&1&&o!==(o=T[0].personalBest.tapCount+"")&&Re(l,o),I&1&&d!==(d=Qt(T[0].personalBest.duration)+"")&&Re(b,d)},d(T){T&&R(r)}}}function Ea(u){let r,s,o=u[0].personalBest.tapCount+"",l,f,d=Qt(u[0].personalBest.duration)+"",b,A;return{c(){r=$("p"),s=se("New personal best 🎉 — "),l=se(o),f=se(" taps over "),b=se(d),A=se(" min."),this.h()},l(T){r=X(T,"P",{class:!0});var I=ie(r);s=ae(I,"New personal best 🎉 — "),l=ae(I,o),f=ae(I," taps over "),b=ae(I,d),A=ae(I," min."),I.forEach(R),this.h()},h(){N(r,"class","mt-4 text-green-600 font-medium animate-fade-in svelte-tnqxsb")},m(T,I){fe(T,r,I),j(r,s),j(r,l),j(r,f),j(r,b),j(r,A)},p(T,I){I&1&&o!==(o=T[0].personalBest.tapCount+"")&&Re(l,o),I&1&&d!==(d=Qt(T[0].personalBest.duration)+"")&&Re(b,d)},d(T){T&&R(r)}}}function Li(u){let r,s=tt(Object.entries(u[1])),o=[];for(let l=0;l<s.length;l+=1)o[l]=Ui(Ni(u,s,l));return{c(){r=$("ul");for(let l=0;l<o.length;l+=1)o[l].c();this.h()},l(l){r=X(l,"UL",{class:!0});var f=ie(r);for(let d=0;d<o.length;d+=1)o[d].l(f);f.forEach(R),this.h()},h(){N(r,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto")},m(l,f){fe(l,r,f);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(l,f){if(f&2){s=tt(Object.entries(l[1]));let d;for(d=0;d<s.length;d+=1){const b=Ni(l,s,d);o[d]?o[d].p(b,f):(o[d]=Ui(b),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(l){l&&R(r),Vt(o,l)}}}function Ui(u){let r,s,o=u[9].completed?"✅":"🔲",l,f,d=u[9].description+"",b,A,T=u[9].info+"",I,P;return{c(){r=$("li"),s=$("span"),l=se(o),f=_e(),b=se(d),A=_e(),I=se(T),P=_e(),this.h()},l(x){r=X(x,"LI",{class:!0});var M=ie(r);s=X(M,"SPAN",{class:!0});var J=ie(s);l=ae(J,o),f=ye(J),b=ae(J,d),A=ye(J),I=ae(J,T),J.forEach(R),P=ye(M),M.forEach(R),this.h()},h(){N(s,"class","mr-2"),N(r,"class","flex items-center")},m(x,M){fe(x,r,M),j(r,s),j(s,l),j(s,f),j(s,b),j(s,A),j(s,I),j(r,P)},p(x,M){M&2&&o!==(o=x[9].completed?"✅":"🔲")&&Re(l,o),M&2&&d!==(d=x[9].description+"")&&Re(b,d),M&2&&T!==(T=x[9].info+"")&&Re(I,T)},d(x){x&&R(r)}}}function Vi(u){let r,s,o=u[0].newlyCompletedTasks.length+"",l,f,d=u[0].newlyCompletedTasks.length===1?"":"s",b,A;return{c(){r=$("p"),s=se("Nice! You just completed "),l=se(o),f=se(" task"),b=se(d),A=se("."),this.h()},l(T){r=X(T,"P",{class:!0});var I=ie(r);s=ae(I,"Nice! You just completed "),l=ae(I,o),f=ae(I," task"),b=ae(I,d),A=ae(I,"."),I.forEach(R),this.h()},h(){N(r,"class","mt-2 text-sm text-accent-foreground")},m(T,I){fe(T,r,I),j(r,s),j(r,l),j(r,f),j(r,b),j(r,A)},p(T,I){I&1&&o!==(o=T[0].newlyCompletedTasks.length+"")&&Re(l,o),I&1&&d!==(d=T[0].newlyCompletedTasks.length===1?"":"s")&&Re(b,d)},d(T){T&&R(r)}}}function Sa(u){let r,s,o="Great practice!",l,f,d,b,A,T,I,P="Level tasks",x,M,J,ue,z,B="Share",ee,U,V,le="Exit",re,Z,te=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p> <p class="mt-2">This app was made by Arjun, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn ↗</a></p>`,Ce,Se,Te=u[0].newStarRating>u[0].previousStarRating&&qi(u),de=tt(Array(3)),ce=[];for(let me=0;me<de.length;me+=1)ce[me]=Fi(Bi(u,de,me));function Ye(me,ve){return me[0].clickTimestamps.length>0?xa:ka}let Ze=Ye(u),ge=Ze(u);function De(me,ve){if(me[0].isNewPersonalBest&&me[0].personalBest)return Ea;if(me[0].personalBest)return Ta}let Ae=De(u),je=Ae&&Ae(u),Ie=u[1]&&Li(u),qe=u[0].newlyCompletedTasks.length>0&&Vi(u);return{c(){r=$("div"),s=$("h2"),s.textContent=o,l=_e(),Te&&Te.c(),f=_e(),d=$("div");for(let me=0;me<ce.length;me+=1)ce[me].c();b=_e(),ge.c(),A=_e(),je&&je.c(),T=_e(),I=$("h3"),I.textContent=P,x=_e(),Ie&&Ie.c(),M=_e(),qe&&qe.c(),J=_e(),ue=$("div"),z=$("button"),z.textContent=B,ee=_e(),U=$("div"),V=$("button"),V.textContent=le,re=_e(),Z=$("div"),Z.innerHTML=te,this.h()},l(me){r=X(me,"DIV",{class:!0});var ve=ie(r);s=X(ve,"H2",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-1untj5h"&&(s.textContent=o),l=ye(ve),Te&&Te.l(ve),f=ye(ve),d=X(ve,"DIV",{class:!0});var Ke=ie(d);for(let Pt=0;Pt<ce.length;Pt+=1)ce[Pt].l(Ke);Ke.forEach(R),b=ye(ve),ge.l(ve),A=ye(ve),je&&je.l(ve),T=ye(ve),I=X(ve,"H3",{class:!0,"data-svelte-h":!0}),Ue(I)!=="svelte-8ylw1a"&&(I.textContent=P),x=ye(ve),Ie&&Ie.l(ve),M=ye(ve),qe&&qe.l(ve),J=ye(ve),ue=X(ve,"DIV",{class:!0});var ot=ie(ue);z=X(ot,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(z)!=="svelte-1wlydhx"&&(z.textContent=B),ot.forEach(R),ee=ye(ve),U=X(ve,"DIV",{class:!0});var ct=ie(U);V=X(ct,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(V)!=="svelte-1t5v3tb"&&(V.textContent=le),ct.forEach(R),re=ye(ve),Z=X(ve,"DIV",{class:!0,"data-svelte-h":!0}),Ue(Z)!=="svelte-k92ud0"&&(Z.innerHTML=te),ve.forEach(R),this.h()},h(){N(s,"class","text-2xl font-bold"),N(d,"class","mt-2 flex items-center space-x-1"),N(I,"class","mt-6 font-semibold"),N(z,"class","btn variant-filled px-4 py-2"),N(ue,"class","mt-6 flex space-x-4"),N(V,"class","btn variant-outlined px-4 py-2"),N(U,"class","mt-6 flex space-x-4"),N(Z,"class","absolute bottom-6 text-center text-sm text-gray-500"),N(r,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(me,ve){fe(me,r,ve),j(r,s),j(r,l),Te&&Te.m(r,null),j(r,f),j(r,d);for(let Ke=0;Ke<ce.length;Ke+=1)ce[Ke]&&ce[Ke].m(d,null);j(r,b),ge.m(r,null),j(r,A),je&&je.m(r,null),j(r,T),j(r,I),j(r,x),Ie&&Ie.m(r,null),j(r,M),qe&&qe.m(r,null),j(r,J),j(r,ue),j(ue,z),j(r,ee),j(r,U),j(U,V),j(r,re),j(r,Z),Ce||(Se=[ht(z,"click",u[5]),ht(V,"click",u[6])],Ce=!0)},p(me,[ve]){if(me[0].newStarRating>me[0].previousStarRating?Te?Te.p(me,ve):(Te=qi(me),Te.c(),Te.m(r,f)):Te&&(Te.d(1),Te=null),ve&1){de=tt(Array(3));let Ke;for(Ke=0;Ke<de.length;Ke+=1){const ot=Bi(me,de,Ke);ce[Ke]?ce[Ke].p(ot,ve):(ce[Ke]=Fi(ot),ce[Ke].c(),ce[Ke].m(d,null))}for(;Ke<ce.length;Ke+=1)ce[Ke].d(1);ce.length=de.length}Ze===(Ze=Ye(me))&&ge?ge.p(me,ve):(ge.d(1),ge=Ze(me),ge&&(ge.c(),ge.m(r,A))),Ae===(Ae=De(me))&&je?je.p(me,ve):(je&&je.d(1),je=Ae&&Ae(me),je&&(je.c(),je.m(r,T))),me[1]?Ie?Ie.p(me,ve):(Ie=Li(me),Ie.c(),Ie.m(r,M)):Ie&&(Ie.d(1),Ie=null),me[0].newlyCompletedTasks.length>0?qe?qe.p(me,ve):(qe=Vi(me),qe.c(),qe.m(r,J)):qe&&(qe.d(1),qe=null)},i:Ve,o:Ve,d(me){me&&R(r),Te&&Te.d(),Vt(ce,me),ge.d(),je&&je.d(),Ie&&Ie.d(),qe&&qe.d(),Ce=!1,Fr(Se)}}}function Ia(u,r,s){let{closeModal:o}=r,{meditationResults:l}=r;const f=l.clickTimestamps.length,d=f>0?(f/(l.durationMeditated/60)).toFixed(1):"0";let b={};Lr(async()=>{l!=null&&l.levelId&&s(1,b=await er(l.levelId))});const A=P=>{const x=Math.floor(P/60),M=P%60;return x===0?M+" second"+(M===1?"":"s"):x+" minute"+(x===1?"":"s")+(M>0?" and "+M+" second"+(M===1?"":"s"):"")},T=()=>{if(navigator.share){const P=l.newStarRating-l.previousStarRating,x=va(l);Me.capture("results_shared",{total_taps:f,distractionRate:d,level:l.levelId,stars_gained:P,tasks_completed:l.newlyCompletedTasks.length,template_used:x,personal_best:l.isNewPersonalBest});const M=ma(l);navigator.share({text:M}).catch(J=>console.error("Sharing failed",J))}else console.log("Web Share API not supported")},I=()=>{Me.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:l.newStarRating-l.previousStarRating,tasks_completed:l.newlyCompletedTasks.length}),o()};return u.$$set=P=>{"closeModal"in P&&s(7,o=P.closeModal),"meditationResults"in P&&s(0,l=P.meditationResults)},[l,b,f,d,A,T,I,o]}class Ca extends Tt{constructor(r){super(),Et(this,r,Ia,Sa,xt,{closeModal:7,meditationResults:0})}}function Yi(u){let r,s,o,l,f,d,b;const A=[Aa,Da,Pa,Oa],T=[];function I(P,x){return P[3]===1?0:P[3]===2?1:P[3]===3?2:3}return o=I(u),l=T[o]=A[o](u),{c(){r=$("div"),s=$("div"),l.c(),this.h()},l(P){r=X(P,"DIV",{class:!0});var x=ie(r);s=X(x,"DIV",{class:!0});var M=ie(s);l.l(M),M.forEach(R),x.forEach(R),this.h()},h(){N(s,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),N(r,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(P,x){fe(P,r,x),j(r,s),T[o].m(s,null),b=!0},p(P,x){let M=o;o=I(P),o===M?T[o].p(P,x):(vn(),Ge(T[M],1,1,()=>{T[M]=null}),yn(),l=T[o],l?l.p(P,x):(l=T[o]=A[o](P),l.c()),Fe(l,1),l.m(s,null))},i(P){b||(Fe(l),P&&kt(()=>{b&&(f||(f=Qe(s,Je,{duration:500},!0)),f.run(1))}),P&&kt(()=>{b&&(d||(d=Qe(r,Je,{duration:500},!0)),d.run(1))}),b=!0)},o(P){Ge(l),P&&(f||(f=Qe(s,Je,{duration:500},!1)),f.run(0)),P&&(d||(d=Qe(r,Je,{duration:500},!1)),d.run(0)),b=!1},d(P){P&&R(r),T[o].d(),P&&f&&f.end(),P&&d&&d.end()}}}function Oa(u){let r,s,o,l;return s=new Ca({props:{closeModal:u[5],meditationResults:u[4]}}),{c(){r=$("div"),Ot(s.$$.fragment),this.h()},l(f){r=X(f,"DIV",{class:!0});var d=ie(r);Ct(s.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(f,d){fe(f,r,d),It(s,r,null),l=!0},p(f,d){const b={};d&16&&(b.meditationResults=f[4]),s.$set(b)},i(f){l||(Fe(s.$$.fragment,f),f&&kt(()=>{l&&(o||(o=Qe(r,Je,{duration:300},!0)),o.run(1))}),l=!0)},o(f){Ge(s.$$.fragment,f),f&&(o||(o=Qe(r,Je,{duration:300},!1)),o.run(0)),l=!1},d(f){f&&R(r),St(s),f&&o&&o.end()}}}function Pa(u){let r,s,o,l;return s=new pa({props:{duration:u[1],nextStep:u[7],levelId:u[2]}}),s.$on("complete",u[8]),{c(){r=$("div"),Ot(s.$$.fragment),this.h()},l(f){r=X(f,"DIV",{class:!0});var d=ie(r);Ct(s.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(f,d){fe(f,r,d),It(s,r,null),l=!0},p(f,d){const b={};d&2&&(b.duration=f[1]),d&4&&(b.levelId=f[2]),s.$set(b)},i(f){l||(Fe(s.$$.fragment,f),f&&kt(()=>{l&&(o||(o=Qe(r,Je,{duration:300},!0)),o.run(1))}),l=!0)},o(f){Ge(s.$$.fragment,f),f&&(o||(o=Qe(r,Je,{duration:300},!1)),o.run(0)),l=!1},d(f){f&&R(r),St(s),f&&o&&o.end()}}}function Da(u){let r,s,o,l;return s=new ua({props:{nextStep:u[7],closeModal:u[5],levelId:u[2]}}),{c(){r=$("div"),Ot(s.$$.fragment),this.h()},l(f){r=X(f,"DIV",{class:!0});var d=ie(r);Ct(s.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(f,d){fe(f,r,d),It(s,r,null),l=!0},p(f,d){const b={};d&4&&(b.levelId=f[2]),s.$set(b)},i(f){l||(Fe(s.$$.fragment,f),f&&kt(()=>{l&&(o||(o=Qe(r,Je,{duration:300},!0)),o.run(1))}),l=!0)},o(f){Ge(s.$$.fragment,f),f&&(o||(o=Qe(r,Je,{duration:300},!1)),o.run(0)),l=!1},d(f){f&&R(r),St(s),f&&o&&o.end()}}}function Aa(u){let r,s,o,l;return s=new ea({props:{nextStep:u[7],duration:u[1],closeModal:u[5],levelId:u[2]}}),{c(){r=$("div"),Ot(s.$$.fragment),this.h()},l(f){r=X(f,"DIV",{class:!0});var d=ie(r);Ct(s.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(f,d){fe(f,r,d),It(s,r,null),l=!0},p(f,d){const b={};d&2&&(b.duration=f[1]),d&4&&(b.levelId=f[2]),s.$set(b)},i(f){l||(Fe(s.$$.fragment,f),f&&kt(()=>{l&&(o||(o=Qe(r,Je,{duration:300},!0)),o.run(1))}),l=!0)},o(f){Ge(s.$$.fragment,f),f&&(o||(o=Qe(r,Je,{duration:300},!1)),o.run(0)),l=!1},d(f){f&&R(r),St(s),f&&o&&o.end()}}}function ja(u){let r,s,o=u[0]&&Yi(u);return{c(){o&&o.c(),r=Jn()},l(l){o&&o.l(l),r=Jn()},m(l,f){o&&o.m(l,f),fe(l,r,f),s=!0},p(l,[f]){l[0]?o?(o.p(l,f),f&1&&Fe(o,1)):(o=Yi(l),o.c(),Fe(o,1),o.m(r.parentNode,r)):o&&(vn(),Ge(o,1,1,()=>{o=null}),yn())},i(l){s||(Fe(o),s=!0)},o(l){Ge(o),s=!1},d(l){l&&R(r),o&&o.d(l)}}}function Ka(u,r,s){let{show:o=!1}=r,{duration:l=Le.ONE_MINUTE}=r,{levelId:f=null}=r,d=1,b;const A=()=>{s(0,o=!1),s(3,d=1)},T=async x=>{const{clickTimestamps:M,durationMeditated:J,completed:ue}=x.detail,z=f||"L1",B=mn.find(ge=>ge.id===z);if(!B)return;const ee=await pn.sessions.where("levelId").equals(z).toArray(),U=await er(z),V=new Set(Object.entries(U).filter(([ge,De])=>De.completed).map(([ge])=>ge)),le=ee.map(ge=>new Set(B.completionTasks.filter(De=>{var Ae;return(Ae=lt[De.id])==null?void 0:Ae.call(lt,[ge],B).completed}).map(De=>De.id))),re=qr(B.starRules,V,le),Z={levelId:z,duration:J,tapCount:M.length,tapTimestamps:M,timestamp:Date.now(),completed:ue};await pn.sessions.add(Z);const te=await er(z),Ce=new Set(Object.entries(te).filter(([ge,De])=>De.completed).map(([ge])=>ge)),Se=Object.entries(te).filter(([ge,De])=>{var Ae;return De.completed&&!((Ae=U[ge])!=null&&Ae.completed)}).map(([ge])=>ge),Te=await pn.sessions.where("levelId").equals(z).toArray(),de=Te.map(ge=>new Set(B.completionTasks.filter(De=>{var Ae;return(Ae=lt[De.id])==null?void 0:Ae.call(lt,[ge],B).completed}).map(De=>De.id))),ce=qr(B.starRules,Ce,de),Ye=uo(Te),Ze=Ye&&Ye.tapCount===M.length&&Ye.duration===J;s(4,b={...x.detail,levelId:z,previousStarRating:re,newStarRating:ce,newlyCompletedTasks:Se,completionTaskResults:Object.fromEntries(Object.entries(te).map(([ge,De])=>[ge,De.completed])),isNewPersonalBest:Ze||!1,personalBest:Ye}),I()},I=()=>setTimeout(()=>s(3,d++,d),300),P=x=>T(x);return u.$$set=x=>{"show"in x&&s(0,o=x.show),"duration"in x&&s(1,l=x.duration),"levelId"in x&&s(2,f=x.levelId)},[o,l,f,d,b,A,T,I,P]}class Ra extends Tt{constructor(r){super(),Et(this,r,Ka,ja,xt,{show:0,duration:1,levelId:2})}}function Hi(u,r,s){const o=u.slice();return o[6]=r[s],o}function zi(u){let r,s=Nr[u[6]]+"",o;return{c(){r=$("option"),o=se(s),this.h()},l(l){r=X(l,"OPTION",{});var f=ie(r);o=ae(f,s),f.forEach(R),this.h()},h(){r.__value=u[6],Wo(r,r.__value)},m(l,f){fe(l,r,f),j(r,o)},p:Ve,d(l){l&&R(r)}}}function Ma(u){let r,s,o="Select Meditation Duration",l,f,d,b,A=tt(u[2]),T=[];for(let I=0;I<A.length;I+=1)T[I]=zi(Hi(u,A,I));return{c(){r=$("div"),s=$("label"),s.textContent=o,l=_e(),f=$("select");for(let I=0;I<T.length;I+=1)T[I].c();this.h()},l(I){r=X(I,"DIV",{class:!0});var P=ie(r);s=X(P,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-g1prfd"&&(s.textContent=o),l=ye(P),f=X(P,"SELECT",{id:!0,class:!0});var x=ie(f);for(let M=0;M<T.length;M+=1)T[M].l(x);x.forEach(R),P.forEach(R),this.h()},h(){N(s,"for","duration"),N(s,"class","text-md font-medium"),N(f,"id","duration"),N(f,"class","select select-bordered w-full max-w-xs"),N(r,"class","flex flex-col items-start gap-1")},m(I,P){fe(I,r,P),j(r,s),j(r,l),j(r,f);for(let x=0;x<T.length;x+=1)T[x]&&T[x].m(f,null);Ii(f,u[1]),d||(b=ht(f,"change",u[5]),d=!0)},p(I,[P]){if(P&4){A=tt(I[2]);let x;for(x=0;x<A.length;x+=1){const M=Hi(I,A,x);T[x]?T[x].p(M,P):(T[x]=zi(M),T[x].c(),T[x].m(f,null))}for(;x<T.length;x+=1)T[x].d(1);T.length=A.length}P&6&&Ii(f,I[1])},i:Ve,o:Ve,d(I){I&&R(r),Vt(T,I),d=!1,b()}}}function Na(u,r,s){let{onDurationChange:o}=r,{minDuration:l=Le.ONE_MINUTE}=r,{maxDuration:f=Le.SIXTY_MINUTES}=r,{selectedDuration:d=l??Le.ONE_MINUTE}=r;const b=Object.values(Le).filter(T=>typeof T=="number").filter(T=>T>=l&&T<=f),A=T=>o(Number(T.currentTarget.value));return u.$$set=T=>{"onDurationChange"in T&&s(0,o=T.onDurationChange),"minDuration"in T&&s(3,l=T.minDuration),"maxDuration"in T&&s(4,f=T.maxDuration),"selectedDuration"in T&&s(1,d=T.selectedDuration)},[o,d,b,l,f,A]}class Ba extends Tt{constructor(r){super(),Et(this,r,Na,Ma,xt,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Gi(u,r,s){const o=u.slice();return o[9]=r[s].level,o[10]=r[s].isUnlocked,o[11]=r[s].taskCompletion,o[12]=r[s].starRating,o[13]=r[s].bestSession,o[14]=r,o[15]=s,o}function Wi(u,r,s){const o=u.slice();return o[16]=r[s][0],o[17]=r[s][1],o}function Xi(u,r,s){const o=u.slice();return o[16]=r[s],o[21]=s,o}function qa(u){let r,s,o=tt(u[3]),l=[];for(let d=0;d<o.length;d+=1)l[d]=no(Gi(u,o,d));const f=d=>Ge(l[d],1,1,()=>{l[d]=null});return{c(){r=$("div");for(let d=0;d<l.length;d+=1)l[d].c();this.h()},l(d){r=X(d,"DIV",{class:!0});var b=ie(r);for(let A=0;A<l.length;A+=1)l[A].l(b);b.forEach(R),this.h()},h(){N(r,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full")},m(d,b){fe(d,r,b);for(let A=0;A<l.length;A+=1)l[A]&&l[A].m(r,null);s=!0},p(d,b){if(b&46){o=tt(d[3]);let A;for(A=0;A<o.length;A+=1){const T=Gi(d,o,A);l[A]?(l[A].p(T,b),Fe(l[A],1)):(l[A]=no(T),l[A].c(),Fe(l[A],1),l[A].m(r,null))}for(vn(),A=o.length;A<l.length;A+=1)f(A);yn()}},i(d){if(!s){for(let b=0;b<o.length;b+=1)Fe(l[b]);s=!0}},o(d){l=l.filter(Boolean);for(let b=0;b<l.length;b+=1)Ge(l[b]);s=!1},d(d){d&&R(r),Vt(l,d)}}}function Fa(u){let r,s='<div class="loading loading-spinner loading-lg"></div>';return{c(){r=$("div"),r.innerHTML=s,this.h()},l(o){r=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Ue(r)!=="svelte-1mgfhb9"&&(r.innerHTML=s),this.h()},h(){N(r,"class","flex justify-center items-center mt-8")},m(o,l){fe(o,r,l)},p:Ve,i:Ve,o:Ve,d(o){o&&R(r)}}}function $i(u){let r,s="🔒";return{c(){r=$("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ue(r)!=="svelte-19hy9gc"&&(r.textContent=s),this.h()},h(){N(r,"class","text-2xl")},m(o,l){fe(o,r,l)},d(o){o&&R(r)}}}function Qi(u){let r,s=tt(Array(3)),o=[];for(let l=0;l<s.length;l+=1)o[l]=Ji(Xi(u,s,l));return{c(){r=$("div");for(let l=0;l<o.length;l+=1)o[l].c();this.h()},l(l){r=X(l,"DIV",{class:!0});var f=ie(r);for(let d=0;d<o.length;d+=1)o[d].l(f);f.forEach(R),this.h()},h(){N(r,"class","flex items-center")},m(l,f){fe(l,r,f);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(l,f){if(f&8){s=tt(Array(3));let d;for(d=0;d<s.length;d+=1){const b=Xi(l,s,d);o[d]?o[d].p(b,f):(o[d]=Ji(b),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(l){l&&R(r),Vt(o,l)}}}function La(u){let r,s="★";return{c(){r=$("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ue(r)!=="svelte-1tpxw7h"&&(r.textContent=s),this.h()},h(){N(r,"class","text-2xl text-gray-300")},m(o,l){fe(o,r,l)},d(o){o&&R(r)}}}function Ua(u){let r,s="⭐";return{c(){r=$("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ue(r)!=="svelte-1jlkvsx"&&(r.textContent=s),this.h()},h(){N(r,"class","text-2xl")},m(o,l){fe(o,r,l)},d(o){o&&R(r)}}}function Ji(u){let r;function s(f,d){return f[21]<f[12]?Ua:La}let o=s(u),l=o(u);return{c(){l.c(),r=Jn()},l(f){l.l(f),r=Jn()},m(f,d){l.m(f,d),fe(f,r,d)},p(f,d){o!==(o=s(f))&&(l.d(1),l=o(f),l&&(l.c(),l.m(r.parentNode,r)))},d(f){f&&R(r),l.d(f)}}}function Zi(u){let r,s,o=u[13].tapCount+"",l,f,d=Qt(u[13].duration)+"",b,A;return{c(){r=$("p"),s=se("Your best: "),l=se(o),f=se(" taps · "),b=se(d),A=se(" min"),this.h()},l(T){r=X(T,"P",{class:!0});var I=ie(r);s=ae(I,"Your best: "),l=ae(I,o),f=ae(I," taps · "),b=ae(I,d),A=ae(I," min"),I.forEach(R),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(T,I){fe(T,r,I),j(r,s),j(r,l),j(r,f),j(r,b),j(r,A)},p(T,I){I&8&&o!==(o=T[13].tapCount+"")&&Re(l,o),I&8&&d!==(d=Qt(T[13].duration)+"")&&Re(b,d)},d(T){T&&R(r)}}}function eo(u){let r,s=tt(Object.entries(u[11])),o=[];for(let l=0;l<s.length;l+=1)o[l]=to(Wi(u,s,l));return{c(){r=$("div");for(let l=0;l<o.length;l+=1)o[l].c();this.h()},l(l){r=X(l,"DIV",{class:!0});var f=ie(r);for(let d=0;d<o.length;d+=1)o[d].l(f);f.forEach(R),this.h()},h(){N(r,"class","space-y-0")},m(l,f){fe(l,r,f);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(l,f){if(f&8){s=tt(Object.entries(l[11]));let d;for(d=0;d<s.length;d+=1){const b=Wi(l,s,d);o[d]?o[d].p(b,f):(o[d]=to(b),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(l){l&&R(r),Vt(o,l)}}}function to(u){let r,s,o=u[17].completed?"✅":"🔲",l,f,d=u[17].description+"",b,A,T=u[17].info+"",I,P;return{c(){r=$("div"),s=$("span"),l=se(o),f=_e(),b=se(d),A=_e(),I=se(T),P=_e(),this.h()},l(x){r=X(x,"DIV",{class:!0});var M=ie(r);s=X(M,"SPAN",{class:!0});var J=ie(s);l=ae(J,o),f=ye(J),b=ae(J,d),A=ye(J),I=ae(J,T),J.forEach(R),P=ye(M),M.forEach(R),this.h()},h(){N(s,"class","mr-2 text-sm text-gray-500"),N(r,"class","flex items-center")},m(x,M){fe(x,r,M),j(r,s),j(s,l),j(s,f),j(s,b),j(s,A),j(s,I),j(r,P)},p(x,M){M&8&&o!==(o=x[17].completed?"✅":"🔲")&&Re(l,o),M&8&&d!==(d=x[17].description+"")&&Re(b,d),M&8&&T!==(T=x[17].info+"")&&Re(I,T)},d(x){x&&R(r)}}}function Va(u){let r,s='<p class="text-sm text-gray-500">Achieve 2 stars in previous levels to unlock</p>';return{c(){r=$("div"),r.innerHTML=s,this.h()},l(o){r=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Ue(r)!=="svelte-agxr37"&&(r.innerHTML=s),this.h()},h(){N(r,"class","space-y-4 mt-8")},m(o,l){fe(o,r,l)},p:Ve,i:Ve,o:Ve,d(o){o&&R(r)}}}function Ya(u){let r,s,o,l,f="Start meditation",d,b,A;function T(...P){return u[6](u[9],u[14],u[15],...P)}s=new Ba({props:{selectedDuration:u[9].selectedDuration,onDurationChange:T,minDuration:u[9].minDuration,maxDuration:u[9].maxDuration}});function I(){return u[7](u[9])}return{c(){r=$("div"),Ot(s.$$.fragment),o=_e(),l=$("button"),l.textContent=f,this.h()},l(P){r=X(P,"DIV",{class:!0});var x=ie(r);Ct(s.$$.fragment,x),o=ye(x),l=X(x,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(l)!=="svelte-egxc4d"&&(l.textContent=f),x.forEach(R),this.h()},h(){N(l,"class","btn variant-filled w-full"),N(r,"class","space-y-6 mt-8")},m(P,x){fe(P,r,x),It(s,r,null),j(r,o),j(r,l),d=!0,b||(A=ht(l,"click",I),b=!0)},p(P,x){u=P;const M={};x&8&&(M.selectedDuration=u[9].selectedDuration),x&8&&(M.onDurationChange=T),x&8&&(M.minDuration=u[9].minDuration),x&8&&(M.maxDuration=u[9].maxDuration),s.$set(M)},i(P){d||(Fe(s.$$.fragment,P),d=!0)},o(P){Ge(s.$$.fragment,P),d=!1},d(P){P&&R(r),St(s),b=!1,A()}}}function no(u){let r,s,o,l,f=u[9].name+"",d,b,A,T,I,P=u[9].description+"",x,M,J,ue,z,B,ee,U,V,le=!u[10]&&$i(),re=u[12]!==void 0&&u[10]&&Qi(u),Z=u[13]&&u[10]&&Zi(u),te=u[11]&&u[10]&&eo(u);const Ce=[Ya,Va],Se=[];function Te(de,ce){return de[10]?0:1}return z=Te(u),B=Se[z]=Ce[z](u),{c(){r=$("div"),s=$("div"),o=$("h3"),le&&le.c(),l=_e(),d=se(f),b=_e(),re&&re.c(),A=_e(),T=$("div"),I=$("p"),x=se(P),M=_e(),Z&&Z.c(),J=_e(),te&&te.c(),ue=_e(),B.c(),ee=_e(),this.h()},l(de){r=X(de,"DIV",{class:!0});var ce=ie(r);s=X(ce,"DIV",{class:!0});var Ye=ie(s);o=X(Ye,"H3",{class:!0});var Ze=ie(o);le&&le.l(Ze),l=ye(Ze),d=ae(Ze,f),Ze.forEach(R),b=ye(Ye),re&&re.l(Ye),Ye.forEach(R),A=ye(ce),T=X(ce,"DIV",{class:!0});var ge=ie(T);I=X(ge,"P",{class:!0});var De=ie(I);x=ae(De,P),De.forEach(R),M=ye(ge),Z&&Z.l(ge),ge.forEach(R),J=ye(ce),te&&te.l(ce),ue=ye(ce),B.l(ce),ee=ye(ce),ce.forEach(R),this.h()},h(){N(o,"class","text-lg font-bold"),N(s,"class","flex justify-between items-center mb-2"),N(I,"class","text-sm text-muted-foreground mb-2"),N(T,"class","mb-2"),N(r,"class",U="card bg-[#ffffffa6] p-8 "+(u[10]?"":"opacity-60"))},m(de,ce){fe(de,r,ce),j(r,s),j(s,o),le&&le.m(o,null),j(o,l),j(o,d),j(s,b),re&&re.m(s,null),j(r,A),j(r,T),j(T,I),j(I,x),j(T,M),Z&&Z.m(T,null),j(r,J),te&&te.m(r,null),j(r,ue),Se[z].m(r,null),j(r,ee),V=!0},p(de,ce){de[10]?le&&(le.d(1),le=null):le||(le=$i(),le.c(),le.m(o,l)),(!V||ce&8)&&f!==(f=de[9].name+"")&&Re(d,f),de[12]!==void 0&&de[10]?re?re.p(de,ce):(re=Qi(de),re.c(),re.m(s,null)):re&&(re.d(1),re=null),(!V||ce&8)&&P!==(P=de[9].description+"")&&Re(x,P),de[13]&&de[10]?Z?Z.p(de,ce):(Z=Zi(de),Z.c(),Z.m(T,null)):Z&&(Z.d(1),Z=null),de[11]&&de[10]?te?te.p(de,ce):(te=eo(de),te.c(),te.m(r,ue)):te&&(te.d(1),te=null);let Ye=z;z=Te(de),z===Ye?Se[z].p(de,ce):(vn(),Ge(Se[Ye],1,1,()=>{Se[Ye]=null}),yn(),B=Se[z],B?B.p(de,ce):(B=Se[z]=Ce[z](de),B.c()),Fe(B,1),B.m(r,ee)),(!V||ce&8&&U!==(U="card bg-[#ffffffa6] p-8 "+(de[10]?"":"opacity-60")))&&N(r,"class",U)},i(de){V||(Fe(B),V=!0)},o(de){Ge(B),V=!1},d(de){de&&R(r),le&&le.d(),re&&re.d(),Z&&Z.d(),te&&te.d(),Se[z].d()}}}function Ha(u){let r,s,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',l,f,d,b,A,T=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn ↗</a></p>`,I,P,x,M;const J=[Fa,qa],ue=[];function z(U,V){return U[4]?0:1}f=z(u),d=ue[f]=J[f](u);function B(U){u[8](U)}let ee={duration:u[1],levelId:u[2]};return u[0]!==void 0&&(ee.show=u[0]),P=new Ra({props:ee}),Ur.push(()=>Yr(P,"show",B)),{c(){r=$("div"),s=$("div"),s.innerHTML=o,l=_e(),d.c(),b=_e(),A=$("div"),A.innerHTML=T,I=_e(),Ot(P.$$.fragment),this.h()},l(U){r=X(U,"DIV",{class:!0});var V=ie(r);s=X(V,"DIV",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-50yq01"&&(s.innerHTML=o),l=ye(V),d.l(V),b=ye(V),A=X(V,"DIV",{class:!0,"data-svelte-h":!0}),Ue(A)!=="svelte-dgw8za"&&(A.innerHTML=T),V.forEach(R),I=ye(U),Ct(P.$$.fragment,U),this.h()},h(){N(s,"class","space-y-6 text-center mt-10 mb-8"),N(A,"class","text-center text-sm text-gray-500 mt-40"),N(r,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(U,V){fe(U,r,V),j(r,s),j(r,l),ue[f].m(r,null),j(r,b),j(r,A),fe(U,I,V),It(P,U,V),M=!0},p(U,[V]){let le=f;f=z(U),f===le?ue[f].p(U,V):(vn(),Ge(ue[le],1,1,()=>{ue[le]=null}),yn(),d=ue[f],d?d.p(U,V):(d=ue[f]=J[f](U),d.c()),Fe(d,1),d.m(r,b));const re={};V&2&&(re.duration=U[1]),V&4&&(re.levelId=U[2]),!x&&V&1&&(x=!0,re.show=U[0],Vr(()=>x=!1)),P.$set(re)},i(U){M||(Fe(d),Fe(P.$$.fragment,U),M=!0)},o(U){Ge(d),Ge(P.$$.fragment,U),M=!1},d(U){U&&(R(r),R(I)),ue[f].d(),St(P,U)}}}function za(u,r,s){let o=!1,l=Le.ONE_MINUTE,f=null,d=[],b=!0;const A=async()=>{await na(),s(0,o=!0)},T=(x,M,J,ue)=>s(3,M[J].level.selectedDuration=ue,d),I=x=>{s(2,f=x.id),s(1,l=x.selectedDuration??x.minDuration),A()};function P(x){o=x,s(0,o)}return u.$$.update=()=>{u.$$.dirty&1&&(o||(s(4,b=!0),ga().then(x=>{s(3,d=x),x.forEach(({level:M})=>{M.selectedDuration=M.minDuration}),s(4,b=!1)}).catch(x=>{console.error("Failed to reload level statuses:",x),s(4,b=!1)})))},[o,l,f,d,b,A,T,I,P]}class us extends Tt{constructor(r){super(),Et(this,r,za,Ha,xt,{})}}export{us as component};
