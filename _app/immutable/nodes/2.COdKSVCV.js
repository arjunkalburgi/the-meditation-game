var No=Object.defineProperty;var Bo=(l,n,s)=>n in l?No(l,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[n]=s;var ki=(l,n,s)=>Bo(l,typeof n!="symbol"?n+"":n,s);import{B as qo,s as Tt,d as A,Z as Yt,c as re,e as R,w as N,f as G,g as se,j as ye,k as W,l as _e,q as Br,n as We,C as it,U as pt,_ as Ue,$ as Fo,a0 as Lo,b as Ne,i as Uo,h as oe,t as ae,a1 as Yn,a2 as Hn,a3 as eo,m as Xn,a4 as Vo,y as qr,a5 as Fr,r as to,x as zn,P as Vt,o as Qn,a6 as xi,a7 as Yo}from"../chunks/BIM6er8B.js";import{S as Et,i as Ct,t as je,a as Te,g as kt,c as xt,f as Be,h as Lr,d as St,m as It,e as Ot,b as Pt}from"../chunks/CLOSa3QW.js";import{p as ct}from"../chunks/CmP4wuhm.js";import{d as Ti,w as Wn}from"../chunks/BSzwmYPV.js";function et(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function qe(l,{delay:n=0,duration:s=400,easing:o=qo}={}){const u=+getComputedStyle(l).opacity;return{delay:n,duration:s,easing:o,css:c=>`opacity: ${c*u}`}}var Ye=(l=>(l[l.ONE_MINUTE=60]="ONE_MINUTE",l[l.TWO_MINUTES=120]="TWO_MINUTES",l[l.FIVE_MINUTES=300]="FIVE_MINUTES",l[l.TEN_MINUTES=600]="TEN_MINUTES",l[l.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",l[l.THIRTY_MINUTES=1800]="THIRTY_MINUTES",l[l.SIXTY_MINUTES=3600]="SIXTY_MINUTES",l))(Ye||{});const Mr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ho(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var no={exports:{}};(function(l,n){(function(s,o){l.exports=o()})(Ei,function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function u(e,t,r){for(var i,a=0,f=t.length;a<f;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var c=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ei,d=Object.keys,v=Array.isArray;function P(e,t){return typeof t!="object"||d(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||c.Promise||(c.Promise=Promise);var g=Object.getPrototypeOf,k={}.hasOwnProperty;function I(e,t){return k.call(e,t)}function y(e,t){typeof t=="function"&&(t=t(g(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(r){J(e,r,t[r])})}var M=Object.defineProperty;function J(e,t,r,i){M(e,t,P(r&&I(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},i))}function ce(e){return{from:function(t){return e.prototype=Object.create(t.prototype),J(e.prototype,"constructor",e),{extend:y.bind(null,e.prototype)}}}}var le=Object.getOwnPropertyDescriptor,H=[].slice;function Q(e,t,r){return H.call(e,t,r)}function Y(e,t){return t(e)}function $(e){if(!e)throw new Error("Assertion Failed")}function pe(e){c.setImmediate?setImmediate(e):setTimeout(e,0)}function ie(e,t){if(typeof t=="string"&&I(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],i=0,a=t.length;i<a;++i){var f=ie(e,t[i]);r.push(f)}return r}var h=t.indexOf(".");if(h!==-1){var p=e[t.substr(0,h)];return p==null?void 0:ie(p,t.substr(h+1))}}function Z(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){$(typeof r!="string"&&"length"in r);for(var i=0,a=t.length;i<a;++i)Z(e,t[i],r[i])}else{var f,h,p=t.indexOf(".");p!==-1?(f=t.substr(0,p),(h=t.substr(p+1))===""?r===void 0?v(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=r:Z(p=!(p=e[f])||!I(e,f)?e[f]={}:p,h,r)):r===void 0?v(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function te(e){var t,r={};for(t in e)I(e,t)&&(r[t]=e[t]);return r}var Oe=[].concat;function Se(e){return Oe.apply([],e)}var Kt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Se([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return c[e]}),Ee=new Set(Kt.map(function(e){return c[e]})),fe=null;function ue(e){return fe=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var i=fe.get(r);if(i)return i;if(v(r)){i=[],fe.set(r,i);for(var a=0,f=r.length;a<f;++a)i.push(t(r[a]))}else if(Ee.has(r.constructor))i=r;else{var h,p=g(r);for(h in i=p===Object.prototype?{}:Object.create(p),fe.set(r,i),r)I(r,h)&&(i[h]=t(r[h]))}return i}(e),fe=null,e}var He={}.toString;function Je(e){return He.call(e).slice(8,-1)}var ge=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ke=typeof ge=="symbol"?function(e){var t;return e!=null&&(t=e[ge])&&t.apply(e)}:function(){return null};function Re(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Me={};function Ie(e){var t,r,i,a;if(arguments.length===1){if(v(e))return e.slice();if(this===Me&&typeof e=="string")return[e];if(a=Ke(e)){for(r=[];!(i=a.next()).done;)r.push(i.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Ve=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},tn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],rt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(tn),me={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ve(e,t){this.name=e,this.message=t}function Ae(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,i,a){return a.indexOf(r)===i}).join(`
`)}function ot(e,t,r,i){this.failures=t,this.failedKeys=i,this.successCount=r,this.message=Ae(e,t)}function ft(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=Ae(e,this.failures)}ce(ve).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ce(ot).from(ve),ce(ft).from(ve);var Dt=rt.reduce(function(e,t){return e[t]=t+"Error",e},{}),oo=ve,ne=rt.reduce(function(e,t){var r=t+"Error";function i(a,f){this.name=r,a?typeof a=="string"?(this.message="".concat(a).concat(f?`
 `+f:""),this.inner=f||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=me[t]||r,this.inner=null)}return ce(i).from(oo),e[t]=i,e},{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var Ur=tn.reduce(function(e,t){return e[t+"Error"]=ne[t],e},{}),yn=rt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ne[t]),e},{});function Ce(){}function Zt(e){return e}function ao(e,t){return e==null||e===Zt?t:function(r){return t(e(r))}}function jt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function so(e,t){return e===Ce?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var f=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?jt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?jt(a,this.onerror):a),f!==void 0?f:r}}function uo(e,t){return e===Ce?t:function(){e.apply(this,arguments);var r=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?jt(r,this.onsuccess):r),i&&(this.onerror=this.onerror?jt(i,this.onerror):i)}}function lo(e,t){return e===Ce?t:function(r){var i=e.apply(this,arguments);P(r,i);var a=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?jt(a,this.onsuccess):a),f&&(this.onerror=this.onerror?jt(f,this.onerror):f),i===void 0?r===void 0?void 0:r:P(i,r)}}function co(e,t){return e===Ce?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Zn(e,t){return e===Ce?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var i=this,a=arguments.length,f=new Array(a);a--;)f[a]=arguments[a];return r.then(function(){return t.apply(i,f)})}return t.apply(this,arguments)}}yn.ModifyError=ot,yn.DexieError=ve,yn.BulkError=ft;var at=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Vr(e){at=e}var en={},Yr=100,Kt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,g(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,g(t),e]}(),tn=Kt[0],rt=Kt[1],Kt=Kt[2],rt=rt&&rt.then,Rt=tn&&tn.constructor,er=!!Kt,nn=function(e,t){rn.push([e,t]),_n&&(queueMicrotask(ho),_n=!1)},tr=!0,_n=!0,Mt=[],gn=[],nr=Zt,mt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ce,pgp:!1,env:{},finalize:Ce},ee=mt,rn=[],At=0,bn=[];function z(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ee;if(typeof e!="function"){if(e!==en)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ir(this,this._value))}this._state=null,this._value=null,++t.ref,function r(i,a){try{a(function(f){if(i._state===null){if(f===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Ht();f&&typeof f.then=="function"?r(i,function(p,_){f instanceof z?f._then(p,_):f.then(p,_)}):(i._state=!0,i._value=f,zr(i)),h&&zt()}},ir.bind(null,i))}catch(f){ir(i,f)}}(this,e)}var rr={get:function(){var e=ee,t=Tn;function r(i,a){var f=this,h=!e.global&&(e!==ee||t!==Tn),p=h&&!yt(),_=new z(function(w,E){or(f,new Hr(Wr(i,e,h,p),Wr(a,e,h,p),w,E,e))});return this._consoleTask&&(_._consoleTask=this._consoleTask),_}return r.prototype=en,r},set:function(e){J(this,"then",e&&e.prototype===en?rr:{get:function(){return e},set:rr.set})}};function Hr(e,t,r,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=i,this.psd=a}function ir(e,t){var r,i;gn.push(t),e._state===null&&(r=e._lib&&Ht(),t=nr(t),e._state=!1,e._value=t,i=e,Mt.some(function(a){return a._value===i._value})||Mt.push(i),zr(e),r&&zt())}function zr(e){var t=e._listeners;e._listeners=[];for(var r=0,i=t.length;r<i;++r)or(e,t[r]);var a=e._PSD;--a.ref||a.finalize(),At===0&&(++At,nn(function(){--At==0&&ar()},[]))}function or(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++At,nn(fo,[r,e,t])}else e._listeners.push(t)}function fo(e,t,r){try{var i,a=t._value;!t._state&&gn.length&&(gn=[]),i=at&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||gn.indexOf(a)!==-1||function(f){for(var h=Mt.length;h;)if(Mt[--h]._value===f._value)return Mt.splice(h,1)}(t),r.resolve(i)}catch(f){r.reject(f)}finally{--At==0&&ar(),--r.psd.ref||r.psd.finalize()}}function ho(){Nt(mt,function(){Ht()&&zt()})}function Ht(){var e=tr;return _n=tr=!1,e}function zt(){var e,t,r;do for(;0<rn.length;)for(e=rn,rn=[],r=e.length,t=0;t<r;++t){var i=e[t];i[0].apply(null,i[1])}while(0<rn.length);_n=tr=!0}function ar(){var e=Mt;Mt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=bn.slice(0),r=t.length;r;)t[--r]()}function wn(e){return new z(en,!1,e)}function De(e,t){var r=ee;return function(){var i=Ht(),a=ee;try{return _t(r,!0),e.apply(this,arguments)}catch(f){t&&t(f)}finally{_t(a,!1),i&&zt()}}}y(z.prototype,{then:rr,_then:function(e,t){or(this,new Hr(null,null,e,t,ee))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?r:wn)(i)}):this.then(null,function(i){return(i&&i.name===t?r:wn)(i)})},finally:function(e){return this.then(function(t){return z.resolve(e()).then(function(){return t})},function(t){return z.resolve(e()).then(function(){return wn(t)})})},timeout:function(e,t){var r=this;return e<1/0?new z(function(i,a){var f=setTimeout(function(){return a(new ne.Timeout(t))},e);r.then(i,a).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&J(z.prototype,Symbol.toStringTag,"Dexie.Promise"),mt.env=Gr(),y(z,{all:function(){var e=Ie.apply(null,arguments).map(En);return new z(function(t,r){e.length===0&&t([]);var i=e.length;e.forEach(function(a,f){return z.resolve(a).then(function(h){e[f]=h,--i||t(e)},r)})})},resolve:function(e){return e instanceof z?e:e&&typeof e.then=="function"?new z(function(t,r){e.then(t,r)}):new z(en,!0,e)},reject:wn,race:function(){var e=Ie.apply(null,arguments).map(En);return new z(function(t,r){e.map(function(i){return z.resolve(i).then(t,r)})})},PSD:{get:function(){return ee},set:function(e){return ee=e}},totalEchoes:{get:function(){return Tn}},newPSD:vt,usePSD:Nt,scheduler:{get:function(){return nn},set:function(e){nn=e}},rejectionMapper:{get:function(){return nr},set:function(e){nr=e}},follow:function(e,t){return new z(function(r,i){return vt(function(a,f){var h=ee;h.unhandleds=[],h.onunhandled=f,h.finalize=jt(function(){var p,_=this;p=function(){_.unhandleds.length===0?a():f(_.unhandleds[0])},bn.push(function w(){p(),bn.splice(bn.indexOf(w),1)}),++At,nn(function(){--At==0&&ar()},[])},h.finalize),e()},t,r,i)})}}),Rt&&(Rt.allSettled&&J(z,"allSettled",function(){var e=Ie.apply(null,arguments).map(En);return new z(function(t){e.length===0&&t([]);var r=e.length,i=new Array(r);e.forEach(function(a,f){return z.resolve(a).then(function(h){return i[f]={status:"fulfilled",value:h}},function(h){return i[f]={status:"rejected",reason:h}}).then(function(){return--r||t(i)})})})}),Rt.any&&typeof AggregateError<"u"&&J(z,"any",function(){var e=Ie.apply(null,arguments).map(En);return new z(function(t,r){e.length===0&&r(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(f,h){return z.resolve(f).then(function(p){return t(p)},function(p){a[h]=p,--i||r(new AggregateError(a))})})})}),Rt.withResolvers&&(z.withResolvers=Rt.withResolvers));var ze={awaits:0,echoes:0,id:0},po=0,kn=[],xn=0,Tn=0,mo=0;function vt(e,t,r,i){var a=ee,f=Object.create(a);return f.parent=a,f.ref=0,f.global=!1,f.id=++mo,mt.env,f.env=er?{Promise:z,PromiseProp:{value:z,configurable:!0,writable:!0},all:z.all,race:z.race,allSettled:z.allSettled,any:z.any,resolve:z.resolve,reject:z.reject}:{},t&&P(f,t),++a.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Nt(f,e,r,i),f.ref===0&&f.finalize(),i}function Gt(){return ze.id||(ze.id=++po),++ze.awaits,ze.echoes+=Yr,ze.id}function yt(){return!!ze.awaits&&(--ze.awaits==0&&(ze.id=0),ze.echoes=ze.awaits*Yr,!0)}function En(e){return ze.echoes&&e&&e.constructor===Rt?(Gt(),e.then(function(t){return yt(),t},function(t){return yt(),Fe(t)})):e}function vo(){var e=kn[kn.length-1];kn.pop(),_t(e,!1)}function _t(e,t){var r,i=ee;(t?!ze.echoes||xn++&&e===ee:!xn||--xn&&e===ee)||queueMicrotask(t?(function(a){++Tn,ze.echoes&&--ze.echoes!=0||(ze.echoes=ze.awaits=ze.id=0),kn.push(ee),_t(a,!0)}).bind(null,e):vo),e!==ee&&(ee=e,i===mt&&(mt.env=Gr()),er&&(r=mt.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(c,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function Gr(){var e=c.Promise;return er?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(c,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Nt(e,t,r,i,a){var f=ee;try{return _t(e,!0),t(r,i,a)}finally{_t(f,!1)}}function Wr(e,t,r,i){return typeof e!="function"?e:function(){var a=ee;r&&Gt(),_t(t,!0);try{return e.apply(this,arguments)}finally{_t(a,!1),i&&queueMicrotask(yt)}}}function sr(e){Promise===Rt&&ze.echoes===0?xn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+rt).indexOf("[native code]")===-1&&(Gt=yt=Ce);var Fe=z.reject,Bt="￿",dt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Xr="String expected.",Wt=[],Cn="__dbnames",ur="readonly",lr="readwrite";function qt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Qr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=ue(t))[e],t}}function $r(){throw ne.Type()}function ke(e,t){try{var r=Jr(e),i=Jr(t);if(r!==i)return r==="Array"?1:i==="Array"?-1:r==="binary"?1:i==="binary"?-1:r==="string"?1:i==="string"?-1:r==="Date"?1:i!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,f){for(var h=a.length,p=f.length,_=h<p?h:p,w=0;w<_;++w)if(a[w]!==f[w])return a[w]<f[w]?-1:1;return h===p?0:h<p?-1:1}(Zr(e),Zr(t));case"Array":return function(a,f){for(var h=a.length,p=f.length,_=h<p?h:p,w=0;w<_;++w){var E=ke(a[w],f[w]);if(E!==0)return E}return h===p?0:h<p?-1:1}(e,t)}}catch{}return NaN}function Jr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Je(e),e==="ArrayBuffer"?"binary":e)}function Zr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ei=(Pe.prototype._trans=function(e,t,r){var i=this._tx||ee.trans,a=this.name,f=at&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(w,E,m){if(!m.schema[a])throw new ne.NotFound("Table "+a+" not part of transaction");return t(m.idbtrans,m)}var p=Ht();try{var _=i&&i.db._novip===this.db._novip?i===ee.trans?i._promise(e,h,r):vt(function(){return i._promise(e,h,r)},{trans:i,transless:ee.transless||ee}):function w(E,m,S,b){if(E.idbdb&&(E._state.openComplete||ee.letThrough||E._vip)){var T=E._createTransaction(m,S,E._dbSchema);try{T.create(),E._state.PR1398_maxLoop=3}catch(C){return C.name===Dt.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return w(E,m,S,b)})):Fe(C)}return T._promise(m,function(C,x){return vt(function(){return ee.trans=T,b(C,x,T)})}).then(function(C){if(m==="readwrite")try{T.idbtrans.commit()}catch{}return m==="readonly"?C:T._completion.then(function(){return C})})}if(E._state.openComplete)return Fe(new ne.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return Fe(new ne.DatabaseClosed);E.open().catch(Ce)}return E._state.dbReadyPromise.then(function(){return w(E,m,S,b)})}(this.db,e,[this.name],h);return f&&(_._consoleTask=f,_=_.catch(function(w){return console.trace(w),Fe(w)})),_}finally{p&&zt()}},Pe.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Fe(new ne.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(a){return r.hook.reading.fire(a)})}).then(t)},Pe.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(v(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(p){if(p.compound&&t.every(function(w){return 0<=p.keyPath.indexOf(w)})){for(var _=0;_<t.length;++_)if(t.indexOf(p.keyPath[_])===-1)return!1;return!0}return!1}).sort(function(p,_){return p.keyPath.length-_.keyPath.length})[0];if(r&&this.db._maxKey!==Bt){var f=r.keyPath.slice(0,t.length);return this.where(f).equals(f.map(function(_){return e[_]}))}!r&&at&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(p,_){return ke(p,_)===0}var h=t.reduce(function(m,_){var w=m[0],E=m[1],m=i[_],S=e[_];return[w||m,w||!m?qt(E,m&&m.multi?function(b){return b=ie(b,_),v(b)&&b.some(function(T){return a(S,T)})}:function(b){return a(S,ie(b,_))}):E]},[null,null]),f=h[0],h=h[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(h):r?this.filter(h):this.where(t).equals("")},Pe.prototype.filter=function(e){return this.toCollection().and(e)},Pe.prototype.count=function(e){return this.toCollection().count(e)},Pe.prototype.offset=function(e){return this.toCollection().offset(e)},Pe.prototype.limit=function(e){return this.toCollection().limit(e)},Pe.prototype.each=function(e){return this.toCollection().each(e)},Pe.prototype.toArray=function(e){return this.toCollection().toArray(e)},Pe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Pe.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,v(e)?"[".concat(e.join("+"),"]"):e))},Pe.prototype.reverse=function(){return this.toCollection().reverse()},Pe.prototype.mapToClass=function(e){var t,r=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof $r&&(function(_,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function E(){this.constructor=_}s(_,w),_.prototype=w===null?Object.create(w):(E.prototype=w.prototype,new E)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var f=new Set,h=e.prototype;h;h=g(h))Object.getOwnPropertyNames(h).forEach(function(_){return f.add(_)});function p(_){if(!_)return _;var w,E=Object.create(e.prototype);for(w in _)if(!f.has(w))try{E[w]=_[w]}catch{}return E}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),e},Pe.prototype.defineClass=function(){return this.mapToClass(function(e){P(this,e)})},Pe.prototype.add=function(e,t){var r=this,i=this.schema.primKey,a=i.auto,f=i.keyPath,h=e;return f&&a&&(h=Sn(f)(e)),this._trans("readwrite",function(p){return r.core.mutate({trans:p,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(p){return p.numFailures?z.reject(p.failures[0]):p.lastResult}).then(function(p){if(f)try{Z(e,f,p)}catch{}return p})},Pe.prototype.update=function(e,t){return typeof e!="object"||v(e)?this.where(":id").equals(e).modify(t):(e=ie(e,this.schema.primKey.keyPath),e===void 0?Fe(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Pe.prototype.put=function(e,t){var r=this,i=this.schema.primKey,a=i.auto,f=i.keyPath,h=e;return f&&a&&(h=Sn(f)(e)),this._trans("readwrite",function(p){return r.core.mutate({trans:p,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(p){return p.numFailures?z.reject(p.failures[0]):p.lastResult}).then(function(p){if(f)try{Z(e,f,p)}catch{}return p})},Pe.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?z.reject(r.failures[0]):void 0})},Pe.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Qr})}).then(function(t){return t.numFailures?z.reject(t.failures[0]):void 0})},Pe.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},Pe.prototype.bulkAdd=function(e,t,r){var i=this,a=Array.isArray(t)?t:void 0,f=(r=r||(a?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var w=i.schema.primKey,p=w.auto,w=w.keyPath;if(w&&a)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var _=e.length,w=w&&p?e.map(Sn(w)):e;return i.core.mutate({trans:h,type:"add",keys:a,values:w,wantResults:f}).then(function(T){var m=T.numFailures,S=T.results,b=T.lastResult,T=T.failures;if(m===0)return f?S:b;throw new ft("".concat(i.name,".bulkAdd(): ").concat(m," of ").concat(_," operations failed"),T)})})},Pe.prototype.bulkPut=function(e,t,r){var i=this,a=Array.isArray(t)?t:void 0,f=(r=r||(a?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var w=i.schema.primKey,p=w.auto,w=w.keyPath;if(w&&a)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var _=e.length,w=w&&p?e.map(Sn(w)):e;return i.core.mutate({trans:h,type:"put",keys:a,values:w,wantResults:f}).then(function(T){var m=T.numFailures,S=T.results,b=T.lastResult,T=T.failures;if(m===0)return f?S:b;throw new ft("".concat(i.name,".bulkPut(): ").concat(m," of ").concat(_," operations failed"),T)})})},Pe.prototype.bulkUpdate=function(e){var t=this,r=this.core,i=e.map(function(h){return h.key}),a=e.map(function(h){return h.changes}),f=[];return this._trans("readwrite",function(h){return r.getMany({trans:h,keys:i,cache:"clone"}).then(function(p){var _=[],w=[];e.forEach(function(m,S){var b=m.key,T=m.changes,C=p[S];if(C){for(var x=0,O=Object.keys(T);x<O.length;x++){var D=O[x],j=T[D];if(D===t.schema.primKey.keyPath){if(ke(j,b)!==0)throw new ne.Constraint("Cannot update primary key in bulkUpdate()")}else Z(C,D,j)}f.push(S),_.push(b),w.push(C)}});var E=_.length;return r.mutate({trans:h,type:"put",keys:_,values:w,updates:{keys:i,changeSpecs:a}}).then(function(m){var S=m.numFailures,b=m.failures;if(S===0)return E;for(var T=0,C=Object.keys(b);T<C.length;T++){var x,O=C[T],D=f[Number(O)];D!=null&&(x=b[O],delete b[O],b[D]=x)}throw new ft("".concat(t.name,".bulkUpdate(): ").concat(S," of ").concat(E," operations failed"),b)})})})},Pe.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var a=h.numFailures,f=h.lastResult,h=h.failures;if(a===0)return f;throw new ft("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),h)})},Pe);function Pe(){}function on(e){function t(h,p){if(p){for(var _=arguments.length,w=new Array(_-1);--_;)w[_-1]=arguments[_];return r[h].subscribe.apply(null,w),e}if(typeof h=="string")return r[h]}var r={};t.addEventType=f;for(var i=1,a=arguments.length;i<a;++i)f(arguments[i]);return t;function f(h,p,_){if(typeof h!="object"){var w;p=p||co;var E={subscribers:[],fire:_=_||Ce,subscribe:function(m){E.subscribers.indexOf(m)===-1&&(E.subscribers.push(m),E.fire=p(E.fire,m))},unsubscribe:function(m){E.subscribers=E.subscribers.filter(function(S){return S!==m}),E.fire=E.subscribers.reduce(p,_)}};return r[h]=t[h]=E}d(w=h).forEach(function(m){var S=w[m];if(v(S))f(m,w[m][0],w[m][1]);else{if(S!=="asap")throw new ne.InvalidArgument("Invalid event config");var b=f(m,Zt,function(){for(var T=arguments.length,C=new Array(T);T--;)C[T]=arguments[T];b.subscribers.forEach(function(x){pe(function(){x.apply(null,C)})})})}})}}function an(e,t){return ce(t).from({prototype:e}),t}function Xt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function cr(e,t){e.filter=qt(e.filter,t)}function fr(e,t,r){var i=e.replayFilter;e.replayFilter=i?function(){return qt(i(),t())}:t,e.justLimit=r&&!i}function In(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function ti(e,t,r){var i=In(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function On(e,t,r,i){var a=e.replayFilter?qt(e.filter,e.replayFilter()):e.filter;if(e.or){var f={},h=function(p,_,w){var E,m;a&&!a(_,w,function(S){return _.stop(S)},function(S){return _.fail(S)})||((m=""+(E=_.primaryKey))=="[object ArrayBuffer]"&&(m=""+new Uint8Array(E)),I(f,m)||(f[m]=!0,t(p,_,w)))};return Promise.all([e.or._iterate(h,r),ni(ti(e,i,r),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ni(ti(e,i,r),qt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function ni(e,t,r,i){var a=De(i?function(f,h,p){return r(i(f),h,p)}:r);return e.then(function(f){if(f)return f.start(function(){var h=function(){return f.continue()};t&&!t(f,function(p){return h=p},function(p){f.stop(p),h=Ce},function(p){f.fail(p),h=Ce})||a(f.value,f,function(p){return h=p}),h()})})}var sn=(ri.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var r=t.add;if(v(r))return u(u([],v(e)?e:[],!0),r).sort();if(typeof r=="number")return(Number(e)||0)+r;if(typeof r=="bigint")try{return BigInt(e)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(t.remove!==void 0){var i=t.remove;if(v(i))return v(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return r=(r=t.replacePrefix)===null||r===void 0?void 0:r[0],r&&typeof e=="string"&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},ri);function ri(e){this["@@propmod"]=e}var yo=(xe.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,Fe.bind(null,r.error)):r.table._trans("readonly",e).then(t)},xe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Fe.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},xe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=qt(t.algorithm,e)},xe.prototype._iterate=function(e,t){return On(this._ctx,e,t,this._ctx.table.core)},xe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&P(r,e),t._ctx=r,t},xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},xe.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return On(t,e,r,t.table.core)})},xe.prototype.count=function(e){var t=this;return this._read(function(r){var i=t._ctx,a=i.table.core;if(Xt(i,!0))return a.count({trans:r,query:{index:In(i,a.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var f=0;return On(i,function(){return++f,!1},r,a).then(function(){return f})}).then(e)},xe.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),i=r[0],a=r.length-1;function f(_,w){return w?f(_[r[w]],w-1):_[i]}var h=this._ctx.dir==="next"?1:-1;function p(_,w){return ke(f(_,a),f(w,a))*h}return this.toArray(function(_){return _.sort(p)}).then(t)},xe.prototype.toArray=function(e){var t=this;return this._read(function(r){var i=t._ctx;if(i.dir==="next"&&Xt(i,!0)&&0<i.limit){var a=i.valueMapper,f=In(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:f,range:i.range}}).then(function(p){return p=p.result,a?p.map(a):p})}var h=[];return On(i,function(p){return h.push(p)},r,i.table.core).then(function(){return h})},e)},xe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Xt(t)?fr(t,function(){var r=e;return function(i,a){return r===0||(r===1?--r:a(function(){i.advance(r),r=0}),!1)}}):fr(t,function(){var r=e;return function(){return--r<0}})),this},xe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),fr(this._ctx,function(){var t=e;return function(r,i,a){return--t<=0&&i(a),0<=t}},!0),this},xe.prototype.until=function(e,t){return cr(this._ctx,function(r,i,a){return!e(r.value)||(i(a),t)}),this},xe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},xe.prototype.last=function(e){return this.reverse().first(e)},xe.prototype.filter=function(e){var t;return cr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=qt(t.isMatch,e),this},xe.prototype.and=function(e){return this.filter(e)},xe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xe.prototype.desc=function(){return this.reverse()},xe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.key,i)})},xe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},xe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(e)},xe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Xt(t,!0)&&0<t.limit)return this._read(function(i){var a=In(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)},xe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},xe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return cr(this._ctx,function(a){var i=a.primaryKey.toString(),a=I(t,i);return t[i]=!0,!a}),this},xe.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(i){var a,f,h;h=typeof e=="function"?e:(a=d(e),f=a.length,function(x){for(var O=!1,D=0;D<f;++D){var j=a[D],K=e[j],B=ie(x,j);K instanceof sn?(Z(x,j,K.execute(B)),O=!0):B!==K&&(Z(x,j,K),O=!0)}return O});var p=r.table.core,m=p.schema.primaryKey,_=m.outbound,w=m.extractKey,E=200,m=t.db._options.modifyChunkSize;m&&(E=typeof m=="object"?m[p.name]||m["*"]||200:m);function S(x,j){var D=j.failures,j=j.numFailures;T+=x-j;for(var K=0,B=d(D);K<B.length;K++){var U=B[K];b.push(D[U])}}var b=[],T=0,C=[];return t.clone().primaryKeys().then(function(x){function O(j){var K=Math.min(E,x.length-j);return p.getMany({trans:i,keys:x.slice(j,j+K),cache:"immutable"}).then(function(B){for(var U=[],q=[],F=_?[]:null,V=[],L=0;L<K;++L){var X=B[L],he={value:ue(X),primKey:x[j+L]};h.call(he,he.value,he)!==!1&&(he.value==null?V.push(x[j+L]):_||ke(w(X),w(he.value))===0?(q.push(he.value),_&&F.push(x[j+L])):(V.push(x[j+L]),U.push(he.value)))}return Promise.resolve(0<U.length&&p.mutate({trans:i,type:"add",values:U}).then(function(be){for(var we in be.failures)V.splice(parseInt(we),1);S(U.length,be)})).then(function(){return(0<q.length||D&&typeof e=="object")&&p.mutate({trans:i,type:"put",keys:F,values:q,criteria:D,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<j}).then(function(be){return S(q.length,be)})}).then(function(){return(0<V.length||D&&e===dr)&&p.mutate({trans:i,type:"delete",keys:V,criteria:D,isAdditionalChunk:0<j}).then(function(be){return S(V.length,be)})}).then(function(){return x.length>j+K&&O(j+E)})})}var D=Xt(r)&&r.limit===1/0&&(typeof e!="function"||e===dr)&&{index:r.index,range:r.range};return O(0).then(function(){if(0<b.length)throw new ot("Error modifying one or more objects",b,T,C);return x.length})})})},xe.prototype.delete=function(){var e=this._ctx,t=e.range;return Xt(e)&&(e.isPrimKey||t.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:r,query:{index:i,range:a}}).then(function(f){return e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(h){var p=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new ot("Could not delete some values",Object.keys(p).map(function(_){return p[_]}),f-h);return f-h})})}):this.modify(dr)},xe);function xe(){}var dr=function(e,t){return t.value=null};function _o(e,t){return e<t?-1:e===t?0:1}function go(e,t){return t<e?-1:e===t?0:1}function tt(e,t,r){return e=e instanceof oi?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function Qt(e){return new e.Collection(e,function(){return ii("")}).limit(0)}function Pn(e,t,r,i){var a,f,h,p,_,w,E,m=r.length;if(!r.every(function(T){return typeof T=="string"}))return tt(e,Xr);function S(T){a=T==="next"?function(x){return x.toUpperCase()}:function(x){return x.toLowerCase()},f=T==="next"?function(x){return x.toLowerCase()}:function(x){return x.toUpperCase()},h=T==="next"?_o:go;var C=r.map(function(x){return{lower:f(x),upper:a(x)}}).sort(function(x,O){return h(x.lower,O.lower)});p=C.map(function(x){return x.upper}),_=C.map(function(x){return x.lower}),E=(w=T)==="next"?"":i}S("next"),e=new e.Collection(e,function(){return gt(p[0],_[m-1]+i)}),e._ondirectionchange=function(T){S(T)};var b=0;return e._addAlgorithm(function(T,C,x){var O=T.key;if(typeof O!="string")return!1;var D=f(O);if(t(D,_,b))return!0;for(var j=null,K=b;K<m;++K){var B=function(U,q,F,V,L,X){for(var he=Math.min(U.length,V.length),be=-1,we=0;we<he;++we){var nt=q[we];if(nt!==V[we])return L(U[we],F[we])<0?U.substr(0,we)+F[we]+F.substr(we+1):L(U[we],V[we])<0?U.substr(0,we)+V[we]+F.substr(we+1):0<=be?U.substr(0,be)+q[be]+F.substr(be+1):null;L(U[we],nt)<0&&(be=we)}return he<V.length&&X==="next"?U+F.substr(U.length):he<U.length&&X==="prev"?U.substr(0,F.length):be<0?null:U.substr(0,be)+V[be]+F.substr(be+1)}(O,D,p[K],_[K],h,w);B===null&&j===null?b=K+1:(j===null||0<h(j,B))&&(j=B)}return C(j!==null?function(){T.continue(j+E)}:x),!1}),e}function gt(e,t,r,i){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:i}}function ii(e){return{type:1,lower:e,upper:e}}var oi=(Object.defineProperty(Ge.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ge.prototype.between=function(e,t,r,i){r=r!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||i)&&(!r||!i)?Qt(this):new this.Collection(this,function(){return gt(e,t,!r,!i)})}catch{return tt(this,dt)}},Ge.prototype.equals=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return ii(e)})},Ge.prototype.above=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(e,void 0,!0)})},Ge.prototype.aboveOrEqual=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(e,void 0,!1)})},Ge.prototype.below=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(void 0,e,!1,!0)})},Ge.prototype.belowOrEqual=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(void 0,e)})},Ge.prototype.startsWith=function(e){return typeof e!="string"?tt(this,Xr):this.between(e,e+Bt,!0,!0)},Ge.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Pn(this,function(t,r){return t.indexOf(r[0])===0},[e],Bt)},Ge.prototype.equalsIgnoreCase=function(e){return Pn(this,function(t,r){return t===r[0]},[e],"")},Ge.prototype.anyOfIgnoreCase=function(){var e=Ie.apply(Me,arguments);return e.length===0?Qt(this):Pn(this,function(t,r){return r.indexOf(t)!==-1},e,"")},Ge.prototype.startsWithAnyOfIgnoreCase=function(){var e=Ie.apply(Me,arguments);return e.length===0?Qt(this):Pn(this,function(t,r){return r.some(function(i){return t.indexOf(i)===0})},e,Bt)},Ge.prototype.anyOf=function(){var e=this,t=Ie.apply(Me,arguments),r=this._cmp;try{t.sort(r)}catch{return tt(this,dt)}if(t.length===0)return Qt(this);var i=new this.Collection(this,function(){return gt(t[0],t[t.length-1])});i._ondirectionchange=function(f){r=f==="next"?e._ascending:e._descending,t.sort(r)};var a=0;return i._addAlgorithm(function(f,h,p){for(var _=f.key;0<r(_,t[a]);)if(++a===t.length)return h(p),!1;return r(_,t[a])===0||(h(function(){f.continue(t[a])}),!1)}),i},Ge.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ge.prototype.noneOf=function(){var e=Ie.apply(Me,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return tt(this,dt)}var t=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ge.prototype.inAnyRange=function(O,t){var r=this,i=this._cmp,a=this._ascending,f=this._descending,h=this._min,p=this._max;if(O.length===0)return Qt(this);if(!O.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&a(D[0],D[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var _=!t||t.includeLowers!==!1,w=t&&t.includeUppers===!0,E,m=a;function S(D,j){return m(D[0],j[0])}try{(E=O.reduce(function(D,j){for(var K=0,B=D.length;K<B;++K){var U=D[K];if(i(j[0],U[1])<0&&0<i(j[1],U[0])){U[0]=h(U[0],j[0]),U[1]=p(U[1],j[1]);break}}return K===B&&D.push(j),D},[])).sort(S)}catch{return tt(this,dt)}var b=0,T=w?function(D){return 0<a(D,E[b][1])}:function(D){return 0<=a(D,E[b][1])},C=_?function(D){return 0<f(D,E[b][0])}:function(D){return 0<=f(D,E[b][0])},x=T,O=new this.Collection(this,function(){return gt(E[0][0],E[E.length-1][1],!_,!w)});return O._ondirectionchange=function(D){m=D==="next"?(x=T,a):(x=C,f),E.sort(S)},O._addAlgorithm(function(D,j,K){for(var B,U=D.key;x(U);)if(++b===E.length)return j(K),!1;return!T(B=U)&&!C(B)||(r._cmp(U,E[b][1])===0||r._cmp(U,E[b][0])===0||j(function(){m===a?D.continue(E[b][0]):D.continue(E[b][1])}),!1)}),O},Ge.prototype.startsWithAnyOf=function(){var e=Ie.apply(Me,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Qt(this):this.inAnyRange(e.map(function(t){return[t,t+Bt]})):tt(this,"startsWithAnyOf() only works with strings")},Ge);function Ge(){}function st(e){return De(function(t){return un(t),e(t.target.error),!1})}function un(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var ln="storagemutated",hr="x-storagemutated-1",bt=on(null,ln),bo=(ut.prototype._lock=function(){return $(!ee.global),++this._reculock,this._reculock!==1||ee.global||(ee.lockOwnerFor=this),this},ut.prototype._unlock=function(){if($(!ee.global),--this._reculock==0)for(ee.global||(ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Nt(e[1],e[0])}catch{}}return this},ut.prototype._locked=function(){return this._reculock&&ee.lockOwnerFor!==this},ut.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if($(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(i);case"MissingAPIError":throw new ne.MissingAPI(i.message,i);default:throw new ne.OpenFailed(i)}if(!this.active)throw new ne.TransactionInactive;return $(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=De(function(a){un(a),t._reject(e.error)}),e.onabort=De(function(a){un(a),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=De(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&bt.storagemutated.fire(e.mutatedParts)}),this},ut.prototype._promise=function(e,t,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return Fe(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return Fe(new ne.TransactionInactive);if(this._locked())return new z(function(f,h){i._blockedFuncs.push([function(){i._promise(e,t,r).then(f,h)},ee])});if(r)return vt(function(){var f=new z(function(h,p){i._lock();var _=t(h,p,i);_&&_.then&&_.then(h,p)});return f.finally(function(){return i._unlock()}),f._lib=!0,f});var a=new z(function(f,h){var p=t(f,h,i);p&&p.then&&p.then(f,h)});return a._lib=!0,a},ut.prototype._root=function(){return this.parent?this.parent._root():this},ut.prototype.waitFor=function(e){var t,r=this._root(),i=z.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return i}):(r._waitingFor=i,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function f(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=f)}());var a=r._waitingFor;return new z(function(f,h){i.then(function(p){return r._waitingQueue.push(De(f.bind(null,p)))},function(p){return r._waitingQueue.push(De(h.bind(null,p)))}).finally(function(){r._waitingFor===a&&(r._waitingFor=null)})})},ut.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ne.Abort))},ut.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(I(t,e))return t[e];var r=this.schema[e];if(!r)throw new ne.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},ut);function ut(){}function pr(e,t,r,i,a,f,h){return{name:e,keyPath:t,unique:r,multi:i,auto:a,compound:f,src:(r&&!h?"&":"")+(i?"*":"")+(a?"++":"")+ai(t)}}function ai(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function mr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},r.reduce(function(a,f,h){return h=i(f,h),h&&(a[h[0]]=h[1]),a},{}))};var i}var cn=function(e){try{return e.only([[]]),cn=function(){return[[]]},[[]]}catch{return cn=function(){return Bt},Bt}};function vr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return ie(r,t)}:function(r){return ie(r,e)};var t}function si(e){return[].slice.call(e)}var wo=0;function fn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ko(e,t,_){function i(x){if(x.type===3)return null;if(x.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=x.lower,T=x.upper,C=x.lowerOpen,x=x.upperOpen;return b===void 0?T===void 0?null:t.upperBound(T,!!x):T===void 0?t.lowerBound(b,!!C):t.bound(b,T,!!C,!!x)}function a(S){var b,T=S.name;return{name:T,schema:S,mutate:function(C){var x=C.trans,O=C.type,D=C.keys,j=C.values,K=C.range;return new Promise(function(B,U){B=De(B);var q=x.objectStore(T),F=q.keyPath==null,V=O==="put"||O==="add";if(!V&&O!=="delete"&&O!=="deleteRange")throw new Error("Invalid operation type: "+O);var L,X=(D||j||{length:1}).length;if(D&&j&&D.length!==j.length)throw new Error("Given keys array must have same length as given values array.");if(X===0)return B({numFailures:0,failures:{},results:[],lastResult:void 0});function he(Ze){++nt,un(Ze)}var be=[],we=[],nt=0;if(O==="deleteRange"){if(K.type===4)return B({numFailures:nt,failures:we,results:[],lastResult:void 0});K.type===3?be.push(L=q.clear()):be.push(L=q.delete(i(K)))}else{var F=V?F?[j,D]:[j,null]:[D,null],de=F[0],Qe=F[1];if(V)for(var $e=0;$e<X;++$e)be.push(L=Qe&&Qe[$e]!==void 0?q[O](de[$e],Qe[$e]):q[O](de[$e])),L.onerror=he;else for($e=0;$e<X;++$e)be.push(L=q[O](de[$e])),L.onerror=he}function Vn(Ze){Ze=Ze.target.result,be.forEach(function(Ut,Rr){return Ut.error!=null&&(we[Rr]=Ut.error)}),B({numFailures:nt,failures:we,results:O==="delete"?D:be.map(function(Ut){return Ut.result}),lastResult:Ze})}L.onerror=function(Ze){he(Ze),Vn(Ze)},L.onsuccess=Vn})},getMany:function(C){var x=C.trans,O=C.keys;return new Promise(function(D,j){D=De(D);for(var K,B=x.objectStore(T),U=O.length,q=new Array(U),F=0,V=0,L=function(be){be=be.target,q[be._pos]=be.result,++V===F&&D(q)},X=st(j),he=0;he<U;++he)O[he]!=null&&((K=B.get(O[he]))._pos=he,K.onsuccess=L,K.onerror=X,++F);F===0&&D(q)})},get:function(C){var x=C.trans,O=C.key;return new Promise(function(D,j){D=De(D);var K=x.objectStore(T).get(O);K.onsuccess=function(B){return D(B.target.result)},K.onerror=st(j)})},query:(b=w,function(C){return new Promise(function(x,O){x=De(x);var D,j,K,F=C.trans,B=C.values,U=C.limit,L=C.query,q=U===1/0?void 0:U,V=L.index,L=L.range,F=F.objectStore(T),V=V.isPrimaryKey?F:F.index(V.name),L=i(L);if(U===0)return x({result:[]});b?((q=B?V.getAll(L,q):V.getAllKeys(L,q)).onsuccess=function(X){return x({result:X.target.result})},q.onerror=st(O)):(D=0,j=!B&&"openKeyCursor"in V?V.openKeyCursor(L):V.openCursor(L),K=[],j.onsuccess=function(X){var he=j.result;return he?(K.push(B?he.value:he.primaryKey),++D===U?x({result:K}):void he.continue()):x({result:K})},j.onerror=st(O))})}),openCursor:function(C){var x=C.trans,O=C.values,D=C.query,j=C.reverse,K=C.unique;return new Promise(function(B,U){B=De(B);var V=D.index,q=D.range,F=x.objectStore(T),F=V.isPrimaryKey?F:F.index(V.name),V=j?K?"prevunique":"prev":K?"nextunique":"next",L=!O&&"openKeyCursor"in F?F.openKeyCursor(i(q),V):F.openCursor(i(q),V);L.onerror=st(U),L.onsuccess=De(function(X){var he,be,we,nt,de=L.result;de?(de.___id=++wo,de.done=!1,he=de.continue.bind(de),be=(be=de.continuePrimaryKey)&&be.bind(de),we=de.advance.bind(de),nt=function(){throw new Error("Cursor not stopped")},de.trans=x,de.stop=de.continue=de.continuePrimaryKey=de.advance=function(){throw new Error("Cursor not started")},de.fail=De(U),de.next=function(){var Qe=this,$e=1;return this.start(function(){return $e--?Qe.continue():Qe.stop()}).then(function(){return Qe})},de.start=function(Qe){function $e(){if(L.result)try{Qe()}catch(Ze){de.fail(Ze)}else de.done=!0,de.start=function(){throw new Error("Cursor behind last entry")},de.stop()}var Vn=new Promise(function(Ze,Ut){Ze=De(Ze),L.onerror=st(Ut),de.fail=Ut,de.stop=function(Rr){de.stop=de.continue=de.continuePrimaryKey=de.advance=nt,Ze(Rr)}});return L.onsuccess=De(function(Ze){L.onsuccess=$e,$e()}),de.continue=he,de.continuePrimaryKey=be,de.advance=we,$e(),Vn},B(de)):B(null)},U)})},count:function(C){var x=C.query,O=C.trans,D=x.index,j=x.range;return new Promise(function(K,B){var U=O.objectStore(T),q=D.isPrimaryKey?U:U.index(D.name),U=i(j),q=U?q.count(U):q.count();q.onsuccess=De(function(F){return K(F.target.result)}),q.onerror=st(B)})}}}var f,h,p,E=(h=_,p=si((f=e).objectStoreNames),{schema:{name:f.name,tables:p.map(function(S){return h.objectStore(S)}).map(function(S){var b=S.keyPath,x=S.autoIncrement,T=v(b),C={},x={name:S.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:T,keyPath:b,autoIncrement:x,unique:!0,extractKey:vr(b)},indexes:si(S.indexNames).map(function(O){return S.index(O)}).map(function(K){var D=K.name,j=K.unique,B=K.multiEntry,K=K.keyPath,B={name:D,compound:v(K),keyPath:K,unique:j,multiEntry:B,extractKey:vr(K)};return C[fn(K)]=B}),getIndexByKeyPath:function(O){return C[fn(O)]}};return C[":id"]=x.primaryKey,b!=null&&(C[fn(b)]=x.primaryKey),x})},hasGetAll:0<p.length&&"getAll"in h.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),_=E.schema,w=E.hasGetAll,E=_.tables.map(a),m={};return E.forEach(function(S){return m[S.name]=S}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(S){if(!m[S])throw new Error("Table '".concat(S,"' not found"));return m[S]},MIN_KEY:-1/0,MAX_KEY:cn(t),schema:_}}function xo(e,t,r,i){var a=r.IDBKeyRange;return r.indexedDB,{dbcore:(i=ko(t,a,i),e.dbcore.reduce(function(f,h){return h=h.create,o(o({},f),h(f))},i))}}function Dn(e,i){var r=i.db,i=xo(e._middlewares,r,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var f=a.name;e.core.schema.tables.some(function(h){return h.name===f})&&(a.core=e.core.table(f),e[f]instanceof e.Table&&(e[f].core=a.core))})}function jn(e,t,r,i){r.forEach(function(a){var f=i[a];t.forEach(function(h){var p=function _(w,E){return le(w,E)||(w=g(w))&&_(w,E)}(h,a);(!p||"value"in p&&p.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?J(h,a,{get:function(){return this.table(a)},set:function(_){M(this,a,{value:_,writable:!0,configurable:!0,enumerable:!0})}}):h[a]=new e.Table(a,f))})})}function yr(e,t){t.forEach(function(r){for(var i in r)r[i]instanceof e.Table&&delete r[i]})}function To(e,t){return e._cfg.version-t._cfg.version}function Eo(e,t,r,i){var a=e._dbSchema;r.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=mr("$meta",li("")[0],[]),e._storeNames.push("$meta"));var f=e._createTransaction("readwrite",e._storeNames,a);f.create(r),f._completion.catch(i);var h=f._reject.bind(f),p=ee.transless||ee;vt(function(){return ee.trans=f,ee.transless=p,t!==0?(Dn(e,r),w=t,((_=f).storeNames.includes("$meta")?_.table("$meta").get("version").then(function(E){return E??w}):z.resolve(w)).then(function(E){return S=E,b=f,T=r,C=[],E=(m=e)._versions,x=m._dbSchema=Rn(0,m.idbdb,T),(E=E.filter(function(O){return O._cfg.version>=S})).length!==0?(E.forEach(function(O){C.push(function(){var D=x,j=O._cfg.dbschema;Mn(m,D,T),Mn(m,j,T),x=m._dbSchema=j;var K=_r(D,j);K.add.forEach(function(V){gr(T,V[0],V[1].primKey,V[1].indexes)}),K.change.forEach(function(V){if(V.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var L=T.objectStore(V.name);V.add.forEach(function(X){return Kn(L,X)}),V.change.forEach(function(X){L.deleteIndex(X.name),Kn(L,X)}),V.del.forEach(function(X){return L.deleteIndex(X)})});var B=O._cfg.contentUpgrade;if(B&&O._cfg.version>S){Dn(m,T),b._memoizedTables={};var U=te(j);K.del.forEach(function(V){U[V]=D[V]}),yr(m,[m.Transaction.prototype]),jn(m,[m.Transaction.prototype],d(U),U),b.schema=U;var q,F=Ve(B);return F&&Gt(),K=z.follow(function(){var V;(q=B(b))&&F&&(V=yt.bind(null,null),q.then(V,V))}),q&&typeof q.then=="function"?z.resolve(q):K.then(function(){return q})}}),C.push(function(D){var j,K,B=O._cfg.dbschema;j=B,K=D,[].slice.call(K.db.objectStoreNames).forEach(function(U){return j[U]==null&&K.db.deleteObjectStore(U)}),yr(m,[m.Transaction.prototype]),jn(m,[m.Transaction.prototype],m._storeNames,m._dbSchema),b.schema=m._dbSchema}),C.push(function(D){m.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(m.idbdb.version/10)===O._cfg.version?(m.idbdb.deleteObjectStore("$meta"),delete m._dbSchema.$meta,m._storeNames=m._storeNames.filter(function(j){return j!=="$meta"})):D.objectStore("$meta").put(O._cfg.version,"version"))})}),function O(){return C.length?z.resolve(C.shift()(b.idbtrans)).then(O):z.resolve()}().then(function(){ui(x,T)})):z.resolve();var m,S,b,T,C,x}).catch(h)):(d(a).forEach(function(E){gr(r,E,a[E].primKey,a[E].indexes)}),Dn(e,r),void z.follow(function(){return e.on.populate.fire(f)}).catch(h));var _,w})}function Co(e,t){ui(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=Rn(0,e.idbdb,t);Mn(e,e._dbSchema,t);for(var i=0,a=_r(r,e._dbSchema).change;i<a.length;i++){var f=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var p=t.objectStore(h.name);h.add.forEach(function(_){at&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(_.src)),Kn(p,_)})}(a[i]);if(typeof f=="object")return f.value}}function _r(e,t){var r,i={del:[],add:[],change:[]};for(r in e)t[r]||i.del.push(r);for(r in t){var a=e[r],f=t[r];if(a){var h={name:r,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||a.primKey.auto!==f.primKey.auto)h.recreate=!0,i.change.push(h);else{var p=a.idxByName,_=f.idxByName,w=void 0;for(w in p)_[w]||h.del.push(w);for(w in _){var E=p[w],m=_[w];E?E.src!==m.src&&h.change.push(m):h.add.push(m)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([r,f])}return i}function gr(e,t,r,i){var a=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return i.forEach(function(f){return Kn(a,f)}),a}function ui(e,t){d(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(at&&console.debug("Dexie: Creating missing table",r),gr(t,r,e[r].primKey,e[r].indexes))})}function Kn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Rn(e,t,r){var i={};return Q(t.objectStoreNames,0).forEach(function(a){for(var f=r.objectStore(a),h=pr(ai(w=f.keyPath),w||"",!0,!1,!!f.autoIncrement,w&&typeof w!="string",!0),p=[],_=0;_<f.indexNames.length;++_){var E=f.index(f.indexNames[_]),w=E.keyPath,E=pr(E.name,w,!!E.unique,!!E.multiEntry,!1,w&&typeof w!="string",!1);p.push(E)}i[a]=mr(a,h,p)}),i}function Mn(e,t,r){for(var i=r.db.objectStoreNames,a=0;a<i.length;++a){var f=i[a],h=r.objectStore(f);e._hasGetAll="getAll"in h;for(var p=0;p<h.indexNames.length;++p){var _=h.indexNames[p],w=h.index(_).keyPath,E=typeof w=="string"?w:"["+Q(w).join("+")+"]";!t[f]||(w=t[f].idxByName[E])&&(w.name=_,delete t[f].idxByName[E],t[f].idxByName[_]=w)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&c.WorkerGlobalScope&&c instanceof c.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function li(e){return e.split(",").map(function(t,r){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return pr(i,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),v(a),r===0)})}var So=(An.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(r){if(e[r]!==null){var i=li(e[r]),a=i.shift();if(a.unique=!0,a.multi)throw new ne.Schema("Primary key cannot be multi-valued");i.forEach(function(f){if(f.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")}),t[r]=mr(r,a,i)}})},An.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?P(this._cfg.storesSource,r):r;var r=t._versions,i={},a={};return r.forEach(function(f){P(i,f._cfg.storesSource),a=f._cfg.dbschema={},f._parseStoresSpec(i,a)}),t._dbSchema=a,yr(t,[t._allTables,t,t.Transaction.prototype]),jn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},An.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Zn(this._cfg.contentUpgrade||Ce,e),this},An);function An(){}function br(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new ht(Cn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function wr(e){return e&&typeof e.databases=="function"}function kr(e){return vt(function(){return ee.letThrough=!0,e()})}function xr(e){return!("from"in e)}var Xe=function(e,t){if(!this){var r=new Xe;return e&&"d"in e&&P(r,e),r}P(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function dn(e,t,r){var i=ke(t,r);if(!isNaN(i)){if(0<i)throw RangeError();if(xr(e))return P(e,{from:t,to:r,d:1});var a=e.l,i=e.r;if(ke(r,e.from)<0)return a?dn(a,t,r):e.l={from:t,to:r,d:1,l:null,r:null},fi(e);if(0<ke(t,e.to))return i?dn(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},fi(e);ke(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<ke(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,a&&!e.l&&hn(e,a),i&&r&&hn(e,i)}}function hn(e,t){xr(t)||function r(i,_){var f=_.from,h=_.to,p=_.l,_=_.r;dn(i,f,h),p&&r(i,p),_&&r(i,_)}(e,t)}function ci(e,t){var r=Nn(t),i=r.next();if(i.done)return!1;for(var a=i.value,f=Nn(e),h=f.next(a.from),p=h.value;!i.done&&!h.done;){if(ke(p.from,a.to)<=0&&0<=ke(p.to,a.from))return!0;ke(a.from,p.from)<0?a=(i=r.next(p.from)).value:p=(h=f.next(a.from)).value}return!1}function Nn(e){var t=xr(e)?null:{s:0,n:e};return{next:function(r){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&ke(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||ke(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function fi(e){var t,r,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",r=o({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],r[a]=i[t],(e[t]=r).d=di(r)),e.d=di(e)}function di(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function Bn(e,t){return d(t).forEach(function(r){e[r]?hn(e[r],t[r]):e[r]=function i(a){var f,h,p={};for(f in a)I(a,f)&&(h=a[f],p[f]=!h||typeof h!="object"||Ee.has(h.constructor)?h:i(h));return p}(t[r])}),e}function Tr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&ci(t[r],e[r])})}y(Xe.prototype,((rt={add:function(e){return hn(this,e),this},addKey:function(e){return dn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return dn(t,r,r)}),this},hasKey:function(e){var t=Nn(this).next(e).value;return t&&ke(t.from,e)<=0&&0<=ke(t.to,e)}})[ge]=function(){return Nn(this)},rt));var Ft={},Er={},Cr=!1;function qn(e){Bn(Er,e),Cr||(Cr=!0,setTimeout(function(){Cr=!1,Sr(Er,!(Er={}))},0))}function Sr(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var i=0,a=Object.values(Ft);i<a.length;i++)hi(h=a[i],e,r,t);else for(var f in e){var h,p=/^idb\:\/\/(.*)\/(.*)\//.exec(f);p&&(f=p[1],p=p[2],(h=Ft["idb://".concat(f,"/").concat(p)])&&hi(h,e,r,t))}r.forEach(function(_){return _()})}function hi(e,t,r,i){for(var a=[],f=0,h=Object.entries(e.queries.query);f<h.length;f++){for(var p=h[f],_=p[0],w=[],E=0,m=p[1];E<m.length;E++){var S=m[E];Tr(t,S.obsSet)?S.subscribers.forEach(function(x){return r.add(x)}):i&&w.push(S)}i&&a.push([_,w])}if(i)for(var b=0,T=a;b<T.length;b++){var C=T[b],_=C[0],w=C[1];e.queries.query[_]=w}}function Io(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Fe(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),f=!1;function h(){if(t.openCanceller!==i)throw new ne.DatabaseClosed("db.open() was cancelled")}function p(){return new z(function(S,b){if(h(),!r)throw new ne.MissingAPI;var T=e.name,C=t.autoSchema||!a?r.open(T):r.open(T,a);if(!C)throw new ne.MissingAPI;C.onerror=st(b),C.onblocked=De(e._fireOnBlocked),C.onupgradeneeded=De(function(x){var O;E=C.transaction,t.autoSchema&&!e._options.allowEmptyDB?(C.onerror=un,E.abort(),C.result.close(),(O=r.deleteDatabase(T)).onsuccess=O.onerror=De(function(){b(new ne.NoSuchDatabase("Database ".concat(T," doesnt exist")))})):(E.onerror=st(b),x=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,m=x<1,e.idbdb=C.result,f&&Co(e,E),Eo(e,x/10,E,b))},b),C.onsuccess=De(function(){E=null;var x,O,D,j,K,B=e.idbdb=C.result,U=Q(B.objectStoreNames);if(0<U.length)try{var q=B.transaction((j=U).length===1?j[0]:j,"readonly");if(t.autoSchema)O=B,D=q,(x=e).verno=O.version/10,D=x._dbSchema=Rn(0,O,D),x._storeNames=Q(O.objectStoreNames,0),jn(x,[x._allTables],d(D),D);else if(Mn(e,e._dbSchema,q),((K=_r(Rn(0,(K=e).idbdb,q),K._dbSchema)).add.length||K.change.some(function(F){return F.add.length||F.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),B.close(),a=B.version+1,f=!0,S(p());Dn(e,q)}catch{}Wt.push(e),B.onversionchange=De(function(F){t.vcFired=!0,e.on("versionchange").fire(F)}),B.onclose=De(function(F){e.on("close").fire(F)}),m&&(K=e._deps,q=T,B=K.indexedDB,K=K.IDBKeyRange,wr(B)||q===Cn||br(B,K).put({name:q}).catch(Ce)),S()},b)}).catch(function(S){switch(S==null?void 0:S.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),p();break;case"VersionError":if(0<a)return a=0,p()}return z.reject(S)})}var _,w=t.dbReadyResolve,E=null,m=!1;return z.race([i,(typeof navigator>"u"?z.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(S){function b(){return indexedDB.databases().finally(S)}_=setInterval(b,100),b()}).finally(function(){return clearInterval(_)}):Promise.resolve()).then(p)]).then(function(){return h(),t.onReadyBeingFired=[],z.resolve(kr(function(){return e.on.ready.fire(e.vip)})).then(function S(){if(0<t.onReadyBeingFired.length){var b=t.onReadyBeingFired.reduce(Zn,Ce);return t.onReadyBeingFired=[],z.resolve(kr(function(){return b(e.vip)})).then(S)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(S){t.dbOpenError=S;try{E&&E.abort()}catch{}return i===t.openCanceller&&e._close(),Fe(S)}).finally(function(){t.openComplete=!0,w()}).then(function(){var S;return m&&(S={},e.tables.forEach(function(b){b.schema.indexes.forEach(function(T){T.name&&(S["idb://".concat(e.name,"/").concat(b.name,"/").concat(T.name)]=new Xe(-1/0,[[[]]]))}),S["idb://".concat(e.name,"/").concat(b.name,"/")]=S["idb://".concat(e.name,"/").concat(b.name,"/:dels")]=new Xe(-1/0,[[[]]])}),bt(ln).fire(S),Sr(S,!0)),e})}function Ir(e){function t(f){return e.next(f)}var r=a(t),i=a(function(f){return e.throw(f)});function a(f){return function(_){var p=f(_),_=p.value;return p.done?_:_&&typeof _.then=="function"?_.then(r,i):v(_)?Promise.all(_).then(r,i):r(_)}}return a(t)()}function Fn(e,t,r){for(var i=v(e)?e.slice():[e],a=0;a<r;++a)i.push(t);return i}var Oo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var r=e.table(t),i=r.schema,a={},f=[];function h(m,S,b){var T=fn(m),C=a[T]=a[T]||[],x=m==null?0:typeof m=="string"?1:m.length,O=0<S,O=o(o({},b),{name:O?"".concat(T,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:O,keyTail:S,keyLength:x,extractKey:vr(m),unique:!O&&b.unique});return C.push(O),O.isPrimaryKey||f.push(O),1<x&&h(x===2?m[0]:m.slice(0,x-1),S+1,b),C.sort(function(D,j){return D.keyTail-j.keyTail}),O}t=h(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var p=0,_=i.indexes;p<_.length;p++){var w=_[p];h(w.keyPath,0,w)}function E(m){var S,b=m.query.index;return b.isVirtual?o(o({},m),{query:{index:b.lowLevelIndex,range:(S=m.query.range,b=b.keyTail,{type:S.type===1?2:S.type,lower:Fn(S.lower,S.lowerOpen?e.MAX_KEY:e.MIN_KEY,b),lowerOpen:!0,upper:Fn(S.upper,S.upperOpen?e.MIN_KEY:e.MAX_KEY,b),upperOpen:!0})}}):m}return o(o({},r),{schema:o(o({},i),{primaryKey:t,indexes:f,getIndexByKeyPath:function(m){return(m=a[fn(m)])&&m[0]}}),count:function(m){return r.count(E(m))},query:function(m){return r.query(E(m))},openCursor:function(m){var S=m.query.index,b=S.keyTail,T=S.isVirtual,C=S.keyLength;return T?r.openCursor(E(m)).then(function(O){return O&&x(O)}):r.openCursor(m);function x(O){return Object.create(O,{continue:{value:function(D){D!=null?O.continue(Fn(D,m.reverse?e.MAX_KEY:e.MIN_KEY,b)):m.unique?O.continue(O.key.slice(0,C).concat(m.reverse?e.MIN_KEY:e.MAX_KEY,b)):O.continue()}},continuePrimaryKey:{value:function(D,j){O.continuePrimaryKey(Fn(D,e.MAX_KEY,b),j)}},primaryKey:{get:function(){return O.primaryKey}},key:{get:function(){var D=O.key;return C===1?D[0]:D.slice(0,C)}},value:{get:function(){return O.value}}})}}})}})}};function Or(e,t,r,i){return r=r||{},i=i||"",d(e).forEach(function(a){var f,h,p;I(t,a)?(f=e[a],h=t[a],typeof f=="object"&&typeof h=="object"&&f&&h?(p=Je(f))!==Je(h)?r[i+a]=t[a]:p==="Object"?Or(f,h,r,i+a+"."):f!==h&&(r[i+a]=t[a]):f!==h&&(r[i+a]=t[a])):r[i+a]=void 0}),d(t).forEach(function(a){I(e,a)||(r[i+a]=t[a])}),r}function Pr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Po={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var r=e.table(t),i=r.schema.primaryKey;return o(o({},r),{mutate:function(a){var f=ee.trans,h=f.table(t).hook,p=h.deleting,_=h.creating,w=h.updating;switch(a.type){case"add":if(_.fire===Ce)break;return f._promise("readwrite",function(){return E(a)},!0);case"put":if(_.fire===Ce&&w.fire===Ce)break;return f._promise("readwrite",function(){return E(a)},!0);case"delete":if(p.fire===Ce)break;return f._promise("readwrite",function(){return E(a)},!0);case"deleteRange":if(p.fire===Ce)break;return f._promise("readwrite",function(){return function m(S,b,T){return r.query({trans:S,values:!1,query:{index:i,range:b},limit:T}).then(function(C){var x=C.result;return E({type:"delete",keys:x,trans:S}).then(function(O){return 0<O.numFailures?Promise.reject(O.failures[0]):x.length<T?{failures:[],numFailures:0,lastResult:void 0}:m(S,o(o({},b),{lower:x[x.length-1],lowerOpen:!0}),T)})})}(a.trans,a.range,1e4)},!0)}return r.mutate(a);function E(m){var S,b,T,C=ee.trans,x=m.keys||Pr(i,m);if(!x)throw new Error("Keys missing");return(m=m.type==="add"||m.type==="put"?o(o({},m),{keys:x}):o({},m)).type!=="delete"&&(m.values=u([],m.values)),m.keys&&(m.keys=u([],m.keys)),S=r,T=x,((b=m).type==="add"?Promise.resolve([]):S.getMany({trans:b.trans,keys:T,cache:"immutable"})).then(function(O){var D=x.map(function(j,K){var B,U,q,F=O[K],V={onerror:null,onsuccess:null};return m.type==="delete"?p.fire.call(V,j,F,C):m.type==="add"||F===void 0?(B=_.fire.call(V,j,m.values[K],C),j==null&&B!=null&&(m.keys[K]=j=B,i.outbound||Z(m.values[K],i.keyPath,j))):(B=Or(F,m.values[K]),(U=w.fire.call(V,B,j,F,C))&&(q=m.values[K],Object.keys(U).forEach(function(L){I(q,L)?q[L]=U[L]:Z(q,L,U[L])}))),V});return r.mutate(m).then(function(j){for(var K=j.failures,B=j.results,U=j.numFailures,j=j.lastResult,q=0;q<x.length;++q){var F=(B||x)[q],V=D[q];F==null?V.onerror&&V.onerror(K[q]):V.onsuccess&&V.onsuccess(m.type==="put"&&O[q]?m.values[q]:F)}return{failures:K,results:B,numFailures:U,lastResult:j}}).catch(function(j){return D.forEach(function(K){return K.onerror&&K.onerror(j)}),Promise.reject(j)})})}}})}})}};function pi(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,f=0;a<t.keys.length&&f<e.length;++a)ke(t.keys[a],e[f])===0&&(i.push(r?ue(t.values[a]):t.values[a]),++f);return i.length===e.length?i:null}catch{return null}}var Do={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return o(o({},r),{getMany:function(i){if(!i.cache)return r.getMany(i);var a=pi(i.keys,i.trans._cache,i.cache==="clone");return a?z.resolve(a):r.getMany(i).then(function(f){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?ue(f):f},f})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),r.mutate(i)}})}}}};function mi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function vi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var jo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new Xe(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,a,f){if(ee.subscr&&a!=="readonly")throw new ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ee.querier));return e.transaction(i,a,f)},table:function(i){var a=e.table(i),f=a.schema,h=f.primaryKey,m=f.indexes,p=h.extractKey,_=h.outbound,w=h.autoIncrement&&m.filter(function(b){return b.compound&&b.keyPath.includes(h.keyPath)}),E=o(o({},a),{mutate:function(b){function T(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),j[L]||(j[L]=new Xe)}var C,x,O,D=b.trans,j=b.mutatedParts||(b.mutatedParts={}),K=T(""),B=T(":dels"),U=b.type,V=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[Pr(h,b).filter(function(L){return L}),b.values]:[],q=V[0],F=V[1],V=b.trans._cache;return v(q)?(K.addKeys(q),(V=U==="delete"||q.length===F.length?pi(q,V):null)||B.addKeys(q),(V||F)&&(C=T,x=V,O=F,f.indexes.forEach(function(L){var X=C(L.name||"");function he(we){return we!=null?L.extractKey(we):null}function be(we){return L.multiEntry&&v(we)?we.forEach(function(nt){return X.addKey(nt)}):X.addKey(we)}(x||O).forEach(function(we,Qe){var de=x&&he(x[Qe]),Qe=O&&he(O[Qe]);ke(de,Qe)!==0&&(de!=null&&be(de),Qe!=null&&be(Qe))})}))):q?(F={from:(F=q.lower)!==null&&F!==void 0?F:e.MIN_KEY,to:(F=q.upper)!==null&&F!==void 0?F:e.MAX_KEY},B.add(F),K.add(F)):(K.add(r),B.add(r),f.indexes.forEach(function(L){return T(L.name).add(r)})),a.mutate(b).then(function(L){return!q||b.type!=="add"&&b.type!=="put"||(K.addKeys(L.results),w&&w.forEach(function(X){for(var he=b.values.map(function(de){return X.extractKey(de)}),be=X.keyPath.findIndex(function(de){return de===h.keyPath}),we=0,nt=L.results.length;we<nt;++we)he[we][be]=L.results[we];T(X.name).addKeys(he)})),D.mutatedParts=Bn(D.mutatedParts||{},j),L})}}),m=function(T){var C=T.query,T=C.index,C=C.range;return[T,new Xe((T=C.lower)!==null&&T!==void 0?T:e.MIN_KEY,(C=C.upper)!==null&&C!==void 0?C:e.MAX_KEY)]},S={get:function(b){return[h,new Xe(b.key)]},getMany:function(b){return[h,new Xe().addKeys(b.keys)]},count:m,query:m,openCursor:m};return d(S).forEach(function(b){E[b]=function(T){var C=ee.subscr,x=!!C,O=mi(ee,a)&&vi(b,T)?T.obsSet={}:C;if(x){var D=function(F){return F="idb://".concat(t,"/").concat(i,"/").concat(F),O[F]||(O[F]=new Xe)},j=D(""),K=D(":dels"),C=S[b](T),x=C[0],C=C[1];if((b==="query"&&x.isPrimaryKey&&!T.values?K:D(x.name||"")).add(C),!x.isPrimaryKey){if(b!=="count"){var B=b==="query"&&_&&T.values&&a.query(o(o({},T),{values:!1}));return a[b].apply(this,arguments).then(function(F){if(b==="query"){if(_&&T.values)return B.then(function(he){return he=he.result,j.addKeys(he),F});var V=T.values?F.result.map(p):F.result;(T.values?j:K).addKeys(V)}else if(b==="openCursor"){var L=F,X=T.values;return L&&Object.create(L,{key:{get:function(){return K.addKey(L.primaryKey),L.key}},primaryKey:{get:function(){var he=L.primaryKey;return K.addKey(he),he}},value:{get:function(){return X&&j.addKey(L.primaryKey),L.value}}})}return F})}K.add(r)}}return a[b].apply(this,arguments)}}),E}})}};function yi(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===i?null:(t=o({},t),v(t.keys)&&(t.keys=t.keys.filter(function(a,f){return!(f in r.failures)})),"values"in t&&v(t.values)&&(t.values=t.values.filter(function(a,f){return!(f in r.failures)})),t)}function Dr(e,t){return r=e,((i=t).lower===void 0||(i.lowerOpen?0<ke(r,i.lower):0<=ke(r,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ke(e,t.upper)<0:ke(e,t.upper)<=0));var r,i}function _i(e,t,S,i,a,f){if(!S||S.length===0)return e;var h=t.query.index,p=h.multiEntry,_=t.query.range,w=i.schema.primaryKey.extractKey,E=h.extractKey,m=(h.lowLevelIndex||h).extractKey,S=S.reduce(function(b,T){var C=b,x=[];if(T.type==="add"||T.type==="put")for(var O=new Xe,D=T.values.length-1;0<=D;--D){var j,K=T.values[D],B=w(K);O.hasKey(B)||(j=E(K),(p&&v(j)?j.some(function(L){return Dr(L,_)}):Dr(j,_))&&(O.addKey(B),x.push(K)))}switch(T.type){case"add":var U=new Xe().addKeys(t.values?b.map(function(X){return w(X)}):b),C=b.concat(t.values?x.filter(function(X){return X=w(X),!U.hasKey(X)&&(U.addKey(X),!0)}):x.map(function(X){return w(X)}).filter(function(X){return!U.hasKey(X)&&(U.addKey(X),!0)}));break;case"put":var q=new Xe().addKeys(T.values.map(function(X){return w(X)}));C=b.filter(function(X){return!q.hasKey(t.values?w(X):X)}).concat(t.values?x:x.map(function(X){return w(X)}));break;case"delete":var F=new Xe().addKeys(T.keys);C=b.filter(function(X){return!F.hasKey(t.values?w(X):X)});break;case"deleteRange":var V=T.range;C=b.filter(function(X){return!Dr(w(X),V)})}return C},e);return S===e?e:(S.sort(function(b,T){return ke(m(b),m(T))||ke(w(b),w(T))}),t.limit&&t.limit<1/0&&(S.length>t.limit?S.length=t.limit:e.length===t.limit&&S.length<t.limit&&(a.dirty=!0)),f?Object.freeze(S):S)}function gi(e,t){return ke(e.lower,t.lower)===0&&ke(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Ko(e,t){return function(r,i,a,f){if(r===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=ke(r,i))===0){if(a&&f)return 0;if(a)return 1;if(f)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,i,a,f){if(r===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=ke(r,i))===0){if(a&&f)return 0;if(a)return-1;if(f)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Ro(e,t,r,i){e.subscribers.add(r),i.addEventListener("abort",function(){var a,f;e.subscribers.delete(r),e.subscribers.size===0&&(a=e,f=t,setTimeout(function(){a.subscribers.size===0&&Re(f,a)},3e3))})}var Mo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(r,i,a){var f,h,p=e.transaction(r,i,a);return i==="readwrite"&&(h=(f=new AbortController).signal,a=function(_){return function(){if(f.abort(),i==="readwrite"){for(var w=new Set,E=0,m=r;E<m.length;E++){var S=m[E],b=Ft["idb://".concat(t,"/").concat(S)];if(b){var T=e.table(S),C=b.optimisticOps.filter(function(X){return X.trans===p});if(p._explicit&&_&&p.mutatedParts)for(var x=0,O=Object.values(b.queries.query);x<O.length;x++)for(var D=0,j=(U=O[x]).slice();D<j.length;D++)Tr((q=j[D]).obsSet,p.mutatedParts)&&(Re(U,q),q.subscribers.forEach(function(X){return w.add(X)}));else if(0<C.length){b.optimisticOps=b.optimisticOps.filter(function(X){return X.trans!==p});for(var K=0,B=Object.values(b.queries.query);K<B.length;K++)for(var U,q,F,V=0,L=(U=B[K]).slice();V<L.length;V++)(q=L[V]).res!=null&&p.mutatedParts&&(_&&!q.dirty?(F=Object.isFrozen(q.res),F=_i(q.res,q.req,C,T,q,F),q.dirty?(Re(U,q),q.subscribers.forEach(function(X){return w.add(X)})):F!==q.res&&(q.res=F,q.promise=z.resolve({result:F}))):(q.dirty&&Re(U,q),q.subscribers.forEach(function(X){return w.add(X)})))}}}w.forEach(function(X){return X()})}}},p.addEventListener("abort",a(!1),{signal:h}),p.addEventListener("error",a(!1),{signal:h}),p.addEventListener("complete",a(!0),{signal:h})),p},table:function(r){var i=e.table(r),a=i.schema.primaryKey;return o(o({},i),{mutate:function(f){var h=ee.trans;if(a.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(f);var p=Ft["idb://".concat(t,"/").concat(r)];return p?(h=i.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||Pr(a,f).some(function(_){return _==null}))?(p.optimisticOps.push(f),f.mutatedParts&&qn(f.mutatedParts),h.then(function(_){0<_.numFailures&&(Re(p.optimisticOps,f),(_=yi(0,f,_))&&p.optimisticOps.push(_),f.mutatedParts&&qn(f.mutatedParts))}),h.catch(function(){Re(p.optimisticOps,f),f.mutatedParts&&qn(f.mutatedParts)})):h.then(function(_){var w=yi(0,o(o({},f),{values:f.values.map(function(E,m){var S;return _.failures[m]?E:(E=(S=a.keyPath)!==null&&S!==void 0&&S.includes(".")?ue(E):o({},E),Z(E,a.keyPath,_.results[m]),E)})}),_);p.optimisticOps.push(w),queueMicrotask(function(){return f.mutatedParts&&qn(f.mutatedParts)})}),h):i.mutate(f)},query:function(f){if(!mi(ee,i)||!vi("query",f))return i.query(f);var h=((w=ee.trans)===null||w===void 0?void 0:w.db._options.cache)==="immutable",m=ee,p=m.requery,_=m.signal,w=function(T,C,x,O){var D=Ft["idb://".concat(T,"/").concat(C)];if(!D)return[];if(!(C=D.queries[x]))return[null,!1,D,null];var j=C[(O.query?O.query.index.name:null)||""];if(!j)return[null,!1,D,null];switch(x){case"query":var K=j.find(function(B){return B.req.limit===O.limit&&B.req.values===O.values&&gi(B.req.query.range,O.query.range)});return K?[K,!0,D,j]:[j.find(function(B){return("limit"in B.req?B.req.limit:1/0)>=O.limit&&(!O.values||B.req.values)&&Ko(B.req.query.range,O.query.range)}),!1,D,j];case"count":return K=j.find(function(B){return gi(B.req.query.range,O.query.range)}),[K,!!K,D,j]}}(t,r,"query",f),E=w[0],m=w[1],S=w[2],b=w[3];return E&&m?E.obsSet=f.obsSet:(m=i.query(f).then(function(T){var C=T.result;if(E&&(E.res=C),h){for(var x=0,O=C.length;x<O;++x)Object.freeze(C[x]);Object.freeze(C)}else T.result=ue(C);return T}).catch(function(T){return b&&E&&Re(b,E),Promise.reject(T)}),E={obsSet:f.obsSet,promise:m,subscribers:new Set,type:"query",req:f,dirty:!1},b?b.push(E):(b=[E],(S=S||(Ft["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=b)),Ro(E,b,p,_),E.promise.then(function(T){return{result:_i(T.result,f,S==null?void 0:S.optimisticOps,i,E,h)}})}})}})}};function Ln(e,t){return new Proxy(e,{get:function(r,i,a){return i==="db"?t:Reflect.get(r,i,a)}})}var ht=(Le.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(To),r.stores({}),this._state.autoSchema=!1,r)},Le.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ee.letThrough||this._vip)?e():new z(function(r,i){if(t._state.openComplete)return i(new ne.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new ne.DatabaseClosed);t.open().catch(Ce)}t._state.dbReadyPromise.then(r,i)}).then(e)},Le.prototype.use=function(e){var t=e.stack,r=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:i??10,name:a}),e.sort(function(f,h){return f.level-h.level}),this},Le.prototype.unuse=function(e){var t=e.stack,r=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!r&&a.name!==r})),this},Le.prototype.open=function(){var e=this;return Nt(mt,function(){return Io(e)})},Le.prototype._close=function(){var e=this._state,t=Wt.indexOf(this);if(0<=t&&Wt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new z(function(r){e.dbReadyResolve=r}),e.openCanceller=new z(function(r,i){e.cancelOpen=i}))},Le.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new ne.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new ne.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},Le.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new z(function(a,f){function h(){t.close(e);var p=t._deps.indexedDB.deleteDatabase(t.name);p.onsuccess=De(function(){var _,w,E;_=t._deps,w=t.name,E=_.indexedDB,_=_.IDBKeyRange,wr(E)||w===Cn||br(E,_).delete(w).catch(Ce),a()}),p.onerror=st(f),p.onblocked=t._fireOnBlocked}if(r)throw new ne.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Le.prototype.backendDB=function(){return this.idbdb},Le.prototype.isOpen=function(){return this.idbdb!==null},Le.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Le.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Le.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Le.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Le.prototype.transaction=function(){var e=(function(t,r,i){var a=arguments.length;if(a<2)throw new ne.InvalidArgument("Too few arguments");for(var f=new Array(a-1);--a;)f[a-1]=arguments[a];return i=f.pop(),[t,Se(f),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Le.prototype._transaction=function(e,t,r){var i=this,a=ee.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var f,h,p=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(w){if(w=w instanceof i.Table?w.name:w,typeof w!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return w}),e=="r"||e===ur)f=ur;else{if(e!="rw"&&e!=lr)throw new ne.InvalidArgument("Invalid transaction mode: "+e);f=lr}if(a){if(a.mode===ur&&f===lr){if(!p)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&h.forEach(function(w){if(a&&a.storeNames.indexOf(w)===-1){if(!p)throw new ne.SubTransaction("Table "+w+" not included in parent transaction.");a=null}}),p&&a&&!a.active&&(a=null)}}catch(w){return a?a._promise(null,function(E,m){m(w)}):Fe(w)}var _=(function w(E,m,S,b,T){return z.resolve().then(function(){var C=ee.transless||ee,x=E._createTransaction(m,S,E._dbSchema,b);if(x.explicit=!0,C={trans:x,transless:C},b)x.idbtrans=b.idbtrans;else try{x.create(),x.idbtrans._explicit=!0,E._state.PR1398_maxLoop=3}catch(j){return j.name===Dt.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return w(E,m,S,null,T)})):Fe(j)}var O,D=Ve(T);return D&&Gt(),C=z.follow(function(){var j;(O=T.call(x,x))&&(D?(j=yt.bind(null,null),O.then(j,j)):typeof O.next=="function"&&typeof O.throw=="function"&&(O=Ir(O)))},C),(O&&typeof O.then=="function"?z.resolve(O).then(function(j){return x.active?j:Fe(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):C.then(function(){return O})).then(function(j){return b&&x._resolve(),x._completion.then(function(){return j})}).catch(function(j){return x._reject(j),Fe(j)})})}).bind(null,this,f,h,a,r);return a?a._promise(f,_,"lock"):ee.trans?Nt(ee.transless,function(){return i._whenReady(_)}):this._whenReady(_)},Le.prototype.table=function(e){if(!I(this._allTables,e))throw new ne.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Le);function Le(e,t){var r=this;this._middlewares={},this.verno=0;var i=Le.dependencies;this._options=t=o({addons:Le.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,f,h,p,_,w={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ce,dbReadyPromise:null,cancelOpen:Ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};w.dbReadyPromise=new z(function(m){w.dbReadyResolve=m}),w.openCanceller=new z(function(m,S){w.cancelOpen=S}),this._state=w,this.name=e,this.on=on(this,"populate","blocked","versionchange","close",{ready:[Zn,Ce]}),this.on.ready.subscribe=Y(this.on.ready.subscribe,function(m){return function(S,b){Le.vip(function(){var T,C=r._state;C.openComplete?(C.dbOpenError||z.resolve().then(S),b&&m(S)):C.onReadyBeingFired?(C.onReadyBeingFired.push(S),b&&m(S)):(m(S),T=r,b||m(function x(){T.on.ready.unsubscribe(S),T.on.ready.unsubscribe(x)}))})}}),this.Collection=(a=this,an(yo.prototype,function(O,x){this.db=a;var b=Qr,T=null;if(x)try{b=x()}catch(D){T=D}var C=O._ctx,x=C.table,O=x.hook.reading.fire;this._ctx={table:x,index:C.index,isPrimKey:!C.index||x.schema.primKey.keyPath&&C.index===x.schema.primKey.name,range:b,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:T,or:C.or,valueMapper:O!==Zt?O:null}})),this.Table=(f=this,an(ei.prototype,function(m,S,b){this.db=f,this._tx=b,this.name=m,this.schema=S,this.hook=f._allTables[m]?f._allTables[m].hook:on(null,{creating:[so,Ce],reading:[ao,Zt],updating:[lo,Ce],deleting:[uo,Ce]})})),this.Transaction=(h=this,an(bo.prototype,function(m,S,b,T,C){var x=this;this.db=h,this.mode=m,this.storeNames=S,this.schema=b,this.chromeTransactionDurability=T,this.idbtrans=null,this.on=on(this,"complete","error","abort"),this.parent=C||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new z(function(O,D){x._resolve=O,x._reject=D}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(O){var D=x.active;return x.active=!1,x.on.error.fire(O),x.parent?x.parent._reject(O):D&&x.idbtrans&&x.idbtrans.abort(),Fe(O)})})),this.Version=(p=this,an(So.prototype,function(m){this.db=p,this._cfg={version:m,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(_=this,an(oi.prototype,function(m,S,b){if(this.db=_,this._ctx={table:m,index:S===":id"?null:S,or:b},this._cmp=this._ascending=ke,this._descending=function(T,C){return ke(C,T)},this._max=function(T,C){return 0<ke(T,C)?T:C},this._min=function(T,C){return ke(T,C)<0?T:C},this._IDBKeyRange=_._deps.IDBKeyRange,!this._IDBKeyRange)throw new ne.MissingAPI})),this.on("versionchange",function(m){0<m.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(m){!m.newVersion||m.newVersion<m.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(m.oldVersion/10))}),this._maxKey=cn(t.IDBKeyRange),this._createTransaction=function(m,S,b,T){return new r.Transaction(m,S,b,r._options.chromeTransactionDurability,T)},this._fireOnBlocked=function(m){r.on("blocked").fire(m),Wt.filter(function(S){return S.name===r.name&&S!==r&&!S._state.vcFired}).map(function(S){return S.on("versionchange").fire(m)})},this.use(Do),this.use(Mo),this.use(jo),this.use(Oo),this.use(Po);var E=new Proxy(this,{get:function(m,S,b){if(S==="_vip")return!0;if(S==="table")return function(C){return Ln(r.table(C),E)};var T=Reflect.get(m,S,b);return T instanceof ei?Ln(T,E):S==="tables"?T.map(function(C){return Ln(C,E)}):S==="_createTransaction"?function(){return Ln(T.apply(this,arguments),E)}:T}});this.vip=E,i.forEach(function(m){return m(r)})}var Un,rt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ao=(jr.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},jr.prototype[rt]=function(){return this},jr);function jr(e){this._subscribe=e}try{Un={indexedDB:c.indexedDB||c.mozIndexedDB||c.webkitIndexedDB||c.msIndexedDB,IDBKeyRange:c.IDBKeyRange||c.webkitIDBKeyRange}}catch{Un={indexedDB:null,IDBKeyRange:null}}function bi(e){var t,r=!1,i=new Ao(function(a){var f=Ve(e),h,p=!1,_={},w={},E={get closed(){return p},unsubscribe:function(){p||(p=!0,h&&h.abort(),m&&bt.storagemutated.unsubscribe(b))}};a.start&&a.start(E);var m=!1,S=function(){return sr(T)},b=function(C){Bn(_,C),Tr(w,_)&&S()},T=function(){var C,x,O;!p&&Un.indexedDB&&(_={},C={},h&&h.abort(),h=new AbortController,O=function(D){var j=Ht();try{f&&Gt();var K=vt(e,D);return K=f?K.finally(yt):K}finally{j&&zt()}}(x={subscr:C,signal:h.signal,requery:S,querier:e,trans:null}),Promise.resolve(O).then(function(D){r=!0,t=D,p||x.signal.aborted||(_={},function(j){for(var K in j)if(I(j,K))return;return 1}(w=C)||m||(bt(ln,b),m=!0),sr(function(){return!p&&a.next&&a.next(D)}))},function(D){r=!1,["DatabaseClosedError","AbortError"].includes(D==null?void 0:D.name)||p||sr(function(){p||a.error&&a.error(D)})}))};return setTimeout(S,0),E});return i.hasValue=function(){return r},i.getValue=function(){return t},i}var Lt=ht;function Kr(e){var t=wt;try{wt=!0,bt.storagemutated.fire(e),Sr(e,!0)}finally{wt=t}}y(Lt,o(o({},yn),{delete:function(e){return new Lt(e,{addons:[]}).delete()},exists:function(e){return new Lt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Lt.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(wr(r)?Promise.resolve(r.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==Cn})}):br(r,t).toCollection().primaryKeys()).then(e)}catch{return Fe(new ne.MissingAPI)}var t,r},defineClass:function(){return function(e){P(this,e)}},ignoreTransaction:function(e){return ee.trans?Nt(ee.transless,e):e()},vip:kr,async:function(e){return function(){try{var t=Ir(e.apply(this,arguments));return t&&typeof t.then=="function"?t:z.resolve(t)}catch(r){return Fe(r)}}},spawn:function(e,t,r){try{var i=Ir(e.apply(r,t||[]));return i&&typeof i.then=="function"?i:z.resolve(i)}catch(a){return Fe(a)}},currentTransaction:{get:function(){return ee.trans||null}},waitFor:function(e,t){return t=z.resolve(typeof e=="function"?Lt.ignoreTransaction(e):e).timeout(t||6e4),ee.trans?ee.trans.waitFor(t):t},Promise:z,debug:{get:function(){return at},set:function(e){Vr(e)}},derive:ce,extend:P,props:y,override:Y,Events:on,on:bt,liveQuery:bi,extendObservabilitySet:Bn,getByKeyPath:ie,setByKeyPath:Z,delByKeyPath:function(e,t){typeof t=="string"?Z(e,t,void 0):"length"in t&&[].map.call(t,function(r){Z(e,r,void 0)})},shallowClone:te,deepClone:ue,getObjectDiff:Or,cmp:ke,asap:pe,minKey:-1/0,addons:[],connections:Wt,errnames:Dt,dependencies:Un,cache:Ft,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),Lt.maxKey=cn(Lt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(bt(ln,function(e){wt||(e=new CustomEvent(hr,{detail:e}),wt=!0,dispatchEvent(e),wt=!1)}),addEventListener(hr,function(e){e=e.detail,wt||Kr(e)}));var $t,wt=!1,wi=function(){};return typeof BroadcastChannel<"u"&&((wi=function(){($t=new BroadcastChannel(hr)).onmessage=function(e){return e.data&&Kr(e.data)}})(),typeof $t.unref=="function"&&$t.unref(),bt(ln,function(e){wt||$t.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!ht.disableBfCache&&e.persisted){at&&console.debug("Dexie: handling persisted pagehide"),$t!=null&&$t.close();for(var t=0,r=Wt;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ht.disableBfCache&&e.persisted&&(at&&console.debug("Dexie: handling persisted pageshow"),wi(),Kr({all:new Xe(-1/0,[[]])}))})),z.rejectionMapper=function(e,t){return!e||e instanceof ve||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ur[e.name]?e:(t=new Ur[e.name](t||e.message,e),"stack"in e&&J(t,"stack",{get:function(){return this.inner.stack}}),t)},Vr(at),o(ht,Object.freeze({__proto__:null,Dexie:ht,liveQuery:bi,Entity:$r,cmp:ke,PropModification:sn,replacePrefix:function(e,t){return new sn({replacePrefix:[e,t]})},add:function(e){return new sn({add:e})},remove:function(e){return new sn({remove:e})},default:ht,RangeSet:Xe,mergeRanges:hn,rangesOverlap:ci}),{default:ht}),ht})})(no);var zo=no.exports;const Ar=Ho(zo),Ci=Symbol.for("Dexie"),$n=globalThis[Ci]||(globalThis[Ci]=Ar);if(Ar.semVer!==$n.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ar.semVer} and ${$n.semVer}`);const{liveQuery:Wa,mergeRanges:Xa,rangesOverlap:Qa,RangeSet:$a,cmp:Ja,Entity:Za,PropModification:es,replacePrefix:ts,add:ns,remove:rs}=$n;class Go extends $n{constructor(){super("MeditationGameDB");ki(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const mn=new Go,vn=[{id:"L1",name:"Level 1",minDuration:Ye.ONE_MINUTE,maxDuration:Ye.FIVE_MINUTES,description:"Sit. Breathe. Notice the mind.",instructions:["Sit comfortably","Focus on the feeling of breath through your nose","Tap when you notice the mind has wandered","Gently return to the breath each time"],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:Ye.TWO_MINUTES,maxDuration:Ye.TEN_MINUTES,description:"Let go of counting and images.",instructions:["Focus on the breath through your nose","Don’t count, visualize, or repeat words","Tap when your mind wanders","Return to the breath, without mental help"],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:Ye.FIVE_MINUTES,maxDuration:Ye.FIFTEEN_MINUTES,description:"Observe thoughts as they arise.",instructions:["Focus on the breath through your nose","Don’t use any counting or mental images","Tap when distracted, then silently observe the thought","Label it if you can (e.g. “planning,” “judging”)","Let it go and return to the breath"],completionTasks:[{id:"two_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]},{id:"L4",name:"Level 4",minDuration:Ye.FIVE_MINUTES,maxDuration:Ye.FIFTEEN_MINUTES,description:"Notice how you react to yourself.",instructions:["Keep observing the breath","No counting or images","Tap when distracted, observe the thought","Then notice how you feel about getting distracted","If there’s frustration or judgment, notice that too — and let it go"],completionTasks:[{id:"two_sessions_under_5_taps",description:"Have 2 sessions in a row with fewer than 5 taps"},{id:"one_min_no_taps_twice",description:"Go 1 minute without a tap in 2 separate sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions","max_duration"]}}]},{id:"L5",name:"Level 5",minDuration:Ye.TEN_MINUTES,maxDuration:Ye.THIRTY_MINUTES,description:"Everything changes. Keep observing.",instructions:["Keep observing breath and distractions","Tap when the mind wanders, observe the thought, notice your reaction","Then remember: everything changes — including this","Let the distraction and your reaction pass","Return to the breath with calm awareness"],completionTasks:[{id:"session_with_3_or_fewer_taps",description:"Have one session with 3 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"two_min_no_taps",description:"Go 2 minutes without tapping"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps","max_duration"]}}]},{id:"L6",name:"Level 6",minDuration:Ye.FIFTEEN_MINUTES,maxDuration:Ye.SIXTY_MINUTES,description:"Sit still. Stay with discomfort.",instructions:["Observe breath, distractions, and reactions as before","Sit still in your chosen posture for the full session","If discomfort arises, don’t shift — just observe it","Notice the discomfort, let it change, and return to breath","Everything will pass"],completionTasks:[{id:"three_min_no_taps",description:"Go 3 minutes without a tap"},{id:"session_with_2_or_fewer_taps",description:"Have a session with 2 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"distractions_early_on",description:"Finish a sit with multiple distractions early on"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions","distractions_early_on","max_duration"]}}]}];function Si(l,n,s){const o=l.slice();return o[9]=n[s],o}function Ii(l){let n,s="Exit Meditation",o,u,c,d;return{c(){n=W("button"),n.textContent=s,this.h()},l(v){n=G(v,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-t4g94n"&&(n.textContent=s),this.h()},h(){N(n,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-filled px-4 py-2")},m(v,P){re(v,n,P),u=!0,c||(d=pt(n,"click",l[4]),c=!0)},p:We,i(v){u||(v&&it(()=>{u&&(o||(o=Be(n,qe,{},!0)),o.run(1))}),u=!0)},o(v){v&&(o||(o=Be(n,qe,{},!1)),o.run(0)),u=!1},d(v){v&&A(n),v&&o&&o.end(),c=!1,d()}}}function Oi(l){let n,s,o=l[9]+"",u,c;return{c(){n=W("p"),s=new Lo(!1),this.h()},l(d){n=G(d,"P",{class:!0});var v=se(n);s=Fo(v,!1),v.forEach(A),this.h()},h(){s.a=null,N(n,"class","text-lg max-w-sm")},m(d,v){re(d,n,v),s.m(o,n),c=!0},p(d,v){(!c||v&4)&&o!==(o=d[9]+"")&&s.p(o)},i(d){c||(d&&it(()=>{c&&(u||(u=Be(n,qe,{},!0)),u.run(1))}),c=!0)},o(d){d&&(u||(u=Be(n,qe,{},!1)),u.run(0)),c=!1},d(d){d&&A(n),d&&u&&u.end()}}}function Pi(l){let n,s="Start meditation countdown",o,u,c,d,v=Mr[l[1]]+"",P,g,k,I;return{c(){n=W("button"),n.textContent=s,u=_e(),c=W("i"),d=ae("Meditating for "),P=ae(v),this.h()},l(y){n=G(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-71gbpm"&&(n.textContent=s),u=ye(y),c=G(y,"I",{class:!0});var M=se(c);d=oe(M,"Meditating for "),P=oe(M,v),M.forEach(A),this.h()},h(){N(n,"class","btn variant-filled px-4 py-2 mt-4"),N(c,"class","text-sm text-gray-500")},m(y,M){re(y,n,M),re(y,u,M),re(y,c,M),R(c,d),R(c,P),g=!0,k||(I=pt(n,"click",function(){Uo(l[0])&&l[0].apply(this,arguments)}),k=!0)},p(y,M){l=y,(!g||M&2)&&v!==(v=Mr[l[1]]+"")&&Ne(P,v)},i(y){g||(y&&it(()=>{g&&(o||(o=Be(n,qe,{},!0)),o.run(1))}),g=!0)},o(y){y&&(o||(o=Be(n,qe,{},!1)),o.run(0)),g=!1},d(y){y&&(A(n),A(u),A(c)),y&&o&&o.end(),k=!1,I()}}}function Wo(l){let n,s,o,u,c=l[2]>=l[3].length&&Ii(l),d=et(l[3].slice(0,l[2])),v=[];for(let k=0;k<d.length;k+=1)v[k]=Oi(Si(l,d,k));const P=k=>je(v[k],1,1,()=>{v[k]=null});let g=l[2]>=l[3].length&&Pi(l);return{c(){n=W("div"),c&&c.c(),s=_e();for(let k=0;k<v.length;k+=1)v[k].c();o=_e(),g&&g.c(),this.h()},l(k){n=G(k,"DIV",{class:!0});var I=se(n);c&&c.l(I),s=ye(I);for(let y=0;y<v.length;y+=1)v[y].l(I);o=ye(I),g&&g.l(I),I.forEach(A),this.h()},h(){N(n,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(k,I){re(k,n,I),c&&c.m(n,null),R(n,s);for(let y=0;y<v.length;y+=1)v[y]&&v[y].m(n,null);R(n,o),g&&g.m(n,null),u=!0},p(k,[I]){if(k[2]>=k[3].length?c?(c.p(k,I),I&4&&Te(c,1)):(c=Ii(k),c.c(),Te(c,1),c.m(n,s)):c&&(kt(),je(c,1,1,()=>{c=null}),xt()),I&12){d=et(k[3].slice(0,k[2]));let y;for(y=0;y<d.length;y+=1){const M=Si(k,d,y);v[y]?(v[y].p(M,I),Te(v[y],1)):(v[y]=Oi(M),v[y].c(),Te(v[y],1),v[y].m(n,o))}for(kt(),y=d.length;y<v.length;y+=1)P(y);xt()}k[2]>=k[3].length?g?(g.p(k,I),I&4&&Te(g,1)):(g=Pi(k),g.c(),Te(g,1),g.m(n,null)):g&&(kt(),je(g,1,1,()=>{g=null}),xt())},i(k){if(!u){Te(c);for(let I=0;I<d.length;I+=1)Te(v[I]);Te(g),u=!0}},o(k){je(c),v=v.filter(Boolean);for(let I=0;I<v.length;I+=1)je(v[I]);je(g),u=!1},d(k){k&&A(n),c&&c.d(),Yt(v,k),g&&g.d()}}}function Xo(l,n,s){let{nextStep:o}=n,{closeModal:u}=n,{duration:c}=n,{levelId:d="L1"}=n;const v=vn.find(y=>y.id===d),P=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],g=(v==null?void 0:v.instructions)||P;let k=0;Br(()=>{ct.capture("instructions_viewed",{level:d});const y=setInterval(()=>{k<g.length+1?s(2,k+=1):clearInterval(y)},1e3)});const I=()=>{ct.capture("instructions_exit",{instructions_viewed:k,level:d}),u()};return l.$$set=y=>{"nextStep"in y&&s(0,o=y.nextStep),"closeModal"in y&&s(5,u=y.closeModal),"duration"in y&&s(1,c=y.duration),"levelId"in y&&s(6,d=y.levelId)},[o,c,k,g,I,u,d]}class Qo extends Et{constructor(n){super(),Ct(this,n,Xo,Wo,Tt,{nextStep:0,closeModal:5,duration:1,levelId:6})}}const $o=l=>{const n=l%60;return(l/60>1?`${Math.floor(l/60)}:`:"")+`${n<10?"0":""}${n}`};function Jt(l){const n=l/60;return Number.isInteger(n)?n:Math.round(n*10)/10}function Jo(l){let n,s,o,u,c,d;return{c(){n=Hn("svg"),s=Hn("circle"),o=Hn("circle"),c=Hn("text"),d=ae(l[1]),this.h()},l(v){n=Yn(v,"svg",{class:!0,viewBox:!0});var P=se(n);s=Yn(P,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),se(s).forEach(A),o=Yn(P,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),se(o).forEach(A),c=Yn(P,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var g=se(c);d=oe(g,l[1]),g.forEach(A),P.forEach(A),this.h()},h(){N(s,"cx","50"),N(s,"cy","50"),N(s,"r","40"),N(s,"stroke","gray"),N(s,"stroke-width","5"),N(s,"fill","none"),N(o,"cx","50"),N(o,"cy","50"),N(o,"r","40"),N(o,"stroke","blue"),N(o,"stroke-width","5"),N(o,"fill","none"),N(o,"stroke-dasharray","251.2"),N(o,"stroke-dashoffset",u=251.2*l[0]),N(o,"transform","rotate(-90 50 50)"),N(c,"x","50"),N(c,"y","55"),N(c,"font-size","14"),N(c,"text-anchor","middle"),N(c,"fill","black"),N(n,"class","w-32 h-32"),N(n,"viewBox","0 0 100 100")},m(v,P){re(v,n,P),R(n,s),R(n,o),R(n,c),R(c,d)},p(v,[P]){P&1&&u!==(u=251.2*v[0])&&N(o,"stroke-dashoffset",u),P&2&&Ne(d,v[1])},i:We,o:We,d(v){v&&A(n)}}}const Zo="/sounds/gong.mp3";function ea(l,n,s){let o,u,{duration:c}=n,{startTimestamp:d}=n;const v=eo();let P=Wn(c),g=null,k,I=null;const y=Ti(P,Q=>$o(Q));Xn(l,y,Q=>s(1,u=Q));const M=Ti(P,Q=>Q/c);Xn(l,M,Q=>s(0,o=Q));const J=async()=>{if(!(!window.audioContext||!I))try{const Q=window.audioContext.createBufferSource();Q.buffer=I,Q.connect(window.audioContext.destination),Q.start(0)}catch(Q){console.error("Error playing sound:",Q)}},ce=async()=>{if(window.audioContext)try{const Y=await(await fetch(Zo)).arrayBuffer();I=await window.audioContext.decodeAudioData(Y)}catch(Q){console.error("Error loading sound:",Q)}},le=()=>{clearInterval(k),J(),v("complete")},H=async Q=>{try{if(!("wakeLock"in navigator))return;Q?g=await navigator.wakeLock.request("screen"):g&&(await g.release(),g=null)}catch(Y){console.error(`Wake Lock ${Q?"request":"release"} failed:`,Y)}};return Br(()=>{s(4,d=Date.now()),k=setInterval(()=>{P.update(Q=>Q>0?Q-1:(le(),0))},1e3),ce(),H(!0)}),Vo(()=>{clearInterval(k),H(!1)}),l.$$set=Q=>{"duration"in Q&&s(5,c=Q.duration),"startTimestamp"in Q&&s(4,d=Q.startTimestamp)},[o,u,y,M,d,c]}class ro extends Et{constructor(n){super(),Ct(this,n,ea,Jo,Tt,{duration:5,startTimestamp:4})}}function ta(l){let n,s,o,u="Your meditation starts in:",c,d,v,P,g,k="Exit Meditation",I,y,M,J;function ce(H){l[6](H)}let le={duration:na};return l[0]!==void 0&&(le.startTimestamp=l[0]),d=new ro({props:le}),qr.push(()=>Lr(d,"startTimestamp",ce)),d.$on("complete",l[1]),{c(){n=W("div"),s=W("div"),o=W("p"),o.textContent=u,c=_e(),Pt(d.$$.fragment),P=_e(),g=W("button"),g.textContent=k,this.h()},l(H){n=G(H,"DIV",{class:!0});var Q=se(n);s=G(Q,"DIV",{class:!0});var Y=se(s);o=G(Y,"P",{class:!0,"data-svelte-h":!0}),Ue(o)!=="svelte-1tp8zka"&&(o.textContent=u),c=ye(Y),Ot(d.$$.fragment,Y),Y.forEach(A),P=ye(Q),g=G(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(g)!=="svelte-hy6wnc"&&(g.textContent=k),Q.forEach(A),this.h()},h(){N(o,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto"),N(g,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(n,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(H,Q){re(H,n,Q),R(n,s),R(s,o),R(s,c),It(d,s,null),R(n,P),R(n,g),y=!0,M||(J=pt(g,"click",l[2]),M=!0)},p(H,[Q]){const Y={};!v&&Q&1&&(v=!0,Y.startTimestamp=H[0],Fr(()=>v=!1)),d.$set(Y)},i(H){y||(Te(d.$$.fragment,H),H&&it(()=>{y&&(I||(I=Be(g,qe,{},!0)),I.run(1))}),y=!0)},o(H){je(d.$$.fragment,H),H&&(I||(I=Be(g,qe,{},!1)),I.run(0)),y=!1},d(H){H&&A(n),St(d),H&&I&&I.end(),M=!1,J()}}}const na=10;function ra(l,n,s){let{nextStep:o}=n,{closeModal:u}=n,{levelId:c="L1"}=n,d=0;ct.capture("countdown_started",{level:c});const v=()=>{ct.capture("countdown_complete",{level:c}),o()},P=()=>{ct.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:c}),u()};function g(k){d=k,s(0,d)}return l.$$set=k=>{"nextStep"in k&&s(3,o=k.nextStep),"closeModal"in k&&s(4,u=k.closeModal),"levelId"in k&&s(5,c=k.levelId)},[d,v,P,o,u,c,g]}class ia extends Et{constructor(n){super(),Ct(this,n,ra,ta,Tt,{nextStep:3,closeModal:4,levelId:5})}}function oa(l){let n,s;return{c(){n=W("br"),s=W("br")},l(o){n=G(o,"BR",{}),s=G(o,"BR",{})},m(o,u){re(o,n,u),re(o,s,u)},p:We,d(o){o&&(A(n),A(s))}}}function aa(l){let n,s,o;return{c(){n=W("i"),s=ae(l[2]),o=ae(" distraction"),this.h()},l(u){n=G(u,"I",{class:!0});var c=se(n);s=oe(c,l[2]),o=oe(c," distraction"),c.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(u,c){re(u,n,c),R(n,s),R(n,o)},p(u,c){c&4&&Ne(s,u[2])},d(u){u&&A(n)}}}function sa(l){let n,s,o;return{c(){n=W("i"),s=ae(l[2]),o=ae(" distractions"),this.h()},l(u){n=G(u,"I",{class:!0});var c=se(n);s=oe(c,l[2]),o=oe(c," distractions"),c.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(u,c){re(u,n,c),R(n,s),R(n,o)},p(u,c){c&4&&Ne(s,u[2])},d(u){u&&A(n)}}}function Di(l){let n;return{c(){n=W("div"),this.h()},l(s){n=G(s,"DIV",{class:!0,style:!0}),se(n).forEach(A),this.h()},h(){N(n,"class","ripple svelte-1wv6db6"),zn(n,"top",l[3].y+"px"),zn(n,"left",l[3].x+"px")},m(s,o){re(s,n,o)},p(s,o){o&8&&zn(n,"top",s[3].y+"px"),o&8&&zn(n,"left",s[3].x+"px")},d(s){s&&A(n)}}}function ua(l){let n,s,o,u,c,d,v="Tap anywhere on the screen to record your distractions",P,g,k,I,y,M="Exit Meditation",J,ce,le,H;function Q(te){l[11](te)}let Y={duration:l[0]};l[1]!==void 0&&(Y.startTimestamp=l[1]),o=new ro({props:Y}),qr.push(()=>Lr(o,"startTimestamp",Q)),o.$on("complete",l[8]);function $(te,Oe){return te[2]>1||te[2]==0?sa:te[2]==1?aa:oa}let pe=$(l),ie=pe(l),Z=l[3]&&Di(l);return{c(){n=W("div"),s=W("div"),Pt(o.$$.fragment),c=_e(),d=W("p"),d.textContent=v,P=_e(),ie.c(),g=_e(),k=W("button"),Z&&Z.c(),I=_e(),y=W("button"),y.textContent=M,this.h()},l(te){n=G(te,"DIV",{class:!0});var Oe=se(n);s=G(Oe,"DIV",{class:!0});var Se=se(s);Ot(o.$$.fragment,Se),c=ye(Se),d=G(Se,"P",{class:!0,"data-svelte-h":!0}),Ue(d)!=="svelte-1uyhl39"&&(d.textContent=v),P=ye(Se),ie.l(Se),Se.forEach(A),g=ye(Oe),k=G(Oe,"BUTTON",{class:!0});var Ee=se(k);Z&&Z.l(Ee),Ee.forEach(A),I=ye(Oe),y=G(Oe,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(y)!=="svelte-hy6wnc"&&(y.textContent=M),Oe.forEach(A),this.h()},h(){N(d,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto p-6"),N(k,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),N(y,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(n,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(te,Oe){re(te,n,Oe),R(n,s),It(o,s,null),R(s,c),R(s,d),R(s,P),ie.m(s,null),R(n,g),R(n,k),Z&&Z.m(k,null),R(n,I),R(n,y),ce=!0,le||(H=[pt(k,"click",l[6]),pt(y,"click",l[7])],le=!0)},p(te,[Oe]){const Se={};Oe&1&&(Se.duration=te[0]),!u&&Oe&2&&(u=!0,Se.startTimestamp=te[1],Fr(()=>u=!1)),o.$set(Se),pe===(pe=$(te))&&ie?ie.p(te,Oe):(ie.d(1),ie=pe(te),ie&&(ie.c(),ie.m(s,null))),te[3]?Z?Z.p(te,Oe):(Z=Di(te),Z.c(),Z.m(k,null)):Z&&(Z.d(1),Z=null)},i(te){ce||(Te(o.$$.fragment,te),te&&it(()=>{ce&&(J||(J=Be(y,qe,{},!0)),J.run(1))}),ce=!0)},o(te){je(o.$$.fragment,te),te&&(J||(J=Be(y,qe,{},!1)),J.run(0)),ce=!1},d(te){te&&A(n),St(o),ie.d(),Z&&Z.d(),te&&J&&J.end(),le=!1,to(H)}}}function la(l,n,s){let o,u,{nextStep:c}=n,{duration:d}=n,{levelId:v="L1"}=n;const P=eo();let g=0;const k=Wn(0);Xn(l,k,H=>s(2,o=H));const I=Wn([]),y=Wn(null);Xn(l,y,H=>s(3,u=H));const M=H=>{const Q=(Date.now()-g)/1e3;k.update(Z=>Z+1),I.update(Z=>[...Z,Q]),console.log(`Click ${Vt(k)} recorded at ${Q} seconds`),ct.capture("game_tap",{timestamp:Q,total_taps:Vt(k),level:v,button:"distracted"});const{clientX:Y,clientY:$,currentTarget:pe}=H,ie=pe.getBoundingClientRect();y.set({x:Y-ie.left,y:$-ie.top}),setTimeout(()=>y.set(null),600)},J=()=>{const H=(Date.now()-g)/1e3;ct.capture("meditation_exit",{duration_meditated:H,total_taps:Vt(I).length,level:v}),P("complete",{clickTimestamps:Vt(I),durationMeditated:H,completed:d-H<5}),c()},ce=()=>{console.log("Meditation complete! Click data:",Vt(I)),ct.capture("meditation_completed",{duration:d,total_taps:Vt(I).length,level:v}),P("complete",{clickTimestamps:Vt(I),durationMeditated:d,completed:!0}),c()};function le(H){g=H,s(1,g)}return l.$$set=H=>{"nextStep"in H&&s(9,c=H.nextStep),"duration"in H&&s(0,d=H.duration),"levelId"in H&&s(10,v=H.levelId)},[d,g,o,u,k,y,M,J,ce,c,v,le]}class ca extends Et{constructor(n){super(),Ct(this,n,la,ua,Tt,{nextStep:9,duration:0,levelId:10})}}function fa(l){const n=Math.floor(l.durationMeditated/60),s=l.clickTimestamps.length,o=l.newStarRating-l.previousStarRating,u="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share";return o>0?`Major win! 🧘‍♂️  I just earned a new ⭐ in The Meditation Game!
I did a ${n}‑min meditation with only ${s} distractions.
I'm at ${"⭐".repeat(l.newStarRating)} on this level!
Learn and practice meditation here: ${u}`:l.isNewPersonalBest?`Mini‑win in The Meditation Game: my new personal best!
${n}‑min sit • only ${s} ${s===1?"mind-wander":"mind-wanders"} • ${"⭐".repeat(l.newStarRating)} on this level
Learn and practice meditation here: ${u}`:`Sharing todays practice in The Meditation Game.
I did a ${n}‑min meditation with only ${s} distractions.
I'm at ${"⭐".repeat(l.newStarRating)} on this level.
Learn and practice meditation here: ${u}`}function da(l){return l.newStarRating-l.previousStarRating>0?"A":l.isNewPersonalBest?"B":"C"}function io(l){return l.filter(n=>n.completed).sort((n,s)=>s.duration!==n.duration?s.duration-n.duration:n.tapCount!==s.tapCount?n.tapCount-s.tapCount:s.timestamp-n.timestamp)[0]??null}function ha(l,n,s){const{scope:o,requirement:u}=l;return o==="cumulative"?ji(u,n):s.some(c=>ji(u,c))}function ji(l,n){if(l.type==="minTasks"){const{count:s,from:o}=l;return o==="all"?n.size>=s:o.filter(c=>n.has(c)).length>=s}return l.type==="specificTasks"?l.taskIds.every(s=>n.has(s)):!1}function Nr(l,n,s){const o=[...l].sort((u,c)=>c.stars-u.stars);for(const u of o)if(ha(u,n,s))return u.stars;return 0}function pa(l){if(l.length<2)return 0;const n=[...l].sort((o,u)=>o.timestamp-u.timestamp);let s=0;for(let o=1;o<n.length;o++){const u=n[o-1],c=n[o],d=u.tapCount/Math.max(u.duration,1),v=c.tapCount/Math.max(c.duration,1);(v<d||Math.abs(v-d)<=.005&&c.duration>u.duration)&&s++}return s}function Gn(l){if(!l.tapTimestamps||l.tapTimestamps.length===0)return l.duration/60;const n=[];n.push(l.tapTimestamps[0]);for(let u=1;u<l.tapTimestamps.length;u++)n.push(l.tapTimestamps[u]-l.tapTimestamps[u-1]);const s=l.tapTimestamps[l.tapTimestamps.length-1];return n.push(l.duration-s),Math.max(...n)/60}const Ki=(l,n)=>l.filter(n).length,pn=(l,n)=>l.some(n),lt={tap_once:([l])=>({completed:(l==null?void 0:l.tapCount)>=1,info:""}),no_early_exit:([l])=>({completed:(l==null?void 0:l.completed)===!0,info:""}),session_under_5_taps:([l])=>({completed:(l==null?void 0:l.tapCount)<=5,info:""}),session_with_2_or_fewer_taps:l=>({completed:pn(l,n=>n.tapCount<=2),info:""}),session_with_3_or_fewer_taps:l=>({completed:pn(l,n=>n.tapCount<=3),info:""}),distractions_early_on:([l])=>{var n;return{completed:((n=l==null?void 0:l.tapTimestamps)==null?void 0:n.filter(s=>s<=60).length)>=2,info:""}},complete_2_sessions:l=>({completed:l.length>=2,info:l.length===0||l.length>=2?"":"(1/2 complete)"}),complete_3_sessions:l=>({completed:l.length>=3,info:l.length===0||l.length>=3?"":`(${l.length}/3 complete)`}),two_sessions_under_5_taps:l=>{let n=0;for(let s=l.length-1;s>=0;s--)if(l[s].tapCount<5){if(n++,n===2)break}else n=0;return{completed:n===2,info:l.length===0||n===2?"":`(${Math.min(n,1)}/2 complete)`}},two_sessions_under_8_taps:l=>{const n=Ki(l,s=>s.tapCount<=8);return{completed:n>=2,info:l.length===0||n>=2?"":`(${n}/2 complete)`}},one_min_no_taps:l=>({completed:pn(l,n=>Gn(n)>=60),info:""}),one_min_no_taps_twice:l=>{const n=Ki(l,s=>Gn(s)>=60);return{completed:n>=2,info:l.length===0||n>=2?"":`(${n}/2 complete)`}},two_min_no_taps:l=>({completed:pn(l,n=>Gn(n)>=120),info:""}),three_min_no_taps:l=>({completed:pn(l,n=>Gn(n)>=180),info:""}),improve_tap_count_2_sessions:l=>{const n=pa(l);return{completed:n>=2,info:l.length===0||n>=2?"":`(${n}/2 complete)`}},max_duration:(l,n)=>({completed:l.some(s=>s.duration>=n.maxDuration),info:""})};async function Jn(l){const n=vn.find(u=>u.id===l);if(!n)return{};const s=await mn.sessions.where("levelId").equals(l).toArray(),o={};for(const u of n.completionTasks){const c=lt[u.id];if(!c){console.warn(`Missing evaluator for task '${u.id}' in level '${l}'`),o[u.id]={completed:!1};continue}o[u.id]={...u,...c(s,n)}}return o}async function ma(){var n;const l=[];for(let s=0;s<vn.length;s++){const o=vn[s],u=await mn.sessions.where("levelId").equals(o.id).toArray(),c=s===0||(((n=l[s-1])==null?void 0:n.starRating)??0)>1;let d=null,v,P=null;if(c){d=await Jn(o.id);const g=new Set(Object.entries(d).filter(([I,y])=>y.completed).map(([I])=>I)),k=u.map(I=>new Set(o.completionTasks.filter(y=>{var M;return(M=lt[y.id])==null?void 0:M.call(lt,[I],o).completed}).map(y=>y.id)));v=Nr(o.starRules,g,k),P=io(u)}l.push({level:o,isUnlocked:c,taskCompletion:d,starRating:v,bestSession:P})}return l}function Ri(l,n,s){const o=l.slice();return o[8]=n[s][0],o[9]=n[s][1],o}function Mi(l,n,s){const o=l.slice();return o[8]=n[s],o[13]=s,o}function Ai(l){let n;function s(c,d){return c[0].newStarRating===3?ya:va}let o=s(l),u=o(l);return{c(){n=W("p"),u.c(),this.h()},l(c){n=G(c,"P",{class:!0});var d=se(n);u.l(d),d.forEach(A),this.h()},h(){N(n,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(c,d){re(c,n,d),u.m(n,null)},p(c,d){o===(o=s(c))&&u?u.p(c,d):(u.d(1),u=o(c),u&&(u.c(),u.m(n,null)))},d(c){c&&A(n),u.d()}}}function va(l){let n,s=l[0].newStarRating-l[0].previousStarRating+"",o,u;return{c(){n=ae("You earned +"),o=ae(s),u=ae(" ⭐ — keep going!")},l(c){n=oe(c,"You earned +"),o=oe(c,s),u=oe(c," ⭐ — keep going!")},m(c,d){re(c,n,d),re(c,o,d),re(c,u,d)},p(c,d){d&1&&s!==(s=c[0].newStarRating-c[0].previousStarRating+"")&&Ne(o,s)},d(c){c&&(A(n),A(o),A(u))}}}function ya(l){let n;return{c(){n=ae("Mastered this level! ✨")},l(s){n=oe(s,"Mastered this level! ✨")},m(s,o){re(s,n,o)},p:We,d(s){s&&A(n)}}}function Ni(l){let n,s=l[13]<l[0].newStarRating?"⭐":"☆",o,u;return{c(){n=W("span"),o=ae(s),u=_e(),this.h()},l(c){n=G(c,"SPAN",{class:!0});var d=se(n);o=oe(d,s),u=ye(d),d.forEach(A),this.h()},h(){N(n,"class","text-xl")},m(c,d){re(c,n,d),R(n,o),R(n,u)},p(c,d){d&1&&s!==(s=c[13]<c[0].newStarRating?"⭐":"☆")&&Ne(o,s)},d(c){c&&A(n)}}}function _a(l){let n,s="You completed your meditation distraction-free!";return{c(){n=W("p"),n.textContent=s,this.h()},l(o){n=G(o,"P",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-j87uf1"&&(n.textContent=s),this.h()},h(){N(n,"class","text-lg mt-4")},m(o,u){re(o,n,u)},p:We,d(o){o&&A(n)}}}function ga(l){let n,s,o=l[4](l[0].durationMeditated)+"",u,c,d,v,P=l[2]===1?"distraction":"distractions",g,k,I,y,M,J,ce,le=Number(l[3])===1?"distraction":"distractions",H,Q;return{c(){n=W("p"),s=ae("You meditated for "),u=ae(o),c=ae(" and recorded "),d=ae(l[2]),v=_e(),g=ae(P),k=ae("."),I=_e(),y=W("p"),M=ae("That's about "),J=ae(l[3]),ce=_e(),H=ae(le),Q=ae(" per minute."),this.h()},l(Y){n=G(Y,"P",{class:!0});var $=se(n);s=oe($,"You meditated for "),u=oe($,o),c=oe($," and recorded "),d=oe($,l[2]),v=ye($),g=oe($,P),k=oe($,"."),$.forEach(A),I=ye(Y),y=G(Y,"P",{class:!0});var pe=se(y);M=oe(pe,"That's about "),J=oe(pe,l[3]),ce=ye(pe),H=oe(pe,le),Q=oe(pe," per minute."),pe.forEach(A),this.h()},h(){N(n,"class","text-lg mt-4"),N(y,"class","text-lg mt-2")},m(Y,$){re(Y,n,$),R(n,s),R(n,u),R(n,c),R(n,d),R(n,v),R(n,g),R(n,k),re(Y,I,$),re(Y,y,$),R(y,M),R(y,J),R(y,ce),R(y,H),R(y,Q)},p(Y,$){$&1&&o!==(o=Y[4](Y[0].durationMeditated)+"")&&Ne(u,o)},d(Y){Y&&(A(n),A(I),A(y))}}}function ba(l){let n,s,o=l[0].personalBest.tapCount+"",u,c,d=Jt(l[0].personalBest.duration)+"",v,P;return{c(){n=W("p"),s=ae("Best so far: "),u=ae(o),c=ae(" taps · "),v=ae(d),P=ae(" min."),this.h()},l(g){n=G(g,"P",{class:!0});var k=se(n);s=oe(k,"Best so far: "),u=oe(k,o),c=oe(k," taps · "),v=oe(k,d),P=oe(k," min."),k.forEach(A),this.h()},h(){N(n,"class","mt-4 text-muted-foreground")},m(g,k){re(g,n,k),R(n,s),R(n,u),R(n,c),R(n,v),R(n,P)},p(g,k){k&1&&o!==(o=g[0].personalBest.tapCount+"")&&Ne(u,o),k&1&&d!==(d=Jt(g[0].personalBest.duration)+"")&&Ne(v,d)},d(g){g&&A(n)}}}function wa(l){let n,s,o=l[0].personalBest.tapCount+"",u,c,d=Jt(l[0].personalBest.duration)+"",v,P;return{c(){n=W("p"),s=ae("New personal best 🎉 — "),u=ae(o),c=ae(" taps over "),v=ae(d),P=ae(" min."),this.h()},l(g){n=G(g,"P",{class:!0});var k=se(n);s=oe(k,"New personal best 🎉 — "),u=oe(k,o),c=oe(k," taps over "),v=oe(k,d),P=oe(k," min."),k.forEach(A),this.h()},h(){N(n,"class","mt-4 text-green-600 font-medium animate-fade-in svelte-tnqxsb")},m(g,k){re(g,n,k),R(n,s),R(n,u),R(n,c),R(n,v),R(n,P)},p(g,k){k&1&&o!==(o=g[0].personalBest.tapCount+"")&&Ne(u,o),k&1&&d!==(d=Jt(g[0].personalBest.duration)+"")&&Ne(v,d)},d(g){g&&A(n)}}}function Bi(l){let n,s=et(Object.entries(l[1])),o=[];for(let u=0;u<s.length;u+=1)o[u]=qi(Ri(l,s,u));return{c(){n=W("ul");for(let u=0;u<o.length;u+=1)o[u].c();this.h()},l(u){n=G(u,"UL",{class:!0});var c=se(n);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(A),this.h()},h(){N(n,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto")},m(u,c){re(u,n,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(u,c){if(c&2){s=et(Object.entries(u[1]));let d;for(d=0;d<s.length;d+=1){const v=Ri(u,s,d);o[d]?o[d].p(v,c):(o[d]=qi(v),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(u){u&&A(n),Yt(o,u)}}}function qi(l){let n,s,o=l[9].completed?"✅":"🔲",u,c,d=l[9].description+"",v,P,g=l[9].info+"",k,I;return{c(){n=W("li"),s=W("span"),u=ae(o),c=_e(),v=ae(d),P=_e(),k=ae(g),I=_e(),this.h()},l(y){n=G(y,"LI",{class:!0});var M=se(n);s=G(M,"SPAN",{class:!0});var J=se(s);u=oe(J,o),c=ye(J),v=oe(J,d),P=ye(J),k=oe(J,g),J.forEach(A),I=ye(M),M.forEach(A),this.h()},h(){N(s,"class","mr-2"),N(n,"class","flex items-center")},m(y,M){re(y,n,M),R(n,s),R(s,u),R(s,c),R(s,v),R(s,P),R(s,k),R(n,I)},p(y,M){M&2&&o!==(o=y[9].completed?"✅":"🔲")&&Ne(u,o),M&2&&d!==(d=y[9].description+"")&&Ne(v,d),M&2&&g!==(g=y[9].info+"")&&Ne(k,g)},d(y){y&&A(n)}}}function Fi(l){let n,s,o=l[0].newlyCompletedTasks.length+"",u,c,d=l[0].newlyCompletedTasks.length===1?"":"s",v,P;return{c(){n=W("p"),s=ae("Nice! You just completed "),u=ae(o),c=ae(" task"),v=ae(d),P=ae("."),this.h()},l(g){n=G(g,"P",{class:!0});var k=se(n);s=oe(k,"Nice! You just completed "),u=oe(k,o),c=oe(k," task"),v=oe(k,d),P=oe(k,"."),k.forEach(A),this.h()},h(){N(n,"class","mt-2 text-sm text-accent-foreground")},m(g,k){re(g,n,k),R(n,s),R(n,u),R(n,c),R(n,v),R(n,P)},p(g,k){k&1&&o!==(o=g[0].newlyCompletedTasks.length+"")&&Ne(u,o),k&1&&d!==(d=g[0].newlyCompletedTasks.length===1?"":"s")&&Ne(v,d)},d(g){g&&A(n)}}}function ka(l){let n,s,o="Great practice!",u,c,d,v,P,g,k,I="Level tasks",y,M,J,ce,le,H="Share",Q,Y,$,pe="Exit",ie,Z,te=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p> <p class="mt-2">This app was made by Arjun, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn ↗</a></p>`,Oe,Se,Ee=l[0].newStarRating>l[0].previousStarRating&&Ai(l),fe=et(Array(3)),ue=[];for(let me=0;me<fe.length;me+=1)ue[me]=Ni(Mi(l,fe,me));function He(me,ve){return me[0].clickTimestamps.length>0?ga:_a}let Je=He(l),ge=Je(l);function Ke(me,ve){if(me[0].isNewPersonalBest&&me[0].personalBest)return wa;if(me[0].personalBest)return ba}let Re=Ke(l),Me=Re&&Re(l),Ie=l[1]&&Bi(l),Ve=l[0].newlyCompletedTasks.length>0&&Fi(l);return{c(){n=W("div"),s=W("h2"),s.textContent=o,u=_e(),Ee&&Ee.c(),c=_e(),d=W("div");for(let me=0;me<ue.length;me+=1)ue[me].c();v=_e(),ge.c(),P=_e(),Me&&Me.c(),g=_e(),k=W("h3"),k.textContent=I,y=_e(),Ie&&Ie.c(),M=_e(),Ve&&Ve.c(),J=_e(),ce=W("div"),le=W("button"),le.textContent=H,Q=_e(),Y=W("div"),$=W("button"),$.textContent=pe,ie=_e(),Z=W("div"),Z.innerHTML=te,this.h()},l(me){n=G(me,"DIV",{class:!0});var ve=se(n);s=G(ve,"H2",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-1untj5h"&&(s.textContent=o),u=ye(ve),Ee&&Ee.l(ve),c=ye(ve),d=G(ve,"DIV",{class:!0});var Ae=se(d);for(let Dt=0;Dt<ue.length;Dt+=1)ue[Dt].l(Ae);Ae.forEach(A),v=ye(ve),ge.l(ve),P=ye(ve),Me&&Me.l(ve),g=ye(ve),k=G(ve,"H3",{class:!0,"data-svelte-h":!0}),Ue(k)!=="svelte-8ylw1a"&&(k.textContent=I),y=ye(ve),Ie&&Ie.l(ve),M=ye(ve),Ve&&Ve.l(ve),J=ye(ve),ce=G(ve,"DIV",{class:!0});var ot=se(ce);le=G(ot,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(le)!=="svelte-1wlydhx"&&(le.textContent=H),ot.forEach(A),Q=ye(ve),Y=G(ve,"DIV",{class:!0});var ft=se(Y);$=G(ft,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue($)!=="svelte-1t5v3tb"&&($.textContent=pe),ft.forEach(A),ie=ye(ve),Z=G(ve,"DIV",{class:!0,"data-svelte-h":!0}),Ue(Z)!=="svelte-k92ud0"&&(Z.innerHTML=te),ve.forEach(A),this.h()},h(){N(s,"class","text-2xl font-bold"),N(d,"class","mt-2 flex items-center space-x-1"),N(k,"class","mt-6 font-semibold"),N(le,"class","btn variant-filled px-4 py-2"),N(ce,"class","mt-6 flex space-x-4"),N($,"class","btn variant-outlined px-4 py-2"),N(Y,"class","mt-6 flex space-x-4"),N(Z,"class","absolute bottom-6 text-center text-sm text-gray-500"),N(n,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(me,ve){re(me,n,ve),R(n,s),R(n,u),Ee&&Ee.m(n,null),R(n,c),R(n,d);for(let Ae=0;Ae<ue.length;Ae+=1)ue[Ae]&&ue[Ae].m(d,null);R(n,v),ge.m(n,null),R(n,P),Me&&Me.m(n,null),R(n,g),R(n,k),R(n,y),Ie&&Ie.m(n,null),R(n,M),Ve&&Ve.m(n,null),R(n,J),R(n,ce),R(ce,le),R(n,Q),R(n,Y),R(Y,$),R(n,ie),R(n,Z),Oe||(Se=[pt(le,"click",l[5]),pt($,"click",l[6])],Oe=!0)},p(me,[ve]){if(me[0].newStarRating>me[0].previousStarRating?Ee?Ee.p(me,ve):(Ee=Ai(me),Ee.c(),Ee.m(n,c)):Ee&&(Ee.d(1),Ee=null),ve&1){fe=et(Array(3));let Ae;for(Ae=0;Ae<fe.length;Ae+=1){const ot=Mi(me,fe,Ae);ue[Ae]?ue[Ae].p(ot,ve):(ue[Ae]=Ni(ot),ue[Ae].c(),ue[Ae].m(d,null))}for(;Ae<ue.length;Ae+=1)ue[Ae].d(1);ue.length=fe.length}Je===(Je=He(me))&&ge?ge.p(me,ve):(ge.d(1),ge=Je(me),ge&&(ge.c(),ge.m(n,P))),Re===(Re=Ke(me))&&Me?Me.p(me,ve):(Me&&Me.d(1),Me=Re&&Re(me),Me&&(Me.c(),Me.m(n,g))),me[1]?Ie?Ie.p(me,ve):(Ie=Bi(me),Ie.c(),Ie.m(n,M)):Ie&&(Ie.d(1),Ie=null),me[0].newlyCompletedTasks.length>0?Ve?Ve.p(me,ve):(Ve=Fi(me),Ve.c(),Ve.m(n,J)):Ve&&(Ve.d(1),Ve=null)},i:We,o:We,d(me){me&&A(n),Ee&&Ee.d(),Yt(ue,me),ge.d(),Me&&Me.d(),Ie&&Ie.d(),Ve&&Ve.d(),Oe=!1,to(Se)}}}function xa(l,n,s){let{closeModal:o}=n,{meditationResults:u}=n;const c=u.clickTimestamps.length,d=c>0?(c/(u.durationMeditated/60)).toFixed(1):"0";let v={};Br(async()=>{u!=null&&u.levelId&&s(1,v=await Jn(u.levelId))});const P=I=>{const y=Math.floor(I/60),M=I%60;return y===0?M+" second"+(M===1?"":"s"):y+" minute"+(y===1?"":"s")+(M>0?" and "+M+" second"+(M===1?"":"s"):"")},g=()=>{if(navigator.share){const I=u.newStarRating-u.previousStarRating,y=da(u);ct.capture("results_shared",{total_taps:c,distractionRate:d,level:u.levelId,stars_gained:I,tasks_completed:u.newlyCompletedTasks.length,template_used:y,personal_best:u.isNewPersonalBest});const M=fa(u);navigator.share({text:M}).catch(J=>console.error("Sharing failed",J))}else console.log("Web Share API not supported")},k=()=>{ct.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:u.newStarRating-u.previousStarRating,tasks_completed:u.newlyCompletedTasks.length}),o()};return l.$$set=I=>{"closeModal"in I&&s(7,o=I.closeModal),"meditationResults"in I&&s(0,u=I.meditationResults)},[u,v,c,d,P,g,k,o]}class Ta extends Et{constructor(n){super(),Ct(this,n,xa,ka,Tt,{closeModal:7,meditationResults:0})}}function Li(l){let n,s,o,u,c,d,v;const P=[Ia,Sa,Ca,Ea],g=[];function k(I,y){return I[3]===1?0:I[3]===2?1:I[3]===3?2:3}return o=k(l),u=g[o]=P[o](l),{c(){n=W("div"),s=W("div"),u.c(),this.h()},l(I){n=G(I,"DIV",{class:!0});var y=se(n);s=G(y,"DIV",{class:!0});var M=se(s);u.l(M),M.forEach(A),y.forEach(A),this.h()},h(){N(s,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),N(n,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(I,y){re(I,n,y),R(n,s),g[o].m(s,null),v=!0},p(I,y){let M=o;o=k(I),o===M?g[o].p(I,y):(kt(),je(g[M],1,1,()=>{g[M]=null}),xt(),u=g[o],u?u.p(I,y):(u=g[o]=P[o](I),u.c()),Te(u,1),u.m(s,null))},i(I){v||(Te(u),I&&it(()=>{v&&(c||(c=Be(s,qe,{duration:500},!0)),c.run(1))}),I&&it(()=>{v&&(d||(d=Be(n,qe,{duration:500},!0)),d.run(1))}),v=!0)},o(I){je(u),I&&(c||(c=Be(s,qe,{duration:500},!1)),c.run(0)),I&&(d||(d=Be(n,qe,{duration:500},!1)),d.run(0)),v=!1},d(I){I&&A(n),g[o].d(),I&&c&&c.end(),I&&d&&d.end()}}}function Ea(l){let n,s,o,u;return s=new Ta({props:{closeModal:l[5],meditationResults:l[4]}}),{c(){n=W("div"),Pt(s.$$.fragment),this.h()},l(c){n=G(c,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(c,d){re(c,n,d),It(s,n,null),u=!0},p(c,d){const v={};d&16&&(v.meditationResults=c[4]),s.$set(v)},i(c){u||(Te(s.$$.fragment,c),c&&it(()=>{u&&(o||(o=Be(n,qe,{duration:300},!0)),o.run(1))}),u=!0)},o(c){je(s.$$.fragment,c),c&&(o||(o=Be(n,qe,{duration:300},!1)),o.run(0)),u=!1},d(c){c&&A(n),St(s),c&&o&&o.end()}}}function Ca(l){let n,s,o,u;return s=new ca({props:{duration:l[1],nextStep:l[7],levelId:l[2]}}),s.$on("complete",l[8]),{c(){n=W("div"),Pt(s.$$.fragment),this.h()},l(c){n=G(c,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(c,d){re(c,n,d),It(s,n,null),u=!0},p(c,d){const v={};d&2&&(v.duration=c[1]),d&4&&(v.levelId=c[2]),s.$set(v)},i(c){u||(Te(s.$$.fragment,c),c&&it(()=>{u&&(o||(o=Be(n,qe,{duration:300},!0)),o.run(1))}),u=!0)},o(c){je(s.$$.fragment,c),c&&(o||(o=Be(n,qe,{duration:300},!1)),o.run(0)),u=!1},d(c){c&&A(n),St(s),c&&o&&o.end()}}}function Sa(l){let n,s,o,u;return s=new ia({props:{nextStep:l[7],closeModal:l[5],levelId:l[2]}}),{c(){n=W("div"),Pt(s.$$.fragment),this.h()},l(c){n=G(c,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(c,d){re(c,n,d),It(s,n,null),u=!0},p(c,d){const v={};d&4&&(v.levelId=c[2]),s.$set(v)},i(c){u||(Te(s.$$.fragment,c),c&&it(()=>{u&&(o||(o=Be(n,qe,{duration:300},!0)),o.run(1))}),u=!0)},o(c){je(s.$$.fragment,c),c&&(o||(o=Be(n,qe,{duration:300},!1)),o.run(0)),u=!1},d(c){c&&A(n),St(s),c&&o&&o.end()}}}function Ia(l){let n,s,o,u;return s=new Qo({props:{nextStep:l[7],duration:l[1],closeModal:l[5],levelId:l[2]}}),{c(){n=W("div"),Pt(s.$$.fragment),this.h()},l(c){n=G(c,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(c,d){re(c,n,d),It(s,n,null),u=!0},p(c,d){const v={};d&2&&(v.duration=c[1]),d&4&&(v.levelId=c[2]),s.$set(v)},i(c){u||(Te(s.$$.fragment,c),c&&it(()=>{u&&(o||(o=Be(n,qe,{duration:300},!0)),o.run(1))}),u=!0)},o(c){je(s.$$.fragment,c),c&&(o||(o=Be(n,qe,{duration:300},!1)),o.run(0)),u=!1},d(c){c&&A(n),St(s),c&&o&&o.end()}}}function Oa(l){let n,s,o=l[0]&&Li(l);return{c(){o&&o.c(),n=Qn()},l(u){o&&o.l(u),n=Qn()},m(u,c){o&&o.m(u,c),re(u,n,c),s=!0},p(u,[c]){u[0]?o?(o.p(u,c),c&1&&Te(o,1)):(o=Li(u),o.c(),Te(o,1),o.m(n.parentNode,n)):o&&(kt(),je(o,1,1,()=>{o=null}),xt())},i(u){s||(Te(o),s=!0)},o(u){je(o),s=!1},d(u){u&&A(n),o&&o.d(u)}}}function Pa(l,n,s){let{show:o=!1}=n,{duration:u=Ye.ONE_MINUTE}=n,{levelId:c=null}=n,d=1,v;const P=()=>{s(0,o=!1),s(3,d=1)},g=async y=>{const{clickTimestamps:M,durationMeditated:J,completed:ce}=y.detail,le=c||"L1",H=vn.find(ge=>ge.id===le);if(!H)return;const Q=await mn.sessions.where("levelId").equals(le).toArray(),Y=await Jn(le),$=new Set(Object.entries(Y).filter(([ge,Ke])=>Ke.completed).map(([ge])=>ge)),pe=Q.map(ge=>new Set(H.completionTasks.filter(Ke=>{var Re;return(Re=lt[Ke.id])==null?void 0:Re.call(lt,[ge],H).completed}).map(Ke=>Ke.id))),ie=Nr(H.starRules,$,pe),Z={levelId:le,duration:J,tapCount:M.length,tapTimestamps:M,timestamp:Date.now(),completed:ce};await mn.sessions.add(Z);const te=await Jn(le),Oe=new Set(Object.entries(te).filter(([ge,Ke])=>Ke.completed).map(([ge])=>ge)),Se=Object.entries(te).filter(([ge,Ke])=>{var Re;return Ke.completed&&!((Re=Y[ge])!=null&&Re.completed)}).map(([ge])=>ge),Ee=await mn.sessions.where("levelId").equals(le).toArray(),fe=Ee.map(ge=>new Set(H.completionTasks.filter(Ke=>{var Re;return(Re=lt[Ke.id])==null?void 0:Re.call(lt,[ge],H).completed}).map(Ke=>Ke.id))),ue=Nr(H.starRules,Oe,fe),He=io(Ee),Je=He&&He.tapCount===M.length&&He.duration===J;s(4,v={...y.detail,levelId:le,previousStarRating:ie,newStarRating:ue,newlyCompletedTasks:Se,completionTaskResults:Object.fromEntries(Object.entries(te).map(([ge,Ke])=>[ge,Ke.completed])),isNewPersonalBest:Je||!1,personalBest:He}),k()},k=()=>setTimeout(()=>s(3,d++,d),300),I=y=>g(y);return l.$$set=y=>{"show"in y&&s(0,o=y.show),"duration"in y&&s(1,u=y.duration),"levelId"in y&&s(2,c=y.levelId)},[o,u,c,d,v,P,g,k,I]}class Da extends Et{constructor(n){super(),Ct(this,n,Pa,Oa,Tt,{show:0,duration:1,levelId:2})}}function Ui(l,n,s){const o=l.slice();return o[6]=n[s],o}function Vi(l){let n,s=Mr[l[6]]+"",o;return{c(){n=W("option"),o=ae(s),this.h()},l(u){n=G(u,"OPTION",{});var c=se(n);o=oe(c,s),c.forEach(A),this.h()},h(){n.__value=l[6],Yo(n,n.__value)},m(u,c){re(u,n,c),R(n,o)},p:We,d(u){u&&A(n)}}}function ja(l){let n,s,o="Select Meditation Duration",u,c,d,v,P=et(l[2]),g=[];for(let k=0;k<P.length;k+=1)g[k]=Vi(Ui(l,P,k));return{c(){n=W("div"),s=W("label"),s.textContent=o,u=_e(),c=W("select");for(let k=0;k<g.length;k+=1)g[k].c();this.h()},l(k){n=G(k,"DIV",{class:!0});var I=se(n);s=G(I,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-g1prfd"&&(s.textContent=o),u=ye(I),c=G(I,"SELECT",{id:!0,class:!0});var y=se(c);for(let M=0;M<g.length;M+=1)g[M].l(y);y.forEach(A),I.forEach(A),this.h()},h(){N(s,"for","duration"),N(s,"class","text-md font-medium"),N(c,"id","duration"),N(c,"class","select select-bordered w-full max-w-xs"),N(n,"class","flex flex-col items-start gap-1")},m(k,I){re(k,n,I),R(n,s),R(n,u),R(n,c);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(c,null);xi(c,l[1]),d||(v=pt(c,"change",l[5]),d=!0)},p(k,[I]){if(I&4){P=et(k[2]);let y;for(y=0;y<P.length;y+=1){const M=Ui(k,P,y);g[y]?g[y].p(M,I):(g[y]=Vi(M),g[y].c(),g[y].m(c,null))}for(;y<g.length;y+=1)g[y].d(1);g.length=P.length}I&6&&xi(c,k[1])},i:We,o:We,d(k){k&&A(n),Yt(g,k),d=!1,v()}}}function Ka(l,n,s){let{onDurationChange:o}=n,{minDuration:u=Ye.ONE_MINUTE}=n,{maxDuration:c=Ye.SIXTY_MINUTES}=n,{selectedDuration:d=u??Ye.ONE_MINUTE}=n;const v=Object.values(Ye).filter(g=>typeof g=="number").filter(g=>g>=u&&g<=c),P=g=>o(Number(g.currentTarget.value));return l.$$set=g=>{"onDurationChange"in g&&s(0,o=g.onDurationChange),"minDuration"in g&&s(3,u=g.minDuration),"maxDuration"in g&&s(4,c=g.maxDuration),"selectedDuration"in g&&s(1,d=g.selectedDuration)},[o,d,v,u,c,P]}class Ra extends Et{constructor(n){super(),Ct(this,n,Ka,ja,Tt,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Yi(l,n,s){const o=l.slice();return o[9]=n[s].level,o[10]=n[s].isUnlocked,o[11]=n[s].taskCompletion,o[12]=n[s].starRating,o[13]=n[s].bestSession,o[14]=n,o[15]=s,o}function Hi(l,n,s){const o=l.slice();return o[16]=n[s][0],o[17]=n[s][1],o}function zi(l,n,s){const o=l.slice();return o[16]=n[s],o[21]=s,o}function Ma(l){let n,s,o=et(l[3]),u=[];for(let d=0;d<o.length;d+=1)u[d]=Zi(Yi(l,o,d));const c=d=>je(u[d],1,1,()=>{u[d]=null});return{c(){n=W("div");for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){n=G(d,"DIV",{class:!0});var v=se(n);for(let P=0;P<u.length;P+=1)u[P].l(v);v.forEach(A),this.h()},h(){N(n,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full")},m(d,v){re(d,n,v);for(let P=0;P<u.length;P+=1)u[P]&&u[P].m(n,null);s=!0},p(d,v){if(v&46){o=et(d[3]);let P;for(P=0;P<o.length;P+=1){const g=Yi(d,o,P);u[P]?(u[P].p(g,v),Te(u[P],1)):(u[P]=Zi(g),u[P].c(),Te(u[P],1),u[P].m(n,null))}for(kt(),P=o.length;P<u.length;P+=1)c(P);xt()}},i(d){if(!s){for(let v=0;v<o.length;v+=1)Te(u[v]);s=!0}},o(d){u=u.filter(Boolean);for(let v=0;v<u.length;v+=1)je(u[v]);s=!1},d(d){d&&A(n),Yt(u,d)}}}function Aa(l){let n,s='<div class="loading loading-spinner loading-lg"></div>';return{c(){n=W("div"),n.innerHTML=s,this.h()},l(o){n=G(o,"DIV",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-1mgfhb9"&&(n.innerHTML=s),this.h()},h(){N(n,"class","flex justify-center items-center mt-8")},m(o,u){re(o,n,u)},p:We,i:We,o:We,d(o){o&&A(n)}}}function Gi(l){let n,s="🔒";return{c(){n=W("span"),n.textContent=s,this.h()},l(o){n=G(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-19hy9gc"&&(n.textContent=s),this.h()},h(){N(n,"class","text-2xl")},m(o,u){re(o,n,u)},d(o){o&&A(n)}}}function Wi(l){let n,s=et(Array(3)),o=[];for(let u=0;u<s.length;u+=1)o[u]=Xi(zi(l,s,u));return{c(){n=W("div");for(let u=0;u<o.length;u+=1)o[u].c();this.h()},l(u){n=G(u,"DIV",{class:!0});var c=se(n);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(A),this.h()},h(){N(n,"class","flex items-center")},m(u,c){re(u,n,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(u,c){if(c&8){s=et(Array(3));let d;for(d=0;d<s.length;d+=1){const v=zi(u,s,d);o[d]?o[d].p(v,c):(o[d]=Xi(v),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(u){u&&A(n),Yt(o,u)}}}function Na(l){let n,s="★";return{c(){n=W("span"),n.textContent=s,this.h()},l(o){n=G(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-1tpxw7h"&&(n.textContent=s),this.h()},h(){N(n,"class","text-2xl text-gray-300")},m(o,u){re(o,n,u)},d(o){o&&A(n)}}}function Ba(l){let n,s="⭐";return{c(){n=W("span"),n.textContent=s,this.h()},l(o){n=G(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-1jlkvsx"&&(n.textContent=s),this.h()},h(){N(n,"class","text-2xl")},m(o,u){re(o,n,u)},d(o){o&&A(n)}}}function Xi(l){let n;function s(c,d){return c[21]<c[12]?Ba:Na}let o=s(l),u=o(l);return{c(){u.c(),n=Qn()},l(c){u.l(c),n=Qn()},m(c,d){u.m(c,d),re(c,n,d)},p(c,d){o!==(o=s(c))&&(u.d(1),u=o(c),u&&(u.c(),u.m(n.parentNode,n)))},d(c){c&&A(n),u.d(c)}}}function Qi(l){let n,s,o=l[13].tapCount+"",u,c,d=Jt(l[13].duration)+"",v,P;return{c(){n=W("p"),s=ae("Your best: "),u=ae(o),c=ae(" taps · "),v=ae(d),P=ae(" min"),this.h()},l(g){n=G(g,"P",{class:!0});var k=se(n);s=oe(k,"Your best: "),u=oe(k,o),c=oe(k," taps · "),v=oe(k,d),P=oe(k," min"),k.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(g,k){re(g,n,k),R(n,s),R(n,u),R(n,c),R(n,v),R(n,P)},p(g,k){k&8&&o!==(o=g[13].tapCount+"")&&Ne(u,o),k&8&&d!==(d=Jt(g[13].duration)+"")&&Ne(v,d)},d(g){g&&A(n)}}}function $i(l){let n,s=et(Object.entries(l[11])),o=[];for(let u=0;u<s.length;u+=1)o[u]=Ji(Hi(l,s,u));return{c(){n=W("div");for(let u=0;u<o.length;u+=1)o[u].c();this.h()},l(u){n=G(u,"DIV",{class:!0});var c=se(n);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(A),this.h()},h(){N(n,"class","space-y-0")},m(u,c){re(u,n,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(u,c){if(c&8){s=et(Object.entries(u[11]));let d;for(d=0;d<s.length;d+=1){const v=Hi(u,s,d);o[d]?o[d].p(v,c):(o[d]=Ji(v),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(u){u&&A(n),Yt(o,u)}}}function Ji(l){let n,s,o=l[17].completed?"✅":"🔲",u,c,d=l[17].description+"",v,P,g=l[17].info+"",k,I;return{c(){n=W("div"),s=W("span"),u=ae(o),c=_e(),v=ae(d),P=_e(),k=ae(g),I=_e(),this.h()},l(y){n=G(y,"DIV",{class:!0});var M=se(n);s=G(M,"SPAN",{class:!0});var J=se(s);u=oe(J,o),c=ye(J),v=oe(J,d),P=ye(J),k=oe(J,g),J.forEach(A),I=ye(M),M.forEach(A),this.h()},h(){N(s,"class","mr-2 text-sm text-gray-500"),N(n,"class","flex items-center")},m(y,M){re(y,n,M),R(n,s),R(s,u),R(s,c),R(s,v),R(s,P),R(s,k),R(n,I)},p(y,M){M&8&&o!==(o=y[17].completed?"✅":"🔲")&&Ne(u,o),M&8&&d!==(d=y[17].description+"")&&Ne(v,d),M&8&&g!==(g=y[17].info+"")&&Ne(k,g)},d(y){y&&A(n)}}}function qa(l){let n,s='<p class="text-sm text-gray-500">Achieve 2 stars in previous levels to unlock</p>';return{c(){n=W("div"),n.innerHTML=s,this.h()},l(o){n=G(o,"DIV",{class:!0,"data-svelte-h":!0}),Ue(n)!=="svelte-agxr37"&&(n.innerHTML=s),this.h()},h(){N(n,"class","space-y-4 mt-8")},m(o,u){re(o,n,u)},p:We,i:We,o:We,d(o){o&&A(n)}}}function Fa(l){let n,s,o,u,c="Start meditation",d,v,P;function g(...I){return l[6](l[9],l[14],l[15],...I)}s=new Ra({props:{selectedDuration:l[9].selectedDuration,onDurationChange:g,minDuration:l[9].minDuration,maxDuration:l[9].maxDuration}});function k(){return l[7](l[9])}return{c(){n=W("div"),Pt(s.$$.fragment),o=_e(),u=W("button"),u.textContent=c,this.h()},l(I){n=G(I,"DIV",{class:!0});var y=se(n);Ot(s.$$.fragment,y),o=ye(y),u=G(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(u)!=="svelte-egxc4d"&&(u.textContent=c),y.forEach(A),this.h()},h(){N(u,"class","btn variant-filled w-full"),N(n,"class","space-y-6 mt-8")},m(I,y){re(I,n,y),It(s,n,null),R(n,o),R(n,u),d=!0,v||(P=pt(u,"click",k),v=!0)},p(I,y){l=I;const M={};y&8&&(M.selectedDuration=l[9].selectedDuration),y&8&&(M.onDurationChange=g),y&8&&(M.minDuration=l[9].minDuration),y&8&&(M.maxDuration=l[9].maxDuration),s.$set(M)},i(I){d||(Te(s.$$.fragment,I),d=!0)},o(I){je(s.$$.fragment,I),d=!1},d(I){I&&A(n),St(s),v=!1,P()}}}function Zi(l){let n,s,o,u,c=l[9].name+"",d,v,P,g,k,I=l[9].description+"",y,M,J,ce,le,H,Q,Y,$,pe=!l[10]&&Gi(),ie=l[12]!==void 0&&l[10]&&Wi(l),Z=l[13]&&l[10]&&Qi(l),te=l[11]&&l[10]&&$i(l);const Oe=[Fa,qa],Se=[];function Ee(fe,ue){return fe[10]?0:1}return le=Ee(l),H=Se[le]=Oe[le](l),{c(){n=W("div"),s=W("div"),o=W("h3"),pe&&pe.c(),u=_e(),d=ae(c),v=_e(),ie&&ie.c(),P=_e(),g=W("div"),k=W("p"),y=ae(I),M=_e(),Z&&Z.c(),J=_e(),te&&te.c(),ce=_e(),H.c(),Q=_e(),this.h()},l(fe){n=G(fe,"DIV",{class:!0});var ue=se(n);s=G(ue,"DIV",{class:!0});var He=se(s);o=G(He,"H3",{class:!0});var Je=se(o);pe&&pe.l(Je),u=ye(Je),d=oe(Je,c),Je.forEach(A),v=ye(He),ie&&ie.l(He),He.forEach(A),P=ye(ue),g=G(ue,"DIV",{class:!0});var ge=se(g);k=G(ge,"P",{class:!0});var Ke=se(k);y=oe(Ke,I),Ke.forEach(A),M=ye(ge),Z&&Z.l(ge),ge.forEach(A),J=ye(ue),te&&te.l(ue),ce=ye(ue),H.l(ue),Q=ye(ue),ue.forEach(A),this.h()},h(){N(o,"class","text-lg font-bold"),N(s,"class","flex justify-between items-center mb-2"),N(k,"class","text-sm text-muted-foreground mb-2"),N(g,"class","mb-2"),N(n,"class",Y="card bg-[#ffffffa6] p-8 "+(l[10]?"":"opacity-60"))},m(fe,ue){re(fe,n,ue),R(n,s),R(s,o),pe&&pe.m(o,null),R(o,u),R(o,d),R(s,v),ie&&ie.m(s,null),R(n,P),R(n,g),R(g,k),R(k,y),R(g,M),Z&&Z.m(g,null),R(n,J),te&&te.m(n,null),R(n,ce),Se[le].m(n,null),R(n,Q),$=!0},p(fe,ue){fe[10]?pe&&(pe.d(1),pe=null):pe||(pe=Gi(),pe.c(),pe.m(o,u)),(!$||ue&8)&&c!==(c=fe[9].name+"")&&Ne(d,c),fe[12]!==void 0&&fe[10]?ie?ie.p(fe,ue):(ie=Wi(fe),ie.c(),ie.m(s,null)):ie&&(ie.d(1),ie=null),(!$||ue&8)&&I!==(I=fe[9].description+"")&&Ne(y,I),fe[13]&&fe[10]?Z?Z.p(fe,ue):(Z=Qi(fe),Z.c(),Z.m(g,null)):Z&&(Z.d(1),Z=null),fe[11]&&fe[10]?te?te.p(fe,ue):(te=$i(fe),te.c(),te.m(n,ce)):te&&(te.d(1),te=null);let He=le;le=Ee(fe),le===He?Se[le].p(fe,ue):(kt(),je(Se[He],1,1,()=>{Se[He]=null}),xt(),H=Se[le],H?H.p(fe,ue):(H=Se[le]=Oe[le](fe),H.c()),Te(H,1),H.m(n,Q)),(!$||ue&8&&Y!==(Y="card bg-[#ffffffa6] p-8 "+(fe[10]?"":"opacity-60")))&&N(n,"class",Y)},i(fe){$||(Te(H),$=!0)},o(fe){je(H),$=!1},d(fe){fe&&A(n),pe&&pe.d(),ie&&ie.d(),Z&&Z.d(),te&&te.d(),Se[le].d()}}}function La(l){let n,s,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',u,c,d,v,P,g=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn ↗</a></p>`,k,I,y,M;const J=[Aa,Ma],ce=[];function le(Y,$){return Y[4]?0:1}c=le(l),d=ce[c]=J[c](l);function H(Y){l[8](Y)}let Q={duration:l[1],levelId:l[2]};return l[0]!==void 0&&(Q.show=l[0]),I=new Da({props:Q}),qr.push(()=>Lr(I,"show",H)),{c(){n=W("div"),s=W("div"),s.innerHTML=o,u=_e(),d.c(),v=_e(),P=W("div"),P.innerHTML=g,k=_e(),Pt(I.$$.fragment),this.h()},l(Y){n=G(Y,"DIV",{class:!0});var $=se(n);s=G($,"DIV",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-50yq01"&&(s.innerHTML=o),u=ye($),d.l($),v=ye($),P=G($,"DIV",{class:!0,"data-svelte-h":!0}),Ue(P)!=="svelte-dgw8za"&&(P.innerHTML=g),$.forEach(A),k=ye(Y),Ot(I.$$.fragment,Y),this.h()},h(){N(s,"class","space-y-6 text-center mt-10 mb-8"),N(P,"class","text-center text-sm text-gray-500 mt-40"),N(n,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(Y,$){re(Y,n,$),R(n,s),R(n,u),ce[c].m(n,null),R(n,v),R(n,P),re(Y,k,$),It(I,Y,$),M=!0},p(Y,[$]){let pe=c;c=le(Y),c===pe?ce[c].p(Y,$):(kt(),je(ce[pe],1,1,()=>{ce[pe]=null}),xt(),d=ce[c],d?d.p(Y,$):(d=ce[c]=J[c](Y),d.c()),Te(d,1),d.m(n,v));const ie={};$&2&&(ie.duration=Y[1]),$&4&&(ie.levelId=Y[2]),!y&&$&1&&(y=!0,ie.show=Y[0],Fr(()=>y=!1)),I.$set(ie)},i(Y){M||(Te(d),Te(I.$$.fragment,Y),M=!0)},o(Y){je(d),je(I.$$.fragment,Y),M=!1},d(Y){Y&&(A(n),A(k)),ce[c].d(),St(I,Y)}}}function Ua(l,n,s){let o=!1,u=Ye.ONE_MINUTE,c=null,d=[],v=!0;const P=()=>{window.audioContext||(window.audioContext=new(window.AudioContext||window.webkitAudioContext)),s(0,o=!0)},g=(y,M,J,ce)=>s(3,M[J].level.selectedDuration=ce,d),k=y=>{s(2,c=y.id),s(1,u=y.selectedDuration??y.minDuration),P()};function I(y){o=y,s(0,o)}return l.$$.update=()=>{l.$$.dirty&1&&(o||(s(4,v=!0),ma().then(y=>{s(3,d=y),y.forEach(({level:M})=>{M.selectedDuration=M.minDuration}),s(4,v=!1)}).catch(y=>{console.error("Failed to reload level statuses:",y),s(4,v=!1)})))},[o,u,c,d,v,P,g,k,I]}class is extends Et{constructor(n){super(),Ct(this,n,Ua,La,Tt,{})}}export{is as component};
