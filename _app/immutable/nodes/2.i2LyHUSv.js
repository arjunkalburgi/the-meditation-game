var Ko=Object.defineProperty;var Ro=(f,r,s)=>r in f?Ko(f,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):f[r]=s;var wi=(f,r,s)=>Ro(f,typeof r!="symbol"?r+"":r,s);import{B as Ao,s as St,d as B,Z as zt,c as oe,e as R,w as M,f as X,g as ue,j as ve,k as Q,l as ye,q as Ji,n as He,C as at,U as vt,_ as Ae,$ as Bo,a0 as Mo,b as Le,i as No,h as ce,t as fe,a1 as Wn,a2 as Gn,a3 as Zi,m as Zn,a4 as qo,y as qr,a5 as Fr,r as $i,x as Xn,P as Yt,o as $n,a6 as ki,a7 as Fo}from"../chunks/BIM6er8B.js";import{S as Et,i as It,t as Ke,a as Ee,g as Tt,c as Ct,f as Me,h as Lr,d as Ot,m as Pt,e as Dt,b as jt}from"../chunks/CLOSa3QW.js";import{p as ht}from"../chunks/CmP4wuhm.js";import{d as xi,w as Qn}from"../chunks/BSzwmYPV.js";function Je(f){return(f==null?void 0:f.length)!==void 0?f:Array.from(f)}function Ne(f,{delay:r=0,duration:s=400,easing:o=Ao}={}){const c=+getComputedStyle(f).opacity;return{delay:r,duration:s,easing:o,css:l=>`opacity: ${l*c}`}}var rt=(f=>(f[f.ONE_MINUTE=60]="ONE_MINUTE",f[f.TWO_MINUTES=120]="TWO_MINUTES",f[f.FIVE_MINUTES=300]="FIVE_MINUTES",f[f.TEN_MINUTES=600]="TEN_MINUTES",f[f.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",f[f.THIRTY_MINUTES=1800]="THIRTY_MINUTES",f[f.SIXTY_MINUTES=3600]="SIXTY_MINUTES",f))(rt||{});const Mr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lo(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var eo={exports:{}};(function(f,r){(function(s,o){f.exports=o()})(Ti,function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function c(e,t,n){for(var i,a=0,u=t.length;a<u;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ti,d=Object.keys,b=Array.isArray;function j(e,t){return typeof t!="object"||d(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var g=Object.getPrototypeOf,m={}.hasOwnProperty;function I(e,t){return m.call(e,t)}function y(e,t){typeof t=="function"&&(t=t(g(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(n){Y(e,n,t[n])})}var A=Object.defineProperty;function Y(e,t,n,i){A(e,t,j(n&&I(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function ie(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Y(e.prototype,"constructor",e),{extend:y.bind(null,e.prototype)}}}}var de=Object.getOwnPropertyDescriptor,V=[].slice;function Z(e,t,n){return V.call(e,t,n)}function W(e,t){return t(e)}function $(e){if(!e)throw new Error("Assertion Failed")}function le(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function ae(e,t){if(typeof t=="string"&&I(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],i=0,a=t.length;i<a;++i){var u=ae(e,t[i]);n.push(u)}return n}var h=t.indexOf(".");if(h!==-1){var p=e[t.substr(0,h)];return p==null?void 0:ae(p,t.substr(h+1))}}function ee(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){$(typeof n!="string"&&"length"in n);for(var i=0,a=t.length;i<a;++i)ee(e,t[i],n[i])}else{var u,h,p=t.indexOf(".");p!==-1?(u=t.substr(0,p),(h=t.substr(p+1))===""?n===void 0?b(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n:ee(p=!(p=e[u])||!I(e,u)?e[u]={}:p,h,n)):n===void 0?b(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function z(e){var t,n={};for(t in e)I(e,t)&&(n[t]=e[t]);return n}var Ce=[].concat;function Ie(e){return Ce.apply([],e)}var Rt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ie([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),Qe=new Set(Rt.map(function(e){return l[e]})),re=null;function be(e){return re=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var i=re.get(n);if(i)return i;if(b(n)){i=[],re.set(n,i);for(var a=0,u=n.length;a<u;++a)i.push(t(n[a]))}else if(Qe.has(n.constructor))i=n;else{var h,p=g(n);for(h in i=p===Object.prototype?{}:Object.create(p),re.set(n,i),n)I(n,h)&&(i[h]=t(n[h]))}return i}(e),re=null,e}var xe={}.toString;function Ze(e){return xe.call(e).slice(8,-1)}var Se=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Be=typeof Se=="symbol"?function(e){var t;return e!=null&&(t=e[Se])&&t.apply(e)}:function(){return null};function st(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var $e={};function Pe(e){var t,n,i,a;if(arguments.length===1){if(b(e))return e.slice();if(this===$e&&typeof e=="string")return[e];if(a=Be(e)){for(n=[];!(i=a.next()).done;)n.push(i.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var ut=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},on=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ot=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(on),Ue={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Re(e,t){this.name=e,this.message=t}function se(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,i,a){return a.indexOf(n)===i}).join(`
`)}function ge(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=se(e,t)}function he(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=se(e,this.failures)}ie(Re).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ie(ge).from(Re),ie(he).from(Re);var it=ot.reduce(function(e,t){return e[t]=t+"Error",e},{}),bn=Re,ne=ot.reduce(function(e,t){var n=t+"Error";function i(a,u){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(u?`
 `+u:""),this.inner=u||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Ue[t]||n,this.inner=null)}return ie(i).from(bn),e[t]=i,e},{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var lt=on.reduce(function(e,t){return e[t+"Error"]=ne[t],e},{}),_n=ot.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ne[t]),e},{});function Oe(){}function nn(e){return e}function no(e,t){return e==null||e===nn?t:function(n){return t(e(n))}}function Kt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ro(e,t){return e===Oe?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Kt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Kt(a,this.onerror):a),u!==void 0?u:n}}function io(e,t){return e===Oe?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Kt(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Kt(i,this.onerror):i)}}function oo(e,t){return e===Oe?t:function(n){var i=e.apply(this,arguments);j(n,i);var a=this.onsuccess,u=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?Kt(a,this.onsuccess):a),u&&(this.onerror=this.onerror?Kt(u,this.onerror):u),i===void 0?n===void 0?void 0:n:j(i,n)}}function ao(e,t){return e===Oe?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function tr(e,t){return e===Oe?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,a=arguments.length,u=new Array(a);a--;)u[a]=arguments[a];return n.then(function(){return t.apply(i,u)})}return t.apply(this,arguments)}}_n.ModifyError=ge,_n.DexieError=Re,_n.BulkError=he;var ct=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ur(e){ct=e}var rn={},Vr=100,Rt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,g(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,g(t),e]}(),on=Rt[0],ot=Rt[1],Rt=Rt[2],ot=ot&&ot.then,At=on&&on.constructor,nr=!!Rt,an=function(e,t){sn.push([e,t]),wn&&(queueMicrotask(uo),wn=!1)},rr=!0,wn=!0,Bt=[],kn=[],ir=nn,yt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Oe,pgp:!1,env:{},finalize:Oe},te=yt,sn=[],Mt=0,xn=[];function G(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=te;if(typeof e!="function"){if(e!==rn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ar(this,this._value))}this._state=null,this._value=null,++t.ref,function n(i,a){try{a(function(u){if(i._state===null){if(u===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Wt();u&&typeof u.then=="function"?n(i,function(p,_){u instanceof G?u._then(p,_):u.then(p,_)}):(i._state=!0,i._value=u,Hr(i)),h&&Gt()}},ar.bind(null,i))}catch(u){ar(i,u)}}(this,e)}var or={get:function(){var e=te,t=En;function n(i,a){var u=this,h=!e.global&&(e!==te||t!==En),p=h&&!bt(),_=new G(function(k,C){sr(u,new Yr(Wr(i,e,h,p),Wr(a,e,h,p),k,C,e))});return this._consoleTask&&(_._consoleTask=this._consoleTask),_}return n.prototype=rn,n},set:function(e){Y(this,"then",e&&e.prototype===rn?or:{get:function(){return e},set:or.set})}};function Yr(e,t,n,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=i,this.psd=a}function ar(e,t){var n,i;kn.push(t),e._state===null&&(n=e._lib&&Wt(),t=ir(t),e._state=!1,e._value=t,i=e,Bt.some(function(a){return a._value===i._value})||Bt.push(i),Hr(e),n&&Gt())}function Hr(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)sr(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),Mt===0&&(++Mt,an(function(){--Mt==0&&ur()},[]))}function sr(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Mt,an(so,[n,e,t])}else e._listeners.push(t)}function so(e,t,n){try{var i,a=t._value;!t._state&&kn.length&&(kn=[]),i=ct&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||kn.indexOf(a)!==-1||function(u){for(var h=Bt.length;h;)if(Bt[--h]._value===u._value)return Bt.splice(h,1)}(t),n.resolve(i)}catch(u){n.reject(u)}finally{--Mt==0&&ur(),--n.psd.ref||n.psd.finalize()}}function uo(){Nt(yt,function(){Wt()&&Gt()})}function Wt(){var e=rr;return wn=rr=!1,e}function Gt(){var e,t,n;do for(;0<sn.length;)for(e=sn,sn=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}while(0<sn.length);wn=rr=!0}function ur(){var e=Bt;Bt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=xn.slice(0),n=t.length;n;)t[--n]()}function Tn(e){return new G(rn,!1,e)}function je(e,t){var n=te;return function(){var i=Wt(),a=te;try{return _t(n,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{_t(a,!1),i&&Gt()}}}y(G.prototype,{then:or,_then:function(e,t){sr(this,new Yr(null,null,e,t,te))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?n:Tn)(i)}):this.then(null,function(i){return(i&&i.name===t?n:Tn)(i)})},finally:function(e){return this.then(function(t){return G.resolve(e()).then(function(){return t})},function(t){return G.resolve(e()).then(function(){return Tn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new G(function(i,a){var u=setTimeout(function(){return a(new ne.Timeout(t))},e);n.then(i,a).finally(clearTimeout.bind(null,u))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Y(G.prototype,Symbol.toStringTag,"Dexie.Promise"),yt.env=zr(),y(G,{all:function(){var e=Pe.apply(null,arguments).map(In);return new G(function(t,n){e.length===0&&t([]);var i=e.length;e.forEach(function(a,u){return G.resolve(a).then(function(h){e[u]=h,--i||t(e)},n)})})},resolve:function(e){return e instanceof G?e:e&&typeof e.then=="function"?new G(function(t,n){e.then(t,n)}):new G(rn,!0,e)},reject:Tn,race:function(){var e=Pe.apply(null,arguments).map(In);return new G(function(t,n){e.map(function(i){return G.resolve(i).then(t,n)})})},PSD:{get:function(){return te},set:function(e){return te=e}},totalEchoes:{get:function(){return En}},newPSD:gt,usePSD:Nt,scheduler:{get:function(){return an},set:function(e){an=e}},rejectionMapper:{get:function(){return ir},set:function(e){ir=e}},follow:function(e,t){return new G(function(n,i){return gt(function(a,u){var h=te;h.unhandleds=[],h.onunhandled=u,h.finalize=Kt(function(){var p,_=this;p=function(){_.unhandleds.length===0?a():u(_.unhandleds[0])},xn.push(function k(){p(),xn.splice(xn.indexOf(k),1)}),++Mt,an(function(){--Mt==0&&ur()},[])},h.finalize),e()},t,n,i)})}}),At&&(At.allSettled&&Y(G,"allSettled",function(){var e=Pe.apply(null,arguments).map(In);return new G(function(t){e.length===0&&t([]);var n=e.length,i=new Array(n);e.forEach(function(a,u){return G.resolve(a).then(function(h){return i[u]={status:"fulfilled",value:h}},function(h){return i[u]={status:"rejected",reason:h}}).then(function(){return--n||t(i)})})})}),At.any&&typeof AggregateError<"u"&&Y(G,"any",function(){var e=Pe.apply(null,arguments).map(In);return new G(function(t,n){e.length===0&&n(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(u,h){return G.resolve(u).then(function(p){return t(p)},function(p){a[h]=p,--i||n(new AggregateError(a))})})})}),At.withResolvers&&(G.withResolvers=At.withResolvers));var Ve={awaits:0,echoes:0,id:0},lo=0,Cn=[],Sn=0,En=0,co=0;function gt(e,t,n,i){var a=te,u=Object.create(a);return u.parent=a,u.ref=0,u.global=!1,u.id=++co,yt.env,u.env=nr?{Promise:G,PromiseProp:{value:G,configurable:!0,writable:!0},all:G.all,race:G.race,allSettled:G.allSettled,any:G.any,resolve:G.resolve,reject:G.reject}:{},t&&j(u,t),++a.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Nt(u,e,n,i),u.ref===0&&u.finalize(),i}function Xt(){return Ve.id||(Ve.id=++lo),++Ve.awaits,Ve.echoes+=Vr,Ve.id}function bt(){return!!Ve.awaits&&(--Ve.awaits==0&&(Ve.id=0),Ve.echoes=Ve.awaits*Vr,!0)}function In(e){return Ve.echoes&&e&&e.constructor===At?(Xt(),e.then(function(t){return bt(),t},function(t){return bt(),qe(t)})):e}function fo(){var e=Cn[Cn.length-1];Cn.pop(),_t(e,!1)}function _t(e,t){var n,i=te;(t?!Ve.echoes||Sn++&&e===te:!Sn||--Sn&&e===te)||queueMicrotask(t?(function(a){++En,Ve.echoes&&--Ve.echoes!=0||(Ve.echoes=Ve.awaits=Ve.id=0),Cn.push(te),_t(a,!0)}).bind(null,e):fo),e!==te&&(te=e,i===yt&&(yt.env=zr()),nr&&(n=yt.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(l,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function zr(){var e=l.Promise;return nr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Nt(e,t,n,i,a){var u=te;try{return _t(e,!0),t(n,i,a)}finally{_t(u,!1)}}function Wr(e,t,n,i){return typeof e!="function"?e:function(){var a=te;n&&Xt(),_t(t,!0);try{return e.apply(this,arguments)}finally{_t(a,!1),i&&queueMicrotask(bt)}}}function lr(e){Promise===At&&Ve.echoes===0?Sn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+ot).indexOf("[native code]")===-1&&(Xt=bt=Oe);var qe=G.reject,qt="ï¿¿",pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Gr="String expected.",Qt=[],On="__dbnames",cr="readonly",fr="readwrite";function Ft(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Xr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Pn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=be(t))[e],t}}function Qr(){throw ne.Type()}function ke(e,t){try{var n=Jr(e),i=Jr(t);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,u){for(var h=a.length,p=u.length,_=h<p?h:p,k=0;k<_;++k)if(a[k]!==u[k])return a[k]<u[k]?-1:1;return h===p?0:h<p?-1:1}(Zr(e),Zr(t));case"Array":return function(a,u){for(var h=a.length,p=u.length,_=h<p?h:p,k=0;k<_;++k){var C=ke(a[k],u[k]);if(C!==0)return C}return h===p?0:h<p?-1:1}(e,t)}}catch{}return NaN}function Jr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Ze(e),e==="ArrayBuffer"?"binary":e)}function Zr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var $r=(De.prototype._trans=function(e,t,n){var i=this._tx||te.trans,a=this.name,u=ct&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(k,C,v){if(!v.schema[a])throw new ne.NotFound("Table "+a+" not part of transaction");return t(v.idbtrans,v)}var p=Wt();try{var _=i&&i.db._novip===this.db._novip?i===te.trans?i._promise(e,h,n):gt(function(){return i._promise(e,h,n)},{trans:i,transless:te.transless||te}):function k(C,v,E,w){if(C.idbdb&&(C._state.openComplete||te.letThrough||C._vip)){var T=C._createTransaction(v,E,C._dbSchema);try{T.create(),C._state.PR1398_maxLoop=3}catch(S){return S.name===it.InvalidState&&C.isOpen()&&0<--C._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),C.close({disableAutoOpen:!1}),C.open().then(function(){return k(C,v,E,w)})):qe(S)}return T._promise(v,function(S,x){return gt(function(){return te.trans=T,w(S,x,T)})}).then(function(S){if(v==="readwrite")try{T.idbtrans.commit()}catch{}return v==="readonly"?S:T._completion.then(function(){return S})})}if(C._state.openComplete)return qe(new ne.DatabaseClosed(C._state.dbOpenError));if(!C._state.isBeingOpened){if(!C._state.autoOpen)return qe(new ne.DatabaseClosed);C.open().catch(Oe)}return C._state.dbReadyPromise.then(function(){return k(C,v,E,w)})}(this.db,e,[this.name],h);return u&&(_._consoleTask=u,_=_.catch(function(k){return console.trace(k),qe(k)})),_}finally{p&&Gt()}},De.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?qe(new ne.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return n.core.get({trans:i,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},De.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(b(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(p){if(p.compound&&t.every(function(k){return 0<=p.keyPath.indexOf(k)})){for(var _=0;_<t.length;++_)if(t.indexOf(p.keyPath[_])===-1)return!1;return!0}return!1}).sort(function(p,_){return p.keyPath.length-_.keyPath.length})[0];if(n&&this.db._maxKey!==qt){var u=n.keyPath.slice(0,t.length);return this.where(u).equals(u.map(function(_){return e[_]}))}!n&&ct&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(p,_){return ke(p,_)===0}var h=t.reduce(function(v,_){var k=v[0],C=v[1],v=i[_],E=e[_];return[k||v,k||!v?Ft(C,v&&v.multi?function(w){return w=ae(w,_),b(w)&&w.some(function(T){return a(E,T)})}:function(w){return a(E,ae(w,_))}):C]},[null,null]),u=h[0],h=h[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(h):n?this.filter(h):this.where(t).equals("")},De.prototype.filter=function(e){return this.toCollection().and(e)},De.prototype.count=function(e){return this.toCollection().count(e)},De.prototype.offset=function(e){return this.toCollection().offset(e)},De.prototype.limit=function(e){return this.toCollection().limit(e)},De.prototype.each=function(e){return this.toCollection().each(e)},De.prototype.toArray=function(e){return this.toCollection().toArray(e)},De.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},De.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,b(e)?"[".concat(e.join("+"),"]"):e))},De.prototype.reverse=function(){return this.toCollection().reverse()},De.prototype.mapToClass=function(e){var t,n=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Qr&&(function(_,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");function C(){this.constructor=_}s(_,k),_.prototype=k===null?Object.create(k):(C.prototype=k.prototype,new C)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var u=new Set,h=e.prototype;h;h=g(h))Object.getOwnPropertyNames(h).forEach(function(_){return u.add(_)});function p(_){if(!_)return _;var k,C=Object.create(e.prototype);for(k in _)if(!u.has(k))try{C[k]=_[k]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),e},De.prototype.defineClass=function(){return this.mapToClass(function(e){j(this,e)})},De.prototype.add=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,h=e;return u&&a&&(h=Pn(u)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(p){return p.numFailures?G.reject(p.failures[0]):p.lastResult}).then(function(p){if(u)try{ee(e,u,p)}catch{}return p})},De.prototype.update=function(e,t){return typeof e!="object"||b(e)?this.where(":id").equals(e).modify(t):(e=ae(e,this.schema.primKey.keyPath),e===void 0?qe(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},De.prototype.put=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,h=e;return u&&a&&(h=Pn(u)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(p){return p.numFailures?G.reject(p.failures[0]):p.lastResult}).then(function(p){if(u)try{ee(e,u,p)}catch{}return p})},De.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?G.reject(n.failures[0]):void 0})},De.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Xr})}).then(function(t){return t.numFailures?G.reject(t.failures[0]):void 0})},De.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},De.prototype.bulkAdd=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,u=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var k=i.schema.primKey,p=k.auto,k=k.keyPath;if(k&&a)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var _=e.length,k=k&&p?e.map(Pn(k)):e;return i.core.mutate({trans:h,type:"add",keys:a,values:k,wantResults:u}).then(function(T){var v=T.numFailures,E=T.results,w=T.lastResult,T=T.failures;if(v===0)return u?E:w;throw new he("".concat(i.name,".bulkAdd(): ").concat(v," of ").concat(_," operations failed"),T)})})},De.prototype.bulkPut=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,u=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var k=i.schema.primKey,p=k.auto,k=k.keyPath;if(k&&a)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var _=e.length,k=k&&p?e.map(Pn(k)):e;return i.core.mutate({trans:h,type:"put",keys:a,values:k,wantResults:u}).then(function(T){var v=T.numFailures,E=T.results,w=T.lastResult,T=T.failures;if(v===0)return u?E:w;throw new he("".concat(i.name,".bulkPut(): ").concat(v," of ").concat(_," operations failed"),T)})})},De.prototype.bulkUpdate=function(e){var t=this,n=this.core,i=e.map(function(h){return h.key}),a=e.map(function(h){return h.changes}),u=[];return this._trans("readwrite",function(h){return n.getMany({trans:h,keys:i,cache:"clone"}).then(function(p){var _=[],k=[];e.forEach(function(v,E){var w=v.key,T=v.changes,S=p[E];if(S){for(var x=0,O=Object.keys(T);x<O.length;x++){var P=O[x],D=T[P];if(P===t.schema.primKey.keyPath){if(ke(D,w)!==0)throw new ne.Constraint("Cannot update primary key in bulkUpdate()")}else ee(S,P,D)}u.push(E),_.push(w),k.push(S)}});var C=_.length;return n.mutate({trans:h,type:"put",keys:_,values:k,updates:{keys:i,changeSpecs:a}}).then(function(v){var E=v.numFailures,w=v.failures;if(E===0)return C;for(var T=0,S=Object.keys(w);T<S.length;T++){var x,O=S[T],P=u[Number(O)];P!=null&&(x=w[O],delete w[O],w[P]=x)}throw new he("".concat(t.name,".bulkUpdate(): ").concat(E," of ").concat(C," operations failed"),w)})})})},De.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var a=h.numFailures,u=h.lastResult,h=h.failures;if(a===0)return u;throw new he("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),h)})},De);function De(){}function un(e){function t(h,p){if(p){for(var _=arguments.length,k=new Array(_-1);--_;)k[_-1]=arguments[_];return n[h].subscribe.apply(null,k),e}if(typeof h=="string")return n[h]}var n={};t.addEventType=u;for(var i=1,a=arguments.length;i<a;++i)u(arguments[i]);return t;function u(h,p,_){if(typeof h!="object"){var k;p=p||ao;var C={subscribers:[],fire:_=_||Oe,subscribe:function(v){C.subscribers.indexOf(v)===-1&&(C.subscribers.push(v),C.fire=p(C.fire,v))},unsubscribe:function(v){C.subscribers=C.subscribers.filter(function(E){return E!==v}),C.fire=C.subscribers.reduce(p,_)}};return n[h]=t[h]=C}d(k=h).forEach(function(v){var E=k[v];if(b(E))u(v,k[v][0],k[v][1]);else{if(E!=="asap")throw new ne.InvalidArgument("Invalid event config");var w=u(v,nn,function(){for(var T=arguments.length,S=new Array(T);T--;)S[T]=arguments[T];w.subscribers.forEach(function(x){le(function(){x.apply(null,S)})})})}})}}function ln(e,t){return ie(t).from({prototype:e}),t}function Jt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function dr(e,t){e.filter=Ft(e.filter,t)}function hr(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return Ft(i(),t())}:t,e.justLimit=n&&!i}function Dn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function ei(e,t,n){var i=Dn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function jn(e,t,n,i){var a=e.replayFilter?Ft(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},h=function(p,_,k){var C,v;a&&!a(_,k,function(E){return _.stop(E)},function(E){return _.fail(E)})||((v=""+(C=_.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(C)),I(u,v)||(u[v]=!0,t(p,_,k)))};return Promise.all([e.or._iterate(h,n),ti(ei(e,i,n),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ti(ei(e,i,n),Ft(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function ti(e,t,n,i){var a=je(i?function(u,h,p){return n(i(u),h,p)}:n);return e.then(function(u){if(u)return u.start(function(){var h=function(){return u.continue()};t&&!t(u,function(p){return h=p},function(p){u.stop(p),h=Oe},function(p){u.fail(p),h=Oe})||a(u.value,u,function(p){return h=p}),h()})})}var cn=(ni.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(b(n))return c(c([],b(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var i=t.remove;if(b(i))return b(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},ni);function ni(e){this["@@propmod"]=e}var ho=(Te.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,qe.bind(null,n.error)):n.table._trans("readonly",e).then(t)},Te.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,qe.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Te.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Ft(t.algorithm,e)},Te.prototype._iterate=function(e,t){return jn(this._ctx,e,t,this._ctx.table.core)},Te.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&j(n,e),t._ctx=n,t},Te.prototype.raw=function(){return this._ctx.valueMapper=null,this},Te.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return jn(t,e,n,t.table.core)})},Te.prototype.count=function(e){var t=this;return this._read(function(n){var i=t._ctx,a=i.table.core;if(Jt(i,!0))return a.count({trans:n,query:{index:Dn(i,a.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var u=0;return jn(i,function(){return++u,!1},n,a).then(function(){return u})}).then(e)},Te.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],a=n.length-1;function u(_,k){return k?u(_[n[k]],k-1):_[i]}var h=this._ctx.dir==="next"?1:-1;function p(_,k){return ke(u(_,a),u(k,a))*h}return this.toArray(function(_){return _.sort(p)}).then(t)},Te.prototype.toArray=function(e){var t=this;return this._read(function(n){var i=t._ctx;if(i.dir==="next"&&Jt(i,!0)&&0<i.limit){var a=i.valueMapper,u=Dn(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(p){return p=p.result,a?p.map(a):p})}var h=[];return jn(i,function(p){return h.push(p)},n,i.table.core).then(function(){return h})},e)},Te.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Jt(t)?hr(t,function(){var n=e;return function(i,a){return n===0||(n===1?--n:a(function(){i.advance(n),n=0}),!1)}}):hr(t,function(){var n=e;return function(){return--n<0}})),this},Te.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),hr(this._ctx,function(){var t=e;return function(n,i,a){return--t<=0&&i(a),0<=t}},!0),this},Te.prototype.until=function(e,t){return dr(this._ctx,function(n,i,a){return!e(n.value)||(i(a),t)}),this},Te.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},Te.prototype.last=function(e){return this.reverse().first(e)},Te.prototype.filter=function(e){var t;return dr(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=Ft(t.isMatch,e),this},Te.prototype.and=function(e){return this.filter(e)},Te.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Te.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Te.prototype.desc=function(){return this.reverse()},Te.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.key,i)})},Te.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Te.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.primaryKey,i)})},Te.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.key)}).then(function(){return n}).then(e)},Te.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Jt(t,!0)&&0<t.limit)return this._read(function(i){var a=Dn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},Te.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Te.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},Te.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Te.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return dr(this._ctx,function(a){var i=a.primaryKey.toString(),a=I(t,i);return t[i]=!0,!a}),this},Te.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(i){var a,u,h;h=typeof e=="function"?e:(a=d(e),u=a.length,function(x){for(var O=!1,P=0;P<u;++P){var D=a[P],K=e[D],N=ae(x,D);K instanceof cn?(ee(x,D,K.execute(N)),O=!0):N!==K&&(ee(x,D,K),O=!0)}return O});var p=n.table.core,v=p.schema.primaryKey,_=v.outbound,k=v.extractKey,C=200,v=t.db._options.modifyChunkSize;v&&(C=typeof v=="object"?v[p.name]||v["*"]||200:v);function E(x,D){var P=D.failures,D=D.numFailures;T+=x-D;for(var K=0,N=d(P);K<N.length;K++){var U=N[K];w.push(P[U])}}var w=[],T=0,S=[];return t.clone().primaryKeys().then(function(x){function O(D){var K=Math.min(C,x.length-D);return p.getMany({trans:i,keys:x.slice(D,D+K),cache:"immutable"}).then(function(N){for(var U=[],q=[],F=_?[]:null,H=[],L=0;L<K;++L){var J=N[L],me={value:be(J),primKey:x[D+L]};h.call(me,me.value,me)!==!1&&(me.value==null?H.push(x[D+L]):_||ke(k(J),k(me.value))===0?(q.push(me.value),_&&F.push(x[D+L])):(H.push(x[D+L]),U.push(me.value)))}return Promise.resolve(0<U.length&&p.mutate({trans:i,type:"add",values:U}).then(function(_e){for(var we in _e.failures)H.splice(parseInt(we),1);E(U.length,_e)})).then(function(){return(0<q.length||P&&typeof e=="object")&&p.mutate({trans:i,type:"put",keys:F,values:q,criteria:P,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<D}).then(function(_e){return E(q.length,_e)})}).then(function(){return(0<H.length||P&&e===pr)&&p.mutate({trans:i,type:"delete",keys:H,criteria:P,isAdditionalChunk:0<D}).then(function(_e){return E(H.length,_e)})}).then(function(){return x.length>D+K&&O(D+C)})})}var P=Jt(n)&&n.limit===1/0&&(typeof e!="function"||e===pr)&&{index:n.index,range:n.range};return O(0).then(function(){if(0<w.length)throw new ge("Error modifying one or more objects",w,T,S);return x.length})})})},Te.prototype.delete=function(){var e=this._ctx,t=e.range;return Jt(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:i,range:a}}).then(function(u){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(h){var p=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new ge("Could not delete some values",Object.keys(p).map(function(_){return p[_]}),u-h);return u-h})})}):this.modify(pr)},Te);function Te(){}var pr=function(e,t){return t.value=null};function po(e,t){return e<t?-1:e===t?0:1}function mo(e,t){return t<e?-1:e===t?0:1}function et(e,t,n){return e=e instanceof ii?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function Zt(e){return new e.Collection(e,function(){return ri("")}).limit(0)}function Kn(e,t,n,i){var a,u,h,p,_,k,C,v=n.length;if(!n.every(function(T){return typeof T=="string"}))return et(e,Gr);function E(T){a=T==="next"?function(x){return x.toUpperCase()}:function(x){return x.toLowerCase()},u=T==="next"?function(x){return x.toLowerCase()}:function(x){return x.toUpperCase()},h=T==="next"?po:mo;var S=n.map(function(x){return{lower:u(x),upper:a(x)}}).sort(function(x,O){return h(x.lower,O.lower)});p=S.map(function(x){return x.upper}),_=S.map(function(x){return x.lower}),C=(k=T)==="next"?"":i}E("next"),e=new e.Collection(e,function(){return wt(p[0],_[v-1]+i)}),e._ondirectionchange=function(T){E(T)};var w=0;return e._addAlgorithm(function(T,S,x){var O=T.key;if(typeof O!="string")return!1;var P=u(O);if(t(P,_,w))return!0;for(var D=null,K=w;K<v;++K){var N=function(U,q,F,H,L,J){for(var me=Math.min(U.length,H.length),_e=-1,we=0;we<me;++we){var tt=q[we];if(tt!==H[we])return L(U[we],F[we])<0?U.substr(0,we)+F[we]+F.substr(we+1):L(U[we],H[we])<0?U.substr(0,we)+H[we]+F.substr(we+1):0<=_e?U.substr(0,_e)+q[_e]+F.substr(_e+1):null;L(U[we],tt)<0&&(_e=we)}return me<H.length&&J==="next"?U+F.substr(U.length):me<U.length&&J==="prev"?U.substr(0,F.length):_e<0?null:U.substr(0,_e)+H[_e]+F.substr(_e+1)}(O,P,p[K],_[K],h,k);N===null&&D===null?w=K+1:(D===null||0<h(D,N))&&(D=N)}return S(D!==null?function(){T.continue(D+C)}:x),!1}),e}function wt(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function ri(e){return{type:1,lower:e,upper:e}}var ii=(Object.defineProperty(Ye.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ye.prototype.between=function(e,t,n,i){n=n!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||i)&&(!n||!i)?Zt(this):new this.Collection(this,function(){return wt(e,t,!n,!i)})}catch{return et(this,pt)}},Ye.prototype.equals=function(e){return e==null?et(this,pt):new this.Collection(this,function(){return ri(e)})},Ye.prototype.above=function(e){return e==null?et(this,pt):new this.Collection(this,function(){return wt(e,void 0,!0)})},Ye.prototype.aboveOrEqual=function(e){return e==null?et(this,pt):new this.Collection(this,function(){return wt(e,void 0,!1)})},Ye.prototype.below=function(e){return e==null?et(this,pt):new this.Collection(this,function(){return wt(void 0,e,!1,!0)})},Ye.prototype.belowOrEqual=function(e){return e==null?et(this,pt):new this.Collection(this,function(){return wt(void 0,e)})},Ye.prototype.startsWith=function(e){return typeof e!="string"?et(this,Gr):this.between(e,e+qt,!0,!0)},Ye.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Kn(this,function(t,n){return t.indexOf(n[0])===0},[e],qt)},Ye.prototype.equalsIgnoreCase=function(e){return Kn(this,function(t,n){return t===n[0]},[e],"")},Ye.prototype.anyOfIgnoreCase=function(){var e=Pe.apply($e,arguments);return e.length===0?Zt(this):Kn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},Ye.prototype.startsWithAnyOfIgnoreCase=function(){var e=Pe.apply($e,arguments);return e.length===0?Zt(this):Kn(this,function(t,n){return n.some(function(i){return t.indexOf(i)===0})},e,qt)},Ye.prototype.anyOf=function(){var e=this,t=Pe.apply($e,arguments),n=this._cmp;try{t.sort(n)}catch{return et(this,pt)}if(t.length===0)return Zt(this);var i=new this.Collection(this,function(){return wt(t[0],t[t.length-1])});i._ondirectionchange=function(u){n=u==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return i._addAlgorithm(function(u,h,p){for(var _=u.key;0<n(_,t[a]);)if(++a===t.length)return h(p),!1;return n(_,t[a])===0||(h(function(){u.continue(t[a])}),!1)}),i},Ye.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ye.prototype.noneOf=function(){var e=Pe.apply($e,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return et(this,pt)}var t=e.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ye.prototype.inAnyRange=function(O,t){var n=this,i=this._cmp,a=this._ascending,u=this._descending,h=this._min,p=this._max;if(O.length===0)return Zt(this);if(!O.every(function(P){return P[0]!==void 0&&P[1]!==void 0&&a(P[0],P[1])<=0}))return et(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var _=!t||t.includeLowers!==!1,k=t&&t.includeUppers===!0,C,v=a;function E(P,D){return v(P[0],D[0])}try{(C=O.reduce(function(P,D){for(var K=0,N=P.length;K<N;++K){var U=P[K];if(i(D[0],U[1])<0&&0<i(D[1],U[0])){U[0]=h(U[0],D[0]),U[1]=p(U[1],D[1]);break}}return K===N&&P.push(D),P},[])).sort(E)}catch{return et(this,pt)}var w=0,T=k?function(P){return 0<a(P,C[w][1])}:function(P){return 0<=a(P,C[w][1])},S=_?function(P){return 0<u(P,C[w][0])}:function(P){return 0<=u(P,C[w][0])},x=T,O=new this.Collection(this,function(){return wt(C[0][0],C[C.length-1][1],!_,!k)});return O._ondirectionchange=function(P){v=P==="next"?(x=T,a):(x=S,u),C.sort(E)},O._addAlgorithm(function(P,D,K){for(var N,U=P.key;x(U);)if(++w===C.length)return D(K),!1;return!T(N=U)&&!S(N)||(n._cmp(U,C[w][1])===0||n._cmp(U,C[w][0])===0||D(function(){v===a?P.continue(C[w][0]):P.continue(C[w][1])}),!1)}),O},Ye.prototype.startsWithAnyOf=function(){var e=Pe.apply($e,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Zt(this):this.inAnyRange(e.map(function(t){return[t,t+qt]})):et(this,"startsWithAnyOf() only works with strings")},Ye);function Ye(){}function ft(e){return je(function(t){return fn(t),e(t.target.error),!1})}function fn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var dn="storagemutated",mr="x-storagemutated-1",kt=un(null,dn),vo=(dt.prototype._lock=function(){return $(!te.global),++this._reculock,this._reculock!==1||te.global||(te.lockOwnerFor=this),this},dt.prototype._unlock=function(){if($(!te.global),--this._reculock==0)for(te.global||(te.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Nt(e[1],e[0])}catch{}}return this},dt.prototype._locked=function(){return this._reculock&&te.lockOwnerFor!==this},dt.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if($(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(i);case"MissingAPIError":throw new ne.MissingAPI(i.message,i);default:throw new ne.OpenFailed(i)}if(!this.active)throw new ne.TransactionInactive;return $(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=je(function(a){fn(a),t._reject(e.error)}),e.onabort=je(function(a){fn(a),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=je(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&kt.storagemutated.fire(e.mutatedParts)}),this},dt.prototype._promise=function(e,t,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return qe(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return qe(new ne.TransactionInactive);if(this._locked())return new G(function(u,h){i._blockedFuncs.push([function(){i._promise(e,t,n).then(u,h)},te])});if(n)return gt(function(){var u=new G(function(h,p){i._lock();var _=t(h,p,i);_&&_.then&&_.then(h,p)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var a=new G(function(u,h){var p=t(u,h,i);p&&p.then&&p.then(u,h)});return a._lib=!0,a},dt.prototype._root=function(){return this.parent?this.parent._root():this},dt.prototype.waitFor=function(e){var t,n=this._root(),i=G.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return i}):(n._waitingFor=i,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=u)}());var a=n._waitingFor;return new G(function(u,h){i.then(function(p){return n._waitingQueue.push(je(u.bind(null,p)))},function(p){return n._waitingQueue.push(je(h.bind(null,p)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},dt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ne.Abort))},dt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(I(t,e))return t[e];var n=this.schema[e];if(!n)throw new ne.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},dt);function dt(){}function vr(e,t,n,i,a,u,h){return{name:e,keyPath:t,unique:n,multi:i,auto:a,compound:u,src:(n&&!h?"&":"")+(i?"*":"")+(a?"++":"")+oi(t)}}function oi(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function yr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},n.reduce(function(a,u,h){return h=i(u,h),h&&(a[h[0]]=h[1]),a},{}))};var i}var hn=function(e){try{return e.only([[]]),hn=function(){return[[]]},[[]]}catch{return hn=function(){return qt},qt}};function gr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return ae(n,t)}:function(n){return ae(n,e)};var t}function ai(e){return[].slice.call(e)}var yo=0;function pn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function go(e,t,_){function i(x){if(x.type===3)return null;if(x.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=x.lower,T=x.upper,S=x.lowerOpen,x=x.upperOpen;return w===void 0?T===void 0?null:t.upperBound(T,!!x):T===void 0?t.lowerBound(w,!!S):t.bound(w,T,!!S,!!x)}function a(E){var w,T=E.name;return{name:T,schema:E,mutate:function(S){var x=S.trans,O=S.type,P=S.keys,D=S.values,K=S.range;return new Promise(function(N,U){N=je(N);var q=x.objectStore(T),F=q.keyPath==null,H=O==="put"||O==="add";if(!H&&O!=="delete"&&O!=="deleteRange")throw new Error("Invalid operation type: "+O);var L,J=(P||D||{length:1}).length;if(P&&D&&P.length!==D.length)throw new Error("Given keys array must have same length as given values array.");if(J===0)return N({numFailures:0,failures:{},results:[],lastResult:void 0});function me(Xe){++tt,fn(Xe)}var _e=[],we=[],tt=0;if(O==="deleteRange"){if(K.type===4)return N({numFailures:tt,failures:we,results:[],lastResult:void 0});K.type===3?_e.push(L=q.clear()):_e.push(L=q.delete(i(K)))}else{var F=H?F?[D,P]:[D,null]:[P,null],pe=F[0],We=F[1];if(H)for(var Ge=0;Ge<J;++Ge)_e.push(L=We&&We[Ge]!==void 0?q[O](pe[Ge],We[Ge]):q[O](pe[Ge])),L.onerror=me;else for(Ge=0;Ge<J;++Ge)_e.push(L=q[O](pe[Ge])),L.onerror=me}function zn(Xe){Xe=Xe.target.result,_e.forEach(function(Vt,Br){return Vt.error!=null&&(we[Br]=Vt.error)}),N({numFailures:tt,failures:we,results:O==="delete"?P:_e.map(function(Vt){return Vt.result}),lastResult:Xe})}L.onerror=function(Xe){me(Xe),zn(Xe)},L.onsuccess=zn})},getMany:function(S){var x=S.trans,O=S.keys;return new Promise(function(P,D){P=je(P);for(var K,N=x.objectStore(T),U=O.length,q=new Array(U),F=0,H=0,L=function(_e){_e=_e.target,q[_e._pos]=_e.result,++H===F&&P(q)},J=ft(D),me=0;me<U;++me)O[me]!=null&&((K=N.get(O[me]))._pos=me,K.onsuccess=L,K.onerror=J,++F);F===0&&P(q)})},get:function(S){var x=S.trans,O=S.key;return new Promise(function(P,D){P=je(P);var K=x.objectStore(T).get(O);K.onsuccess=function(N){return P(N.target.result)},K.onerror=ft(D)})},query:(w=k,function(S){return new Promise(function(x,O){x=je(x);var P,D,K,F=S.trans,N=S.values,U=S.limit,L=S.query,q=U===1/0?void 0:U,H=L.index,L=L.range,F=F.objectStore(T),H=H.isPrimaryKey?F:F.index(H.name),L=i(L);if(U===0)return x({result:[]});w?((q=N?H.getAll(L,q):H.getAllKeys(L,q)).onsuccess=function(J){return x({result:J.target.result})},q.onerror=ft(O)):(P=0,D=!N&&"openKeyCursor"in H?H.openKeyCursor(L):H.openCursor(L),K=[],D.onsuccess=function(J){var me=D.result;return me?(K.push(N?me.value:me.primaryKey),++P===U?x({result:K}):void me.continue()):x({result:K})},D.onerror=ft(O))})}),openCursor:function(S){var x=S.trans,O=S.values,P=S.query,D=S.reverse,K=S.unique;return new Promise(function(N,U){N=je(N);var H=P.index,q=P.range,F=x.objectStore(T),F=H.isPrimaryKey?F:F.index(H.name),H=D?K?"prevunique":"prev":K?"nextunique":"next",L=!O&&"openKeyCursor"in F?F.openKeyCursor(i(q),H):F.openCursor(i(q),H);L.onerror=ft(U),L.onsuccess=je(function(J){var me,_e,we,tt,pe=L.result;pe?(pe.___id=++yo,pe.done=!1,me=pe.continue.bind(pe),_e=(_e=pe.continuePrimaryKey)&&_e.bind(pe),we=pe.advance.bind(pe),tt=function(){throw new Error("Cursor not stopped")},pe.trans=x,pe.stop=pe.continue=pe.continuePrimaryKey=pe.advance=function(){throw new Error("Cursor not started")},pe.fail=je(U),pe.next=function(){var We=this,Ge=1;return this.start(function(){return Ge--?We.continue():We.stop()}).then(function(){return We})},pe.start=function(We){function Ge(){if(L.result)try{We()}catch(Xe){pe.fail(Xe)}else pe.done=!0,pe.start=function(){throw new Error("Cursor behind last entry")},pe.stop()}var zn=new Promise(function(Xe,Vt){Xe=je(Xe),L.onerror=ft(Vt),pe.fail=Vt,pe.stop=function(Br){pe.stop=pe.continue=pe.continuePrimaryKey=pe.advance=tt,Xe(Br)}});return L.onsuccess=je(function(Xe){L.onsuccess=Ge,Ge()}),pe.continue=me,pe.continuePrimaryKey=_e,pe.advance=we,Ge(),zn},N(pe)):N(null)},U)})},count:function(S){var x=S.query,O=S.trans,P=x.index,D=x.range;return new Promise(function(K,N){var U=O.objectStore(T),q=P.isPrimaryKey?U:U.index(P.name),U=i(D),q=U?q.count(U):q.count();q.onsuccess=je(function(F){return K(F.target.result)}),q.onerror=ft(N)})}}}var u,h,p,C=(h=_,p=ai((u=e).objectStoreNames),{schema:{name:u.name,tables:p.map(function(E){return h.objectStore(E)}).map(function(E){var w=E.keyPath,x=E.autoIncrement,T=b(w),S={},x={name:E.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w==null,compound:T,keyPath:w,autoIncrement:x,unique:!0,extractKey:gr(w)},indexes:ai(E.indexNames).map(function(O){return E.index(O)}).map(function(K){var P=K.name,D=K.unique,N=K.multiEntry,K=K.keyPath,N={name:P,compound:b(K),keyPath:K,unique:D,multiEntry:N,extractKey:gr(K)};return S[pn(K)]=N}),getIndexByKeyPath:function(O){return S[pn(O)]}};return S[":id"]=x.primaryKey,w!=null&&(S[pn(w)]=x.primaryKey),x})},hasGetAll:0<p.length&&"getAll"in h.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),_=C.schema,k=C.hasGetAll,C=_.tables.map(a),v={};return C.forEach(function(E){return v[E.name]=E}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(E){if(!v[E])throw new Error("Table '".concat(E,"' not found"));return v[E]},MIN_KEY:-1/0,MAX_KEY:hn(t),schema:_}}function bo(e,t,n,i){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(i=go(t,a,i),e.dbcore.reduce(function(u,h){return h=h.create,o(o({},u),h(u))},i))}}function Rn(e,i){var n=i.db,i=bo(e._middlewares,n,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var u=a.name;e.core.schema.tables.some(function(h){return h.name===u})&&(a.core=e.core.table(u),e[u]instanceof e.Table&&(e[u].core=a.core))})}function An(e,t,n,i){n.forEach(function(a){var u=i[a];t.forEach(function(h){var p=function _(k,C){return de(k,C)||(k=g(k))&&_(k,C)}(h,a);(!p||"value"in p&&p.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?Y(h,a,{get:function(){return this.table(a)},set:function(_){A(this,a,{value:_,writable:!0,configurable:!0,enumerable:!0})}}):h[a]=new e.Table(a,u))})})}function br(e,t){t.forEach(function(n){for(var i in n)n[i]instanceof e.Table&&delete n[i]})}function _o(e,t){return e._cfg.version-t._cfg.version}function wo(e,t,n,i){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=yr("$meta",ui("")[0],[]),e._storeNames.push("$meta"));var u=e._createTransaction("readwrite",e._storeNames,a);u.create(n),u._completion.catch(i);var h=u._reject.bind(u),p=te.transless||te;gt(function(){return te.trans=u,te.transless=p,t!==0?(Rn(e,n),k=t,((_=u).storeNames.includes("$meta")?_.table("$meta").get("version").then(function(C){return C??k}):G.resolve(k)).then(function(C){return E=C,w=u,T=n,S=[],C=(v=e)._versions,x=v._dbSchema=Mn(0,v.idbdb,T),(C=C.filter(function(O){return O._cfg.version>=E})).length!==0?(C.forEach(function(O){S.push(function(){var P=x,D=O._cfg.dbschema;Nn(v,P,T),Nn(v,D,T),x=v._dbSchema=D;var K=_r(P,D);K.add.forEach(function(H){wr(T,H[0],H[1].primKey,H[1].indexes)}),K.change.forEach(function(H){if(H.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var L=T.objectStore(H.name);H.add.forEach(function(J){return Bn(L,J)}),H.change.forEach(function(J){L.deleteIndex(J.name),Bn(L,J)}),H.del.forEach(function(J){return L.deleteIndex(J)})});var N=O._cfg.contentUpgrade;if(N&&O._cfg.version>E){Rn(v,T),w._memoizedTables={};var U=z(D);K.del.forEach(function(H){U[H]=P[H]}),br(v,[v.Transaction.prototype]),An(v,[v.Transaction.prototype],d(U),U),w.schema=U;var q,F=ut(N);return F&&Xt(),K=G.follow(function(){var H;(q=N(w))&&F&&(H=bt.bind(null,null),q.then(H,H))}),q&&typeof q.then=="function"?G.resolve(q):K.then(function(){return q})}}),S.push(function(P){var D,K,N=O._cfg.dbschema;D=N,K=P,[].slice.call(K.db.objectStoreNames).forEach(function(U){return D[U]==null&&K.db.deleteObjectStore(U)}),br(v,[v.Transaction.prototype]),An(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),w.schema=v._dbSchema}),S.push(function(P){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===O._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(D){return D!=="$meta"})):P.objectStore("$meta").put(O._cfg.version,"version"))})}),function O(){return S.length?G.resolve(S.shift()(w.idbtrans)).then(O):G.resolve()}().then(function(){si(x,T)})):G.resolve();var v,E,w,T,S,x}).catch(h)):(d(a).forEach(function(C){wr(n,C,a[C].primKey,a[C].indexes)}),Rn(e,n),void G.follow(function(){return e.on.populate.fire(u)}).catch(h));var _,k})}function ko(e,t){si(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Mn(0,e.idbdb,t);Nn(e,e._dbSchema,t);for(var i=0,a=_r(n,e._dbSchema).change;i<a.length;i++){var u=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var p=t.objectStore(h.name);h.add.forEach(function(_){ct&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(_.src)),Bn(p,_)})}(a[i]);if(typeof u=="object")return u.value}}function _r(e,t){var n,i={del:[],add:[],change:[]};for(n in e)t[n]||i.del.push(n);for(n in t){var a=e[n],u=t[n];if(a){var h={name:n,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||a.primKey.auto!==u.primKey.auto)h.recreate=!0,i.change.push(h);else{var p=a.idxByName,_=u.idxByName,k=void 0;for(k in p)_[k]||h.del.push(k);for(k in _){var C=p[k],v=_[k];C?C.src!==v.src&&h.change.push(v):h.add.push(v)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([n,u])}return i}function wr(e,t,n,i){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(u){return Bn(a,u)}),a}function si(e,t){d(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(ct&&console.debug("Dexie: Creating missing table",n),wr(t,n,e[n].primKey,e[n].indexes))})}function Bn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Mn(e,t,n){var i={};return Z(t.objectStoreNames,0).forEach(function(a){for(var u=n.objectStore(a),h=vr(oi(k=u.keyPath),k||"",!0,!1,!!u.autoIncrement,k&&typeof k!="string",!0),p=[],_=0;_<u.indexNames.length;++_){var C=u.index(u.indexNames[_]),k=C.keyPath,C=vr(C.name,k,!!C.unique,!!C.multiEntry,!1,k&&typeof k!="string",!1);p.push(C)}i[a]=yr(a,h,p)}),i}function Nn(e,t,n){for(var i=n.db.objectStoreNames,a=0;a<i.length;++a){var u=i[a],h=n.objectStore(u);e._hasGetAll="getAll"in h;for(var p=0;p<h.indexNames.length;++p){var _=h.indexNames[p],k=h.index(_).keyPath,C=typeof k=="string"?k:"["+Z(k).join("+")+"]";!t[u]||(k=t[u].idxByName[C])&&(k.name=_,delete t[u].idxByName[C],t[u].idxByName[_]=k)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function ui(e){return e.split(",").map(function(t,n){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return vr(i,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),b(a),n===0)})}var xo=(qn.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(n){if(e[n]!==null){var i=ui(e[n]),a=i.shift();if(a.unique=!0,a.multi)throw new ne.Schema("Primary key cannot be multi-valued");i.forEach(function(u){if(u.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!u.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")}),t[n]=yr(n,a,i)}})},qn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?j(this._cfg.storesSource,n):n;var n=t._versions,i={},a={};return n.forEach(function(u){j(i,u._cfg.storesSource),a=u._cfg.dbschema={},u._parseStoresSpec(i,a)}),t._dbSchema=a,br(t,[t._allTables,t,t.Transaction.prototype]),An(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},qn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=tr(this._cfg.contentUpgrade||Oe,e),this},qn);function qn(){}function kr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new mt(On,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function xr(e){return e&&typeof e.databases=="function"}function Tr(e){return gt(function(){return te.letThrough=!0,e()})}function Cr(e){return!("from"in e)}var ze=function(e,t){if(!this){var n=new ze;return e&&"d"in e&&j(n,e),n}j(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function mn(e,t,n){var i=ke(t,n);if(!isNaN(i)){if(0<i)throw RangeError();if(Cr(e))return j(e,{from:t,to:n,d:1});var a=e.l,i=e.r;if(ke(n,e.from)<0)return a?mn(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},ci(e);if(0<ke(t,e.to))return i?mn(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},ci(e);ke(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<ke(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&vn(e,a),i&&n&&vn(e,i)}}function vn(e,t){Cr(t)||function n(i,_){var u=_.from,h=_.to,p=_.l,_=_.r;mn(i,u,h),p&&n(i,p),_&&n(i,_)}(e,t)}function li(e,t){var n=Fn(t),i=n.next();if(i.done)return!1;for(var a=i.value,u=Fn(e),h=u.next(a.from),p=h.value;!i.done&&!h.done;){if(ke(p.from,a.to)<=0&&0<=ke(p.to,a.from))return!0;ke(a.from,p.from)<0?a=(i=n.next(p.from)).value:p=(h=u.next(a.from)).value}return!1}function Fn(e){var t=Cr(e)?null:{s:0,n:e};return{next:function(n){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&ke(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||ke(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function ci(e){var t,n,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",n=o({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],n[a]=i[t],(e[t]=n).d=fi(n)),e.d=fi(e)}function fi(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Ln(e,t){return d(t).forEach(function(n){e[n]?vn(e[n],t[n]):e[n]=function i(a){var u,h,p={};for(u in a)I(a,u)&&(h=a[u],p[u]=!h||typeof h!="object"||Qe.has(h.constructor)?h:i(h));return p}(t[n])}),e}function Sr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&li(t[n],e[n])})}y(ze.prototype,((ot={add:function(e){return vn(this,e),this},addKey:function(e){return mn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return mn(t,n,n)}),this},hasKey:function(e){var t=Fn(this).next(e).value;return t&&ke(t.from,e)<=0&&0<=ke(t.to,e)}})[Se]=function(){return Fn(this)},ot));var Lt={},Er={},Ir=!1;function Un(e){Ln(Er,e),Ir||(Ir=!0,setTimeout(function(){Ir=!1,Or(Er,!(Er={}))},0))}function Or(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var i=0,a=Object.values(Lt);i<a.length;i++)di(h=a[i],e,n,t);else for(var u in e){var h,p=/^idb\:\/\/(.*)\/(.*)\//.exec(u);p&&(u=p[1],p=p[2],(h=Lt["idb://".concat(u,"/").concat(p)])&&di(h,e,n,t))}n.forEach(function(_){return _()})}function di(e,t,n,i){for(var a=[],u=0,h=Object.entries(e.queries.query);u<h.length;u++){for(var p=h[u],_=p[0],k=[],C=0,v=p[1];C<v.length;C++){var E=v[C];Sr(t,E.obsSet)?E.subscribers.forEach(function(x){return n.add(x)}):i&&k.push(E)}i&&a.push([_,k])}if(i)for(var w=0,T=a;w<T.length;w++){var S=T[w],_=S[0],k=S[1];e.queries.query[_]=k}}function To(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?qe(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),u=!1;function h(){if(t.openCanceller!==i)throw new ne.DatabaseClosed("db.open() was cancelled")}function p(){return new G(function(E,w){if(h(),!n)throw new ne.MissingAPI;var T=e.name,S=t.autoSchema||!a?n.open(T):n.open(T,a);if(!S)throw new ne.MissingAPI;S.onerror=ft(w),S.onblocked=je(e._fireOnBlocked),S.onupgradeneeded=je(function(x){var O;C=S.transaction,t.autoSchema&&!e._options.allowEmptyDB?(S.onerror=fn,C.abort(),S.result.close(),(O=n.deleteDatabase(T)).onsuccess=O.onerror=je(function(){w(new ne.NoSuchDatabase("Database ".concat(T," doesnt exist")))})):(C.onerror=ft(w),x=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,v=x<1,e.idbdb=S.result,u&&ko(e,C),wo(e,x/10,C,w))},w),S.onsuccess=je(function(){C=null;var x,O,P,D,K,N=e.idbdb=S.result,U=Z(N.objectStoreNames);if(0<U.length)try{var q=N.transaction((D=U).length===1?D[0]:D,"readonly");if(t.autoSchema)O=N,P=q,(x=e).verno=O.version/10,P=x._dbSchema=Mn(0,O,P),x._storeNames=Z(O.objectStoreNames,0),An(x,[x._allTables],d(P),P);else if(Nn(e,e._dbSchema,q),((K=_r(Mn(0,(K=e).idbdb,q),K._dbSchema)).add.length||K.change.some(function(F){return F.add.length||F.change.length}))&&!u)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),N.close(),a=N.version+1,u=!0,E(p());Rn(e,q)}catch{}Qt.push(e),N.onversionchange=je(function(F){t.vcFired=!0,e.on("versionchange").fire(F)}),N.onclose=je(function(F){e.on("close").fire(F)}),v&&(K=e._deps,q=T,N=K.indexedDB,K=K.IDBKeyRange,xr(N)||q===On||kr(N,K).put({name:q}).catch(Oe)),E()},w)}).catch(function(E){switch(E==null?void 0:E.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),p();break;case"VersionError":if(0<a)return a=0,p()}return G.reject(E)})}var _,k=t.dbReadyResolve,C=null,v=!1;return G.race([i,(typeof navigator>"u"?G.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(E){function w(){return indexedDB.databases().finally(E)}_=setInterval(w,100),w()}).finally(function(){return clearInterval(_)}):Promise.resolve()).then(p)]).then(function(){return h(),t.onReadyBeingFired=[],G.resolve(Tr(function(){return e.on.ready.fire(e.vip)})).then(function E(){if(0<t.onReadyBeingFired.length){var w=t.onReadyBeingFired.reduce(tr,Oe);return t.onReadyBeingFired=[],G.resolve(Tr(function(){return w(e.vip)})).then(E)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(E){t.dbOpenError=E;try{C&&C.abort()}catch{}return i===t.openCanceller&&e._close(),qe(E)}).finally(function(){t.openComplete=!0,k()}).then(function(){var E;return v&&(E={},e.tables.forEach(function(w){w.schema.indexes.forEach(function(T){T.name&&(E["idb://".concat(e.name,"/").concat(w.name,"/").concat(T.name)]=new ze(-1/0,[[[]]]))}),E["idb://".concat(e.name,"/").concat(w.name,"/")]=E["idb://".concat(e.name,"/").concat(w.name,"/:dels")]=new ze(-1/0,[[[]]])}),kt(dn).fire(E),Or(E,!0)),e})}function Pr(e){function t(u){return e.next(u)}var n=a(t),i=a(function(u){return e.throw(u)});function a(u){return function(_){var p=u(_),_=p.value;return p.done?_:_&&typeof _.then=="function"?_.then(n,i):b(_)?Promise.all(_).then(n,i):n(_)}}return a(t)()}function Vn(e,t,n){for(var i=b(e)?e.slice():[e],a=0;a<n;++a)i.push(t);return i}var Co={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema,a={},u=[];function h(v,E,w){var T=pn(v),S=a[T]=a[T]||[],x=v==null?0:typeof v=="string"?1:v.length,O=0<E,O=o(o({},w),{name:O?"".concat(T,"(virtual-from:").concat(w.name,")"):w.name,lowLevelIndex:w,isVirtual:O,keyTail:E,keyLength:x,extractKey:gr(v),unique:!O&&w.unique});return S.push(O),O.isPrimaryKey||u.push(O),1<x&&h(x===2?v[0]:v.slice(0,x-1),E+1,w),S.sort(function(P,D){return P.keyTail-D.keyTail}),O}t=h(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var p=0,_=i.indexes;p<_.length;p++){var k=_[p];h(k.keyPath,0,k)}function C(v){var E,w=v.query.index;return w.isVirtual?o(o({},v),{query:{index:w.lowLevelIndex,range:(E=v.query.range,w=w.keyTail,{type:E.type===1?2:E.type,lower:Vn(E.lower,E.lowerOpen?e.MAX_KEY:e.MIN_KEY,w),lowerOpen:!0,upper:Vn(E.upper,E.upperOpen?e.MIN_KEY:e.MAX_KEY,w),upperOpen:!0})}}):v}return o(o({},n),{schema:o(o({},i),{primaryKey:t,indexes:u,getIndexByKeyPath:function(v){return(v=a[pn(v)])&&v[0]}}),count:function(v){return n.count(C(v))},query:function(v){return n.query(C(v))},openCursor:function(v){var E=v.query.index,w=E.keyTail,T=E.isVirtual,S=E.keyLength;return T?n.openCursor(C(v)).then(function(O){return O&&x(O)}):n.openCursor(v);function x(O){return Object.create(O,{continue:{value:function(P){P!=null?O.continue(Vn(P,v.reverse?e.MAX_KEY:e.MIN_KEY,w)):v.unique?O.continue(O.key.slice(0,S).concat(v.reverse?e.MIN_KEY:e.MAX_KEY,w)):O.continue()}},continuePrimaryKey:{value:function(P,D){O.continuePrimaryKey(Vn(P,e.MAX_KEY,w),D)}},primaryKey:{get:function(){return O.primaryKey}},key:{get:function(){var P=O.key;return S===1?P[0]:P.slice(0,S)}},value:{get:function(){return O.value}}})}}})}})}};function Dr(e,t,n,i){return n=n||{},i=i||"",d(e).forEach(function(a){var u,h,p;I(t,a)?(u=e[a],h=t[a],typeof u=="object"&&typeof h=="object"&&u&&h?(p=Ze(u))!==Ze(h)?n[i+a]=t[a]:p==="Object"?Dr(u,h,n,i+a+"."):u!==h&&(n[i+a]=t[a]):u!==h&&(n[i+a]=t[a])):n[i+a]=void 0}),d(t).forEach(function(a){I(e,a)||(n[i+a]=t[a])}),n}function jr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var So={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return o(o({},n),{mutate:function(a){var u=te.trans,h=u.table(t).hook,p=h.deleting,_=h.creating,k=h.updating;switch(a.type){case"add":if(_.fire===Oe)break;return u._promise("readwrite",function(){return C(a)},!0);case"put":if(_.fire===Oe&&k.fire===Oe)break;return u._promise("readwrite",function(){return C(a)},!0);case"delete":if(p.fire===Oe)break;return u._promise("readwrite",function(){return C(a)},!0);case"deleteRange":if(p.fire===Oe)break;return u._promise("readwrite",function(){return function v(E,w,T){return n.query({trans:E,values:!1,query:{index:i,range:w},limit:T}).then(function(S){var x=S.result;return C({type:"delete",keys:x,trans:E}).then(function(O){return 0<O.numFailures?Promise.reject(O.failures[0]):x.length<T?{failures:[],numFailures:0,lastResult:void 0}:v(E,o(o({},w),{lower:x[x.length-1],lowerOpen:!0}),T)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function C(v){var E,w,T,S=te.trans,x=v.keys||jr(i,v);if(!x)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?o(o({},v),{keys:x}):o({},v)).type!=="delete"&&(v.values=c([],v.values)),v.keys&&(v.keys=c([],v.keys)),E=n,T=x,((w=v).type==="add"?Promise.resolve([]):E.getMany({trans:w.trans,keys:T,cache:"immutable"})).then(function(O){var P=x.map(function(D,K){var N,U,q,F=O[K],H={onerror:null,onsuccess:null};return v.type==="delete"?p.fire.call(H,D,F,S):v.type==="add"||F===void 0?(N=_.fire.call(H,D,v.values[K],S),D==null&&N!=null&&(v.keys[K]=D=N,i.outbound||ee(v.values[K],i.keyPath,D))):(N=Dr(F,v.values[K]),(U=k.fire.call(H,N,D,F,S))&&(q=v.values[K],Object.keys(U).forEach(function(L){I(q,L)?q[L]=U[L]:ee(q,L,U[L])}))),H});return n.mutate(v).then(function(D){for(var K=D.failures,N=D.results,U=D.numFailures,D=D.lastResult,q=0;q<x.length;++q){var F=(N||x)[q],H=P[q];F==null?H.onerror&&H.onerror(K[q]):H.onsuccess&&H.onsuccess(v.type==="put"&&O[q]?v.values[q]:F)}return{failures:K,results:N,numFailures:U,lastResult:D}}).catch(function(D){return P.forEach(function(K){return K.onerror&&K.onerror(D)}),Promise.reject(D)})})}}})}})}};function hi(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,u=0;a<t.keys.length&&u<e.length;++a)ke(t.keys[a],e[u])===0&&(i.push(n?be(t.values[a]):t.values[a]),++u);return i.length===e.length?i:null}catch{return null}}var Eo={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return o(o({},n),{getMany:function(i){if(!i.cache)return n.getMany(i);var a=hi(i.keys,i.trans._cache,i.cache==="clone");return a?G.resolve(a):n.getMany(i).then(function(u){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?be(u):u},u})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),n.mutate(i)}})}}}};function pi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function mi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Io={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new ze(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,a,u){if(te.subscr&&a!=="readonly")throw new ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(te.querier));return e.transaction(i,a,u)},table:function(i){var a=e.table(i),u=a.schema,h=u.primaryKey,v=u.indexes,p=h.extractKey,_=h.outbound,k=h.autoIncrement&&v.filter(function(w){return w.compound&&w.keyPath.includes(h.keyPath)}),C=o(o({},a),{mutate:function(w){function T(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),D[L]||(D[L]=new ze)}var S,x,O,P=w.trans,D=w.mutatedParts||(w.mutatedParts={}),K=T(""),N=T(":dels"),U=w.type,H=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[jr(h,w).filter(function(L){return L}),w.values]:[],q=H[0],F=H[1],H=w.trans._cache;return b(q)?(K.addKeys(q),(H=U==="delete"||q.length===F.length?hi(q,H):null)||N.addKeys(q),(H||F)&&(S=T,x=H,O=F,u.indexes.forEach(function(L){var J=S(L.name||"");function me(we){return we!=null?L.extractKey(we):null}function _e(we){return L.multiEntry&&b(we)?we.forEach(function(tt){return J.addKey(tt)}):J.addKey(we)}(x||O).forEach(function(we,We){var pe=x&&me(x[We]),We=O&&me(O[We]);ke(pe,We)!==0&&(pe!=null&&_e(pe),We!=null&&_e(We))})}))):q?(F={from:(F=q.lower)!==null&&F!==void 0?F:e.MIN_KEY,to:(F=q.upper)!==null&&F!==void 0?F:e.MAX_KEY},N.add(F),K.add(F)):(K.add(n),N.add(n),u.indexes.forEach(function(L){return T(L.name).add(n)})),a.mutate(w).then(function(L){return!q||w.type!=="add"&&w.type!=="put"||(K.addKeys(L.results),k&&k.forEach(function(J){for(var me=w.values.map(function(pe){return J.extractKey(pe)}),_e=J.keyPath.findIndex(function(pe){return pe===h.keyPath}),we=0,tt=L.results.length;we<tt;++we)me[we][_e]=L.results[we];T(J.name).addKeys(me)})),P.mutatedParts=Ln(P.mutatedParts||{},D),L})}}),v=function(T){var S=T.query,T=S.index,S=S.range;return[T,new ze((T=S.lower)!==null&&T!==void 0?T:e.MIN_KEY,(S=S.upper)!==null&&S!==void 0?S:e.MAX_KEY)]},E={get:function(w){return[h,new ze(w.key)]},getMany:function(w){return[h,new ze().addKeys(w.keys)]},count:v,query:v,openCursor:v};return d(E).forEach(function(w){C[w]=function(T){var S=te.subscr,x=!!S,O=pi(te,a)&&mi(w,T)?T.obsSet={}:S;if(x){var P=function(F){return F="idb://".concat(t,"/").concat(i,"/").concat(F),O[F]||(O[F]=new ze)},D=P(""),K=P(":dels"),S=E[w](T),x=S[0],S=S[1];if((w==="query"&&x.isPrimaryKey&&!T.values?K:P(x.name||"")).add(S),!x.isPrimaryKey){if(w!=="count"){var N=w==="query"&&_&&T.values&&a.query(o(o({},T),{values:!1}));return a[w].apply(this,arguments).then(function(F){if(w==="query"){if(_&&T.values)return N.then(function(me){return me=me.result,D.addKeys(me),F});var H=T.values?F.result.map(p):F.result;(T.values?D:K).addKeys(H)}else if(w==="openCursor"){var L=F,J=T.values;return L&&Object.create(L,{key:{get:function(){return K.addKey(L.primaryKey),L.key}},primaryKey:{get:function(){var me=L.primaryKey;return K.addKey(me),me}},value:{get:function(){return J&&D.addKey(L.primaryKey),L.value}}})}return F})}K.add(n)}}return a[w].apply(this,arguments)}}),C}})}};function vi(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===i?null:(t=o({},t),b(t.keys)&&(t.keys=t.keys.filter(function(a,u){return!(u in n.failures)})),"values"in t&&b(t.values)&&(t.values=t.values.filter(function(a,u){return!(u in n.failures)})),t)}function Kr(e,t){return n=e,((i=t).lower===void 0||(i.lowerOpen?0<ke(n,i.lower):0<=ke(n,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ke(e,t.upper)<0:ke(e,t.upper)<=0));var n,i}function yi(e,t,E,i,a,u){if(!E||E.length===0)return e;var h=t.query.index,p=h.multiEntry,_=t.query.range,k=i.schema.primaryKey.extractKey,C=h.extractKey,v=(h.lowLevelIndex||h).extractKey,E=E.reduce(function(w,T){var S=w,x=[];if(T.type==="add"||T.type==="put")for(var O=new ze,P=T.values.length-1;0<=P;--P){var D,K=T.values[P],N=k(K);O.hasKey(N)||(D=C(K),(p&&b(D)?D.some(function(L){return Kr(L,_)}):Kr(D,_))&&(O.addKey(N),x.push(K)))}switch(T.type){case"add":var U=new ze().addKeys(t.values?w.map(function(J){return k(J)}):w),S=w.concat(t.values?x.filter(function(J){return J=k(J),!U.hasKey(J)&&(U.addKey(J),!0)}):x.map(function(J){return k(J)}).filter(function(J){return!U.hasKey(J)&&(U.addKey(J),!0)}));break;case"put":var q=new ze().addKeys(T.values.map(function(J){return k(J)}));S=w.filter(function(J){return!q.hasKey(t.values?k(J):J)}).concat(t.values?x:x.map(function(J){return k(J)}));break;case"delete":var F=new ze().addKeys(T.keys);S=w.filter(function(J){return!F.hasKey(t.values?k(J):J)});break;case"deleteRange":var H=T.range;S=w.filter(function(J){return!Kr(k(J),H)})}return S},e);return E===e?e:(E.sort(function(w,T){return ke(v(w),v(T))||ke(k(w),k(T))}),t.limit&&t.limit<1/0&&(E.length>t.limit?E.length=t.limit:e.length===t.limit&&E.length<t.limit&&(a.dirty=!0)),u?Object.freeze(E):E)}function gi(e,t){return ke(e.lower,t.lower)===0&&ke(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Oo(e,t){return function(n,i,a,u){if(n===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=ke(n,i))===0){if(a&&u)return 0;if(a)return 1;if(u)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,i,a,u){if(n===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=ke(n,i))===0){if(a&&u)return 0;if(a)return-1;if(u)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Po(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",function(){var a,u;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,u=t,setTimeout(function(){a.subscribers.size===0&&st(u,a)},3e3))})}var Do={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(n,i,a){var u,h,p=e.transaction(n,i,a);return i==="readwrite"&&(h=(u=new AbortController).signal,a=function(_){return function(){if(u.abort(),i==="readwrite"){for(var k=new Set,C=0,v=n;C<v.length;C++){var E=v[C],w=Lt["idb://".concat(t,"/").concat(E)];if(w){var T=e.table(E),S=w.optimisticOps.filter(function(J){return J.trans===p});if(p._explicit&&_&&p.mutatedParts)for(var x=0,O=Object.values(w.queries.query);x<O.length;x++)for(var P=0,D=(U=O[x]).slice();P<D.length;P++)Sr((q=D[P]).obsSet,p.mutatedParts)&&(st(U,q),q.subscribers.forEach(function(J){return k.add(J)}));else if(0<S.length){w.optimisticOps=w.optimisticOps.filter(function(J){return J.trans!==p});for(var K=0,N=Object.values(w.queries.query);K<N.length;K++)for(var U,q,F,H=0,L=(U=N[K]).slice();H<L.length;H++)(q=L[H]).res!=null&&p.mutatedParts&&(_&&!q.dirty?(F=Object.isFrozen(q.res),F=yi(q.res,q.req,S,T,q,F),q.dirty?(st(U,q),q.subscribers.forEach(function(J){return k.add(J)})):F!==q.res&&(q.res=F,q.promise=G.resolve({result:F}))):(q.dirty&&st(U,q),q.subscribers.forEach(function(J){return k.add(J)})))}}}k.forEach(function(J){return J()})}}},p.addEventListener("abort",a(!1),{signal:h}),p.addEventListener("error",a(!1),{signal:h}),p.addEventListener("complete",a(!0),{signal:h})),p},table:function(n){var i=e.table(n),a=i.schema.primaryKey;return o(o({},i),{mutate:function(u){var h=te.trans;if(a.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(u);var p=Lt["idb://".concat(t,"/").concat(n)];return p?(h=i.mutate(u),u.type!=="add"&&u.type!=="put"||!(50<=u.values.length||jr(a,u).some(function(_){return _==null}))?(p.optimisticOps.push(u),u.mutatedParts&&Un(u.mutatedParts),h.then(function(_){0<_.numFailures&&(st(p.optimisticOps,u),(_=vi(0,u,_))&&p.optimisticOps.push(_),u.mutatedParts&&Un(u.mutatedParts))}),h.catch(function(){st(p.optimisticOps,u),u.mutatedParts&&Un(u.mutatedParts)})):h.then(function(_){var k=vi(0,o(o({},u),{values:u.values.map(function(C,v){var E;return _.failures[v]?C:(C=(E=a.keyPath)!==null&&E!==void 0&&E.includes(".")?be(C):o({},C),ee(C,a.keyPath,_.results[v]),C)})}),_);p.optimisticOps.push(k),queueMicrotask(function(){return u.mutatedParts&&Un(u.mutatedParts)})}),h):i.mutate(u)},query:function(u){if(!pi(te,i)||!mi("query",u))return i.query(u);var h=((k=te.trans)===null||k===void 0?void 0:k.db._options.cache)==="immutable",v=te,p=v.requery,_=v.signal,k=function(T,S,x,O){var P=Lt["idb://".concat(T,"/").concat(S)];if(!P)return[];if(!(S=P.queries[x]))return[null,!1,P,null];var D=S[(O.query?O.query.index.name:null)||""];if(!D)return[null,!1,P,null];switch(x){case"query":var K=D.find(function(N){return N.req.limit===O.limit&&N.req.values===O.values&&gi(N.req.query.range,O.query.range)});return K?[K,!0,P,D]:[D.find(function(N){return("limit"in N.req?N.req.limit:1/0)>=O.limit&&(!O.values||N.req.values)&&Oo(N.req.query.range,O.query.range)}),!1,P,D];case"count":return K=D.find(function(N){return gi(N.req.query.range,O.query.range)}),[K,!!K,P,D]}}(t,n,"query",u),C=k[0],v=k[1],E=k[2],w=k[3];return C&&v?C.obsSet=u.obsSet:(v=i.query(u).then(function(T){var S=T.result;if(C&&(C.res=S),h){for(var x=0,O=S.length;x<O;++x)Object.freeze(S[x]);Object.freeze(S)}else T.result=be(S);return T}).catch(function(T){return w&&C&&st(w,C),Promise.reject(T)}),C={obsSet:u.obsSet,promise:v,subscribers:new Set,type:"query",req:u,dirty:!1},w?w.push(C):(w=[C],(E=E||(Lt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[u.query.index.name||""]=w)),Po(C,w,p,_),C.promise.then(function(T){return{result:yi(T.result,u,E==null?void 0:E.optimisticOps,i,C,h)}})}})}})}};function Yn(e,t){return new Proxy(e,{get:function(n,i,a){return i==="db"?t:Reflect.get(n,i,a)}})}var mt=(Fe.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(i){return i._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(_o),n.stores({}),this._state.autoSchema=!1,n)},Fe.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||te.letThrough||this._vip)?e():new G(function(n,i){if(t._state.openComplete)return i(new ne.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new ne.DatabaseClosed);t.open().catch(Oe)}t._state.dbReadyPromise.then(n,i)}).then(e)},Fe.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:i??10,name:a}),e.sort(function(u,h){return u.level-h.level}),this},Fe.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!n&&a.name!==n})),this},Fe.prototype.open=function(){var e=this;return Nt(yt,function(){return To(e)})},Fe.prototype._close=function(){var e=this._state,t=Qt.indexOf(this);if(0<=t&&Qt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new G(function(n){e.dbReadyResolve=n}),e.openCanceller=new G(function(n,i){e.cancelOpen=i}))},Fe.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new ne.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new ne.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Fe.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new G(function(a,u){function h(){t.close(e);var p=t._deps.indexedDB.deleteDatabase(t.name);p.onsuccess=je(function(){var _,k,C;_=t._deps,k=t.name,C=_.indexedDB,_=_.IDBKeyRange,xr(C)||k===On||kr(C,_).delete(k).catch(Oe),a()}),p.onerror=ft(u),p.onblocked=t._fireOnBlocked}if(n)throw new ne.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Fe.prototype.backendDB=function(){return this.idbdb},Fe.prototype.isOpen=function(){return this.idbdb!==null},Fe.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Fe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Fe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Fe.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Fe.prototype.transaction=function(){var e=(function(t,n,i){var a=arguments.length;if(a<2)throw new ne.InvalidArgument("Too few arguments");for(var u=new Array(a-1);--a;)u[a-1]=arguments[a];return i=u.pop(),[t,Ie(u),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Fe.prototype._transaction=function(e,t,n){var i=this,a=te.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var u,h,p=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(k){if(k=k instanceof i.Table?k.name:k,typeof k!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return k}),e=="r"||e===cr)u=cr;else{if(e!="rw"&&e!=fr)throw new ne.InvalidArgument("Invalid transaction mode: "+e);u=fr}if(a){if(a.mode===cr&&u===fr){if(!p)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&h.forEach(function(k){if(a&&a.storeNames.indexOf(k)===-1){if(!p)throw new ne.SubTransaction("Table "+k+" not included in parent transaction.");a=null}}),p&&a&&!a.active&&(a=null)}}catch(k){return a?a._promise(null,function(C,v){v(k)}):qe(k)}var _=(function k(C,v,E,w,T){return G.resolve().then(function(){var S=te.transless||te,x=C._createTransaction(v,E,C._dbSchema,w);if(x.explicit=!0,S={trans:x,transless:S},w)x.idbtrans=w.idbtrans;else try{x.create(),x.idbtrans._explicit=!0,C._state.PR1398_maxLoop=3}catch(D){return D.name===it.InvalidState&&C.isOpen()&&0<--C._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),C.close({disableAutoOpen:!1}),C.open().then(function(){return k(C,v,E,null,T)})):qe(D)}var O,P=ut(T);return P&&Xt(),S=G.follow(function(){var D;(O=T.call(x,x))&&(P?(D=bt.bind(null,null),O.then(D,D)):typeof O.next=="function"&&typeof O.throw=="function"&&(O=Pr(O)))},S),(O&&typeof O.then=="function"?G.resolve(O).then(function(D){return x.active?D:qe(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):S.then(function(){return O})).then(function(D){return w&&x._resolve(),x._completion.then(function(){return D})}).catch(function(D){return x._reject(D),qe(D)})})}).bind(null,this,u,h,a,n);return a?a._promise(u,_,"lock"):te.trans?Nt(te.transless,function(){return i._whenReady(_)}):this._whenReady(_)},Fe.prototype.table=function(e){if(!I(this._allTables,e))throw new ne.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Fe);function Fe(e,t){var n=this;this._middlewares={},this.verno=0;var i=Fe.dependencies;this._options=t=o({addons:Fe.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,u,h,p,_,k={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Oe,dbReadyPromise:null,cancelOpen:Oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};k.dbReadyPromise=new G(function(v){k.dbReadyResolve=v}),k.openCanceller=new G(function(v,E){k.cancelOpen=E}),this._state=k,this.name=e,this.on=un(this,"populate","blocked","versionchange","close",{ready:[tr,Oe]}),this.on.ready.subscribe=W(this.on.ready.subscribe,function(v){return function(E,w){Fe.vip(function(){var T,S=n._state;S.openComplete?(S.dbOpenError||G.resolve().then(E),w&&v(E)):S.onReadyBeingFired?(S.onReadyBeingFired.push(E),w&&v(E)):(v(E),T=n,w||v(function x(){T.on.ready.unsubscribe(E),T.on.ready.unsubscribe(x)}))})}}),this.Collection=(a=this,ln(ho.prototype,function(O,x){this.db=a;var w=Xr,T=null;if(x)try{w=x()}catch(P){T=P}var S=O._ctx,x=S.table,O=x.hook.reading.fire;this._ctx={table:x,index:S.index,isPrimKey:!S.index||x.schema.primKey.keyPath&&S.index===x.schema.primKey.name,range:w,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:T,or:S.or,valueMapper:O!==nn?O:null}})),this.Table=(u=this,ln($r.prototype,function(v,E,w){this.db=u,this._tx=w,this.name=v,this.schema=E,this.hook=u._allTables[v]?u._allTables[v].hook:un(null,{creating:[ro,Oe],reading:[no,nn],updating:[oo,Oe],deleting:[io,Oe]})})),this.Transaction=(h=this,ln(vo.prototype,function(v,E,w,T,S){var x=this;this.db=h,this.mode=v,this.storeNames=E,this.schema=w,this.chromeTransactionDurability=T,this.idbtrans=null,this.on=un(this,"complete","error","abort"),this.parent=S||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new G(function(O,P){x._resolve=O,x._reject=P}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(O){var P=x.active;return x.active=!1,x.on.error.fire(O),x.parent?x.parent._reject(O):P&&x.idbtrans&&x.idbtrans.abort(),qe(O)})})),this.Version=(p=this,ln(xo.prototype,function(v){this.db=p,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(_=this,ln(ii.prototype,function(v,E,w){if(this.db=_,this._ctx={table:v,index:E===":id"?null:E,or:w},this._cmp=this._ascending=ke,this._descending=function(T,S){return ke(S,T)},this._max=function(T,S){return 0<ke(T,S)?T:S},this._min=function(T,S){return ke(T,S)<0?T:S},this._IDBKeyRange=_._deps.IDBKeyRange,!this._IDBKeyRange)throw new ne.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=hn(t.IDBKeyRange),this._createTransaction=function(v,E,w,T){return new n.Transaction(v,E,w,n._options.chromeTransactionDurability,T)},this._fireOnBlocked=function(v){n.on("blocked").fire(v),Qt.filter(function(E){return E.name===n.name&&E!==n&&!E._state.vcFired}).map(function(E){return E.on("versionchange").fire(v)})},this.use(Eo),this.use(Do),this.use(Io),this.use(Co),this.use(So);var C=new Proxy(this,{get:function(v,E,w){if(E==="_vip")return!0;if(E==="table")return function(S){return Yn(n.table(S),C)};var T=Reflect.get(v,E,w);return T instanceof $r?Yn(T,C):E==="tables"?T.map(function(S){return Yn(S,C)}):E==="_createTransaction"?function(){return Yn(T.apply(this,arguments),C)}:T}});this.vip=C,i.forEach(function(v){return v(n)})}var Hn,ot=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",jo=(Rr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},Rr.prototype[ot]=function(){return this},Rr);function Rr(e){this._subscribe=e}try{Hn={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Hn={indexedDB:null,IDBKeyRange:null}}function bi(e){var t,n=!1,i=new jo(function(a){var u=ut(e),h,p=!1,_={},k={},C={get closed(){return p},unsubscribe:function(){p||(p=!0,h&&h.abort(),v&&kt.storagemutated.unsubscribe(w))}};a.start&&a.start(C);var v=!1,E=function(){return lr(T)},w=function(S){Ln(_,S),Sr(k,_)&&E()},T=function(){var S,x,O;!p&&Hn.indexedDB&&(_={},S={},h&&h.abort(),h=new AbortController,O=function(P){var D=Wt();try{u&&Xt();var K=gt(e,P);return K=u?K.finally(bt):K}finally{D&&Gt()}}(x={subscr:S,signal:h.signal,requery:E,querier:e,trans:null}),Promise.resolve(O).then(function(P){n=!0,t=P,p||x.signal.aborted||(_={},function(D){for(var K in D)if(I(D,K))return;return 1}(k=S)||v||(kt(dn,w),v=!0),lr(function(){return!p&&a.next&&a.next(P)}))},function(P){n=!1,["DatabaseClosedError","AbortError"].includes(P==null?void 0:P.name)||p||lr(function(){p||a.error&&a.error(P)})}))};return setTimeout(E,0),C});return i.hasValue=function(){return n},i.getValue=function(){return t},i}var Ut=mt;function Ar(e){var t=xt;try{xt=!0,kt.storagemutated.fire(e),Or(e,!0)}finally{xt=t}}y(Ut,o(o({},_n),{delete:function(e){return new Ut(e,{addons:[]}).delete()},exists:function(e){return new Ut(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Ut.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(xr(n)?Promise.resolve(n.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==On})}):kr(n,t).toCollection().primaryKeys()).then(e)}catch{return qe(new ne.MissingAPI)}var t,n},defineClass:function(){return function(e){j(this,e)}},ignoreTransaction:function(e){return te.trans?Nt(te.transless,e):e()},vip:Tr,async:function(e){return function(){try{var t=Pr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:G.resolve(t)}catch(n){return qe(n)}}},spawn:function(e,t,n){try{var i=Pr(e.apply(n,t||[]));return i&&typeof i.then=="function"?i:G.resolve(i)}catch(a){return qe(a)}},currentTransaction:{get:function(){return te.trans||null}},waitFor:function(e,t){return t=G.resolve(typeof e=="function"?Ut.ignoreTransaction(e):e).timeout(t||6e4),te.trans?te.trans.waitFor(t):t},Promise:G,debug:{get:function(){return ct},set:function(e){Ur(e)}},derive:ie,extend:j,props:y,override:W,Events:un,on:kt,liveQuery:bi,extendObservabilitySet:Ln,getByKeyPath:ae,setByKeyPath:ee,delByKeyPath:function(e,t){typeof t=="string"?ee(e,t,void 0):"length"in t&&[].map.call(t,function(n){ee(e,n,void 0)})},shallowClone:z,deepClone:be,getObjectDiff:Dr,cmp:ke,asap:le,minKey:-1/0,addons:[],connections:Qt,errnames:it,dependencies:Hn,cache:Lt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Ut.maxKey=hn(Ut.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(kt(dn,function(e){xt||(e=new CustomEvent(mr,{detail:e}),xt=!0,dispatchEvent(e),xt=!1)}),addEventListener(mr,function(e){e=e.detail,xt||Ar(e)}));var $t,xt=!1,_i=function(){};return typeof BroadcastChannel<"u"&&((_i=function(){($t=new BroadcastChannel(mr)).onmessage=function(e){return e.data&&Ar(e.data)}})(),typeof $t.unref=="function"&&$t.unref(),kt(dn,function(e){xt||$t.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!mt.disableBfCache&&e.persisted){ct&&console.debug("Dexie: handling persisted pagehide"),$t!=null&&$t.close();for(var t=0,n=Qt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!mt.disableBfCache&&e.persisted&&(ct&&console.debug("Dexie: handling persisted pageshow"),_i(),Ar({all:new ze(-1/0,[[]])}))})),G.rejectionMapper=function(e,t){return!e||e instanceof Re||e instanceof TypeError||e instanceof SyntaxError||!e.name||!lt[e.name]?e:(t=new lt[e.name](t||e.message,e),"stack"in e&&Y(t,"stack",{get:function(){return this.inner.stack}}),t)},Ur(ct),o(mt,Object.freeze({__proto__:null,Dexie:mt,liveQuery:bi,Entity:Qr,cmp:ke,PropModification:cn,replacePrefix:function(e,t){return new cn({replacePrefix:[e,t]})},add:function(e){return new cn({add:e})},remove:function(e){return new cn({remove:e})},default:mt,RangeSet:ze,mergeRanges:vn,rangesOverlap:li}),{default:mt}),mt})})(eo);var Uo=eo.exports;const Nr=Lo(Uo),Ci=Symbol.for("Dexie"),er=globalThis[Ci]||(globalThis[Ci]=Nr);if(Nr.semVer!==er.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Nr.semVer} and ${er.semVer}`);const{liveQuery:Va,mergeRanges:Ya,rangesOverlap:Ha,RangeSet:za,cmp:Wa,Entity:Ga,PropModification:Xa,replacePrefix:Qa,add:Ja,remove:Za}=er;class Vo extends er{constructor(){super("MeditationGameDB");wi(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const Ht=new Vo,nt=[{id:"L1",name:"Level 1",minDuration:rt.ONE_MINUTE,maxDuration:rt.FIVE_MINUTES,description:"Notice distraction without judgment.",instructions:["Sit comfortably and bring your attention to the breath","Feel the air move through your nose as you breathe","Tap when you notice the mind has wandered","Every tap is a sign of awareness â it means you're learning","You're not here to be perfect. Just to begin."],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:rt.FIVE_MINUTES,maxDuration:rt.FIFTEEN_MINUTES,description:"Gently return the mind to focus.",instructions:["Bring your attention to the feeling of the breath","Notice when thoughts pull you away, and tap when they do","Gently return your focus to the breath, again and again","Let the practice be steady, not strict","You're building the habit of coming back."],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count",description:"Improve your tap count in 2 of 3 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:rt.TEN_MINUTES,maxDuration:rt.THIRTY_MINUTES,description:"Feel a sense of continuity and confidence.",instructions:["Rest your mind on the breath like a steady beam of light","If the mind wanders, tap to acknowledge, then return","Let distractions come and go â stay grounded in breath","You're developing continuity â not by force, but by ease","Allow the mind to settle. You're ready for this."],completionTasks:[{id:"2_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["2_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["2_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]}];function Si(f,r,s){const o=f.slice();return o[9]=r[s],o}function Ei(f){let r,s="Exit Meditation",o,c,l,d;return{c(){r=Q("button"),r.textContent=s,this.h()},l(b){r=X(b,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-t4g94n"&&(r.textContent=s),this.h()},h(){M(r,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-filled px-4 py-2")},m(b,j){oe(b,r,j),c=!0,l||(d=vt(r,"click",f[4]),l=!0)},p:He,i(b){c||(b&&at(()=>{c&&(o||(o=Me(r,Ne,{},!0)),o.run(1))}),c=!0)},o(b){b&&(o||(o=Me(r,Ne,{},!1)),o.run(0)),c=!1},d(b){b&&B(r),b&&o&&o.end(),l=!1,d()}}}function Ii(f){let r,s,o=f[9]+"",c,l;return{c(){r=Q("p"),s=new Mo(!1),this.h()},l(d){r=X(d,"P",{class:!0});var b=ue(r);s=Bo(b,!1),b.forEach(B),this.h()},h(){s.a=null,M(r,"class","text-lg max-w-sm")},m(d,b){oe(d,r,b),s.m(o,r),l=!0},p(d,b){(!l||b&4)&&o!==(o=d[9]+"")&&s.p(o)},i(d){l||(d&&at(()=>{l&&(c||(c=Me(r,Ne,{},!0)),c.run(1))}),l=!0)},o(d){d&&(c||(c=Me(r,Ne,{},!1)),c.run(0)),l=!1},d(d){d&&B(r),d&&c&&c.end()}}}function Oi(f){let r,s="Start meditation countdown",o,c,l,d,b=Mr[f[1]]+"",j,g,m,I;return{c(){r=Q("button"),r.textContent=s,c=ye(),l=Q("i"),d=fe("Meditating for "),j=fe(b),this.h()},l(y){r=X(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-71gbpm"&&(r.textContent=s),c=ve(y),l=X(y,"I",{class:!0});var A=ue(l);d=ce(A,"Meditating for "),j=ce(A,b),A.forEach(B),this.h()},h(){M(r,"class","btn variant-filled px-4 py-2 mt-4"),M(l,"class","text-sm text-gray-500")},m(y,A){oe(y,r,A),oe(y,c,A),oe(y,l,A),R(l,d),R(l,j),g=!0,m||(I=vt(r,"click",function(){No(f[0])&&f[0].apply(this,arguments)}),m=!0)},p(y,A){f=y,(!g||A&2)&&b!==(b=Mr[f[1]]+"")&&Le(j,b)},i(y){g||(y&&at(()=>{g&&(o||(o=Me(r,Ne,{},!0)),o.run(1))}),g=!0)},o(y){y&&(o||(o=Me(r,Ne,{},!1)),o.run(0)),g=!1},d(y){y&&(B(r),B(c),B(l)),y&&o&&o.end(),m=!1,I()}}}function Yo(f){let r,s,o,c,l=f[2]>=f[3].length&&Ei(f),d=Je(f[3].slice(0,f[2])),b=[];for(let m=0;m<d.length;m+=1)b[m]=Ii(Si(f,d,m));const j=m=>Ke(b[m],1,1,()=>{b[m]=null});let g=f[2]>=f[3].length&&Oi(f);return{c(){r=Q("div"),l&&l.c(),s=ye();for(let m=0;m<b.length;m+=1)b[m].c();o=ye(),g&&g.c(),this.h()},l(m){r=X(m,"DIV",{class:!0});var I=ue(r);l&&l.l(I),s=ve(I);for(let y=0;y<b.length;y+=1)b[y].l(I);o=ve(I),g&&g.l(I),I.forEach(B),this.h()},h(){M(r,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(m,I){oe(m,r,I),l&&l.m(r,null),R(r,s);for(let y=0;y<b.length;y+=1)b[y]&&b[y].m(r,null);R(r,o),g&&g.m(r,null),c=!0},p(m,[I]){if(m[2]>=m[3].length?l?(l.p(m,I),I&4&&Ee(l,1)):(l=Ei(m),l.c(),Ee(l,1),l.m(r,s)):l&&(Tt(),Ke(l,1,1,()=>{l=null}),Ct()),I&12){d=Je(m[3].slice(0,m[2]));let y;for(y=0;y<d.length;y+=1){const A=Si(m,d,y);b[y]?(b[y].p(A,I),Ee(b[y],1)):(b[y]=Ii(A),b[y].c(),Ee(b[y],1),b[y].m(r,o))}for(Tt(),y=d.length;y<b.length;y+=1)j(y);Ct()}m[2]>=m[3].length?g?(g.p(m,I),I&4&&Ee(g,1)):(g=Oi(m),g.c(),Ee(g,1),g.m(r,null)):g&&(Tt(),Ke(g,1,1,()=>{g=null}),Ct())},i(m){if(!c){Ee(l);for(let I=0;I<d.length;I+=1)Ee(b[I]);Ee(g),c=!0}},o(m){Ke(l),b=b.filter(Boolean);for(let I=0;I<b.length;I+=1)Ke(b[I]);Ke(g),c=!1},d(m){m&&B(r),l&&l.d(),zt(b,m),g&&g.d()}}}function Ho(f,r,s){let{nextStep:o}=r,{closeModal:c}=r,{duration:l}=r,{levelId:d="L1"}=r;const b=nt.find(y=>y.id===d),j=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],g=(b==null?void 0:b.instructions)||j;let m=0;Ji(()=>{ht.capture("instructions_viewed",{level:d});const y=setInterval(()=>{m<g.length+1?s(2,m+=1):clearInterval(y)},1e3)});const I=()=>{ht.capture("instructions_exit",{instructions_viewed:m,level:d}),c()};return f.$$set=y=>{"nextStep"in y&&s(0,o=y.nextStep),"closeModal"in y&&s(5,c=y.closeModal),"duration"in y&&s(1,l=y.duration),"levelId"in y&&s(6,d=y.levelId)},[o,l,m,g,I,c,d]}class zo extends Et{constructor(r){super(),It(this,r,Ho,Yo,St,{nextStep:0,closeModal:5,duration:1,levelId:6})}}const Wo=f=>{const r=f%60;return(f/60>1?`${Math.floor(f/60)}:`:"")+`${r<10?"0":""}${r}`};function tn(f){const r=f/60;return Number.isInteger(r)?r:Math.round(r*10)/10}function Go(f){let r,s,o,c,l,d;return{c(){r=Gn("svg"),s=Gn("circle"),o=Gn("circle"),l=Gn("text"),d=fe(f[1]),this.h()},l(b){r=Wn(b,"svg",{class:!0,viewBox:!0});var j=ue(r);s=Wn(j,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),ue(s).forEach(B),o=Wn(j,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),ue(o).forEach(B),l=Wn(j,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var g=ue(l);d=ce(g,f[1]),g.forEach(B),j.forEach(B),this.h()},h(){M(s,"cx","50"),M(s,"cy","50"),M(s,"r","40"),M(s,"stroke","gray"),M(s,"stroke-width","5"),M(s,"fill","none"),M(o,"cx","50"),M(o,"cy","50"),M(o,"r","40"),M(o,"stroke","blue"),M(o,"stroke-width","5"),M(o,"fill","none"),M(o,"stroke-dasharray","251.2"),M(o,"stroke-dashoffset",c=251.2*f[0]),M(o,"transform","rotate(-90 50 50)"),M(l,"x","50"),M(l,"y","55"),M(l,"font-size","14"),M(l,"text-anchor","middle"),M(l,"fill","black"),M(r,"class","w-32 h-32"),M(r,"viewBox","0 0 100 100")},m(b,j){oe(b,r,j),R(r,s),R(r,o),R(r,l),R(l,d)},p(b,[j]){j&1&&c!==(c=251.2*b[0])&&M(o,"stroke-dashoffset",c),j&2&&Le(d,b[1])},i:He,o:He,d(b){b&&B(r)}}}const Xo="/sounds/gong.mp3";function Qo(f,r,s){let o,c,{duration:l}=r,{startTimestamp:d}=r;const b=Zi();let j=Qn(l),g=null,m,I=null;const y=xi(j,Z=>Wo(Z));Zn(f,y,Z=>s(1,c=Z));const A=xi(j,Z=>Z/l);Zn(f,A,Z=>s(0,o=Z));const Y=async()=>{if(!(!window.audioContext||!I))try{const Z=window.audioContext.createBufferSource();Z.buffer=I,Z.connect(window.audioContext.destination),Z.start(0)}catch(Z){console.error("Error playing sound:",Z)}},ie=async()=>{if(window.audioContext)try{const W=await(await fetch(Xo)).arrayBuffer();I=await window.audioContext.decodeAudioData(W)}catch(Z){console.error("Error loading sound:",Z)}},de=()=>{clearInterval(m),Y(),b("complete")},V=async Z=>{try{if(!("wakeLock"in navigator))return;Z?g=await navigator.wakeLock.request("screen"):g&&(await g.release(),g=null)}catch(W){console.error(`Wake Lock ${Z?"request":"release"} failed:`,W)}};return Ji(()=>{s(4,d=Date.now()),m=setInterval(()=>{j.update(Z=>Z>0?Z-1:(de(),0))},1e3),ie(),V(!0)}),qo(()=>{clearInterval(m),V(!1)}),f.$$set=Z=>{"duration"in Z&&s(5,l=Z.duration),"startTimestamp"in Z&&s(4,d=Z.startTimestamp)},[o,c,y,A,d,l]}class to extends Et{constructor(r){super(),It(this,r,Qo,Go,St,{duration:5,startTimestamp:4})}}function Jo(f){let r,s,o,c="Your meditation starts in:",l,d,b,j,g,m="Exit Meditation",I,y,A,Y;function ie(V){f[6](V)}let de={duration:Zo};return f[0]!==void 0&&(de.startTimestamp=f[0]),d=new to({props:de}),qr.push(()=>Lr(d,"startTimestamp",ie)),d.$on("complete",f[1]),{c(){r=Q("div"),s=Q("div"),o=Q("p"),o.textContent=c,l=ye(),jt(d.$$.fragment),j=ye(),g=Q("button"),g.textContent=m,this.h()},l(V){r=X(V,"DIV",{class:!0});var Z=ue(r);s=X(Z,"DIV",{class:!0});var W=ue(s);o=X(W,"P",{class:!0,"data-svelte-h":!0}),Ae(o)!=="svelte-1tp8zka"&&(o.textContent=c),l=ve(W),Dt(d.$$.fragment,W),W.forEach(B),j=ve(Z),g=X(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(g)!=="svelte-hy6wnc"&&(g.textContent=m),Z.forEach(B),this.h()},h(){M(o,"class","text-lg mt-4 text-center"),M(s,"class","absolute flex flex-col items-center pointer-events-auto"),M(g,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),M(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(V,Z){oe(V,r,Z),R(r,s),R(s,o),R(s,l),Pt(d,s,null),R(r,j),R(r,g),y=!0,A||(Y=vt(g,"click",f[2]),A=!0)},p(V,[Z]){const W={};!b&&Z&1&&(b=!0,W.startTimestamp=V[0],Fr(()=>b=!1)),d.$set(W)},i(V){y||(Ee(d.$$.fragment,V),V&&at(()=>{y&&(I||(I=Me(g,Ne,{},!0)),I.run(1))}),y=!0)},o(V){Ke(d.$$.fragment,V),V&&(I||(I=Me(g,Ne,{},!1)),I.run(0)),y=!1},d(V){V&&B(r),Ot(d),V&&I&&I.end(),A=!1,Y()}}}const Zo=10;function $o(f,r,s){let{nextStep:o}=r,{closeModal:c}=r,{levelId:l="L1"}=r,d=0;ht.capture("countdown_started",{level:l});const b=()=>{ht.capture("countdown_complete",{level:l}),o()},j=()=>{ht.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:l}),c()};function g(m){d=m,s(0,d)}return f.$$set=m=>{"nextStep"in m&&s(3,o=m.nextStep),"closeModal"in m&&s(4,c=m.closeModal),"levelId"in m&&s(5,l=m.levelId)},[d,b,j,o,c,l,g]}class ea extends Et{constructor(r){super(),It(this,r,$o,Jo,St,{nextStep:3,closeModal:4,levelId:5})}}function ta(f){let r,s;return{c(){r=Q("br"),s=Q("br")},l(o){r=X(o,"BR",{}),s=X(o,"BR",{})},m(o,c){oe(o,r,c),oe(o,s,c)},p:He,d(o){o&&(B(r),B(s))}}}function na(f){let r,s,o;return{c(){r=Q("i"),s=fe(f[2]),o=fe(" distraction"),this.h()},l(c){r=X(c,"I",{class:!0});var l=ue(r);s=ce(l,f[2]),o=ce(l," distraction"),l.forEach(B),this.h()},h(){M(r,"class","text-sm text-gray-500")},m(c,l){oe(c,r,l),R(r,s),R(r,o)},p(c,l){l&4&&Le(s,c[2])},d(c){c&&B(r)}}}function ra(f){let r,s,o;return{c(){r=Q("i"),s=fe(f[2]),o=fe(" distractions"),this.h()},l(c){r=X(c,"I",{class:!0});var l=ue(r);s=ce(l,f[2]),o=ce(l," distractions"),l.forEach(B),this.h()},h(){M(r,"class","text-sm text-gray-500")},m(c,l){oe(c,r,l),R(r,s),R(r,o)},p(c,l){l&4&&Le(s,c[2])},d(c){c&&B(r)}}}function Pi(f){let r;return{c(){r=Q("div"),this.h()},l(s){r=X(s,"DIV",{class:!0,style:!0}),ue(r).forEach(B),this.h()},h(){M(r,"class","ripple svelte-1wv6db6"),Xn(r,"top",f[3].y+"px"),Xn(r,"left",f[3].x+"px")},m(s,o){oe(s,r,o)},p(s,o){o&8&&Xn(r,"top",s[3].y+"px"),o&8&&Xn(r,"left",s[3].x+"px")},d(s){s&&B(r)}}}function ia(f){let r,s,o,c,l,d,b="Tap anywhere on the screen to record your distractions",j,g,m,I,y,A="Exit Meditation",Y,ie,de,V;function Z(z){f[11](z)}let W={duration:f[0]};f[1]!==void 0&&(W.startTimestamp=f[1]),o=new to({props:W}),qr.push(()=>Lr(o,"startTimestamp",Z)),o.$on("complete",f[8]);function $(z,Ce){return z[2]>1||z[2]==0?ra:z[2]==1?na:ta}let le=$(f),ae=le(f),ee=f[3]&&Pi(f);return{c(){r=Q("div"),s=Q("div"),jt(o.$$.fragment),l=ye(),d=Q("p"),d.textContent=b,j=ye(),ae.c(),g=ye(),m=Q("button"),ee&&ee.c(),I=ye(),y=Q("button"),y.textContent=A,this.h()},l(z){r=X(z,"DIV",{class:!0});var Ce=ue(r);s=X(Ce,"DIV",{class:!0});var Ie=ue(s);Dt(o.$$.fragment,Ie),l=ve(Ie),d=X(Ie,"P",{class:!0,"data-svelte-h":!0}),Ae(d)!=="svelte-1uyhl39"&&(d.textContent=b),j=ve(Ie),ae.l(Ie),Ie.forEach(B),g=ve(Ce),m=X(Ce,"BUTTON",{class:!0});var Qe=ue(m);ee&&ee.l(Qe),Qe.forEach(B),I=ve(Ce),y=X(Ce,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(y)!=="svelte-hy6wnc"&&(y.textContent=A),Ce.forEach(B),this.h()},h(){M(d,"class","text-lg mt-4 text-center"),M(s,"class","absolute flex flex-col items-center pointer-events-auto p-6"),M(m,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),M(y,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),M(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(z,Ce){oe(z,r,Ce),R(r,s),Pt(o,s,null),R(s,l),R(s,d),R(s,j),ae.m(s,null),R(r,g),R(r,m),ee&&ee.m(m,null),R(r,I),R(r,y),ie=!0,de||(V=[vt(m,"click",f[6]),vt(y,"click",f[7])],de=!0)},p(z,[Ce]){const Ie={};Ce&1&&(Ie.duration=z[0]),!c&&Ce&2&&(c=!0,Ie.startTimestamp=z[1],Fr(()=>c=!1)),o.$set(Ie),le===(le=$(z))&&ae?ae.p(z,Ce):(ae.d(1),ae=le(z),ae&&(ae.c(),ae.m(s,null))),z[3]?ee?ee.p(z,Ce):(ee=Pi(z),ee.c(),ee.m(m,null)):ee&&(ee.d(1),ee=null)},i(z){ie||(Ee(o.$$.fragment,z),z&&at(()=>{ie&&(Y||(Y=Me(y,Ne,{},!0)),Y.run(1))}),ie=!0)},o(z){Ke(o.$$.fragment,z),z&&(Y||(Y=Me(y,Ne,{},!1)),Y.run(0)),ie=!1},d(z){z&&B(r),Ot(o),ae.d(),ee&&ee.d(),z&&Y&&Y.end(),de=!1,$i(V)}}}function oa(f,r,s){let o,c,{nextStep:l}=r,{duration:d}=r,{levelId:b="L1"}=r;const j=Zi();let g=0;const m=Qn(0);Zn(f,m,V=>s(2,o=V));const I=Qn([]),y=Qn(null);Zn(f,y,V=>s(3,c=V));const A=V=>{const Z=(Date.now()-g)/1e3;m.update(ee=>ee+1),I.update(ee=>[...ee,Z]),console.log(`Click ${Yt(m)} recorded at ${Z} seconds`),ht.capture("game_tap",{timestamp:Z,total_taps:Yt(m),level:b,button:"distracted"});const{clientX:W,clientY:$,currentTarget:le}=V,ae=le.getBoundingClientRect();y.set({x:W-ae.left,y:$-ae.top}),setTimeout(()=>y.set(null),600)},Y=()=>{const V=(Date.now()-g)/1e3;ht.capture("meditation_exit",{duration_meditated:V,total_taps:Yt(I).length,level:b}),j("complete",{clickTimestamps:Yt(I),durationMeditated:V,completed:d-V<5}),l()},ie=()=>{console.log("Meditation complete! Click data:",Yt(I)),ht.capture("meditation_completed",{duration:d,total_taps:Yt(I).length,level:b}),j("complete",{clickTimestamps:Yt(I),durationMeditated:d,completed:!0}),l()};function de(V){g=V,s(1,g)}return f.$$set=V=>{"nextStep"in V&&s(9,l=V.nextStep),"duration"in V&&s(0,d=V.duration),"levelId"in V&&s(10,b=V.levelId)},[d,g,o,c,m,y,A,Y,ie,l,b,de]}class aa extends Et{constructor(r){super(),It(this,r,oa,ia,St,{nextStep:9,duration:0,levelId:10})}}function sa(f){const r=Math.floor(f.durationMeditated/60),s=f.clickTimestamps.length,o=f.newStarRating-f.previousStarRating,c="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share";return o>0?`Major win! ð§ââï¸  I just earned a new â­ in The Meditation Game!
I did a ${r}âmin meditation with only ${s} distractions.
I'm at ${"â­".repeat(f.newStarRating)} on this level!
Learn and practice meditation here: ${c}`:f.isNewPersonalBest?`Miniâwin in The Meditation Game: my new personal best!
${r}âmin sit â¢ only ${s} ${s===1?"mind-wander":"mind-wanders"} â¢ ${"â­".repeat(f.newStarRating)} on this level
Learn and practice meditation here: ${c}`:`Sharing todays practice in The Meditation Game.
I did a ${r}âmin meditation with only ${s} distractions.
I'm at ${"â­".repeat(f.newStarRating)} on this level.
Learn and practice meditation here: ${c}`}function ua(f){return f.newStarRating-f.previousStarRating>0?"A":f.isNewPersonalBest?"B":"C"}function Di(f,r,s){const o=f.slice();return o[9]=r[s][0],o[10]=r[s][1],o}function ji(f,r,s){const o=f.slice();return o[13]=r[s],o[15]=s,o}function Ki(f){let r;function s(l,d){return l[0].newStarRating===3?ca:la}let o=s(f),c=o(f);return{c(){r=Q("p"),c.c(),this.h()},l(l){r=X(l,"P",{class:!0});var d=ue(r);c.l(d),d.forEach(B),this.h()},h(){M(r,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(l,d){oe(l,r,d),c.m(r,null)},p(l,d){o===(o=s(l))&&c?c.p(l,d):(c.d(1),c=o(l),c&&(c.c(),c.m(r,null)))},d(l){l&&B(r),c.d()}}}function la(f){let r,s=f[0].newStarRating-f[0].previousStarRating+"",o,c;return{c(){r=fe("You earned +"),o=fe(s),c=fe(" â­ â keep going!")},l(l){r=ce(l,"You earned +"),o=ce(l,s),c=ce(l," â­ â keep going!")},m(l,d){oe(l,r,d),oe(l,o,d),oe(l,c,d)},p(l,d){d&1&&s!==(s=l[0].newStarRating-l[0].previousStarRating+"")&&Le(o,s)},d(l){l&&(B(r),B(o),B(c))}}}function ca(f){let r;return{c(){r=fe("Mastered this level! â¨")},l(s){r=ce(s,"Mastered this level! â¨")},m(s,o){oe(s,r,o)},p:He,d(s){s&&B(r)}}}function Ri(f){let r,s=f[15]<f[0].newStarRating?"â­":"â",o,c;return{c(){r=Q("span"),o=fe(s),c=ye(),this.h()},l(l){r=X(l,"SPAN",{class:!0});var d=ue(r);o=ce(d,s),c=ve(d),d.forEach(B),this.h()},h(){M(r,"class","text-xl")},m(l,d){oe(l,r,d),R(r,o),R(r,c)},p(l,d){d&1&&s!==(s=l[15]<l[0].newStarRating?"â­":"â")&&Le(o,s)},d(l){l&&B(r)}}}function fa(f){let r,s="You completed your meditation distraction-free!";return{c(){r=Q("p"),r.textContent=s,this.h()},l(o){r=X(o,"P",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-j87uf1"&&(r.textContent=s),this.h()},h(){M(r,"class","text-lg mt-4")},m(o,c){oe(o,r,c)},p:He,d(o){o&&B(r)}}}function da(f){let r,s,o=f[4](f[0].durationMeditated)+"",c,l,d,b,j=f[2]===1?"distraction":"distractions",g,m,I,y,A,Y,ie,de=Number(f[3])===1?"distraction":"distractions",V,Z;return{c(){r=Q("p"),s=fe("You meditated for "),c=fe(o),l=fe(" and recorded "),d=fe(f[2]),b=ye(),g=fe(j),m=fe("."),I=ye(),y=Q("p"),A=fe("That's about "),Y=fe(f[3]),ie=ye(),V=fe(de),Z=fe(" per minute."),this.h()},l(W){r=X(W,"P",{class:!0});var $=ue(r);s=ce($,"You meditated for "),c=ce($,o),l=ce($," and recorded "),d=ce($,f[2]),b=ve($),g=ce($,j),m=ce($,"."),$.forEach(B),I=ve(W),y=X(W,"P",{class:!0});var le=ue(y);A=ce(le,"That's about "),Y=ce(le,f[3]),ie=ve(le),V=ce(le,de),Z=ce(le," per minute."),le.forEach(B),this.h()},h(){M(r,"class","text-lg mt-4"),M(y,"class","text-lg mt-2")},m(W,$){oe(W,r,$),R(r,s),R(r,c),R(r,l),R(r,d),R(r,b),R(r,g),R(r,m),oe(W,I,$),oe(W,y,$),R(y,A),R(y,Y),R(y,ie),R(y,V),R(y,Z)},p(W,$){$&1&&o!==(o=W[4](W[0].durationMeditated)+"")&&Le(c,o)},d(W){W&&(B(r),B(I),B(y))}}}function ha(f){let r,s,o=f[0].personalBest.tapCount+"",c,l,d=tn(f[0].personalBest.duration)+"",b,j;return{c(){r=Q("p"),s=fe("Best so far: "),c=fe(o),l=fe(" taps Â· "),b=fe(d),j=fe(" min."),this.h()},l(g){r=X(g,"P",{class:!0});var m=ue(r);s=ce(m,"Best so far: "),c=ce(m,o),l=ce(m," taps Â· "),b=ce(m,d),j=ce(m," min."),m.forEach(B),this.h()},h(){M(r,"class","mt-4 text-muted-foreground")},m(g,m){oe(g,r,m),R(r,s),R(r,c),R(r,l),R(r,b),R(r,j)},p(g,m){m&1&&o!==(o=g[0].personalBest.tapCount+"")&&Le(c,o),m&1&&d!==(d=tn(g[0].personalBest.duration)+"")&&Le(b,d)},d(g){g&&B(r)}}}function pa(f){let r,s,o=f[0].personalBest.tapCount+"",c,l,d=tn(f[0].personalBest.duration)+"",b,j;return{c(){r=Q("p"),s=fe("New personal best ð â "),c=fe(o),l=fe(" taps over "),b=fe(d),j=fe(" min."),this.h()},l(g){r=X(g,"P",{class:!0});var m=ue(r);s=ce(m,"New personal best ð â "),c=ce(m,o),l=ce(m," taps over "),b=ce(m,d),j=ce(m," min."),m.forEach(B),this.h()},h(){M(r,"class","mt-4 text-green-600 font-medium animate-fade-in svelte-tnqxsb")},m(g,m){oe(g,r,m),R(r,s),R(r,c),R(r,l),R(r,b),R(r,j)},p(g,m){m&1&&o!==(o=g[0].personalBest.tapCount+"")&&Le(c,o),m&1&&d!==(d=tn(g[0].personalBest.duration)+"")&&Le(b,d)},d(g){g&&B(r)}}}function Ai(f){let r,s,o=f[10]?"â":"ð²",c,l,d=(f[1][f[9]]||f[9])+"",b,j;return{c(){r=Q("li"),s=Q("span"),c=fe(o),l=ye(),b=fe(d),j=ye(),this.h()},l(g){r=X(g,"LI",{class:!0});var m=ue(r);s=X(m,"SPAN",{class:!0});var I=ue(s);c=ce(I,o),I.forEach(B),l=ve(m),b=ce(m,d),j=ve(m),m.forEach(B),this.h()},h(){M(s,"class","mr-2"),M(r,"class","flex items-center")},m(g,m){oe(g,r,m),R(r,s),R(s,c),R(r,l),R(r,b),R(r,j)},p(g,m){m&1&&o!==(o=g[10]?"â":"ð²")&&Le(c,o),m&3&&d!==(d=(g[1][g[9]]||g[9])+"")&&Le(b,d)},d(g){g&&B(r)}}}function Bi(f){let r,s,o=f[0].newlyCompletedTasks.length+"",c,l,d=f[0].newlyCompletedTasks.length===1?"":"s",b,j;return{c(){r=Q("p"),s=fe("Nice! You just completed "),c=fe(o),l=fe(" task"),b=fe(d),j=fe("."),this.h()},l(g){r=X(g,"P",{class:!0});var m=ue(r);s=ce(m,"Nice! You just completed "),c=ce(m,o),l=ce(m," task"),b=ce(m,d),j=ce(m,"."),m.forEach(B),this.h()},h(){M(r,"class","mt-2 text-sm text-accent-foreground")},m(g,m){oe(g,r,m),R(r,s),R(r,c),R(r,l),R(r,b),R(r,j)},p(g,m){m&1&&o!==(o=g[0].newlyCompletedTasks.length+"")&&Le(c,o),m&1&&d!==(d=g[0].newlyCompletedTasks.length===1?"":"s")&&Le(b,d)},d(g){g&&B(r)}}}function ma(f){let r,s,o="Great practice!",c,l,d,b,j,g,m,I="Level tasks",y,A,Y,ie,de,V,Z="Share",W,$,le,ae="Exit",ee,z,Ce=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org â</a></p> <p class="mt-2">This app was made by Arjun, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn â</a></p>`,Ie,Qe,re=f[0].newStarRating>f[0].previousStarRating&&Ki(f),be=Je(Array(3)),xe=[];for(let se=0;se<be.length;se+=1)xe[se]=Ri(ji(f,be,se));function Ze(se,ge){return se[0].clickTimestamps.length>0?da:fa}let Se=Ze(f),Be=Se(f);function st(se,ge){if(se[0].isNewPersonalBest&&se[0].personalBest)return pa;if(se[0].personalBest)return ha}let $e=st(f),Pe=$e&&$e(f),ut=Je(Object.entries(f[0].completionTaskResults)),Ue=[];for(let se=0;se<ut.length;se+=1)Ue[se]=Ai(Di(f,ut,se));let Re=f[0].newlyCompletedTasks.length>0&&Bi(f);return{c(){r=Q("div"),s=Q("h2"),s.textContent=o,c=ye(),re&&re.c(),l=ye(),d=Q("div");for(let se=0;se<xe.length;se+=1)xe[se].c();b=ye(),Be.c(),j=ye(),Pe&&Pe.c(),g=ye(),m=Q("h3"),m.textContent=I,y=ye(),A=Q("ul");for(let se=0;se<Ue.length;se+=1)Ue[se].c();Y=ye(),Re&&Re.c(),ie=ye(),de=Q("div"),V=Q("button"),V.textContent=Z,W=ye(),$=Q("div"),le=Q("button"),le.textContent=ae,ee=ye(),z=Q("div"),z.innerHTML=Ce,this.h()},l(se){r=X(se,"DIV",{class:!0});var ge=ue(r);s=X(ge,"H2",{class:!0,"data-svelte-h":!0}),Ae(s)!=="svelte-1untj5h"&&(s.textContent=o),c=ve(ge),re&&re.l(ge),l=ve(ge),d=X(ge,"DIV",{class:!0});var he=ue(d);for(let lt=0;lt<xe.length;lt+=1)xe[lt].l(he);he.forEach(B),b=ve(ge),Be.l(ge),j=ve(ge),Pe&&Pe.l(ge),g=ve(ge),m=X(ge,"H3",{class:!0,"data-svelte-h":!0}),Ae(m)!=="svelte-8ylw1a"&&(m.textContent=I),y=ve(ge),A=X(ge,"UL",{class:!0});var it=ue(A);for(let lt=0;lt<Ue.length;lt+=1)Ue[lt].l(it);it.forEach(B),Y=ve(ge),Re&&Re.l(ge),ie=ve(ge),de=X(ge,"DIV",{class:!0});var bn=ue(de);V=X(bn,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(V)!=="svelte-1wlydhx"&&(V.textContent=Z),bn.forEach(B),W=ve(ge),$=X(ge,"DIV",{class:!0});var ne=ue($);le=X(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(le)!=="svelte-1t5v3tb"&&(le.textContent=ae),ne.forEach(B),ee=ve(ge),z=X(ge,"DIV",{class:!0,"data-svelte-h":!0}),Ae(z)!=="svelte-k92ud0"&&(z.innerHTML=Ce),ge.forEach(B),this.h()},h(){M(s,"class","text-2xl font-bold"),M(d,"class","mt-2 flex items-center space-x-1"),M(m,"class","mt-6 font-semibold"),M(A,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto"),M(V,"class","btn variant-filled px-4 py-2"),M(de,"class","mt-6 flex space-x-4"),M(le,"class","btn variant-outlined px-4 py-2"),M($,"class","mt-6 flex space-x-4"),M(z,"class","absolute bottom-6 text-center text-sm text-gray-500"),M(r,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(se,ge){oe(se,r,ge),R(r,s),R(r,c),re&&re.m(r,null),R(r,l),R(r,d);for(let he=0;he<xe.length;he+=1)xe[he]&&xe[he].m(d,null);R(r,b),Be.m(r,null),R(r,j),Pe&&Pe.m(r,null),R(r,g),R(r,m),R(r,y),R(r,A);for(let he=0;he<Ue.length;he+=1)Ue[he]&&Ue[he].m(A,null);R(r,Y),Re&&Re.m(r,null),R(r,ie),R(r,de),R(de,V),R(r,W),R(r,$),R($,le),R(r,ee),R(r,z),Ie||(Qe=[vt(V,"click",f[5]),vt(le,"click",f[6])],Ie=!0)},p(se,[ge]){if(se[0].newStarRating>se[0].previousStarRating?re?re.p(se,ge):(re=Ki(se),re.c(),re.m(r,l)):re&&(re.d(1),re=null),ge&1){be=Je(Array(3));let he;for(he=0;he<be.length;he+=1){const it=ji(se,be,he);xe[he]?xe[he].p(it,ge):(xe[he]=Ri(it),xe[he].c(),xe[he].m(d,null))}for(;he<xe.length;he+=1)xe[he].d(1);xe.length=be.length}if(Se===(Se=Ze(se))&&Be?Be.p(se,ge):(Be.d(1),Be=Se(se),Be&&(Be.c(),Be.m(r,j))),$e===($e=st(se))&&Pe?Pe.p(se,ge):(Pe&&Pe.d(1),Pe=$e&&$e(se),Pe&&(Pe.c(),Pe.m(r,g))),ge&3){ut=Je(Object.entries(se[0].completionTaskResults));let he;for(he=0;he<ut.length;he+=1){const it=Di(se,ut,he);Ue[he]?Ue[he].p(it,ge):(Ue[he]=Ai(it),Ue[he].c(),Ue[he].m(A,null))}for(;he<Ue.length;he+=1)Ue[he].d(1);Ue.length=ut.length}se[0].newlyCompletedTasks.length>0?Re?Re.p(se,ge):(Re=Bi(se),Re.c(),Re.m(r,ie)):Re&&(Re.d(1),Re=null)},i:He,o:He,d(se){se&&B(r),re&&re.d(),zt(xe,se),Be.d(),Pe&&Pe.d(),zt(Ue,se),Re&&Re.d(),Ie=!1,$i(Qe)}}}function va(f,r,s){let{closeModal:o}=r,{meditationResults:c}=r;const l=c.clickTimestamps.length,d=l>0?(l/(c.durationMeditated/60)).toFixed(1):"0",b=nt.find(y=>y.id===c.levelId),j={};b&&b.completionTasks.forEach(y=>{s(1,j[y.id]=y.description,j)});const g=y=>{const A=Math.floor(y/60),Y=y%60;return A===0?Y+" second"+(Y===1?"":"s"):A+" minute"+(A===1?"":"s")+(Y>0?" and "+Y+" second"+(Y===1?"":"s"):"")},m=()=>{if(navigator.share){const y=c.newStarRating-c.previousStarRating,A=ua(c);ht.capture("results_shared",{total_taps:l,distractionRate:d,level:c.levelId,stars_gained:y,tasks_completed:c.newlyCompletedTasks.length,template_used:A,personal_best:c.isNewPersonalBest});const Y=sa(c);navigator.share({text:Y}).catch(ie=>console.error("Sharing failed",ie))}else console.log("Web Share API not supported")},I=()=>{ht.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:c.newStarRating-c.previousStarRating,tasks_completed:c.newlyCompletedTasks.length}),o()};return f.$$set=y=>{"closeModal"in y&&s(7,o=y.closeModal),"meditationResults"in y&&s(0,c=y.meditationResults)},[c,j,l,d,g,m,I,o]}class ya extends Et{constructor(r){super(),It(this,r,va,ma,St,{closeModal:7,meditationResults:0})}}function Jn(f){return f.filter(r=>r.completed).sort((r,s)=>s.duration!==r.duration?s.duration-r.duration:r.tapCount!==s.tapCount?r.tapCount-s.tapCount:s.timestamp-r.timestamp)[0]??null}function ga(f,r,s){const{scope:o,requirement:c}=f;return o==="cumulative"?Mi(c,r):s.some(l=>Mi(c,l))}function Mi(f,r){if(f.type==="minTasks"){const{count:s,from:o}=f;return o==="all"?r.size>=s:o.filter(l=>r.has(l)).length>=s}return f.type==="specificTasks"?f.taskIds.every(s=>r.has(s)):!1}function yn(f,r,s){const o=[...f].sort((c,l)=>l.stars-c.stars);for(const c of o)if(ga(c,r,s))return c.stars;return 0}function en(f,r){const s=new Set;for(const o of r.completionTasks)switch(o.id){case"tap_once":f.tapCount>0&&s.add(o.id);break;case"no_early_exit":f.completed&&s.add(o.id);break;case"max_duration":f.duration>=r.maxDuration&&s.add(o.id);break;case"session_under_5_taps":f.tapCount<=5&&s.add(o.id);break;case"2_sessions_under_8_taps":f.tapCount<=8&&s.add(o.id);break;case"one_min_no_taps":if(f.tapTimestamps.length===0)s.add(o.id);else if(f.tapTimestamps.length===1)(f.tapTimestamps[0]>60||f.duration-f.tapTimestamps[0]>60)&&s.add(o.id);else{for(let c=0;c<f.tapTimestamps.length-1;c++)if(f.tapTimestamps[c+1]-f.tapTimestamps[c]>60){s.add(o.id);break}(f.tapTimestamps[0]>60||f.duration-f.tapTimestamps[f.tapTimestamps.length-1]>60)&&s.add(o.id)}break}return s}async function gn(f){const r=nt.find(c=>c.id===f);if(!r)return{};const s=await Ht.sessions.where("levelId").equals(f).toArray(),o={};for(const c of r.completionTasks)switch(c.id){case"complete_2_sessions":o[c.id]=s.length>=2;break;case"complete_3_sessions":o[c.id]=s.length>=3;break;case"improve_tap_count":if(s.length>=3){const d=[...s].sort((j,g)=>j.timestamp-g.timestamp);let b=0;for(let j=1;j<d.length;j++)d[j].tapCount<d[j-1].tapCount&&b++;o[c.id]=b>=2}else o[c.id]=!1;break;case"2_sessions_under_8_taps":const l=s.filter(d=>d.tapCount<=8);o[c.id]=l.length>=2;break;default:o[c.id]=s.some(d=>en(d,r).has(c.id))}return o}async function ba(){const f=await Ht.sessions.where("levelId").equals("L1").toArray(),r=await gn("L1"),s=new Set(Object.entries(r).filter(([z,Ce])=>Ce).map(([z])=>z)),o=f.map(z=>en(z,nt[0])),c=yn(nt[0].starRules,s,o),l=Jn(f),d={level:nt[0],isUnlocked:!0,progress:{sessionsCompleted:f.length,requiredSessions:2},taskCompletion:r,starRating:c,bestSession:l},b=await Ht.sessions.where("levelId").equals("L2").toArray(),j=await gn("L2"),g=new Set(Object.entries(j).filter(([z,Ce])=>Ce).map(([z])=>z)),m=b.map(z=>en(z,nt[1])),I=yn(nt[1].starRules,g,m),y=Jn(b),A=c>=2,Y={level:nt[1],isUnlocked:A,progress:{sessionsCompleted:b.length,requiredSessions:3},taskCompletion:j,starRating:I,bestSession:y},ie=await Ht.sessions.where("levelId").equals("L3").toArray(),de=ie.filter(z=>z.tapCount<=3),V=await gn("L3"),Z=new Set(Object.entries(V).filter(([z,Ce])=>Ce).map(([z])=>z)),W=ie.map(z=>en(z,nt[2])),$=yn(nt[2].starRules,Z,W),le=Jn(ie),ae=I>=2,ee={level:nt[2],isUnlocked:ae,progress:{sessionsCompleted:de.length,requiredSessions:2},taskCompletion:V,starRating:$,bestSession:le};return[d,Y,ee]}function Ni(f){let r,s,o,c,l,d,b;const j=[xa,ka,wa,_a],g=[];function m(I,y){return I[3]===1?0:I[3]===2?1:I[3]===3?2:3}return o=m(f),c=g[o]=j[o](f),{c(){r=Q("div"),s=Q("div"),c.c(),this.h()},l(I){r=X(I,"DIV",{class:!0});var y=ue(r);s=X(y,"DIV",{class:!0});var A=ue(s);c.l(A),A.forEach(B),y.forEach(B),this.h()},h(){M(s,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),M(r,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(I,y){oe(I,r,y),R(r,s),g[o].m(s,null),b=!0},p(I,y){let A=o;o=m(I),o===A?g[o].p(I,y):(Tt(),Ke(g[A],1,1,()=>{g[A]=null}),Ct(),c=g[o],c?c.p(I,y):(c=g[o]=j[o](I),c.c()),Ee(c,1),c.m(s,null))},i(I){b||(Ee(c),I&&at(()=>{b&&(l||(l=Me(s,Ne,{duration:500},!0)),l.run(1))}),I&&at(()=>{b&&(d||(d=Me(r,Ne,{duration:500},!0)),d.run(1))}),b=!0)},o(I){Ke(c),I&&(l||(l=Me(s,Ne,{duration:500},!1)),l.run(0)),I&&(d||(d=Me(r,Ne,{duration:500},!1)),d.run(0)),b=!1},d(I){I&&B(r),g[o].d(),I&&l&&l.end(),I&&d&&d.end()}}}function _a(f){let r,s,o,c;return s=new ya({props:{closeModal:f[5],meditationResults:f[4]}}),{c(){r=Q("div"),jt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=ue(r);Dt(s.$$.fragment,d),d.forEach(B),this.h()},h(){M(r,"class","absolute inset-0 flex flex-col")},m(l,d){oe(l,r,d),Pt(s,r,null),c=!0},p(l,d){const b={};d&16&&(b.meditationResults=l[4]),s.$set(b)},i(l){c||(Ee(s.$$.fragment,l),l&&at(()=>{c&&(o||(o=Me(r,Ne,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ke(s.$$.fragment,l),l&&(o||(o=Me(r,Ne,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&B(r),Ot(s),l&&o&&o.end()}}}function wa(f){let r,s,o,c;return s=new aa({props:{duration:f[1],nextStep:f[7],levelId:f[2]}}),s.$on("complete",f[8]),{c(){r=Q("div"),jt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=ue(r);Dt(s.$$.fragment,d),d.forEach(B),this.h()},h(){M(r,"class","absolute inset-0 flex flex-col")},m(l,d){oe(l,r,d),Pt(s,r,null),c=!0},p(l,d){const b={};d&2&&(b.duration=l[1]),d&4&&(b.levelId=l[2]),s.$set(b)},i(l){c||(Ee(s.$$.fragment,l),l&&at(()=>{c&&(o||(o=Me(r,Ne,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ke(s.$$.fragment,l),l&&(o||(o=Me(r,Ne,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&B(r),Ot(s),l&&o&&o.end()}}}function ka(f){let r,s,o,c;return s=new ea({props:{nextStep:f[7],closeModal:f[5],levelId:f[2]}}),{c(){r=Q("div"),jt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=ue(r);Dt(s.$$.fragment,d),d.forEach(B),this.h()},h(){M(r,"class","absolute inset-0 flex flex-col")},m(l,d){oe(l,r,d),Pt(s,r,null),c=!0},p(l,d){const b={};d&4&&(b.levelId=l[2]),s.$set(b)},i(l){c||(Ee(s.$$.fragment,l),l&&at(()=>{c&&(o||(o=Me(r,Ne,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ke(s.$$.fragment,l),l&&(o||(o=Me(r,Ne,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&B(r),Ot(s),l&&o&&o.end()}}}function xa(f){let r,s,o,c;return s=new zo({props:{nextStep:f[7],duration:f[1],closeModal:f[5],levelId:f[2]}}),{c(){r=Q("div"),jt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=ue(r);Dt(s.$$.fragment,d),d.forEach(B),this.h()},h(){M(r,"class","absolute inset-0 flex flex-col")},m(l,d){oe(l,r,d),Pt(s,r,null),c=!0},p(l,d){const b={};d&2&&(b.duration=l[1]),d&4&&(b.levelId=l[2]),s.$set(b)},i(l){c||(Ee(s.$$.fragment,l),l&&at(()=>{c&&(o||(o=Me(r,Ne,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ke(s.$$.fragment,l),l&&(o||(o=Me(r,Ne,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&B(r),Ot(s),l&&o&&o.end()}}}function Ta(f){let r,s,o=f[0]&&Ni(f);return{c(){o&&o.c(),r=$n()},l(c){o&&o.l(c),r=$n()},m(c,l){o&&o.m(c,l),oe(c,r,l),s=!0},p(c,[l]){c[0]?o?(o.p(c,l),l&1&&Ee(o,1)):(o=Ni(c),o.c(),Ee(o,1),o.m(r.parentNode,r)):o&&(Tt(),Ke(o,1,1,()=>{o=null}),Ct())},i(c){s||(Ee(o),s=!0)},o(c){Ke(o),s=!1},d(c){c&&B(r),o&&o.d(c)}}}function Ca(f,r,s){let{show:o=!1}=r,{duration:c=rt.ONE_MINUTE}=r,{levelId:l=null}=r,d=1,b;const j=()=>{s(0,o=!1),s(3,d=1)},g=async y=>{const{clickTimestamps:A,durationMeditated:Y,completed:ie}=y.detail,de=l||"L1",V=nt.find(Se=>Se.id===de);if(!V)return;const Z=await Ht.sessions.where("levelId").equals(de).toArray(),W=await gn(de),$=new Set(Object.entries(W).filter(([Se,Be])=>Be).map(([Se])=>Se)),le=Z.map(Se=>en(Se,V)),ae=yn(V.starRules,$,le),ee={levelId:de,duration:Y,tapCount:A.length,tapTimestamps:A,timestamp:Date.now(),completed:ie};await Ht.sessions.add(ee);const z=await gn(de),Ce=new Set(Object.entries(z).filter(([Se,Be])=>Be).map(([Se])=>Se)),Ie=Object.entries(z).filter(([Se,Be])=>Be&&!W[Se]).map(([Se])=>Se),Qe=await Ht.sessions.where("levelId").equals(de).toArray(),re=Qe.map(Se=>en(Se,V)),be=yn(V.starRules,Ce,re),xe=Jn(Qe),Ze=xe&&xe.tapCount===A.length&&xe.duration===Y;s(4,b={...y.detail,levelId:de,previousStarRating:ae,newStarRating:be,newlyCompletedTasks:Ie,completionTaskResults:z,isNewPersonalBest:Ze||!1,personalBest:xe}),m()},m=()=>setTimeout(()=>s(3,d++,d),300),I=y=>g(y);return f.$$set=y=>{"show"in y&&s(0,o=y.show),"duration"in y&&s(1,c=y.duration),"levelId"in y&&s(2,l=y.levelId)},[o,c,l,d,b,j,g,m,I]}class Sa extends Et{constructor(r){super(),It(this,r,Ca,Ta,St,{show:0,duration:1,levelId:2})}}function qi(f,r,s){const o=f.slice();return o[6]=r[s],o}function Fi(f){let r,s=Mr[f[6]]+"",o;return{c(){r=Q("option"),o=fe(s),this.h()},l(c){r=X(c,"OPTION",{});var l=ue(r);o=ce(l,s),l.forEach(B),this.h()},h(){r.__value=f[6],Fo(r,r.__value)},m(c,l){oe(c,r,l),R(r,o)},p:He,d(c){c&&B(r)}}}function Ea(f){let r,s,o="Select Meditation Duration",c,l,d,b,j=Je(f[2]),g=[];for(let m=0;m<j.length;m+=1)g[m]=Fi(qi(f,j,m));return{c(){r=Q("div"),s=Q("label"),s.textContent=o,c=ye(),l=Q("select");for(let m=0;m<g.length;m+=1)g[m].c();this.h()},l(m){r=X(m,"DIV",{class:!0});var I=ue(r);s=X(I,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Ae(s)!=="svelte-g1prfd"&&(s.textContent=o),c=ve(I),l=X(I,"SELECT",{id:!0,class:!0});var y=ue(l);for(let A=0;A<g.length;A+=1)g[A].l(y);y.forEach(B),I.forEach(B),this.h()},h(){M(s,"for","duration"),M(s,"class","text-md font-medium"),M(l,"id","duration"),M(l,"class","select select-bordered w-full max-w-xs"),M(r,"class","flex flex-col items-start gap-1")},m(m,I){oe(m,r,I),R(r,s),R(r,c),R(r,l);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(l,null);ki(l,f[1]),d||(b=vt(l,"change",f[5]),d=!0)},p(m,[I]){if(I&4){j=Je(m[2]);let y;for(y=0;y<j.length;y+=1){const A=qi(m,j,y);g[y]?g[y].p(A,I):(g[y]=Fi(A),g[y].c(),g[y].m(l,null))}for(;y<g.length;y+=1)g[y].d(1);g.length=j.length}I&6&&ki(l,m[1])},i:He,o:He,d(m){m&&B(r),zt(g,m),d=!1,b()}}}function Ia(f,r,s){let{onDurationChange:o}=r,{minDuration:c=rt.ONE_MINUTE}=r,{maxDuration:l=rt.SIXTY_MINUTES}=r,{selectedDuration:d=c??rt.ONE_MINUTE}=r;const b=Object.values(rt).filter(g=>typeof g=="number").filter(g=>g>=c&&g<=l),j=g=>o(Number(g.currentTarget.value));return f.$$set=g=>{"onDurationChange"in g&&s(0,o=g.onDurationChange),"minDuration"in g&&s(3,c=g.minDuration),"maxDuration"in g&&s(4,l=g.maxDuration),"selectedDuration"in g&&s(1,d=g.selectedDuration)},[o,d,b,c,l,j]}class Oa extends Et{constructor(r){super(),It(this,r,Ia,Ea,St,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Li(f,r,s){const o=f.slice();return o[9]=r[s].level,o[10]=r[s].isUnlocked,o[11]=r[s].taskCompletion,o[12]=r[s].starRating,o[13]=r[s].bestSession,o[14]=r,o[15]=s,o}function Ui(f,r,s){const o=f.slice();return o[16]=r[s],o[18]=s,o}function Vi(f,r,s){const o=f.slice();return o[19]=r[s],o[18]=s,o}function Pa(f){let r,s,o="Section 1: Focus",c,l,d,b="<h2>Section 2: Sharpness</h2> <i>Coming soon</i>",j,g=Je(f[3]),m=[];for(let y=0;y<g.length;y+=1)m[y]=Qi(Li(f,g,y));const I=y=>Ke(m[y],1,1,()=>{m[y]=null});return{c(){r=Q("div"),s=Q("h2"),s.textContent=o,c=ye();for(let y=0;y<m.length;y+=1)m[y].c();l=ye(),d=Q("div"),d.innerHTML=b,this.h()},l(y){r=X(y,"DIV",{class:!0});var A=ue(r);s=X(A,"H2",{class:!0,"data-svelte-h":!0}),Ae(s)!=="svelte-jjrz8w"&&(s.textContent=o),c=ve(A);for(let Y=0;Y<m.length;Y+=1)m[Y].l(A);A.forEach(B),l=ve(y),d=X(y,"DIV",{class:!0,"data-svelte-h":!0}),Ae(d)!=="svelte-1nrer3t"&&(d.innerHTML=b),this.h()},h(){M(s,"class","font-bold"),M(r,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full"),M(d,"class","mt-8")},m(y,A){oe(y,r,A),R(r,s),R(r,c);for(let Y=0;Y<m.length;Y+=1)m[Y]&&m[Y].m(r,null);oe(y,l,A),oe(y,d,A),j=!0},p(y,A){if(A&46){g=Je(y[3]);let Y;for(Y=0;Y<g.length;Y+=1){const ie=Li(y,g,Y);m[Y]?(m[Y].p(ie,A),Ee(m[Y],1)):(m[Y]=Qi(ie),m[Y].c(),Ee(m[Y],1),m[Y].m(r,null))}for(Tt(),Y=g.length;Y<m.length;Y+=1)I(Y);Ct()}},i(y){if(!j){for(let A=0;A<g.length;A+=1)Ee(m[A]);j=!0}},o(y){m=m.filter(Boolean);for(let A=0;A<m.length;A+=1)Ke(m[A]);j=!1},d(y){y&&(B(r),B(l),B(d)),zt(m,y)}}}function Da(f){let r,s='<div class="loading loading-spinner loading-lg"></div>';return{c(){r=Q("div"),r.innerHTML=s,this.h()},l(o){r=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-1mgfhb9"&&(r.innerHTML=s),this.h()},h(){M(r,"class","flex justify-center items-center mt-8")},m(o,c){oe(o,r,c)},p:He,i:He,o:He,d(o){o&&B(r)}}}function Yi(f){let r,s="ð";return{c(){r=Q("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-19hy9gc"&&(r.textContent=s),this.h()},h(){M(r,"class","text-2xl")},m(o,c){oe(o,r,c)},d(o){o&&B(r)}}}function Hi(f){let r,s=Je(Array(3)),o=[];for(let c=0;c<s.length;c+=1)o[c]=zi(Vi(f,s,c));return{c(){r=Q("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r=X(c,"DIV",{class:!0});var l=ue(r);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(B),this.h()},h(){M(r,"class","flex items-center")},m(c,l){oe(c,r,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(c,l){if(l&8){s=Je(Array(3));let d;for(d=0;d<s.length;d+=1){const b=Vi(c,s,d);o[d]?o[d].p(b,l):(o[d]=zi(b),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&B(r),zt(o,c)}}}function ja(f){let r,s="â";return{c(){r=Q("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-1tpxw7h"&&(r.textContent=s),this.h()},h(){M(r,"class","text-2xl text-gray-300")},m(o,c){oe(o,r,c)},d(o){o&&B(r)}}}function Ka(f){let r,s="â­";return{c(){r=Q("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-1jlkvsx"&&(r.textContent=s),this.h()},h(){M(r,"class","text-2xl")},m(o,c){oe(o,r,c)},d(o){o&&B(r)}}}function zi(f){let r;function s(l,d){return l[18]<l[12]?Ka:ja}let o=s(f),c=o(f);return{c(){c.c(),r=$n()},l(l){c.l(l),r=$n()},m(l,d){c.m(l,d),oe(l,r,d)},p(l,d){o!==(o=s(l))&&(c.d(1),c=o(l),c&&(c.c(),c.m(r.parentNode,r)))},d(l){l&&B(r),c.d(l)}}}function Wi(f){let r,s,o=f[13].tapCount+"",c,l,d=tn(f[13].duration)+"",b,j;return{c(){r=Q("p"),s=fe("Your best: "),c=fe(o),l=fe(" taps Â· "),b=fe(d),j=fe(" min"),this.h()},l(g){r=X(g,"P",{class:!0});var m=ue(r);s=ce(m,"Your best: "),c=ce(m,o),l=ce(m," taps Â· "),b=ce(m,d),j=ce(m," min"),m.forEach(B),this.h()},h(){M(r,"class","text-sm text-gray-500")},m(g,m){oe(g,r,m),R(r,s),R(r,c),R(r,l),R(r,b),R(r,j)},p(g,m){m&8&&o!==(o=g[13].tapCount+"")&&Le(c,o),m&8&&d!==(d=tn(g[13].duration)+"")&&Le(b,d)},d(g){g&&B(r)}}}function Gi(f){let r,s=Je(f[9].completionTasks),o=[];for(let c=0;c<s.length;c+=1)o[c]=Xi(Ui(f,s,c));return{c(){r=Q("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r=X(c,"DIV",{class:!0});var l=ue(r);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(B),this.h()},h(){M(r,"class","space-y-0")},m(c,l){oe(c,r,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(c,l){if(l&8){s=Je(c[9].completionTasks);let d;for(d=0;d<s.length;d+=1){const b=Ui(c,s,d);o[d]?o[d].p(b,l):(o[d]=Xi(b),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&B(r),zt(o,c)}}}function Xi(f){let r,s,o=f[11][f[16].id]?"â":"ð²",c,l,d=f[16].description+"",b,j;return{c(){r=Q("div"),s=Q("span"),c=fe(o),l=ye(),b=fe(d),j=ye(),this.h()},l(g){r=X(g,"DIV",{class:!0});var m=ue(r);s=X(m,"SPAN",{class:!0});var I=ue(s);c=ce(I,o),l=ve(I),b=ce(I,d),I.forEach(B),j=ve(m),m.forEach(B),this.h()},h(){M(s,"class","mr-2 text-sm text-gray-500"),M(r,"class","flex items-center")},m(g,m){oe(g,r,m),R(r,s),R(s,c),R(s,l),R(s,b),R(r,j)},p(g,m){m&8&&o!==(o=g[11][g[16].id]?"â":"ð²")&&Le(c,o),m&8&&d!==(d=g[16].description+"")&&Le(b,d)},d(g){g&&B(r)}}}function Ra(f){let r,s='<p class="text-sm text-gray-500">Complete previous levels to unlock</p>';return{c(){r=Q("div"),r.innerHTML=s,this.h()},l(o){r=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-pdbav7"&&(r.innerHTML=s),this.h()},h(){M(r,"class","space-y-4 mt-8")},m(o,c){oe(o,r,c)},p:He,i:He,o:He,d(o){o&&B(r)}}}function Aa(f){let r,s,o,c,l="Start meditation",d,b,j;function g(...I){return f[6](f[9],f[14],f[15],...I)}s=new Oa({props:{selectedDuration:f[9].selectedDuration,onDurationChange:g,minDuration:f[9].minDuration,maxDuration:f[9].maxDuration}});function m(){return f[7](f[9])}return{c(){r=Q("div"),jt(s.$$.fragment),o=ye(),c=Q("button"),c.textContent=l,this.h()},l(I){r=X(I,"DIV",{class:!0});var y=ue(r);Dt(s.$$.fragment,y),o=ve(y),c=X(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(c)!=="svelte-1m9y00f"&&(c.textContent=l),y.forEach(B),this.h()},h(){M(c,"class","btn variant-filled w-full"),M(r,"class","space-y-6 mt-8")},m(I,y){oe(I,r,y),Pt(s,r,null),R(r,o),R(r,c),d=!0,b||(j=vt(c,"click",m),b=!0)},p(I,y){f=I;const A={};y&8&&(A.selectedDuration=f[9].selectedDuration),y&8&&(A.onDurationChange=g),y&8&&(A.minDuration=f[9].minDuration),y&8&&(A.maxDuration=f[9].maxDuration),s.$set(A)},i(I){d||(Ee(s.$$.fragment,I),d=!0)},o(I){Ke(s.$$.fragment,I),d=!1},d(I){I&&B(r),Ot(s),b=!1,j()}}}function Qi(f){let r,s,o,c,l=f[9].name+"",d,b,j,g,m,I=f[9].description+"",y,A,Y,ie,de,V,Z,W,$,le=!f[10]&&Yi(),ae=f[12]!==void 0&&f[10]&&Hi(f),ee=f[13]&&f[10]&&Wi(f),z=f[11]&&f[10]&&Gi(f);const Ce=[Aa,Ra],Ie=[];function Qe(re,be){return re[10]?0:1}return de=Qe(f),V=Ie[de]=Ce[de](f),{c(){r=Q("div"),s=Q("div"),o=Q("h3"),le&&le.c(),c=ye(),d=fe(l),b=ye(),ae&&ae.c(),j=ye(),g=Q("div"),m=Q("p"),y=fe(I),A=ye(),ee&&ee.c(),Y=ye(),z&&z.c(),ie=ye(),V.c(),Z=ye(),this.h()},l(re){r=X(re,"DIV",{class:!0});var be=ue(r);s=X(be,"DIV",{class:!0});var xe=ue(s);o=X(xe,"H3",{class:!0});var Ze=ue(o);le&&le.l(Ze),c=ve(Ze),d=ce(Ze,l),Ze.forEach(B),b=ve(xe),ae&&ae.l(xe),xe.forEach(B),j=ve(be),g=X(be,"DIV",{class:!0});var Se=ue(g);m=X(Se,"P",{class:!0});var Be=ue(m);y=ce(Be,I),Be.forEach(B),A=ve(Se),ee&&ee.l(Se),Se.forEach(B),Y=ve(be),z&&z.l(be),ie=ve(be),V.l(be),Z=ve(be),be.forEach(B),this.h()},h(){M(o,"class","text-lg font-bold"),M(s,"class","flex justify-between items-center mb-2"),M(m,"class","text-sm text-muted-foreground mb-2"),M(g,"class","mb-2"),M(r,"class",W="card bg-[#ffffffa6] p-8 "+(f[10]?"":"opacity-60"))},m(re,be){oe(re,r,be),R(r,s),R(s,o),le&&le.m(o,null),R(o,c),R(o,d),R(s,b),ae&&ae.m(s,null),R(r,j),R(r,g),R(g,m),R(m,y),R(g,A),ee&&ee.m(g,null),R(r,Y),z&&z.m(r,null),R(r,ie),Ie[de].m(r,null),R(r,Z),$=!0},p(re,be){re[10]?le&&(le.d(1),le=null):le||(le=Yi(),le.c(),le.m(o,c)),(!$||be&8)&&l!==(l=re[9].name+"")&&Le(d,l),re[12]!==void 0&&re[10]?ae?ae.p(re,be):(ae=Hi(re),ae.c(),ae.m(s,null)):ae&&(ae.d(1),ae=null),(!$||be&8)&&I!==(I=re[9].description+"")&&Le(y,I),re[13]&&re[10]?ee?ee.p(re,be):(ee=Wi(re),ee.c(),ee.m(g,null)):ee&&(ee.d(1),ee=null),re[11]&&re[10]?z?z.p(re,be):(z=Gi(re),z.c(),z.m(r,ie)):z&&(z.d(1),z=null);let xe=de;de=Qe(re),de===xe?Ie[de].p(re,be):(Tt(),Ke(Ie[xe],1,1,()=>{Ie[xe]=null}),Ct(),V=Ie[de],V?V.p(re,be):(V=Ie[de]=Ce[de](re),V.c()),Ee(V,1),V.m(r,Z)),(!$||be&8&&W!==(W="card bg-[#ffffffa6] p-8 "+(re[10]?"":"opacity-60")))&&M(r,"class",W)},i(re){$||(Ee(V),$=!0)},o(re){Ke(V),$=!1},d(re){re&&B(r),le&&le.d(),ae&&ae.d(),ee&&ee.d(),z&&z.d(),Ie[de].d()}}}function Ba(f){let r,s,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',c,l,d,b,j,g=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org â</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn â</a></p>`,m,I,y,A;const Y=[Da,Pa],ie=[];function de(W,$){return W[4]?0:1}l=de(f),d=ie[l]=Y[l](f);function V(W){f[8](W)}let Z={duration:f[1],levelId:f[2]};return f[0]!==void 0&&(Z.show=f[0]),I=new Sa({props:Z}),qr.push(()=>Lr(I,"show",V)),{c(){r=Q("div"),s=Q("div"),s.innerHTML=o,c=ye(),d.c(),b=ye(),j=Q("div"),j.innerHTML=g,m=ye(),jt(I.$$.fragment),this.h()},l(W){r=X(W,"DIV",{class:!0});var $=ue(r);s=X($,"DIV",{class:!0,"data-svelte-h":!0}),Ae(s)!=="svelte-50yq01"&&(s.innerHTML=o),c=ve($),d.l($),b=ve($),j=X($,"DIV",{class:!0,"data-svelte-h":!0}),Ae(j)!=="svelte-dgw8za"&&(j.innerHTML=g),$.forEach(B),m=ve(W),Dt(I.$$.fragment,W),this.h()},h(){M(s,"class","space-y-6 text-center mt-10 mb-8"),M(j,"class","text-center text-sm text-gray-500 mt-40"),M(r,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(W,$){oe(W,r,$),R(r,s),R(r,c),ie[l].m(r,null),R(r,b),R(r,j),oe(W,m,$),Pt(I,W,$),A=!0},p(W,[$]){let le=l;l=de(W),l===le?ie[l].p(W,$):(Tt(),Ke(ie[le],1,1,()=>{ie[le]=null}),Ct(),d=ie[l],d?d.p(W,$):(d=ie[l]=Y[l](W),d.c()),Ee(d,1),d.m(r,b));const ae={};$&2&&(ae.duration=W[1]),$&4&&(ae.levelId=W[2]),!y&&$&1&&(y=!0,ae.show=W[0],Fr(()=>y=!1)),I.$set(ae)},i(W){A||(Ee(d),Ee(I.$$.fragment,W),A=!0)},o(W){Ke(d),Ke(I.$$.fragment,W),A=!1},d(W){W&&(B(r),B(m)),ie[l].d(),Ot(I,W)}}}function Ma(f,r,s){let o=!1,c=rt.ONE_MINUTE,l=null,d=[],b=!0;const j=()=>{window.audioContext||(window.audioContext=new(window.AudioContext||window.webkitAudioContext)),s(0,o=!0)},g=(y,A,Y,ie)=>s(3,A[Y].level.selectedDuration=ie,d),m=y=>{s(2,l=y.id),s(1,c=y.selectedDuration),j()};function I(y){o=y,s(0,o)}return f.$$.update=()=>{f.$$.dirty&1&&(o||(s(4,b=!0),ba().then(y=>{s(3,d=y),y.forEach(({level:A})=>{A.selectedDuration=A.minDuration}),s(4,b=!1)}).catch(y=>{console.error("Failed to reload level statuses:",y),s(4,b=!1)})))},[o,c,l,d,b,j,g,m,I]}class $a extends Et{constructor(r){super(),It(this,r,Ma,Ba,St,{})}}export{$a as component};
