var No=Object.defineProperty;var Bo=(u,n,s)=>n in u?No(u,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[n]=s;var ki=(u,n,s)=>Bo(u,typeof n!="symbol"?n+"":n,s);import{B as qo,s as Tt,d as A,Z as Yt,c as te,e as R,w as N,f as W,g as se,j as he,k as X,l as pe,q as Br,n as We,C as it,U as pt,_ as Ne,$ as Fo,a0 as Lo,b as Be,i as Uo,h as oe,t as ae,a1 as Yn,a2 as Hn,a3 as eo,m as Xn,a4 as Vo,y as qr,a5 as Fr,r as to,x as zn,P as Vt,o as Qn,a6 as xi,a7 as Yo}from"../chunks/BIM6er8B.js";import{S as Et,i as Ct,t as je,a as Te,g as kt,c as xt,f as qe,h as Lr,d as St,m as It,e as Ot,b as Pt}from"../chunks/CLOSa3QW.js";import{p as ct}from"../chunks/CmP4wuhm.js";import{d as Ti,w as Wn}from"../chunks/BSzwmYPV.js";function et(u){return(u==null?void 0:u.length)!==void 0?u:Array.from(u)}function Fe(u,{delay:n=0,duration:s=400,easing:o=qo}={}){const c=+getComputedStyle(u).opacity;return{delay:n,duration:s,easing:o,css:l=>`opacity: ${l*c}`}}var Ye=(u=>(u[u.ONE_MINUTE=60]="ONE_MINUTE",u[u.TWO_MINUTES=120]="TWO_MINUTES",u[u.FIVE_MINUTES=300]="FIVE_MINUTES",u[u.TEN_MINUTES=600]="TEN_MINUTES",u[u.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",u[u.THIRTY_MINUTES=1800]="THIRTY_MINUTES",u[u.SIXTY_MINUTES=3600]="SIXTY_MINUTES",u))(Ye||{});const Rr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ho(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var no={exports:{}};(function(u,n){(function(s,o){u.exports=o()})(Ei,function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function c(e,t,r){for(var i,a=0,f=t.length;a<f;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ei,d=Object.keys,_=Array.isArray;function j(e,t){return typeof t!="object"||d(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var g=Object.getPrototypeOf,y={}.hasOwnProperty;function I(e,t){return y.call(e,t)}function p(e,t){typeof t=="function"&&(t=t(g(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(r){F(e,r,t[r])})}var K=Object.defineProperty;function F(e,t,r,i){K(e,t,j(r&&I(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},i))}function ue(e){return{from:function(t){return e.prototype=Object.create(t.prototype),F(e.prototype,"constructor",e),{extend:p.bind(null,e.prototype)}}}}var ce=Object.getOwnPropertyDescriptor,z=[].slice;function $(e,t,r){return z.call(e,t,r)}function H(e,t){return t(e)}function J(e){if(!e)throw new Error("Assertion Failed")}function ve(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function ie(e,t){if(typeof t=="string"&&I(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],i=0,a=t.length;i<a;++i){var f=ie(e,t[i]);r.push(f)}return r}var h=t.indexOf(".");if(h!==-1){var m=e[t.substr(0,h)];return m==null?void 0:ie(m,t.substr(h+1))}}function Z(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){J(typeof r!="string"&&"length"in r);for(var i=0,a=t.length;i<a;++i)Z(e,t[i],r[i])}else{var f,h,m=t.indexOf(".");m!==-1?(f=t.substr(0,m),(h=t.substr(m+1))===""?r===void 0?_(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=r:Z(m=!(m=e[f])||!I(e,f)?e[f]={}:m,h,r)):r===void 0?_(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function ne(e){var t,r={};for(t in e)I(e,t)&&(r[t]=e[t]);return r}var Oe=[].concat;function Se(e){return Oe.apply([],e)}var Kt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Se([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),Ee=new Set(Kt.map(function(e){return l[e]})),fe=null;function le(e){return fe=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var i=fe.get(r);if(i)return i;if(_(r)){i=[],fe.set(r,i);for(var a=0,f=r.length;a<f;++a)i.push(t(r[a]))}else if(Ee.has(r.constructor))i=r;else{var h,m=g(r);for(h in i=m===Object.prototype?{}:Object.create(m),fe.set(r,i),r)I(r,h)&&(i[h]=t(r[h]))}return i}(e),fe=null,e}var He={}.toString;function Je(e){return He.call(e).slice(8,-1)}var ge=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ke=typeof ge=="symbol"?function(e){var t;return e!=null&&(t=e[ge])&&t.apply(e)}:function(){return null};function Me(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Re={};function Ie(e){var t,r,i,a;if(arguments.length===1){if(_(e))return e.slice();if(this===Re&&typeof e=="string")return[e];if(a=Ke(e)){for(r=[];!(i=a.next()).done;)r.push(i.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Ve=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},tn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],rt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(tn),ye={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function _e(e,t){this.name=e,this.message=t}function Ae(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,i,a){return a.indexOf(r)===i}).join(`
`)}function ot(e,t,r,i){this.failures=t,this.failedKeys=i,this.successCount=r,this.message=Ae(e,t)}function ft(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=Ae(e,this.failures)}ue(_e).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ue(ot).from(_e),ue(ft).from(_e);var Dt=rt.reduce(function(e,t){return e[t]=t+"Error",e},{}),oo=_e,re=rt.reduce(function(e,t){var r=t+"Error";function i(a,f){this.name=r,a?typeof a=="string"?(this.message="".concat(a).concat(f?`
 `+f:""),this.inner=f||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=ye[t]||r,this.inner=null)}return ue(i).from(oo),e[t]=i,e},{});re.Syntax=SyntaxError,re.Type=TypeError,re.Range=RangeError;var Ur=tn.reduce(function(e,t){return e[t+"Error"]=re[t],e},{}),yn=rt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=re[t]),e},{});function Ce(){}function Zt(e){return e}function ao(e,t){return e==null||e===Zt?t:function(r){return t(e(r))}}function jt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function so(e,t){return e===Ce?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var f=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?jt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?jt(a,this.onerror):a),f!==void 0?f:r}}function uo(e,t){return e===Ce?t:function(){e.apply(this,arguments);var r=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?jt(r,this.onsuccess):r),i&&(this.onerror=this.onerror?jt(i,this.onerror):i)}}function lo(e,t){return e===Ce?t:function(r){var i=e.apply(this,arguments);j(r,i);var a=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?jt(a,this.onsuccess):a),f&&(this.onerror=this.onerror?jt(f,this.onerror):f),i===void 0?r===void 0?void 0:r:j(i,r)}}function co(e,t){return e===Ce?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Zn(e,t){return e===Ce?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var i=this,a=arguments.length,f=new Array(a);a--;)f[a]=arguments[a];return r.then(function(){return t.apply(i,f)})}return t.apply(this,arguments)}}yn.ModifyError=ot,yn.DexieError=_e,yn.BulkError=ft;var at=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Vr(e){at=e}var en={},Yr=100,Kt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,g(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,g(t),e]}(),tn=Kt[0],rt=Kt[1],Kt=Kt[2],rt=rt&&rt.then,Mt=tn&&tn.constructor,er=!!Kt,nn=function(e,t){rn.push([e,t]),_n&&(queueMicrotask(ho),_n=!1)},tr=!0,_n=!0,Rt=[],gn=[],nr=Zt,mt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ce,pgp:!1,env:{},finalize:Ce},ee=mt,rn=[],At=0,bn=[];function G(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ee;if(typeof e!="function"){if(e!==en)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ir(this,this._value))}this._state=null,this._value=null,++t.ref,function r(i,a){try{a(function(f){if(i._state===null){if(f===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Ht();f&&typeof f.then=="function"?r(i,function(m,b){f instanceof G?f._then(m,b):f.then(m,b)}):(i._state=!0,i._value=f,zr(i)),h&&zt()}},ir.bind(null,i))}catch(f){ir(i,f)}}(this,e)}var rr={get:function(){var e=ee,t=Tn;function r(i,a){var f=this,h=!e.global&&(e!==ee||t!==Tn),m=h&&!yt(),b=new G(function(k,E){or(f,new Hr(Wr(i,e,h,m),Wr(a,e,h,m),k,E,e))});return this._consoleTask&&(b._consoleTask=this._consoleTask),b}return r.prototype=en,r},set:function(e){F(this,"then",e&&e.prototype===en?rr:{get:function(){return e},set:rr.set})}};function Hr(e,t,r,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=i,this.psd=a}function ir(e,t){var r,i;gn.push(t),e._state===null&&(r=e._lib&&Ht(),t=nr(t),e._state=!1,e._value=t,i=e,Rt.some(function(a){return a._value===i._value})||Rt.push(i),zr(e),r&&zt())}function zr(e){var t=e._listeners;e._listeners=[];for(var r=0,i=t.length;r<i;++r)or(e,t[r]);var a=e._PSD;--a.ref||a.finalize(),At===0&&(++At,nn(function(){--At==0&&ar()},[]))}function or(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++At,nn(fo,[r,e,t])}else e._listeners.push(t)}function fo(e,t,r){try{var i,a=t._value;!t._state&&gn.length&&(gn=[]),i=at&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||gn.indexOf(a)!==-1||function(f){for(var h=Rt.length;h;)if(Rt[--h]._value===f._value)return Rt.splice(h,1)}(t),r.resolve(i)}catch(f){r.reject(f)}finally{--At==0&&ar(),--r.psd.ref||r.psd.finalize()}}function ho(){Nt(mt,function(){Ht()&&zt()})}function Ht(){var e=tr;return _n=tr=!1,e}function zt(){var e,t,r;do for(;0<rn.length;)for(e=rn,rn=[],r=e.length,t=0;t<r;++t){var i=e[t];i[0].apply(null,i[1])}while(0<rn.length);_n=tr=!0}function ar(){var e=Rt;Rt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=bn.slice(0),r=t.length;r;)t[--r]()}function wn(e){return new G(en,!1,e)}function De(e,t){var r=ee;return function(){var i=Ht(),a=ee;try{return _t(r,!0),e.apply(this,arguments)}catch(f){t&&t(f)}finally{_t(a,!1),i&&zt()}}}p(G.prototype,{then:rr,_then:function(e,t){or(this,new Hr(null,null,e,t,ee))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?r:wn)(i)}):this.then(null,function(i){return(i&&i.name===t?r:wn)(i)})},finally:function(e){return this.then(function(t){return G.resolve(e()).then(function(){return t})},function(t){return G.resolve(e()).then(function(){return wn(t)})})},timeout:function(e,t){var r=this;return e<1/0?new G(function(i,a){var f=setTimeout(function(){return a(new re.Timeout(t))},e);r.then(i,a).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&F(G.prototype,Symbol.toStringTag,"Dexie.Promise"),mt.env=Gr(),p(G,{all:function(){var e=Ie.apply(null,arguments).map(En);return new G(function(t,r){e.length===0&&t([]);var i=e.length;e.forEach(function(a,f){return G.resolve(a).then(function(h){e[f]=h,--i||t(e)},r)})})},resolve:function(e){return e instanceof G?e:e&&typeof e.then=="function"?new G(function(t,r){e.then(t,r)}):new G(en,!0,e)},reject:wn,race:function(){var e=Ie.apply(null,arguments).map(En);return new G(function(t,r){e.map(function(i){return G.resolve(i).then(t,r)})})},PSD:{get:function(){return ee},set:function(e){return ee=e}},totalEchoes:{get:function(){return Tn}},newPSD:vt,usePSD:Nt,scheduler:{get:function(){return nn},set:function(e){nn=e}},rejectionMapper:{get:function(){return nr},set:function(e){nr=e}},follow:function(e,t){return new G(function(r,i){return vt(function(a,f){var h=ee;h.unhandleds=[],h.onunhandled=f,h.finalize=jt(function(){var m,b=this;m=function(){b.unhandleds.length===0?a():f(b.unhandleds[0])},bn.push(function k(){m(),bn.splice(bn.indexOf(k),1)}),++At,nn(function(){--At==0&&ar()},[])},h.finalize),e()},t,r,i)})}}),Mt&&(Mt.allSettled&&F(G,"allSettled",function(){var e=Ie.apply(null,arguments).map(En);return new G(function(t){e.length===0&&t([]);var r=e.length,i=new Array(r);e.forEach(function(a,f){return G.resolve(a).then(function(h){return i[f]={status:"fulfilled",value:h}},function(h){return i[f]={status:"rejected",reason:h}}).then(function(){return--r||t(i)})})})}),Mt.any&&typeof AggregateError<"u"&&F(G,"any",function(){var e=Ie.apply(null,arguments).map(En);return new G(function(t,r){e.length===0&&r(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(f,h){return G.resolve(f).then(function(m){return t(m)},function(m){a[h]=m,--i||r(new AggregateError(a))})})})}),Mt.withResolvers&&(G.withResolvers=Mt.withResolvers));var ze={awaits:0,echoes:0,id:0},po=0,kn=[],xn=0,Tn=0,mo=0;function vt(e,t,r,i){var a=ee,f=Object.create(a);return f.parent=a,f.ref=0,f.global=!1,f.id=++mo,mt.env,f.env=er?{Promise:G,PromiseProp:{value:G,configurable:!0,writable:!0},all:G.all,race:G.race,allSettled:G.allSettled,any:G.any,resolve:G.resolve,reject:G.reject}:{},t&&j(f,t),++a.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Nt(f,e,r,i),f.ref===0&&f.finalize(),i}function Gt(){return ze.id||(ze.id=++po),++ze.awaits,ze.echoes+=Yr,ze.id}function yt(){return!!ze.awaits&&(--ze.awaits==0&&(ze.id=0),ze.echoes=ze.awaits*Yr,!0)}function En(e){return ze.echoes&&e&&e.constructor===Mt?(Gt(),e.then(function(t){return yt(),t},function(t){return yt(),Le(t)})):e}function vo(){var e=kn[kn.length-1];kn.pop(),_t(e,!1)}function _t(e,t){var r,i=ee;(t?!ze.echoes||xn++&&e===ee:!xn||--xn&&e===ee)||queueMicrotask(t?(function(a){++Tn,ze.echoes&&--ze.echoes!=0||(ze.echoes=ze.awaits=ze.id=0),kn.push(ee),_t(a,!0)}).bind(null,e):vo),e!==ee&&(ee=e,i===mt&&(mt.env=Gr()),er&&(r=mt.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(l,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function Gr(){var e=l.Promise;return er?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Nt(e,t,r,i,a){var f=ee;try{return _t(e,!0),t(r,i,a)}finally{_t(f,!1)}}function Wr(e,t,r,i){return typeof e!="function"?e:function(){var a=ee;r&&Gt(),_t(t,!0);try{return e.apply(this,arguments)}finally{_t(a,!1),i&&queueMicrotask(yt)}}}function sr(e){Promise===Mt&&ze.echoes===0?xn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+rt).indexOf("[native code]")===-1&&(Gt=yt=Ce);var Le=G.reject,Bt="ï¿¿",dt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Xr="String expected.",Wt=[],Cn="__dbnames",ur="readonly",lr="readwrite";function qt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Qr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=le(t))[e],t}}function $r(){throw re.Type()}function ke(e,t){try{var r=Jr(e),i=Jr(t);if(r!==i)return r==="Array"?1:i==="Array"?-1:r==="binary"?1:i==="binary"?-1:r==="string"?1:i==="string"?-1:r==="Date"?1:i!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,f){for(var h=a.length,m=f.length,b=h<m?h:m,k=0;k<b;++k)if(a[k]!==f[k])return a[k]<f[k]?-1:1;return h===m?0:h<m?-1:1}(Zr(e),Zr(t));case"Array":return function(a,f){for(var h=a.length,m=f.length,b=h<m?h:m,k=0;k<b;++k){var E=ke(a[k],f[k]);if(E!==0)return E}return h===m?0:h<m?-1:1}(e,t)}}catch{}return NaN}function Jr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Je(e),e==="ArrayBuffer"?"binary":e)}function Zr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ei=(Pe.prototype._trans=function(e,t,r){var i=this._tx||ee.trans,a=this.name,f=at&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(k,E,v){if(!v.schema[a])throw new re.NotFound("Table "+a+" not part of transaction");return t(v.idbtrans,v)}var m=Ht();try{var b=i&&i.db._novip===this.db._novip?i===ee.trans?i._promise(e,h,r):vt(function(){return i._promise(e,h,r)},{trans:i,transless:ee.transless||ee}):function k(E,v,S,w){if(E.idbdb&&(E._state.openComplete||ee.letThrough||E._vip)){var T=E._createTransaction(v,S,E._dbSchema);try{T.create(),E._state.PR1398_maxLoop=3}catch(C){return C.name===Dt.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return k(E,v,S,w)})):Le(C)}return T._promise(v,function(C,x){return vt(function(){return ee.trans=T,w(C,x,T)})}).then(function(C){if(v==="readwrite")try{T.idbtrans.commit()}catch{}return v==="readonly"?C:T._completion.then(function(){return C})})}if(E._state.openComplete)return Le(new re.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return Le(new re.DatabaseClosed);E.open().catch(Ce)}return E._state.dbReadyPromise.then(function(){return k(E,v,S,w)})}(this.db,e,[this.name],h);return f&&(b._consoleTask=f,b=b.catch(function(k){return console.trace(k),Le(k)})),b}finally{m&&zt()}},Pe.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Le(new re.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(a){return r.hook.reading.fire(a)})}).then(t)},Pe.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(_(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&t.every(function(k){return 0<=m.keyPath.indexOf(k)})){for(var b=0;b<t.length;++b)if(t.indexOf(m.keyPath[b])===-1)return!1;return!0}return!1}).sort(function(m,b){return m.keyPath.length-b.keyPath.length})[0];if(r&&this.db._maxKey!==Bt){var f=r.keyPath.slice(0,t.length);return this.where(f).equals(f.map(function(b){return e[b]}))}!r&&at&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(m,b){return ke(m,b)===0}var h=t.reduce(function(v,b){var k=v[0],E=v[1],v=i[b],S=e[b];return[k||v,k||!v?qt(E,v&&v.multi?function(w){return w=ie(w,b),_(w)&&w.some(function(T){return a(S,T)})}:function(w){return a(S,ie(w,b))}):E]},[null,null]),f=h[0],h=h[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(h):r?this.filter(h):this.where(t).equals("")},Pe.prototype.filter=function(e){return this.toCollection().and(e)},Pe.prototype.count=function(e){return this.toCollection().count(e)},Pe.prototype.offset=function(e){return this.toCollection().offset(e)},Pe.prototype.limit=function(e){return this.toCollection().limit(e)},Pe.prototype.each=function(e){return this.toCollection().each(e)},Pe.prototype.toArray=function(e){return this.toCollection().toArray(e)},Pe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Pe.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,_(e)?"[".concat(e.join("+"),"]"):e))},Pe.prototype.reverse=function(){return this.toCollection().reverse()},Pe.prototype.mapToClass=function(e){var t,r=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof $r&&(function(b,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");function E(){this.constructor=b}s(b,k),b.prototype=k===null?Object.create(k):(E.prototype=k.prototype,new E)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var f=new Set,h=e.prototype;h;h=g(h))Object.getOwnPropertyNames(h).forEach(function(b){return f.add(b)});function m(b){if(!b)return b;var k,E=Object.create(e.prototype);for(k in b)if(!f.has(k))try{E[k]=b[k]}catch{}return E}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),e},Pe.prototype.defineClass=function(){return this.mapToClass(function(e){j(this,e)})},Pe.prototype.add=function(e,t){var r=this,i=this.schema.primKey,a=i.auto,f=i.keyPath,h=e;return f&&a&&(h=Sn(f)(e)),this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(m){return m.numFailures?G.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{Z(e,f,m)}catch{}return m})},Pe.prototype.update=function(e,t){return typeof e!="object"||_(e)?this.where(":id").equals(e).modify(t):(e=ie(e,this.schema.primKey.keyPath),e===void 0?Le(new re.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Pe.prototype.put=function(e,t){var r=this,i=this.schema.primKey,a=i.auto,f=i.keyPath,h=e;return f&&a&&(h=Sn(f)(e)),this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(m){return m.numFailures?G.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{Z(e,f,m)}catch{}return m})},Pe.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?G.reject(r.failures[0]):void 0})},Pe.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Qr})}).then(function(t){return t.numFailures?G.reject(t.failures[0]):void 0})},Pe.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},Pe.prototype.bulkAdd=function(e,t,r){var i=this,a=Array.isArray(t)?t:void 0,f=(r=r||(a?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var k=i.schema.primKey,m=k.auto,k=k.keyPath;if(k&&a)throw new re.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new re.InvalidArgument("Arguments objects and keys must have the same length");var b=e.length,k=k&&m?e.map(Sn(k)):e;return i.core.mutate({trans:h,type:"add",keys:a,values:k,wantResults:f}).then(function(T){var v=T.numFailures,S=T.results,w=T.lastResult,T=T.failures;if(v===0)return f?S:w;throw new ft("".concat(i.name,".bulkAdd(): ").concat(v," of ").concat(b," operations failed"),T)})})},Pe.prototype.bulkPut=function(e,t,r){var i=this,a=Array.isArray(t)?t:void 0,f=(r=r||(a?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var k=i.schema.primKey,m=k.auto,k=k.keyPath;if(k&&a)throw new re.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new re.InvalidArgument("Arguments objects and keys must have the same length");var b=e.length,k=k&&m?e.map(Sn(k)):e;return i.core.mutate({trans:h,type:"put",keys:a,values:k,wantResults:f}).then(function(T){var v=T.numFailures,S=T.results,w=T.lastResult,T=T.failures;if(v===0)return f?S:w;throw new ft("".concat(i.name,".bulkPut(): ").concat(v," of ").concat(b," operations failed"),T)})})},Pe.prototype.bulkUpdate=function(e){var t=this,r=this.core,i=e.map(function(h){return h.key}),a=e.map(function(h){return h.changes}),f=[];return this._trans("readwrite",function(h){return r.getMany({trans:h,keys:i,cache:"clone"}).then(function(m){var b=[],k=[];e.forEach(function(v,S){var w=v.key,T=v.changes,C=m[S];if(C){for(var x=0,O=Object.keys(T);x<O.length;x++){var P=O[x],D=T[P];if(P===t.schema.primKey.keyPath){if(ke(D,w)!==0)throw new re.Constraint("Cannot update primary key in bulkUpdate()")}else Z(C,P,D)}f.push(S),b.push(w),k.push(C)}});var E=b.length;return r.mutate({trans:h,type:"put",keys:b,values:k,updates:{keys:i,changeSpecs:a}}).then(function(v){var S=v.numFailures,w=v.failures;if(S===0)return E;for(var T=0,C=Object.keys(w);T<C.length;T++){var x,O=C[T],P=f[Number(O)];P!=null&&(x=w[O],delete w[O],w[P]=x)}throw new ft("".concat(t.name,".bulkUpdate(): ").concat(S," of ").concat(E," operations failed"),w)})})})},Pe.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var a=h.numFailures,f=h.lastResult,h=h.failures;if(a===0)return f;throw new ft("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),h)})},Pe);function Pe(){}function on(e){function t(h,m){if(m){for(var b=arguments.length,k=new Array(b-1);--b;)k[b-1]=arguments[b];return r[h].subscribe.apply(null,k),e}if(typeof h=="string")return r[h]}var r={};t.addEventType=f;for(var i=1,a=arguments.length;i<a;++i)f(arguments[i]);return t;function f(h,m,b){if(typeof h!="object"){var k;m=m||co;var E={subscribers:[],fire:b=b||Ce,subscribe:function(v){E.subscribers.indexOf(v)===-1&&(E.subscribers.push(v),E.fire=m(E.fire,v))},unsubscribe:function(v){E.subscribers=E.subscribers.filter(function(S){return S!==v}),E.fire=E.subscribers.reduce(m,b)}};return r[h]=t[h]=E}d(k=h).forEach(function(v){var S=k[v];if(_(S))f(v,k[v][0],k[v][1]);else{if(S!=="asap")throw new re.InvalidArgument("Invalid event config");var w=f(v,Zt,function(){for(var T=arguments.length,C=new Array(T);T--;)C[T]=arguments[T];w.subscribers.forEach(function(x){ve(function(){x.apply(null,C)})})})}})}}function an(e,t){return ue(t).from({prototype:e}),t}function Xt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function cr(e,t){e.filter=qt(e.filter,t)}function fr(e,t,r){var i=e.replayFilter;e.replayFilter=i?function(){return qt(i(),t())}:t,e.justLimit=r&&!i}function In(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new re.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function ti(e,t,r){var i=In(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function On(e,t,r,i){var a=e.replayFilter?qt(e.filter,e.replayFilter()):e.filter;if(e.or){var f={},h=function(m,b,k){var E,v;a&&!a(b,k,function(S){return b.stop(S)},function(S){return b.fail(S)})||((v=""+(E=b.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(E)),I(f,v)||(f[v]=!0,t(m,b,k)))};return Promise.all([e.or._iterate(h,r),ni(ti(e,i,r),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ni(ti(e,i,r),qt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function ni(e,t,r,i){var a=De(i?function(f,h,m){return r(i(f),h,m)}:r);return e.then(function(f){if(f)return f.start(function(){var h=function(){return f.continue()};t&&!t(f,function(m){return h=m},function(m){f.stop(m),h=Ce},function(m){f.fail(m),h=Ce})||a(f.value,f,function(m){return h=m}),h()})})}var sn=(ri.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var r=t.add;if(_(r))return c(c([],_(e)?e:[],!0),r).sort();if(typeof r=="number")return(Number(e)||0)+r;if(typeof r=="bigint")try{return BigInt(e)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(t.remove!==void 0){var i=t.remove;if(_(i))return _(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return r=(r=t.replacePrefix)===null||r===void 0?void 0:r[0],r&&typeof e=="string"&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},ri);function ri(e){this["@@propmod"]=e}var yo=(xe.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,Le.bind(null,r.error)):r.table._trans("readonly",e).then(t)},xe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Le.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},xe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=qt(t.algorithm,e)},xe.prototype._iterate=function(e,t){return On(this._ctx,e,t,this._ctx.table.core)},xe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&j(r,e),t._ctx=r,t},xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},xe.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return On(t,e,r,t.table.core)})},xe.prototype.count=function(e){var t=this;return this._read(function(r){var i=t._ctx,a=i.table.core;if(Xt(i,!0))return a.count({trans:r,query:{index:In(i,a.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var f=0;return On(i,function(){return++f,!1},r,a).then(function(){return f})}).then(e)},xe.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),i=r[0],a=r.length-1;function f(b,k){return k?f(b[r[k]],k-1):b[i]}var h=this._ctx.dir==="next"?1:-1;function m(b,k){return ke(f(b,a),f(k,a))*h}return this.toArray(function(b){return b.sort(m)}).then(t)},xe.prototype.toArray=function(e){var t=this;return this._read(function(r){var i=t._ctx;if(i.dir==="next"&&Xt(i,!0)&&0<i.limit){var a=i.valueMapper,f=In(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:f,range:i.range}}).then(function(m){return m=m.result,a?m.map(a):m})}var h=[];return On(i,function(m){return h.push(m)},r,i.table.core).then(function(){return h})},e)},xe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Xt(t)?fr(t,function(){var r=e;return function(i,a){return r===0||(r===1?--r:a(function(){i.advance(r),r=0}),!1)}}):fr(t,function(){var r=e;return function(){return--r<0}})),this},xe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),fr(this._ctx,function(){var t=e;return function(r,i,a){return--t<=0&&i(a),0<=t}},!0),this},xe.prototype.until=function(e,t){return cr(this._ctx,function(r,i,a){return!e(r.value)||(i(a),t)}),this},xe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},xe.prototype.last=function(e){return this.reverse().first(e)},xe.prototype.filter=function(e){var t;return cr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=qt(t.isMatch,e),this},xe.prototype.and=function(e){return this.filter(e)},xe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xe.prototype.desc=function(){return this.reverse()},xe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.key,i)})},xe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},xe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(e)},xe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Xt(t,!0)&&0<t.limit)return this._read(function(i){var a=In(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)},xe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},xe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return cr(this._ctx,function(a){var i=a.primaryKey.toString(),a=I(t,i);return t[i]=!0,!a}),this},xe.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(i){var a,f,h;h=typeof e=="function"?e:(a=d(e),f=a.length,function(x){for(var O=!1,P=0;P<f;++P){var D=a[P],M=e[D],B=ie(x,D);M instanceof sn?(Z(x,D,M.execute(B)),O=!0):B!==M&&(Z(x,D,M),O=!0)}return O});var m=r.table.core,v=m.schema.primaryKey,b=v.outbound,k=v.extractKey,E=200,v=t.db._options.modifyChunkSize;v&&(E=typeof v=="object"?v[m.name]||v["*"]||200:v);function S(x,D){var P=D.failures,D=D.numFailures;T+=x-D;for(var M=0,B=d(P);M<B.length;M++){var V=B[M];w.push(P[V])}}var w=[],T=0,C=[];return t.clone().primaryKeys().then(function(x){function O(D){var M=Math.min(E,x.length-D);return m.getMany({trans:i,keys:x.slice(D,D+M),cache:"immutable"}).then(function(B){for(var V=[],q=[],L=b?[]:null,Y=[],U=0;U<M;++U){var Q=B[U],me={value:le(Q),primKey:x[D+U]};h.call(me,me.value,me)!==!1&&(me.value==null?Y.push(x[D+U]):b||ke(k(Q),k(me.value))===0?(q.push(me.value),b&&L.push(x[D+U])):(Y.push(x[D+U]),V.push(me.value)))}return Promise.resolve(0<V.length&&m.mutate({trans:i,type:"add",values:V}).then(function(be){for(var we in be.failures)Y.splice(parseInt(we),1);S(V.length,be)})).then(function(){return(0<q.length||P&&typeof e=="object")&&m.mutate({trans:i,type:"put",keys:L,values:q,criteria:P,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<D}).then(function(be){return S(q.length,be)})}).then(function(){return(0<Y.length||P&&e===dr)&&m.mutate({trans:i,type:"delete",keys:Y,criteria:P,isAdditionalChunk:0<D}).then(function(be){return S(Y.length,be)})}).then(function(){return x.length>D+M&&O(D+E)})})}var P=Xt(r)&&r.limit===1/0&&(typeof e!="function"||e===dr)&&{index:r.index,range:r.range};return O(0).then(function(){if(0<w.length)throw new ot("Error modifying one or more objects",w,T,C);return x.length})})})},xe.prototype.delete=function(){var e=this._ctx,t=e.range;return Xt(e)&&(e.isPrimKey||t.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:r,query:{index:i,range:a}}).then(function(f){return e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(h){var m=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new ot("Could not delete some values",Object.keys(m).map(function(b){return m[b]}),f-h);return f-h})})}):this.modify(dr)},xe);function xe(){}var dr=function(e,t){return t.value=null};function _o(e,t){return e<t?-1:e===t?0:1}function go(e,t){return t<e?-1:e===t?0:1}function tt(e,t,r){return e=e instanceof oi?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function Qt(e){return new e.Collection(e,function(){return ii("")}).limit(0)}function Pn(e,t,r,i){var a,f,h,m,b,k,E,v=r.length;if(!r.every(function(T){return typeof T=="string"}))return tt(e,Xr);function S(T){a=T==="next"?function(x){return x.toUpperCase()}:function(x){return x.toLowerCase()},f=T==="next"?function(x){return x.toLowerCase()}:function(x){return x.toUpperCase()},h=T==="next"?_o:go;var C=r.map(function(x){return{lower:f(x),upper:a(x)}}).sort(function(x,O){return h(x.lower,O.lower)});m=C.map(function(x){return x.upper}),b=C.map(function(x){return x.lower}),E=(k=T)==="next"?"":i}S("next"),e=new e.Collection(e,function(){return gt(m[0],b[v-1]+i)}),e._ondirectionchange=function(T){S(T)};var w=0;return e._addAlgorithm(function(T,C,x){var O=T.key;if(typeof O!="string")return!1;var P=f(O);if(t(P,b,w))return!0;for(var D=null,M=w;M<v;++M){var B=function(V,q,L,Y,U,Q){for(var me=Math.min(V.length,Y.length),be=-1,we=0;we<me;++we){var nt=q[we];if(nt!==Y[we])return U(V[we],L[we])<0?V.substr(0,we)+L[we]+L.substr(we+1):U(V[we],Y[we])<0?V.substr(0,we)+Y[we]+L.substr(we+1):0<=be?V.substr(0,be)+q[be]+L.substr(be+1):null;U(V[we],nt)<0&&(be=we)}return me<Y.length&&Q==="next"?V+L.substr(V.length):me<V.length&&Q==="prev"?V.substr(0,L.length):be<0?null:V.substr(0,be)+Y[be]+L.substr(be+1)}(O,P,m[M],b[M],h,k);B===null&&D===null?w=M+1:(D===null||0<h(D,B))&&(D=B)}return C(D!==null?function(){T.continue(D+E)}:x),!1}),e}function gt(e,t,r,i){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:i}}function ii(e){return{type:1,lower:e,upper:e}}var oi=(Object.defineProperty(Ge.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ge.prototype.between=function(e,t,r,i){r=r!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||i)&&(!r||!i)?Qt(this):new this.Collection(this,function(){return gt(e,t,!r,!i)})}catch{return tt(this,dt)}},Ge.prototype.equals=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return ii(e)})},Ge.prototype.above=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(e,void 0,!0)})},Ge.prototype.aboveOrEqual=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(e,void 0,!1)})},Ge.prototype.below=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(void 0,e,!1,!0)})},Ge.prototype.belowOrEqual=function(e){return e==null?tt(this,dt):new this.Collection(this,function(){return gt(void 0,e)})},Ge.prototype.startsWith=function(e){return typeof e!="string"?tt(this,Xr):this.between(e,e+Bt,!0,!0)},Ge.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Pn(this,function(t,r){return t.indexOf(r[0])===0},[e],Bt)},Ge.prototype.equalsIgnoreCase=function(e){return Pn(this,function(t,r){return t===r[0]},[e],"")},Ge.prototype.anyOfIgnoreCase=function(){var e=Ie.apply(Re,arguments);return e.length===0?Qt(this):Pn(this,function(t,r){return r.indexOf(t)!==-1},e,"")},Ge.prototype.startsWithAnyOfIgnoreCase=function(){var e=Ie.apply(Re,arguments);return e.length===0?Qt(this):Pn(this,function(t,r){return r.some(function(i){return t.indexOf(i)===0})},e,Bt)},Ge.prototype.anyOf=function(){var e=this,t=Ie.apply(Re,arguments),r=this._cmp;try{t.sort(r)}catch{return tt(this,dt)}if(t.length===0)return Qt(this);var i=new this.Collection(this,function(){return gt(t[0],t[t.length-1])});i._ondirectionchange=function(f){r=f==="next"?e._ascending:e._descending,t.sort(r)};var a=0;return i._addAlgorithm(function(f,h,m){for(var b=f.key;0<r(b,t[a]);)if(++a===t.length)return h(m),!1;return r(b,t[a])===0||(h(function(){f.continue(t[a])}),!1)}),i},Ge.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ge.prototype.noneOf=function(){var e=Ie.apply(Re,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return tt(this,dt)}var t=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ge.prototype.inAnyRange=function(O,t){var r=this,i=this._cmp,a=this._ascending,f=this._descending,h=this._min,m=this._max;if(O.length===0)return Qt(this);if(!O.every(function(P){return P[0]!==void 0&&P[1]!==void 0&&a(P[0],P[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",re.InvalidArgument);var b=!t||t.includeLowers!==!1,k=t&&t.includeUppers===!0,E,v=a;function S(P,D){return v(P[0],D[0])}try{(E=O.reduce(function(P,D){for(var M=0,B=P.length;M<B;++M){var V=P[M];if(i(D[0],V[1])<0&&0<i(D[1],V[0])){V[0]=h(V[0],D[0]),V[1]=m(V[1],D[1]);break}}return M===B&&P.push(D),P},[])).sort(S)}catch{return tt(this,dt)}var w=0,T=k?function(P){return 0<a(P,E[w][1])}:function(P){return 0<=a(P,E[w][1])},C=b?function(P){return 0<f(P,E[w][0])}:function(P){return 0<=f(P,E[w][0])},x=T,O=new this.Collection(this,function(){return gt(E[0][0],E[E.length-1][1],!b,!k)});return O._ondirectionchange=function(P){v=P==="next"?(x=T,a):(x=C,f),E.sort(S)},O._addAlgorithm(function(P,D,M){for(var B,V=P.key;x(V);)if(++w===E.length)return D(M),!1;return!T(B=V)&&!C(B)||(r._cmp(V,E[w][1])===0||r._cmp(V,E[w][0])===0||D(function(){v===a?P.continue(E[w][0]):P.continue(E[w][1])}),!1)}),O},Ge.prototype.startsWithAnyOf=function(){var e=Ie.apply(Re,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Qt(this):this.inAnyRange(e.map(function(t){return[t,t+Bt]})):tt(this,"startsWithAnyOf() only works with strings")},Ge);function Ge(){}function st(e){return De(function(t){return un(t),e(t.target.error),!1})}function un(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var ln="storagemutated",hr="x-storagemutated-1",bt=on(null,ln),bo=(ut.prototype._lock=function(){return J(!ee.global),++this._reculock,this._reculock!==1||ee.global||(ee.lockOwnerFor=this),this},ut.prototype._unlock=function(){if(J(!ee.global),--this._reculock==0)for(ee.global||(ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Nt(e[1],e[0])}catch{}}return this},ut.prototype._locked=function(){return this._reculock&&ee.lockOwnerFor!==this},ut.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(J(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new re.DatabaseClosed(i);case"MissingAPIError":throw new re.MissingAPI(i.message,i);default:throw new re.OpenFailed(i)}if(!this.active)throw new re.TransactionInactive;return J(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=De(function(a){un(a),t._reject(e.error)}),e.onabort=De(function(a){un(a),t.active&&t._reject(new re.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=De(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&bt.storagemutated.fire(e.mutatedParts)}),this},ut.prototype._promise=function(e,t,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return Le(new re.ReadOnly("Transaction is readonly"));if(!this.active)return Le(new re.TransactionInactive);if(this._locked())return new G(function(f,h){i._blockedFuncs.push([function(){i._promise(e,t,r).then(f,h)},ee])});if(r)return vt(function(){var f=new G(function(h,m){i._lock();var b=t(h,m,i);b&&b.then&&b.then(h,m)});return f.finally(function(){return i._unlock()}),f._lib=!0,f});var a=new G(function(f,h){var m=t(f,h,i);m&&m.then&&m.then(f,h)});return a._lib=!0,a},ut.prototype._root=function(){return this.parent?this.parent._root():this},ut.prototype.waitFor=function(e){var t,r=this._root(),i=G.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return i}):(r._waitingFor=i,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function f(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=f)}());var a=r._waitingFor;return new G(function(f,h){i.then(function(m){return r._waitingQueue.push(De(f.bind(null,m)))},function(m){return r._waitingQueue.push(De(h.bind(null,m)))}).finally(function(){r._waitingFor===a&&(r._waitingFor=null)})})},ut.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new re.Abort))},ut.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(I(t,e))return t[e];var r=this.schema[e];if(!r)throw new re.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},ut);function ut(){}function pr(e,t,r,i,a,f,h){return{name:e,keyPath:t,unique:r,multi:i,auto:a,compound:f,src:(r&&!h?"&":"")+(i?"*":"")+(a?"++":"")+ai(t)}}function ai(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function mr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},r.reduce(function(a,f,h){return h=i(f,h),h&&(a[h[0]]=h[1]),a},{}))};var i}var cn=function(e){try{return e.only([[]]),cn=function(){return[[]]},[[]]}catch{return cn=function(){return Bt},Bt}};function vr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return ie(r,t)}:function(r){return ie(r,e)};var t}function si(e){return[].slice.call(e)}var wo=0;function fn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ko(e,t,b){function i(x){if(x.type===3)return null;if(x.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=x.lower,T=x.upper,C=x.lowerOpen,x=x.upperOpen;return w===void 0?T===void 0?null:t.upperBound(T,!!x):T===void 0?t.lowerBound(w,!!C):t.bound(w,T,!!C,!!x)}function a(S){var w,T=S.name;return{name:T,schema:S,mutate:function(C){var x=C.trans,O=C.type,P=C.keys,D=C.values,M=C.range;return new Promise(function(B,V){B=De(B);var q=x.objectStore(T),L=q.keyPath==null,Y=O==="put"||O==="add";if(!Y&&O!=="delete"&&O!=="deleteRange")throw new Error("Invalid operation type: "+O);var U,Q=(P||D||{length:1}).length;if(P&&D&&P.length!==D.length)throw new Error("Given keys array must have same length as given values array.");if(Q===0)return B({numFailures:0,failures:{},results:[],lastResult:void 0});function me(Ze){++nt,un(Ze)}var be=[],we=[],nt=0;if(O==="deleteRange"){if(M.type===4)return B({numFailures:nt,failures:we,results:[],lastResult:void 0});M.type===3?be.push(U=q.clear()):be.push(U=q.delete(i(M)))}else{var L=Y?L?[D,P]:[D,null]:[P,null],de=L[0],Qe=L[1];if(Y)for(var $e=0;$e<Q;++$e)be.push(U=Qe&&Qe[$e]!==void 0?q[O](de[$e],Qe[$e]):q[O](de[$e])),U.onerror=me;else for($e=0;$e<Q;++$e)be.push(U=q[O](de[$e])),U.onerror=me}function Vn(Ze){Ze=Ze.target.result,be.forEach(function(Ut,Mr){return Ut.error!=null&&(we[Mr]=Ut.error)}),B({numFailures:nt,failures:we,results:O==="delete"?P:be.map(function(Ut){return Ut.result}),lastResult:Ze})}U.onerror=function(Ze){me(Ze),Vn(Ze)},U.onsuccess=Vn})},getMany:function(C){var x=C.trans,O=C.keys;return new Promise(function(P,D){P=De(P);for(var M,B=x.objectStore(T),V=O.length,q=new Array(V),L=0,Y=0,U=function(be){be=be.target,q[be._pos]=be.result,++Y===L&&P(q)},Q=st(D),me=0;me<V;++me)O[me]!=null&&((M=B.get(O[me]))._pos=me,M.onsuccess=U,M.onerror=Q,++L);L===0&&P(q)})},get:function(C){var x=C.trans,O=C.key;return new Promise(function(P,D){P=De(P);var M=x.objectStore(T).get(O);M.onsuccess=function(B){return P(B.target.result)},M.onerror=st(D)})},query:(w=k,function(C){return new Promise(function(x,O){x=De(x);var P,D,M,L=C.trans,B=C.values,V=C.limit,U=C.query,q=V===1/0?void 0:V,Y=U.index,U=U.range,L=L.objectStore(T),Y=Y.isPrimaryKey?L:L.index(Y.name),U=i(U);if(V===0)return x({result:[]});w?((q=B?Y.getAll(U,q):Y.getAllKeys(U,q)).onsuccess=function(Q){return x({result:Q.target.result})},q.onerror=st(O)):(P=0,D=!B&&"openKeyCursor"in Y?Y.openKeyCursor(U):Y.openCursor(U),M=[],D.onsuccess=function(Q){var me=D.result;return me?(M.push(B?me.value:me.primaryKey),++P===V?x({result:M}):void me.continue()):x({result:M})},D.onerror=st(O))})}),openCursor:function(C){var x=C.trans,O=C.values,P=C.query,D=C.reverse,M=C.unique;return new Promise(function(B,V){B=De(B);var Y=P.index,q=P.range,L=x.objectStore(T),L=Y.isPrimaryKey?L:L.index(Y.name),Y=D?M?"prevunique":"prev":M?"nextunique":"next",U=!O&&"openKeyCursor"in L?L.openKeyCursor(i(q),Y):L.openCursor(i(q),Y);U.onerror=st(V),U.onsuccess=De(function(Q){var me,be,we,nt,de=U.result;de?(de.___id=++wo,de.done=!1,me=de.continue.bind(de),be=(be=de.continuePrimaryKey)&&be.bind(de),we=de.advance.bind(de),nt=function(){throw new Error("Cursor not stopped")},de.trans=x,de.stop=de.continue=de.continuePrimaryKey=de.advance=function(){throw new Error("Cursor not started")},de.fail=De(V),de.next=function(){var Qe=this,$e=1;return this.start(function(){return $e--?Qe.continue():Qe.stop()}).then(function(){return Qe})},de.start=function(Qe){function $e(){if(U.result)try{Qe()}catch(Ze){de.fail(Ze)}else de.done=!0,de.start=function(){throw new Error("Cursor behind last entry")},de.stop()}var Vn=new Promise(function(Ze,Ut){Ze=De(Ze),U.onerror=st(Ut),de.fail=Ut,de.stop=function(Mr){de.stop=de.continue=de.continuePrimaryKey=de.advance=nt,Ze(Mr)}});return U.onsuccess=De(function(Ze){U.onsuccess=$e,$e()}),de.continue=me,de.continuePrimaryKey=be,de.advance=we,$e(),Vn},B(de)):B(null)},V)})},count:function(C){var x=C.query,O=C.trans,P=x.index,D=x.range;return new Promise(function(M,B){var V=O.objectStore(T),q=P.isPrimaryKey?V:V.index(P.name),V=i(D),q=V?q.count(V):q.count();q.onsuccess=De(function(L){return M(L.target.result)}),q.onerror=st(B)})}}}var f,h,m,E=(h=b,m=si((f=e).objectStoreNames),{schema:{name:f.name,tables:m.map(function(S){return h.objectStore(S)}).map(function(S){var w=S.keyPath,x=S.autoIncrement,T=_(w),C={},x={name:S.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w==null,compound:T,keyPath:w,autoIncrement:x,unique:!0,extractKey:vr(w)},indexes:si(S.indexNames).map(function(O){return S.index(O)}).map(function(M){var P=M.name,D=M.unique,B=M.multiEntry,M=M.keyPath,B={name:P,compound:_(M),keyPath:M,unique:D,multiEntry:B,extractKey:vr(M)};return C[fn(M)]=B}),getIndexByKeyPath:function(O){return C[fn(O)]}};return C[":id"]=x.primaryKey,w!=null&&(C[fn(w)]=x.primaryKey),x})},hasGetAll:0<m.length&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),b=E.schema,k=E.hasGetAll,E=b.tables.map(a),v={};return E.forEach(function(S){return v[S.name]=S}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(S){if(!v[S])throw new Error("Table '".concat(S,"' not found"));return v[S]},MIN_KEY:-1/0,MAX_KEY:cn(t),schema:b}}function xo(e,t,r,i){var a=r.IDBKeyRange;return r.indexedDB,{dbcore:(i=ko(t,a,i),e.dbcore.reduce(function(f,h){return h=h.create,o(o({},f),h(f))},i))}}function Dn(e,i){var r=i.db,i=xo(e._middlewares,r,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var f=a.name;e.core.schema.tables.some(function(h){return h.name===f})&&(a.core=e.core.table(f),e[f]instanceof e.Table&&(e[f].core=a.core))})}function jn(e,t,r,i){r.forEach(function(a){var f=i[a];t.forEach(function(h){var m=function b(k,E){return ce(k,E)||(k=g(k))&&b(k,E)}(h,a);(!m||"value"in m&&m.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?F(h,a,{get:function(){return this.table(a)},set:function(b){K(this,a,{value:b,writable:!0,configurable:!0,enumerable:!0})}}):h[a]=new e.Table(a,f))})})}function yr(e,t){t.forEach(function(r){for(var i in r)r[i]instanceof e.Table&&delete r[i]})}function To(e,t){return e._cfg.version-t._cfg.version}function Eo(e,t,r,i){var a=e._dbSchema;r.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=mr("$meta",li("")[0],[]),e._storeNames.push("$meta"));var f=e._createTransaction("readwrite",e._storeNames,a);f.create(r),f._completion.catch(i);var h=f._reject.bind(f),m=ee.transless||ee;vt(function(){return ee.trans=f,ee.transless=m,t!==0?(Dn(e,r),k=t,((b=f).storeNames.includes("$meta")?b.table("$meta").get("version").then(function(E){return E??k}):G.resolve(k)).then(function(E){return S=E,w=f,T=r,C=[],E=(v=e)._versions,x=v._dbSchema=Mn(0,v.idbdb,T),(E=E.filter(function(O){return O._cfg.version>=S})).length!==0?(E.forEach(function(O){C.push(function(){var P=x,D=O._cfg.dbschema;Rn(v,P,T),Rn(v,D,T),x=v._dbSchema=D;var M=_r(P,D);M.add.forEach(function(Y){gr(T,Y[0],Y[1].primKey,Y[1].indexes)}),M.change.forEach(function(Y){if(Y.recreate)throw new re.Upgrade("Not yet support for changing primary key");var U=T.objectStore(Y.name);Y.add.forEach(function(Q){return Kn(U,Q)}),Y.change.forEach(function(Q){U.deleteIndex(Q.name),Kn(U,Q)}),Y.del.forEach(function(Q){return U.deleteIndex(Q)})});var B=O._cfg.contentUpgrade;if(B&&O._cfg.version>S){Dn(v,T),w._memoizedTables={};var V=ne(D);M.del.forEach(function(Y){V[Y]=P[Y]}),yr(v,[v.Transaction.prototype]),jn(v,[v.Transaction.prototype],d(V),V),w.schema=V;var q,L=Ve(B);return L&&Gt(),M=G.follow(function(){var Y;(q=B(w))&&L&&(Y=yt.bind(null,null),q.then(Y,Y))}),q&&typeof q.then=="function"?G.resolve(q):M.then(function(){return q})}}),C.push(function(P){var D,M,B=O._cfg.dbschema;D=B,M=P,[].slice.call(M.db.objectStoreNames).forEach(function(V){return D[V]==null&&M.db.deleteObjectStore(V)}),yr(v,[v.Transaction.prototype]),jn(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),w.schema=v._dbSchema}),C.push(function(P){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===O._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(D){return D!=="$meta"})):P.objectStore("$meta").put(O._cfg.version,"version"))})}),function O(){return C.length?G.resolve(C.shift()(w.idbtrans)).then(O):G.resolve()}().then(function(){ui(x,T)})):G.resolve();var v,S,w,T,C,x}).catch(h)):(d(a).forEach(function(E){gr(r,E,a[E].primKey,a[E].indexes)}),Dn(e,r),void G.follow(function(){return e.on.populate.fire(f)}).catch(h));var b,k})}function Co(e,t){ui(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=Mn(0,e.idbdb,t);Rn(e,e._dbSchema,t);for(var i=0,a=_r(r,e._dbSchema).change;i<a.length;i++){var f=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=t.objectStore(h.name);h.add.forEach(function(b){at&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(b.src)),Kn(m,b)})}(a[i]);if(typeof f=="object")return f.value}}function _r(e,t){var r,i={del:[],add:[],change:[]};for(r in e)t[r]||i.del.push(r);for(r in t){var a=e[r],f=t[r];if(a){var h={name:r,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||a.primKey.auto!==f.primKey.auto)h.recreate=!0,i.change.push(h);else{var m=a.idxByName,b=f.idxByName,k=void 0;for(k in m)b[k]||h.del.push(k);for(k in b){var E=m[k],v=b[k];E?E.src!==v.src&&h.change.push(v):h.add.push(v)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([r,f])}return i}function gr(e,t,r,i){var a=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return i.forEach(function(f){return Kn(a,f)}),a}function ui(e,t){d(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(at&&console.debug("Dexie: Creating missing table",r),gr(t,r,e[r].primKey,e[r].indexes))})}function Kn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Mn(e,t,r){var i={};return $(t.objectStoreNames,0).forEach(function(a){for(var f=r.objectStore(a),h=pr(ai(k=f.keyPath),k||"",!0,!1,!!f.autoIncrement,k&&typeof k!="string",!0),m=[],b=0;b<f.indexNames.length;++b){var E=f.index(f.indexNames[b]),k=E.keyPath,E=pr(E.name,k,!!E.unique,!!E.multiEntry,!1,k&&typeof k!="string",!1);m.push(E)}i[a]=mr(a,h,m)}),i}function Rn(e,t,r){for(var i=r.db.objectStoreNames,a=0;a<i.length;++a){var f=i[a],h=r.objectStore(f);e._hasGetAll="getAll"in h;for(var m=0;m<h.indexNames.length;++m){var b=h.indexNames[m],k=h.index(b).keyPath,E=typeof k=="string"?k:"["+$(k).join("+")+"]";!t[f]||(k=t[f].idxByName[E])&&(k.name=b,delete t[f].idxByName[E],t[f].idxByName[b]=k)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function li(e){return e.split(",").map(function(t,r){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return pr(i,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),_(a),r===0)})}var So=(An.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(r){if(e[r]!==null){var i=li(e[r]),a=i.shift();if(a.unique=!0,a.multi)throw new re.Schema("Primary key cannot be multi-valued");i.forEach(function(f){if(f.auto)throw new re.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new re.Schema("Index must have a name and cannot be an empty string")}),t[r]=mr(r,a,i)}})},An.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?j(this._cfg.storesSource,r):r;var r=t._versions,i={},a={};return r.forEach(function(f){j(i,f._cfg.storesSource),a=f._cfg.dbschema={},f._parseStoresSpec(i,a)}),t._dbSchema=a,yr(t,[t._allTables,t,t.Transaction.prototype]),jn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},An.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Zn(this._cfg.contentUpgrade||Ce,e),this},An);function An(){}function br(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new ht(Cn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function wr(e){return e&&typeof e.databases=="function"}function kr(e){return vt(function(){return ee.letThrough=!0,e()})}function xr(e){return!("from"in e)}var Xe=function(e,t){if(!this){var r=new Xe;return e&&"d"in e&&j(r,e),r}j(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function dn(e,t,r){var i=ke(t,r);if(!isNaN(i)){if(0<i)throw RangeError();if(xr(e))return j(e,{from:t,to:r,d:1});var a=e.l,i=e.r;if(ke(r,e.from)<0)return a?dn(a,t,r):e.l={from:t,to:r,d:1,l:null,r:null},fi(e);if(0<ke(t,e.to))return i?dn(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},fi(e);ke(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<ke(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,a&&!e.l&&hn(e,a),i&&r&&hn(e,i)}}function hn(e,t){xr(t)||function r(i,b){var f=b.from,h=b.to,m=b.l,b=b.r;dn(i,f,h),m&&r(i,m),b&&r(i,b)}(e,t)}function ci(e,t){var r=Nn(t),i=r.next();if(i.done)return!1;for(var a=i.value,f=Nn(e),h=f.next(a.from),m=h.value;!i.done&&!h.done;){if(ke(m.from,a.to)<=0&&0<=ke(m.to,a.from))return!0;ke(a.from,m.from)<0?a=(i=r.next(m.from)).value:m=(h=f.next(a.from)).value}return!1}function Nn(e){var t=xr(e)?null:{s:0,n:e};return{next:function(r){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&ke(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||ke(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function fi(e){var t,r,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",r=o({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],r[a]=i[t],(e[t]=r).d=di(r)),e.d=di(e)}function di(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function Bn(e,t){return d(t).forEach(function(r){e[r]?hn(e[r],t[r]):e[r]=function i(a){var f,h,m={};for(f in a)I(a,f)&&(h=a[f],m[f]=!h||typeof h!="object"||Ee.has(h.constructor)?h:i(h));return m}(t[r])}),e}function Tr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&ci(t[r],e[r])})}p(Xe.prototype,((rt={add:function(e){return hn(this,e),this},addKey:function(e){return dn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return dn(t,r,r)}),this},hasKey:function(e){var t=Nn(this).next(e).value;return t&&ke(t.from,e)<=0&&0<=ke(t.to,e)}})[ge]=function(){return Nn(this)},rt));var Ft={},Er={},Cr=!1;function qn(e){Bn(Er,e),Cr||(Cr=!0,setTimeout(function(){Cr=!1,Sr(Er,!(Er={}))},0))}function Sr(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var i=0,a=Object.values(Ft);i<a.length;i++)hi(h=a[i],e,r,t);else for(var f in e){var h,m=/^idb\:\/\/(.*)\/(.*)\//.exec(f);m&&(f=m[1],m=m[2],(h=Ft["idb://".concat(f,"/").concat(m)])&&hi(h,e,r,t))}r.forEach(function(b){return b()})}function hi(e,t,r,i){for(var a=[],f=0,h=Object.entries(e.queries.query);f<h.length;f++){for(var m=h[f],b=m[0],k=[],E=0,v=m[1];E<v.length;E++){var S=v[E];Tr(t,S.obsSet)?S.subscribers.forEach(function(x){return r.add(x)}):i&&k.push(S)}i&&a.push([b,k])}if(i)for(var w=0,T=a;w<T.length;w++){var C=T[w],b=C[0],k=C[1];e.queries.query[b]=k}}function Io(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Le(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),f=!1;function h(){if(t.openCanceller!==i)throw new re.DatabaseClosed("db.open() was cancelled")}function m(){return new G(function(S,w){if(h(),!r)throw new re.MissingAPI;var T=e.name,C=t.autoSchema||!a?r.open(T):r.open(T,a);if(!C)throw new re.MissingAPI;C.onerror=st(w),C.onblocked=De(e._fireOnBlocked),C.onupgradeneeded=De(function(x){var O;E=C.transaction,t.autoSchema&&!e._options.allowEmptyDB?(C.onerror=un,E.abort(),C.result.close(),(O=r.deleteDatabase(T)).onsuccess=O.onerror=De(function(){w(new re.NoSuchDatabase("Database ".concat(T," doesnt exist")))})):(E.onerror=st(w),x=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,v=x<1,e.idbdb=C.result,f&&Co(e,E),Eo(e,x/10,E,w))},w),C.onsuccess=De(function(){E=null;var x,O,P,D,M,B=e.idbdb=C.result,V=$(B.objectStoreNames);if(0<V.length)try{var q=B.transaction((D=V).length===1?D[0]:D,"readonly");if(t.autoSchema)O=B,P=q,(x=e).verno=O.version/10,P=x._dbSchema=Mn(0,O,P),x._storeNames=$(O.objectStoreNames,0),jn(x,[x._allTables],d(P),P);else if(Rn(e,e._dbSchema,q),((M=_r(Mn(0,(M=e).idbdb,q),M._dbSchema)).add.length||M.change.some(function(L){return L.add.length||L.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),B.close(),a=B.version+1,f=!0,S(m());Dn(e,q)}catch{}Wt.push(e),B.onversionchange=De(function(L){t.vcFired=!0,e.on("versionchange").fire(L)}),B.onclose=De(function(L){e.on("close").fire(L)}),v&&(M=e._deps,q=T,B=M.indexedDB,M=M.IDBKeyRange,wr(B)||q===Cn||br(B,M).put({name:q}).catch(Ce)),S()},w)}).catch(function(S){switch(S==null?void 0:S.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<a)return a=0,m()}return G.reject(S)})}var b,k=t.dbReadyResolve,E=null,v=!1;return G.race([i,(typeof navigator>"u"?G.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(S){function w(){return indexedDB.databases().finally(S)}b=setInterval(w,100),w()}).finally(function(){return clearInterval(b)}):Promise.resolve()).then(m)]).then(function(){return h(),t.onReadyBeingFired=[],G.resolve(kr(function(){return e.on.ready.fire(e.vip)})).then(function S(){if(0<t.onReadyBeingFired.length){var w=t.onReadyBeingFired.reduce(Zn,Ce);return t.onReadyBeingFired=[],G.resolve(kr(function(){return w(e.vip)})).then(S)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(S){t.dbOpenError=S;try{E&&E.abort()}catch{}return i===t.openCanceller&&e._close(),Le(S)}).finally(function(){t.openComplete=!0,k()}).then(function(){var S;return v&&(S={},e.tables.forEach(function(w){w.schema.indexes.forEach(function(T){T.name&&(S["idb://".concat(e.name,"/").concat(w.name,"/").concat(T.name)]=new Xe(-1/0,[[[]]]))}),S["idb://".concat(e.name,"/").concat(w.name,"/")]=S["idb://".concat(e.name,"/").concat(w.name,"/:dels")]=new Xe(-1/0,[[[]]])}),bt(ln).fire(S),Sr(S,!0)),e})}function Ir(e){function t(f){return e.next(f)}var r=a(t),i=a(function(f){return e.throw(f)});function a(f){return function(b){var m=f(b),b=m.value;return m.done?b:b&&typeof b.then=="function"?b.then(r,i):_(b)?Promise.all(b).then(r,i):r(b)}}return a(t)()}function Fn(e,t,r){for(var i=_(e)?e.slice():[e],a=0;a<r;++a)i.push(t);return i}var Oo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var r=e.table(t),i=r.schema,a={},f=[];function h(v,S,w){var T=fn(v),C=a[T]=a[T]||[],x=v==null?0:typeof v=="string"?1:v.length,O=0<S,O=o(o({},w),{name:O?"".concat(T,"(virtual-from:").concat(w.name,")"):w.name,lowLevelIndex:w,isVirtual:O,keyTail:S,keyLength:x,extractKey:vr(v),unique:!O&&w.unique});return C.push(O),O.isPrimaryKey||f.push(O),1<x&&h(x===2?v[0]:v.slice(0,x-1),S+1,w),C.sort(function(P,D){return P.keyTail-D.keyTail}),O}t=h(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var m=0,b=i.indexes;m<b.length;m++){var k=b[m];h(k.keyPath,0,k)}function E(v){var S,w=v.query.index;return w.isVirtual?o(o({},v),{query:{index:w.lowLevelIndex,range:(S=v.query.range,w=w.keyTail,{type:S.type===1?2:S.type,lower:Fn(S.lower,S.lowerOpen?e.MAX_KEY:e.MIN_KEY,w),lowerOpen:!0,upper:Fn(S.upper,S.upperOpen?e.MIN_KEY:e.MAX_KEY,w),upperOpen:!0})}}):v}return o(o({},r),{schema:o(o({},i),{primaryKey:t,indexes:f,getIndexByKeyPath:function(v){return(v=a[fn(v)])&&v[0]}}),count:function(v){return r.count(E(v))},query:function(v){return r.query(E(v))},openCursor:function(v){var S=v.query.index,w=S.keyTail,T=S.isVirtual,C=S.keyLength;return T?r.openCursor(E(v)).then(function(O){return O&&x(O)}):r.openCursor(v);function x(O){return Object.create(O,{continue:{value:function(P){P!=null?O.continue(Fn(P,v.reverse?e.MAX_KEY:e.MIN_KEY,w)):v.unique?O.continue(O.key.slice(0,C).concat(v.reverse?e.MIN_KEY:e.MAX_KEY,w)):O.continue()}},continuePrimaryKey:{value:function(P,D){O.continuePrimaryKey(Fn(P,e.MAX_KEY,w),D)}},primaryKey:{get:function(){return O.primaryKey}},key:{get:function(){var P=O.key;return C===1?P[0]:P.slice(0,C)}},value:{get:function(){return O.value}}})}}})}})}};function Or(e,t,r,i){return r=r||{},i=i||"",d(e).forEach(function(a){var f,h,m;I(t,a)?(f=e[a],h=t[a],typeof f=="object"&&typeof h=="object"&&f&&h?(m=Je(f))!==Je(h)?r[i+a]=t[a]:m==="Object"?Or(f,h,r,i+a+"."):f!==h&&(r[i+a]=t[a]):f!==h&&(r[i+a]=t[a])):r[i+a]=void 0}),d(t).forEach(function(a){I(e,a)||(r[i+a]=t[a])}),r}function Pr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Po={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var r=e.table(t),i=r.schema.primaryKey;return o(o({},r),{mutate:function(a){var f=ee.trans,h=f.table(t).hook,m=h.deleting,b=h.creating,k=h.updating;switch(a.type){case"add":if(b.fire===Ce)break;return f._promise("readwrite",function(){return E(a)},!0);case"put":if(b.fire===Ce&&k.fire===Ce)break;return f._promise("readwrite",function(){return E(a)},!0);case"delete":if(m.fire===Ce)break;return f._promise("readwrite",function(){return E(a)},!0);case"deleteRange":if(m.fire===Ce)break;return f._promise("readwrite",function(){return function v(S,w,T){return r.query({trans:S,values:!1,query:{index:i,range:w},limit:T}).then(function(C){var x=C.result;return E({type:"delete",keys:x,trans:S}).then(function(O){return 0<O.numFailures?Promise.reject(O.failures[0]):x.length<T?{failures:[],numFailures:0,lastResult:void 0}:v(S,o(o({},w),{lower:x[x.length-1],lowerOpen:!0}),T)})})}(a.trans,a.range,1e4)},!0)}return r.mutate(a);function E(v){var S,w,T,C=ee.trans,x=v.keys||Pr(i,v);if(!x)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?o(o({},v),{keys:x}):o({},v)).type!=="delete"&&(v.values=c([],v.values)),v.keys&&(v.keys=c([],v.keys)),S=r,T=x,((w=v).type==="add"?Promise.resolve([]):S.getMany({trans:w.trans,keys:T,cache:"immutable"})).then(function(O){var P=x.map(function(D,M){var B,V,q,L=O[M],Y={onerror:null,onsuccess:null};return v.type==="delete"?m.fire.call(Y,D,L,C):v.type==="add"||L===void 0?(B=b.fire.call(Y,D,v.values[M],C),D==null&&B!=null&&(v.keys[M]=D=B,i.outbound||Z(v.values[M],i.keyPath,D))):(B=Or(L,v.values[M]),(V=k.fire.call(Y,B,D,L,C))&&(q=v.values[M],Object.keys(V).forEach(function(U){I(q,U)?q[U]=V[U]:Z(q,U,V[U])}))),Y});return r.mutate(v).then(function(D){for(var M=D.failures,B=D.results,V=D.numFailures,D=D.lastResult,q=0;q<x.length;++q){var L=(B||x)[q],Y=P[q];L==null?Y.onerror&&Y.onerror(M[q]):Y.onsuccess&&Y.onsuccess(v.type==="put"&&O[q]?v.values[q]:L)}return{failures:M,results:B,numFailures:V,lastResult:D}}).catch(function(D){return P.forEach(function(M){return M.onerror&&M.onerror(D)}),Promise.reject(D)})})}}})}})}};function pi(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,f=0;a<t.keys.length&&f<e.length;++a)ke(t.keys[a],e[f])===0&&(i.push(r?le(t.values[a]):t.values[a]),++f);return i.length===e.length?i:null}catch{return null}}var Do={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return o(o({},r),{getMany:function(i){if(!i.cache)return r.getMany(i);var a=pi(i.keys,i.trans._cache,i.cache==="clone");return a?G.resolve(a):r.getMany(i).then(function(f){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?le(f):f},f})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),r.mutate(i)}})}}}};function mi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function vi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var jo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new Xe(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,a,f){if(ee.subscr&&a!=="readonly")throw new re.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ee.querier));return e.transaction(i,a,f)},table:function(i){var a=e.table(i),f=a.schema,h=f.primaryKey,v=f.indexes,m=h.extractKey,b=h.outbound,k=h.autoIncrement&&v.filter(function(w){return w.compound&&w.keyPath.includes(h.keyPath)}),E=o(o({},a),{mutate:function(w){function T(U){return U="idb://".concat(t,"/").concat(i,"/").concat(U),D[U]||(D[U]=new Xe)}var C,x,O,P=w.trans,D=w.mutatedParts||(w.mutatedParts={}),M=T(""),B=T(":dels"),V=w.type,Y=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[Pr(h,w).filter(function(U){return U}),w.values]:[],q=Y[0],L=Y[1],Y=w.trans._cache;return _(q)?(M.addKeys(q),(Y=V==="delete"||q.length===L.length?pi(q,Y):null)||B.addKeys(q),(Y||L)&&(C=T,x=Y,O=L,f.indexes.forEach(function(U){var Q=C(U.name||"");function me(we){return we!=null?U.extractKey(we):null}function be(we){return U.multiEntry&&_(we)?we.forEach(function(nt){return Q.addKey(nt)}):Q.addKey(we)}(x||O).forEach(function(we,Qe){var de=x&&me(x[Qe]),Qe=O&&me(O[Qe]);ke(de,Qe)!==0&&(de!=null&&be(de),Qe!=null&&be(Qe))})}))):q?(L={from:(L=q.lower)!==null&&L!==void 0?L:e.MIN_KEY,to:(L=q.upper)!==null&&L!==void 0?L:e.MAX_KEY},B.add(L),M.add(L)):(M.add(r),B.add(r),f.indexes.forEach(function(U){return T(U.name).add(r)})),a.mutate(w).then(function(U){return!q||w.type!=="add"&&w.type!=="put"||(M.addKeys(U.results),k&&k.forEach(function(Q){for(var me=w.values.map(function(de){return Q.extractKey(de)}),be=Q.keyPath.findIndex(function(de){return de===h.keyPath}),we=0,nt=U.results.length;we<nt;++we)me[we][be]=U.results[we];T(Q.name).addKeys(me)})),P.mutatedParts=Bn(P.mutatedParts||{},D),U})}}),v=function(T){var C=T.query,T=C.index,C=C.range;return[T,new Xe((T=C.lower)!==null&&T!==void 0?T:e.MIN_KEY,(C=C.upper)!==null&&C!==void 0?C:e.MAX_KEY)]},S={get:function(w){return[h,new Xe(w.key)]},getMany:function(w){return[h,new Xe().addKeys(w.keys)]},count:v,query:v,openCursor:v};return d(S).forEach(function(w){E[w]=function(T){var C=ee.subscr,x=!!C,O=mi(ee,a)&&vi(w,T)?T.obsSet={}:C;if(x){var P=function(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),O[L]||(O[L]=new Xe)},D=P(""),M=P(":dels"),C=S[w](T),x=C[0],C=C[1];if((w==="query"&&x.isPrimaryKey&&!T.values?M:P(x.name||"")).add(C),!x.isPrimaryKey){if(w!=="count"){var B=w==="query"&&b&&T.values&&a.query(o(o({},T),{values:!1}));return a[w].apply(this,arguments).then(function(L){if(w==="query"){if(b&&T.values)return B.then(function(me){return me=me.result,D.addKeys(me),L});var Y=T.values?L.result.map(m):L.result;(T.values?D:M).addKeys(Y)}else if(w==="openCursor"){var U=L,Q=T.values;return U&&Object.create(U,{key:{get:function(){return M.addKey(U.primaryKey),U.key}},primaryKey:{get:function(){var me=U.primaryKey;return M.addKey(me),me}},value:{get:function(){return Q&&D.addKey(U.primaryKey),U.value}}})}return L})}M.add(r)}}return a[w].apply(this,arguments)}}),E}})}};function yi(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===i?null:(t=o({},t),_(t.keys)&&(t.keys=t.keys.filter(function(a,f){return!(f in r.failures)})),"values"in t&&_(t.values)&&(t.values=t.values.filter(function(a,f){return!(f in r.failures)})),t)}function Dr(e,t){return r=e,((i=t).lower===void 0||(i.lowerOpen?0<ke(r,i.lower):0<=ke(r,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ke(e,t.upper)<0:ke(e,t.upper)<=0));var r,i}function _i(e,t,S,i,a,f){if(!S||S.length===0)return e;var h=t.query.index,m=h.multiEntry,b=t.query.range,k=i.schema.primaryKey.extractKey,E=h.extractKey,v=(h.lowLevelIndex||h).extractKey,S=S.reduce(function(w,T){var C=w,x=[];if(T.type==="add"||T.type==="put")for(var O=new Xe,P=T.values.length-1;0<=P;--P){var D,M=T.values[P],B=k(M);O.hasKey(B)||(D=E(M),(m&&_(D)?D.some(function(U){return Dr(U,b)}):Dr(D,b))&&(O.addKey(B),x.push(M)))}switch(T.type){case"add":var V=new Xe().addKeys(t.values?w.map(function(Q){return k(Q)}):w),C=w.concat(t.values?x.filter(function(Q){return Q=k(Q),!V.hasKey(Q)&&(V.addKey(Q),!0)}):x.map(function(Q){return k(Q)}).filter(function(Q){return!V.hasKey(Q)&&(V.addKey(Q),!0)}));break;case"put":var q=new Xe().addKeys(T.values.map(function(Q){return k(Q)}));C=w.filter(function(Q){return!q.hasKey(t.values?k(Q):Q)}).concat(t.values?x:x.map(function(Q){return k(Q)}));break;case"delete":var L=new Xe().addKeys(T.keys);C=w.filter(function(Q){return!L.hasKey(t.values?k(Q):Q)});break;case"deleteRange":var Y=T.range;C=w.filter(function(Q){return!Dr(k(Q),Y)})}return C},e);return S===e?e:(S.sort(function(w,T){return ke(v(w),v(T))||ke(k(w),k(T))}),t.limit&&t.limit<1/0&&(S.length>t.limit?S.length=t.limit:e.length===t.limit&&S.length<t.limit&&(a.dirty=!0)),f?Object.freeze(S):S)}function gi(e,t){return ke(e.lower,t.lower)===0&&ke(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Ko(e,t){return function(r,i,a,f){if(r===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=ke(r,i))===0){if(a&&f)return 0;if(a)return 1;if(f)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,i,a,f){if(r===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=ke(r,i))===0){if(a&&f)return 0;if(a)return-1;if(f)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Mo(e,t,r,i){e.subscribers.add(r),i.addEventListener("abort",function(){var a,f;e.subscribers.delete(r),e.subscribers.size===0&&(a=e,f=t,setTimeout(function(){a.subscribers.size===0&&Me(f,a)},3e3))})}var Ro={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(r,i,a){var f,h,m=e.transaction(r,i,a);return i==="readwrite"&&(h=(f=new AbortController).signal,a=function(b){return function(){if(f.abort(),i==="readwrite"){for(var k=new Set,E=0,v=r;E<v.length;E++){var S=v[E],w=Ft["idb://".concat(t,"/").concat(S)];if(w){var T=e.table(S),C=w.optimisticOps.filter(function(Q){return Q.trans===m});if(m._explicit&&b&&m.mutatedParts)for(var x=0,O=Object.values(w.queries.query);x<O.length;x++)for(var P=0,D=(V=O[x]).slice();P<D.length;P++)Tr((q=D[P]).obsSet,m.mutatedParts)&&(Me(V,q),q.subscribers.forEach(function(Q){return k.add(Q)}));else if(0<C.length){w.optimisticOps=w.optimisticOps.filter(function(Q){return Q.trans!==m});for(var M=0,B=Object.values(w.queries.query);M<B.length;M++)for(var V,q,L,Y=0,U=(V=B[M]).slice();Y<U.length;Y++)(q=U[Y]).res!=null&&m.mutatedParts&&(b&&!q.dirty?(L=Object.isFrozen(q.res),L=_i(q.res,q.req,C,T,q,L),q.dirty?(Me(V,q),q.subscribers.forEach(function(Q){return k.add(Q)})):L!==q.res&&(q.res=L,q.promise=G.resolve({result:L}))):(q.dirty&&Me(V,q),q.subscribers.forEach(function(Q){return k.add(Q)})))}}}k.forEach(function(Q){return Q()})}}},m.addEventListener("abort",a(!1),{signal:h}),m.addEventListener("error",a(!1),{signal:h}),m.addEventListener("complete",a(!0),{signal:h})),m},table:function(r){var i=e.table(r),a=i.schema.primaryKey;return o(o({},i),{mutate:function(f){var h=ee.trans;if(a.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(f);var m=Ft["idb://".concat(t,"/").concat(r)];return m?(h=i.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||Pr(a,f).some(function(b){return b==null}))?(m.optimisticOps.push(f),f.mutatedParts&&qn(f.mutatedParts),h.then(function(b){0<b.numFailures&&(Me(m.optimisticOps,f),(b=yi(0,f,b))&&m.optimisticOps.push(b),f.mutatedParts&&qn(f.mutatedParts))}),h.catch(function(){Me(m.optimisticOps,f),f.mutatedParts&&qn(f.mutatedParts)})):h.then(function(b){var k=yi(0,o(o({},f),{values:f.values.map(function(E,v){var S;return b.failures[v]?E:(E=(S=a.keyPath)!==null&&S!==void 0&&S.includes(".")?le(E):o({},E),Z(E,a.keyPath,b.results[v]),E)})}),b);m.optimisticOps.push(k),queueMicrotask(function(){return f.mutatedParts&&qn(f.mutatedParts)})}),h):i.mutate(f)},query:function(f){if(!mi(ee,i)||!vi("query",f))return i.query(f);var h=((k=ee.trans)===null||k===void 0?void 0:k.db._options.cache)==="immutable",v=ee,m=v.requery,b=v.signal,k=function(T,C,x,O){var P=Ft["idb://".concat(T,"/").concat(C)];if(!P)return[];if(!(C=P.queries[x]))return[null,!1,P,null];var D=C[(O.query?O.query.index.name:null)||""];if(!D)return[null,!1,P,null];switch(x){case"query":var M=D.find(function(B){return B.req.limit===O.limit&&B.req.values===O.values&&gi(B.req.query.range,O.query.range)});return M?[M,!0,P,D]:[D.find(function(B){return("limit"in B.req?B.req.limit:1/0)>=O.limit&&(!O.values||B.req.values)&&Ko(B.req.query.range,O.query.range)}),!1,P,D];case"count":return M=D.find(function(B){return gi(B.req.query.range,O.query.range)}),[M,!!M,P,D]}}(t,r,"query",f),E=k[0],v=k[1],S=k[2],w=k[3];return E&&v?E.obsSet=f.obsSet:(v=i.query(f).then(function(T){var C=T.result;if(E&&(E.res=C),h){for(var x=0,O=C.length;x<O;++x)Object.freeze(C[x]);Object.freeze(C)}else T.result=le(C);return T}).catch(function(T){return w&&E&&Me(w,E),Promise.reject(T)}),E={obsSet:f.obsSet,promise:v,subscribers:new Set,type:"query",req:f,dirty:!1},w?w.push(E):(w=[E],(S=S||(Ft["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=w)),Mo(E,w,m,b),E.promise.then(function(T){return{result:_i(T.result,f,S==null?void 0:S.optimisticOps,i,E,h)}})}})}})}};function Ln(e,t){return new Proxy(e,{get:function(r,i,a){return i==="db"?t:Reflect.get(r,i,a)}})}var ht=(Ue.prototype.version=function(e){if(isNaN(e)||e<.1)throw new re.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new re.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(To),r.stores({}),this._state.autoSchema=!1,r)},Ue.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ee.letThrough||this._vip)?e():new G(function(r,i){if(t._state.openComplete)return i(new re.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new re.DatabaseClosed);t.open().catch(Ce)}t._state.dbReadyPromise.then(r,i)}).then(e)},Ue.prototype.use=function(e){var t=e.stack,r=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:i??10,name:a}),e.sort(function(f,h){return f.level-h.level}),this},Ue.prototype.unuse=function(e){var t=e.stack,r=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!r&&a.name!==r})),this},Ue.prototype.open=function(){var e=this;return Nt(mt,function(){return Io(e)})},Ue.prototype._close=function(){var e=this._state,t=Wt.indexOf(this);if(0<=t&&Wt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new G(function(r){e.dbReadyResolve=r}),e.openCanceller=new G(function(r,i){e.cancelOpen=i}))},Ue.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new re.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new re.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},Ue.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new G(function(a,f){function h(){t.close(e);var m=t._deps.indexedDB.deleteDatabase(t.name);m.onsuccess=De(function(){var b,k,E;b=t._deps,k=t.name,E=b.indexedDB,b=b.IDBKeyRange,wr(E)||k===Cn||br(E,b).delete(k).catch(Ce),a()}),m.onerror=st(f),m.onblocked=t._fireOnBlocked}if(r)throw new re.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Ue.prototype.backendDB=function(){return this.idbdb},Ue.prototype.isOpen=function(){return this.idbdb!==null},Ue.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Ue.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ue.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ue.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Ue.prototype.transaction=function(){var e=(function(t,r,i){var a=arguments.length;if(a<2)throw new re.InvalidArgument("Too few arguments");for(var f=new Array(a-1);--a;)f[a-1]=arguments[a];return i=f.pop(),[t,Se(f),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Ue.prototype._transaction=function(e,t,r){var i=this,a=ee.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var f,h,m=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(k){if(k=k instanceof i.Table?k.name:k,typeof k!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return k}),e=="r"||e===ur)f=ur;else{if(e!="rw"&&e!=lr)throw new re.InvalidArgument("Invalid transaction mode: "+e);f=lr}if(a){if(a.mode===ur&&f===lr){if(!m)throw new re.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&h.forEach(function(k){if(a&&a.storeNames.indexOf(k)===-1){if(!m)throw new re.SubTransaction("Table "+k+" not included in parent transaction.");a=null}}),m&&a&&!a.active&&(a=null)}}catch(k){return a?a._promise(null,function(E,v){v(k)}):Le(k)}var b=(function k(E,v,S,w,T){return G.resolve().then(function(){var C=ee.transless||ee,x=E._createTransaction(v,S,E._dbSchema,w);if(x.explicit=!0,C={trans:x,transless:C},w)x.idbtrans=w.idbtrans;else try{x.create(),x.idbtrans._explicit=!0,E._state.PR1398_maxLoop=3}catch(D){return D.name===Dt.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return k(E,v,S,null,T)})):Le(D)}var O,P=Ve(T);return P&&Gt(),C=G.follow(function(){var D;(O=T.call(x,x))&&(P?(D=yt.bind(null,null),O.then(D,D)):typeof O.next=="function"&&typeof O.throw=="function"&&(O=Ir(O)))},C),(O&&typeof O.then=="function"?G.resolve(O).then(function(D){return x.active?D:Le(new re.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):C.then(function(){return O})).then(function(D){return w&&x._resolve(),x._completion.then(function(){return D})}).catch(function(D){return x._reject(D),Le(D)})})}).bind(null,this,f,h,a,r);return a?a._promise(f,b,"lock"):ee.trans?Nt(ee.transless,function(){return i._whenReady(b)}):this._whenReady(b)},Ue.prototype.table=function(e){if(!I(this._allTables,e))throw new re.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Ue);function Ue(e,t){var r=this;this._middlewares={},this.verno=0;var i=Ue.dependencies;this._options=t=o({addons:Ue.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,f,h,m,b,k={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ce,dbReadyPromise:null,cancelOpen:Ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};k.dbReadyPromise=new G(function(v){k.dbReadyResolve=v}),k.openCanceller=new G(function(v,S){k.cancelOpen=S}),this._state=k,this.name=e,this.on=on(this,"populate","blocked","versionchange","close",{ready:[Zn,Ce]}),this.on.ready.subscribe=H(this.on.ready.subscribe,function(v){return function(S,w){Ue.vip(function(){var T,C=r._state;C.openComplete?(C.dbOpenError||G.resolve().then(S),w&&v(S)):C.onReadyBeingFired?(C.onReadyBeingFired.push(S),w&&v(S)):(v(S),T=r,w||v(function x(){T.on.ready.unsubscribe(S),T.on.ready.unsubscribe(x)}))})}}),this.Collection=(a=this,an(yo.prototype,function(O,x){this.db=a;var w=Qr,T=null;if(x)try{w=x()}catch(P){T=P}var C=O._ctx,x=C.table,O=x.hook.reading.fire;this._ctx={table:x,index:C.index,isPrimKey:!C.index||x.schema.primKey.keyPath&&C.index===x.schema.primKey.name,range:w,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:T,or:C.or,valueMapper:O!==Zt?O:null}})),this.Table=(f=this,an(ei.prototype,function(v,S,w){this.db=f,this._tx=w,this.name=v,this.schema=S,this.hook=f._allTables[v]?f._allTables[v].hook:on(null,{creating:[so,Ce],reading:[ao,Zt],updating:[lo,Ce],deleting:[uo,Ce]})})),this.Transaction=(h=this,an(bo.prototype,function(v,S,w,T,C){var x=this;this.db=h,this.mode=v,this.storeNames=S,this.schema=w,this.chromeTransactionDurability=T,this.idbtrans=null,this.on=on(this,"complete","error","abort"),this.parent=C||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new G(function(O,P){x._resolve=O,x._reject=P}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(O){var P=x.active;return x.active=!1,x.on.error.fire(O),x.parent?x.parent._reject(O):P&&x.idbtrans&&x.idbtrans.abort(),Le(O)})})),this.Version=(m=this,an(So.prototype,function(v){this.db=m,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(b=this,an(oi.prototype,function(v,S,w){if(this.db=b,this._ctx={table:v,index:S===":id"?null:S,or:w},this._cmp=this._ascending=ke,this._descending=function(T,C){return ke(C,T)},this._max=function(T,C){return 0<ke(T,C)?T:C},this._min=function(T,C){return ke(T,C)<0?T:C},this._IDBKeyRange=b._deps.IDBKeyRange,!this._IDBKeyRange)throw new re.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=cn(t.IDBKeyRange),this._createTransaction=function(v,S,w,T){return new r.Transaction(v,S,w,r._options.chromeTransactionDurability,T)},this._fireOnBlocked=function(v){r.on("blocked").fire(v),Wt.filter(function(S){return S.name===r.name&&S!==r&&!S._state.vcFired}).map(function(S){return S.on("versionchange").fire(v)})},this.use(Do),this.use(Ro),this.use(jo),this.use(Oo),this.use(Po);var E=new Proxy(this,{get:function(v,S,w){if(S==="_vip")return!0;if(S==="table")return function(C){return Ln(r.table(C),E)};var T=Reflect.get(v,S,w);return T instanceof ei?Ln(T,E):S==="tables"?T.map(function(C){return Ln(C,E)}):S==="_createTransaction"?function(){return Ln(T.apply(this,arguments),E)}:T}});this.vip=E,i.forEach(function(v){return v(r)})}var Un,rt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ao=(jr.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},jr.prototype[rt]=function(){return this},jr);function jr(e){this._subscribe=e}try{Un={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Un={indexedDB:null,IDBKeyRange:null}}function bi(e){var t,r=!1,i=new Ao(function(a){var f=Ve(e),h,m=!1,b={},k={},E={get closed(){return m},unsubscribe:function(){m||(m=!0,h&&h.abort(),v&&bt.storagemutated.unsubscribe(w))}};a.start&&a.start(E);var v=!1,S=function(){return sr(T)},w=function(C){Bn(b,C),Tr(k,b)&&S()},T=function(){var C,x,O;!m&&Un.indexedDB&&(b={},C={},h&&h.abort(),h=new AbortController,O=function(P){var D=Ht();try{f&&Gt();var M=vt(e,P);return M=f?M.finally(yt):M}finally{D&&zt()}}(x={subscr:C,signal:h.signal,requery:S,querier:e,trans:null}),Promise.resolve(O).then(function(P){r=!0,t=P,m||x.signal.aborted||(b={},function(D){for(var M in D)if(I(D,M))return;return 1}(k=C)||v||(bt(ln,w),v=!0),sr(function(){return!m&&a.next&&a.next(P)}))},function(P){r=!1,["DatabaseClosedError","AbortError"].includes(P==null?void 0:P.name)||m||sr(function(){m||a.error&&a.error(P)})}))};return setTimeout(S,0),E});return i.hasValue=function(){return r},i.getValue=function(){return t},i}var Lt=ht;function Kr(e){var t=wt;try{wt=!0,bt.storagemutated.fire(e),Sr(e,!0)}finally{wt=t}}p(Lt,o(o({},yn),{delete:function(e){return new Lt(e,{addons:[]}).delete()},exists:function(e){return new Lt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Lt.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(wr(r)?Promise.resolve(r.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==Cn})}):br(r,t).toCollection().primaryKeys()).then(e)}catch{return Le(new re.MissingAPI)}var t,r},defineClass:function(){return function(e){j(this,e)}},ignoreTransaction:function(e){return ee.trans?Nt(ee.transless,e):e()},vip:kr,async:function(e){return function(){try{var t=Ir(e.apply(this,arguments));return t&&typeof t.then=="function"?t:G.resolve(t)}catch(r){return Le(r)}}},spawn:function(e,t,r){try{var i=Ir(e.apply(r,t||[]));return i&&typeof i.then=="function"?i:G.resolve(i)}catch(a){return Le(a)}},currentTransaction:{get:function(){return ee.trans||null}},waitFor:function(e,t){return t=G.resolve(typeof e=="function"?Lt.ignoreTransaction(e):e).timeout(t||6e4),ee.trans?ee.trans.waitFor(t):t},Promise:G,debug:{get:function(){return at},set:function(e){Vr(e)}},derive:ue,extend:j,props:p,override:H,Events:on,on:bt,liveQuery:bi,extendObservabilitySet:Bn,getByKeyPath:ie,setByKeyPath:Z,delByKeyPath:function(e,t){typeof t=="string"?Z(e,t,void 0):"length"in t&&[].map.call(t,function(r){Z(e,r,void 0)})},shallowClone:ne,deepClone:le,getObjectDiff:Or,cmp:ke,asap:ve,minKey:-1/0,addons:[],connections:Wt,errnames:Dt,dependencies:Un,cache:Ft,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),Lt.maxKey=cn(Lt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(bt(ln,function(e){wt||(e=new CustomEvent(hr,{detail:e}),wt=!0,dispatchEvent(e),wt=!1)}),addEventListener(hr,function(e){e=e.detail,wt||Kr(e)}));var $t,wt=!1,wi=function(){};return typeof BroadcastChannel<"u"&&((wi=function(){($t=new BroadcastChannel(hr)).onmessage=function(e){return e.data&&Kr(e.data)}})(),typeof $t.unref=="function"&&$t.unref(),bt(ln,function(e){wt||$t.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!ht.disableBfCache&&e.persisted){at&&console.debug("Dexie: handling persisted pagehide"),$t!=null&&$t.close();for(var t=0,r=Wt;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ht.disableBfCache&&e.persisted&&(at&&console.debug("Dexie: handling persisted pageshow"),wi(),Kr({all:new Xe(-1/0,[[]])}))})),G.rejectionMapper=function(e,t){return!e||e instanceof _e||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ur[e.name]?e:(t=new Ur[e.name](t||e.message,e),"stack"in e&&F(t,"stack",{get:function(){return this.inner.stack}}),t)},Vr(at),o(ht,Object.freeze({__proto__:null,Dexie:ht,liveQuery:bi,Entity:$r,cmp:ke,PropModification:sn,replacePrefix:function(e,t){return new sn({replacePrefix:[e,t]})},add:function(e){return new sn({add:e})},remove:function(e){return new sn({remove:e})},default:ht,RangeSet:Xe,mergeRanges:hn,rangesOverlap:ci}),{default:ht}),ht})})(no);var zo=no.exports;const Ar=Ho(zo),Ci=Symbol.for("Dexie"),$n=globalThis[Ci]||(globalThis[Ci]=Ar);if(Ar.semVer!==$n.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ar.semVer} and ${$n.semVer}`);const{liveQuery:Wa,mergeRanges:Xa,rangesOverlap:Qa,RangeSet:$a,cmp:Ja,Entity:Za,PropModification:es,replacePrefix:ts,add:ns,remove:rs}=$n;class Go extends $n{constructor(){super("MeditationGameDB");ki(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const mn=new Go,vn=[{id:"L1",name:"Level 1",minDuration:Ye.ONE_MINUTE,maxDuration:Ye.FIVE_MINUTES,description:"Sit. Breathe. Notice the mind.",instructions:["Sit comfortably","Focus on the feeling of breath through your nose","Tap when you notice the mind has wandered","Gently return to the breath each time"],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:Ye.TWO_MINUTES,maxDuration:Ye.TEN_MINUTES,description:"Let go of counting and images.",instructions:["Focus on the breath through your nose","Donât count, visualize, or repeat words","Tap when your mind wanders","Return to the breath, without mental help"],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:Ye.FIVE_MINUTES,maxDuration:Ye.FIFTEEN_MINUTES,description:"Observe thoughts as they arise.",instructions:["Focus on the breath through your nose","Donât use any counting or mental images","Tap when distracted, then silently observe the thought","Label it if you can (e.g. âplanning,â âjudgingâ)","Let it go and return to the breath"],completionTasks:[{id:"two_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]},{id:"L4",name:"Level 4",minDuration:Ye.FIVE_MINUTES,maxDuration:Ye.FIFTEEN_MINUTES,description:"Notice how you react to yourself.",instructions:["Keep observing the breath","No counting or images","Tap when distracted, observe the thought","Then notice how you feel about getting distracted","If thereâs frustration or judgment, notice that too â and let it go"],completionTasks:[{id:"two_sessions_under_5_taps",description:"Have 2 sessions in a row with fewer than 5 taps"},{id:"one_min_no_taps_twice",description:"Go 1 minute without a tap in 2 separate sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions","max_duration"]}}]},{id:"L5",name:"Level 5",minDuration:Ye.TEN_MINUTES,maxDuration:Ye.THIRTY_MINUTES,description:"Everything changes. Keep observing.",instructions:["Keep observing breath and distractions","Tap when the mind wanders, observe the thought, notice your reaction","Then remember: everything changes â including this","Let the distraction and your reaction pass","Return to the breath with calm awareness"],completionTasks:[{id:"session_with_3_or_fewer_taps",description:"Have one session with 3 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"two_min_no_taps",description:"Go 2 minutes without tapping"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps","max_duration"]}}]},{id:"L6",name:"Level 6",minDuration:Ye.FIFTEEN_MINUTES,maxDuration:Ye.SIXTY_MINUTES,description:"Sit still. Stay with discomfort.",instructions:["Observe breath, distractions, and reactions as before","Sit still in your chosen posture for the full session","If discomfort arises, donât shift â just observe it","Notice the discomfort, let it change, and return to breath","Everything will pass"],completionTasks:[{id:"three_min_no_taps",description:"Go 3 minutes without a tap"},{id:"session_with_2_or_fewer_taps",description:"Have a session with 2 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"distractions_early_on",description:"Finish a sit with multiple distractions early on"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions","distractions_early_on","max_duration"]}}]}];function Si(u,n,s){const o=u.slice();return o[9]=n[s],o}function Ii(u){let n,s="Exit Meditation",o,c,l,d;return{c(){n=X("button"),n.textContent=s,this.h()},l(_){n=W(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-t4g94n"&&(n.textContent=s),this.h()},h(){N(n,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-filled px-4 py-2")},m(_,j){te(_,n,j),c=!0,l||(d=pt(n,"click",u[4]),l=!0)},p:We,i(_){c||(_&&it(()=>{c&&(o||(o=qe(n,Fe,{},!0)),o.run(1))}),c=!0)},o(_){_&&(o||(o=qe(n,Fe,{},!1)),o.run(0)),c=!1},d(_){_&&A(n),_&&o&&o.end(),l=!1,d()}}}function Oi(u){let n,s,o=u[9]+"",c,l;return{c(){n=X("p"),s=new Lo(!1),this.h()},l(d){n=W(d,"P",{class:!0});var _=se(n);s=Fo(_,!1),_.forEach(A),this.h()},h(){s.a=null,N(n,"class","text-lg max-w-sm")},m(d,_){te(d,n,_),s.m(o,n),l=!0},p(d,_){(!l||_&4)&&o!==(o=d[9]+"")&&s.p(o)},i(d){l||(d&&it(()=>{l&&(c||(c=qe(n,Fe,{},!0)),c.run(1))}),l=!0)},o(d){d&&(c||(c=qe(n,Fe,{},!1)),c.run(0)),l=!1},d(d){d&&A(n),d&&c&&c.end()}}}function Pi(u){let n,s="Start meditation countdown",o,c,l,d,_=Rr[u[1]]+"",j,g,y,I;return{c(){n=X("button"),n.textContent=s,c=pe(),l=X("i"),d=ae("Meditating for "),j=ae(_),this.h()},l(p){n=W(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-71gbpm"&&(n.textContent=s),c=he(p),l=W(p,"I",{class:!0});var K=se(l);d=oe(K,"Meditating for "),j=oe(K,_),K.forEach(A),this.h()},h(){N(n,"class","btn variant-filled px-4 py-2 mt-4"),N(l,"class","text-sm text-gray-500")},m(p,K){te(p,n,K),te(p,c,K),te(p,l,K),R(l,d),R(l,j),g=!0,y||(I=pt(n,"click",function(){Uo(u[0])&&u[0].apply(this,arguments)}),y=!0)},p(p,K){u=p,(!g||K&2)&&_!==(_=Rr[u[1]]+"")&&Be(j,_)},i(p){g||(p&&it(()=>{g&&(o||(o=qe(n,Fe,{},!0)),o.run(1))}),g=!0)},o(p){p&&(o||(o=qe(n,Fe,{},!1)),o.run(0)),g=!1},d(p){p&&(A(n),A(c),A(l)),p&&o&&o.end(),y=!1,I()}}}function Wo(u){let n,s,o,c,l=u[2]>=u[3].length&&Ii(u),d=et(u[3].slice(0,u[2])),_=[];for(let y=0;y<d.length;y+=1)_[y]=Oi(Si(u,d,y));const j=y=>je(_[y],1,1,()=>{_[y]=null});let g=u[2]>=u[3].length&&Pi(u);return{c(){n=X("div"),l&&l.c(),s=pe();for(let y=0;y<_.length;y+=1)_[y].c();o=pe(),g&&g.c(),this.h()},l(y){n=W(y,"DIV",{class:!0});var I=se(n);l&&l.l(I),s=he(I);for(let p=0;p<_.length;p+=1)_[p].l(I);o=he(I),g&&g.l(I),I.forEach(A),this.h()},h(){N(n,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(y,I){te(y,n,I),l&&l.m(n,null),R(n,s);for(let p=0;p<_.length;p+=1)_[p]&&_[p].m(n,null);R(n,o),g&&g.m(n,null),c=!0},p(y,[I]){if(y[2]>=y[3].length?l?(l.p(y,I),I&4&&Te(l,1)):(l=Ii(y),l.c(),Te(l,1),l.m(n,s)):l&&(kt(),je(l,1,1,()=>{l=null}),xt()),I&12){d=et(y[3].slice(0,y[2]));let p;for(p=0;p<d.length;p+=1){const K=Si(y,d,p);_[p]?(_[p].p(K,I),Te(_[p],1)):(_[p]=Oi(K),_[p].c(),Te(_[p],1),_[p].m(n,o))}for(kt(),p=d.length;p<_.length;p+=1)j(p);xt()}y[2]>=y[3].length?g?(g.p(y,I),I&4&&Te(g,1)):(g=Pi(y),g.c(),Te(g,1),g.m(n,null)):g&&(kt(),je(g,1,1,()=>{g=null}),xt())},i(y){if(!c){Te(l);for(let I=0;I<d.length;I+=1)Te(_[I]);Te(g),c=!0}},o(y){je(l),_=_.filter(Boolean);for(let I=0;I<_.length;I+=1)je(_[I]);je(g),c=!1},d(y){y&&A(n),l&&l.d(),Yt(_,y),g&&g.d()}}}function Xo(u,n,s){let{nextStep:o}=n,{closeModal:c}=n,{duration:l}=n,{levelId:d="L1"}=n;const _=vn.find(p=>p.id===d),j=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],g=(_==null?void 0:_.instructions)||j;let y=0;Br(()=>{ct.capture("instructions_viewed",{level:d});const p=setInterval(()=>{y<g.length+1?s(2,y+=1):clearInterval(p)},1e3)});const I=()=>{ct.capture("instructions_exit",{instructions_viewed:y,level:d}),c()};return u.$$set=p=>{"nextStep"in p&&s(0,o=p.nextStep),"closeModal"in p&&s(5,c=p.closeModal),"duration"in p&&s(1,l=p.duration),"levelId"in p&&s(6,d=p.levelId)},[o,l,y,g,I,c,d]}class Qo extends Et{constructor(n){super(),Ct(this,n,Xo,Wo,Tt,{nextStep:0,closeModal:5,duration:1,levelId:6})}}const $o=u=>{const n=u%60;return(u/60>1?`${Math.floor(u/60)}:`:"")+`${n<10?"0":""}${n}`};function Jt(u){const n=u/60;return Number.isInteger(n)?n:Math.round(n*10)/10}function Jo(u){let n,s,o,c,l,d;return{c(){n=Hn("svg"),s=Hn("circle"),o=Hn("circle"),l=Hn("text"),d=ae(u[1]),this.h()},l(_){n=Yn(_,"svg",{class:!0,viewBox:!0});var j=se(n);s=Yn(j,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),se(s).forEach(A),o=Yn(j,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),se(o).forEach(A),l=Yn(j,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var g=se(l);d=oe(g,u[1]),g.forEach(A),j.forEach(A),this.h()},h(){N(s,"cx","50"),N(s,"cy","50"),N(s,"r","40"),N(s,"stroke","gray"),N(s,"stroke-width","5"),N(s,"fill","none"),N(o,"cx","50"),N(o,"cy","50"),N(o,"r","40"),N(o,"stroke","blue"),N(o,"stroke-width","5"),N(o,"fill","none"),N(o,"stroke-dasharray","251.2"),N(o,"stroke-dashoffset",c=251.2*u[0]),N(o,"transform","rotate(-90 50 50)"),N(l,"x","50"),N(l,"y","55"),N(l,"font-size","14"),N(l,"text-anchor","middle"),N(l,"fill","black"),N(n,"class","w-32 h-32"),N(n,"viewBox","0 0 100 100")},m(_,j){te(_,n,j),R(n,s),R(n,o),R(n,l),R(l,d)},p(_,[j]){j&1&&c!==(c=251.2*_[0])&&N(o,"stroke-dashoffset",c),j&2&&Be(d,_[1])},i:We,o:We,d(_){_&&A(n)}}}const Zo="/sounds/gong.mp3";function ea(u,n,s){let o,c,{duration:l}=n,{startTimestamp:d}=n;const _=eo();let j=Wn(l),g=null,y,I=null;const p=Ti(j,$=>$o($));Xn(u,p,$=>s(1,c=$));const K=Ti(j,$=>$/l);Xn(u,K,$=>s(0,o=$));const F=async()=>{if(!(!window.audioContext||!I))try{const $=window.audioContext.createBufferSource();$.buffer=I,$.connect(window.audioContext.destination),$.start(0)}catch($){console.error("Error playing sound:",$)}},ue=async()=>{if(window.audioContext)try{const H=await(await fetch(Zo)).arrayBuffer();I=await window.audioContext.decodeAudioData(H)}catch($){console.error("Error loading sound:",$)}},ce=()=>{clearInterval(y),F(),_("complete")},z=async $=>{try{if(!("wakeLock"in navigator))return;$?g=await navigator.wakeLock.request("screen"):g&&(await g.release(),g=null)}catch(H){console.error(`Wake Lock ${$?"request":"release"} failed:`,H)}};return Br(()=>{s(4,d=Date.now()),y=setInterval(()=>{j.update($=>$>0?$-1:(ce(),0))},1e3),ue(),z(!0)}),Vo(()=>{clearInterval(y),z(!1)}),u.$$set=$=>{"duration"in $&&s(5,l=$.duration),"startTimestamp"in $&&s(4,d=$.startTimestamp)},[o,c,p,K,d,l]}class ro extends Et{constructor(n){super(),Ct(this,n,ea,Jo,Tt,{duration:5,startTimestamp:4})}}function ta(u){let n,s,o,c="Your meditation starts in:",l,d,_,j,g,y="Exit Meditation",I,p,K,F;function ue(z){u[6](z)}let ce={duration:na};return u[0]!==void 0&&(ce.startTimestamp=u[0]),d=new ro({props:ce}),qr.push(()=>Lr(d,"startTimestamp",ue)),d.$on("complete",u[1]),{c(){n=X("div"),s=X("div"),o=X("p"),o.textContent=c,l=pe(),Pt(d.$$.fragment),j=pe(),g=X("button"),g.textContent=y,this.h()},l(z){n=W(z,"DIV",{class:!0});var $=se(n);s=W($,"DIV",{class:!0});var H=se(s);o=W(H,"P",{class:!0,"data-svelte-h":!0}),Ne(o)!=="svelte-1tp8zka"&&(o.textContent=c),l=he(H),Ot(d.$$.fragment,H),H.forEach(A),j=he($),g=W($,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(g)!=="svelte-hy6wnc"&&(g.textContent=y),$.forEach(A),this.h()},h(){N(o,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto"),N(g,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(n,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(z,$){te(z,n,$),R(n,s),R(s,o),R(s,l),It(d,s,null),R(n,j),R(n,g),p=!0,K||(F=pt(g,"click",u[2]),K=!0)},p(z,[$]){const H={};!_&&$&1&&(_=!0,H.startTimestamp=z[0],Fr(()=>_=!1)),d.$set(H)},i(z){p||(Te(d.$$.fragment,z),z&&it(()=>{p&&(I||(I=qe(g,Fe,{},!0)),I.run(1))}),p=!0)},o(z){je(d.$$.fragment,z),z&&(I||(I=qe(g,Fe,{},!1)),I.run(0)),p=!1},d(z){z&&A(n),St(d),z&&I&&I.end(),K=!1,F()}}}const na=10;function ra(u,n,s){let{nextStep:o}=n,{closeModal:c}=n,{levelId:l="L1"}=n,d=0;ct.capture("countdown_started",{level:l});const _=()=>{ct.capture("countdown_complete",{level:l}),o()},j=()=>{ct.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:l}),c()};function g(y){d=y,s(0,d)}return u.$$set=y=>{"nextStep"in y&&s(3,o=y.nextStep),"closeModal"in y&&s(4,c=y.closeModal),"levelId"in y&&s(5,l=y.levelId)},[d,_,j,o,c,l,g]}class ia extends Et{constructor(n){super(),Ct(this,n,ra,ta,Tt,{nextStep:3,closeModal:4,levelId:5})}}function oa(u){let n,s;return{c(){n=X("br"),s=X("br")},l(o){n=W(o,"BR",{}),s=W(o,"BR",{})},m(o,c){te(o,n,c),te(o,s,c)},p:We,d(o){o&&(A(n),A(s))}}}function aa(u){let n,s,o;return{c(){n=X("i"),s=ae(u[2]),o=ae(" distraction"),this.h()},l(c){n=W(c,"I",{class:!0});var l=se(n);s=oe(l,u[2]),o=oe(l," distraction"),l.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(c,l){te(c,n,l),R(n,s),R(n,o)},p(c,l){l&4&&Be(s,c[2])},d(c){c&&A(n)}}}function sa(u){let n,s,o;return{c(){n=X("i"),s=ae(u[2]),o=ae(" distractions"),this.h()},l(c){n=W(c,"I",{class:!0});var l=se(n);s=oe(l,u[2]),o=oe(l," distractions"),l.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(c,l){te(c,n,l),R(n,s),R(n,o)},p(c,l){l&4&&Be(s,c[2])},d(c){c&&A(n)}}}function Di(u){let n;return{c(){n=X("div"),this.h()},l(s){n=W(s,"DIV",{class:!0,style:!0}),se(n).forEach(A),this.h()},h(){N(n,"class","ripple svelte-1wv6db6"),zn(n,"top",u[3].y+"px"),zn(n,"left",u[3].x+"px")},m(s,o){te(s,n,o)},p(s,o){o&8&&zn(n,"top",s[3].y+"px"),o&8&&zn(n,"left",s[3].x+"px")},d(s){s&&A(n)}}}function ua(u){let n,s,o,c,l,d,_="Tap anywhere on the screen to record your distractions",j,g,y,I,p,K="Exit Meditation",F,ue,ce,z;function $(ne){u[11](ne)}let H={duration:u[0]};u[1]!==void 0&&(H.startTimestamp=u[1]),o=new ro({props:H}),qr.push(()=>Lr(o,"startTimestamp",$)),o.$on("complete",u[8]);function J(ne,Oe){return ne[2]>1||ne[2]==0?sa:ne[2]==1?aa:oa}let ve=J(u),ie=ve(u),Z=u[3]&&Di(u);return{c(){n=X("div"),s=X("div"),Pt(o.$$.fragment),l=pe(),d=X("p"),d.textContent=_,j=pe(),ie.c(),g=pe(),y=X("button"),Z&&Z.c(),I=pe(),p=X("button"),p.textContent=K,this.h()},l(ne){n=W(ne,"DIV",{class:!0});var Oe=se(n);s=W(Oe,"DIV",{class:!0});var Se=se(s);Ot(o.$$.fragment,Se),l=he(Se),d=W(Se,"P",{class:!0,"data-svelte-h":!0}),Ne(d)!=="svelte-1uyhl39"&&(d.textContent=_),j=he(Se),ie.l(Se),Se.forEach(A),g=he(Oe),y=W(Oe,"BUTTON",{class:!0});var Ee=se(y);Z&&Z.l(Ee),Ee.forEach(A),I=he(Oe),p=W(Oe,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(p)!=="svelte-hy6wnc"&&(p.textContent=K),Oe.forEach(A),this.h()},h(){N(d,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto p-6"),N(y,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),N(p,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(n,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(ne,Oe){te(ne,n,Oe),R(n,s),It(o,s,null),R(s,l),R(s,d),R(s,j),ie.m(s,null),R(n,g),R(n,y),Z&&Z.m(y,null),R(n,I),R(n,p),ue=!0,ce||(z=[pt(y,"click",u[6]),pt(p,"click",u[7])],ce=!0)},p(ne,[Oe]){const Se={};Oe&1&&(Se.duration=ne[0]),!c&&Oe&2&&(c=!0,Se.startTimestamp=ne[1],Fr(()=>c=!1)),o.$set(Se),ve===(ve=J(ne))&&ie?ie.p(ne,Oe):(ie.d(1),ie=ve(ne),ie&&(ie.c(),ie.m(s,null))),ne[3]?Z?Z.p(ne,Oe):(Z=Di(ne),Z.c(),Z.m(y,null)):Z&&(Z.d(1),Z=null)},i(ne){ue||(Te(o.$$.fragment,ne),ne&&it(()=>{ue&&(F||(F=qe(p,Fe,{},!0)),F.run(1))}),ue=!0)},o(ne){je(o.$$.fragment,ne),ne&&(F||(F=qe(p,Fe,{},!1)),F.run(0)),ue=!1},d(ne){ne&&A(n),St(o),ie.d(),Z&&Z.d(),ne&&F&&F.end(),ce=!1,to(z)}}}function la(u,n,s){let o,c,{nextStep:l}=n,{duration:d}=n,{levelId:_="L1"}=n;const j=eo();let g=0;const y=Wn(0);Xn(u,y,z=>s(2,o=z));const I=Wn([]),p=Wn(null);Xn(u,p,z=>s(3,c=z));const K=z=>{const $=(Date.now()-g)/1e3;y.update(Z=>Z+1),I.update(Z=>[...Z,$]),console.log(`Click ${Vt(y)} recorded at ${$} seconds`),ct.capture("game_tap",{timestamp:$,total_taps:Vt(y),level:_,button:"distracted"});const{clientX:H,clientY:J,currentTarget:ve}=z,ie=ve.getBoundingClientRect();p.set({x:H-ie.left,y:J-ie.top}),setTimeout(()=>p.set(null),600)},F=()=>{const z=(Date.now()-g)/1e3;ct.capture("meditation_exit",{duration_meditated:z,total_taps:Vt(I).length,level:_}),j("complete",{clickTimestamps:Vt(I),durationMeditated:z,completed:d-z<5}),l()},ue=()=>{console.log("Meditation complete! Click data:",Vt(I)),ct.capture("meditation_completed",{duration:d,total_taps:Vt(I).length,level:_}),j("complete",{clickTimestamps:Vt(I),durationMeditated:d,completed:!0}),l()};function ce(z){g=z,s(1,g)}return u.$$set=z=>{"nextStep"in z&&s(9,l=z.nextStep),"duration"in z&&s(0,d=z.duration),"levelId"in z&&s(10,_=z.levelId)},[d,g,o,c,y,p,K,F,ue,l,_,ce]}class ca extends Et{constructor(n){super(),Ct(this,n,la,ua,Tt,{nextStep:9,duration:0,levelId:10})}}function fa(u){const n=Math.floor(u.durationMeditated/60),s=u.clickTimestamps.length,o=u.newStarRating-u.previousStarRating,c="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share";return o>0?`Major win! ð§ââï¸  I just earned a new â­ in The Meditation Game!
I did a ${n}âmin meditation with only ${s} distractions.
I'm at ${"â­".repeat(u.newStarRating)} on this level!
Learn and practice meditation here: ${c}`:u.isNewPersonalBest?`Miniâwin in The Meditation Game: my new personal best!
${n}âmin sit â¢ only ${s} ${s===1?"mind-wander":"mind-wanders"} â¢ ${"â­".repeat(u.newStarRating)} on this level
Learn and practice meditation here: ${c}`:`Sharing todays practice in The Meditation Game.
I did a ${n}âmin meditation with only ${s} distractions.
I'm at ${"â­".repeat(u.newStarRating)} on this level.
Learn and practice meditation here: ${c}`}function da(u){return u.newStarRating-u.previousStarRating>0?"A":u.isNewPersonalBest?"B":"C"}function io(u){return u.filter(n=>n.completed).sort((n,s)=>s.duration!==n.duration?s.duration-n.duration:n.tapCount!==s.tapCount?n.tapCount-s.tapCount:s.timestamp-n.timestamp)[0]??null}function ha(u,n,s){const{scope:o,requirement:c}=u;return o==="cumulative"?ji(c,n):s.some(l=>ji(c,l))}function ji(u,n){if(u.type==="minTasks"){const{count:s,from:o}=u;return o==="all"?n.size>=s:o.filter(l=>n.has(l)).length>=s}return u.type==="specificTasks"?u.taskIds.every(s=>n.has(s)):!1}function Nr(u,n,s){const o=[...u].sort((c,l)=>l.stars-c.stars);for(const c of o)if(ha(c,n,s))return c.stars;return 0}function pa(u){if(u.length<2)return 0;const n=[...u].sort((o,c)=>o.timestamp-c.timestamp);let s=0;for(let o=1;o<n.length;o++){const c=n[o-1],l=n[o],d=c.tapCount/Math.max(c.duration,1),_=l.tapCount/Math.max(l.duration,1);(_<d||Math.abs(_-d)<=.005&&l.duration>c.duration)&&s++}return s}function Gn(u){if(!u.tapTimestamps||u.tapTimestamps.length===0)return u.duration/60;const n=[];n.push(u.tapTimestamps[0]);for(let c=1;c<u.tapTimestamps.length;c++)n.push(u.tapTimestamps[c]-u.tapTimestamps[c-1]);const s=u.tapTimestamps[u.tapTimestamps.length-1];return n.push(u.duration-s),Math.max(...n)/60}const Ki=(u,n)=>u.filter(n).length,pn=(u,n)=>u.some(n),lt={tap_once:([u])=>({completed:(u==null?void 0:u.tapCount)>=1,info:""}),no_early_exit:([u])=>({completed:(u==null?void 0:u.completed)===!0,info:""}),session_under_5_taps:([u])=>({completed:(u==null?void 0:u.tapCount)<=5,info:""}),session_with_2_or_fewer_taps:u=>({completed:pn(u,n=>n.tapCount<=2),info:""}),session_with_3_or_fewer_taps:u=>({completed:pn(u,n=>n.tapCount<=3),info:""}),distractions_early_on:([u])=>{var n;return{completed:((n=u==null?void 0:u.tapTimestamps)==null?void 0:n.filter(s=>s<=60).length)>=2,info:""}},complete_2_sessions:u=>({completed:u.length>=2,info:u.length===0||u.length>=2?"":"(1/2 complete)"}),complete_3_sessions:u=>({completed:u.length>=3,info:u.length===0||u.length>=3?"":`(${u.length}/3 complete)`}),two_sessions_under_5_taps:u=>{let n=0;for(let s=u.length-1;s>=0;s--)if(u[s].tapCount<5){if(n++,n===2)break}else n=0;return{completed:n===2,info:u.length===0||n===2?"":`(${Math.min(n,1)}/2 complete)`}},two_sessions_under_8_taps:u=>{const n=Ki(u,s=>s.tapCount<=8);return{completed:n>=2,info:u.length===0||n>=2?"":`(${n}/2 complete)`}},one_min_no_taps:u=>({completed:pn(u,n=>Gn(n)>=60),info:""}),one_min_no_taps_twice:u=>{const n=Ki(u,s=>Gn(s)>=60);return{completed:n>=2,info:u.length===0||n>=2?"":`(${n}/2 complete)`}},two_min_no_taps:u=>({completed:pn(u,n=>Gn(n)>=120),info:""}),three_min_no_taps:u=>({completed:pn(u,n=>Gn(n)>=180),info:""}),improve_tap_count_2_sessions:u=>{const n=pa(u);return{completed:n>=2,info:u.length===0||n>=2?"":`(${n}/2 complete)`}},max_duration:(u,n)=>({completed:u.some(s=>s.duration>=n.maxDuration),info:""})};async function Jn(u){const n=vn.find(c=>c.id===u);if(!n)return{};const s=await mn.sessions.where("levelId").equals(u).toArray(),o={};for(const c of n.completionTasks){const l=lt[c.id];if(!l){console.warn(`Missing evaluator for task '${c.id}' in level '${u}'`),o[c.id]={completed:!1};continue}o[c.id]={...c,...l(s,n)}}return o}async function ma(){var n;const u=[];for(let s=0;s<vn.length;s++){const o=vn[s],c=await mn.sessions.where("levelId").equals(o.id).toArray(),l=s===0||(((n=u[s-1])==null?void 0:n.starRating)??0)>1;let d=null,_,j=null;if(l){d=await Jn(o.id);const g=new Set(Object.entries(d).filter(([I,p])=>p.completed).map(([I])=>I)),y=c.map(I=>new Set(o.completionTasks.filter(p=>{var K;return(K=lt[p.id])==null?void 0:K.call(lt,[I],o).completed}).map(p=>p.id)));_=Nr(o.starRules,g,y),j=io(c)}u.push({level:o,isUnlocked:l,taskCompletion:d,starRating:_,bestSession:j})}return u}function Mi(u,n,s){const o=u.slice();return o[8]=n[s][0],o[9]=n[s][1],o}function Ri(u,n,s){const o=u.slice();return o[8]=n[s],o[13]=s,o}function Ai(u){let n;function s(l,d){return l[0].newStarRating===3?ya:va}let o=s(u),c=o(u);return{c(){n=X("p"),c.c(),this.h()},l(l){n=W(l,"P",{class:!0});var d=se(n);c.l(d),d.forEach(A),this.h()},h(){N(n,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(l,d){te(l,n,d),c.m(n,null)},p(l,d){o===(o=s(l))&&c?c.p(l,d):(c.d(1),c=o(l),c&&(c.c(),c.m(n,null)))},d(l){l&&A(n),c.d()}}}function va(u){let n,s=u[0].newStarRating-u[0].previousStarRating+"",o,c;return{c(){n=ae("You earned +"),o=ae(s),c=ae(" â­ â keep going!")},l(l){n=oe(l,"You earned +"),o=oe(l,s),c=oe(l," â­ â keep going!")},m(l,d){te(l,n,d),te(l,o,d),te(l,c,d)},p(l,d){d&1&&s!==(s=l[0].newStarRating-l[0].previousStarRating+"")&&Be(o,s)},d(l){l&&(A(n),A(o),A(c))}}}function ya(u){let n;return{c(){n=ae("Mastered this level! â¨")},l(s){n=oe(s,"Mastered this level! â¨")},m(s,o){te(s,n,o)},p:We,d(s){s&&A(n)}}}function Ni(u){let n,s=u[13]<u[0].newStarRating?"â­":"â",o,c;return{c(){n=X("span"),o=ae(s),c=pe(),this.h()},l(l){n=W(l,"SPAN",{class:!0});var d=se(n);o=oe(d,s),c=he(d),d.forEach(A),this.h()},h(){N(n,"class","text-xl")},m(l,d){te(l,n,d),R(n,o),R(n,c)},p(l,d){d&1&&s!==(s=l[13]<l[0].newStarRating?"â­":"â")&&Be(o,s)},d(l){l&&A(n)}}}function _a(u){let n,s="You completed your meditation distraction-free!";return{c(){n=X("p"),n.textContent=s,this.h()},l(o){n=W(o,"P",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-j87uf1"&&(n.textContent=s),this.h()},h(){N(n,"class","text-lg mt-4")},m(o,c){te(o,n,c)},p:We,d(o){o&&A(n)}}}function ga(u){let n,s,o=u[4](u[0].durationMeditated)+"",c,l,d,_,j=u[2]===1?"distraction":"distractions",g,y,I,p,K,F,ue,ce=Number(u[3])===1?"distraction":"distractions",z,$;return{c(){n=X("p"),s=ae("You meditated for "),c=ae(o),l=ae(" and recorded "),d=ae(u[2]),_=pe(),g=ae(j),y=ae("."),I=pe(),p=X("p"),K=ae("That's about "),F=ae(u[3]),ue=pe(),z=ae(ce),$=ae(" per minute."),this.h()},l(H){n=W(H,"P",{class:!0});var J=se(n);s=oe(J,"You meditated for "),c=oe(J,o),l=oe(J," and recorded "),d=oe(J,u[2]),_=he(J),g=oe(J,j),y=oe(J,"."),J.forEach(A),I=he(H),p=W(H,"P",{class:!0});var ve=se(p);K=oe(ve,"That's about "),F=oe(ve,u[3]),ue=he(ve),z=oe(ve,ce),$=oe(ve," per minute."),ve.forEach(A),this.h()},h(){N(n,"class","text-lg mt-4"),N(p,"class","text-lg mt-2")},m(H,J){te(H,n,J),R(n,s),R(n,c),R(n,l),R(n,d),R(n,_),R(n,g),R(n,y),te(H,I,J),te(H,p,J),R(p,K),R(p,F),R(p,ue),R(p,z),R(p,$)},p(H,J){J&1&&o!==(o=H[4](H[0].durationMeditated)+"")&&Be(c,o)},d(H){H&&(A(n),A(I),A(p))}}}function ba(u){let n,s,o=u[0].personalBest.tapCount+"",c,l,d=Jt(u[0].personalBest.duration)+"",_,j;return{c(){n=X("p"),s=ae("Best so far: "),c=ae(o),l=ae(" taps Â· "),_=ae(d),j=ae(" min."),this.h()},l(g){n=W(g,"P",{class:!0});var y=se(n);s=oe(y,"Best so far: "),c=oe(y,o),l=oe(y," taps Â· "),_=oe(y,d),j=oe(y," min."),y.forEach(A),this.h()},h(){N(n,"class","mt-4 text-muted-foreground")},m(g,y){te(g,n,y),R(n,s),R(n,c),R(n,l),R(n,_),R(n,j)},p(g,y){y&1&&o!==(o=g[0].personalBest.tapCount+"")&&Be(c,o),y&1&&d!==(d=Jt(g[0].personalBest.duration)+"")&&Be(_,d)},d(g){g&&A(n)}}}function wa(u){let n,s,o=u[0].personalBest.tapCount+"",c,l,d=Jt(u[0].personalBest.duration)+"",_,j;return{c(){n=X("p"),s=ae("New personal best ð â "),c=ae(o),l=ae(" taps over "),_=ae(d),j=ae(" min."),this.h()},l(g){n=W(g,"P",{class:!0});var y=se(n);s=oe(y,"New personal best ð â "),c=oe(y,o),l=oe(y," taps over "),_=oe(y,d),j=oe(y," min."),y.forEach(A),this.h()},h(){N(n,"class","mt-4 text-green-600 font-medium animate-fade-in svelte-tnqxsb")},m(g,y){te(g,n,y),R(n,s),R(n,c),R(n,l),R(n,_),R(n,j)},p(g,y){y&1&&o!==(o=g[0].personalBest.tapCount+"")&&Be(c,o),y&1&&d!==(d=Jt(g[0].personalBest.duration)+"")&&Be(_,d)},d(g){g&&A(n)}}}function Bi(u){let n,s=et(Object.entries(u[1])),o=[];for(let c=0;c<s.length;c+=1)o[c]=qi(Mi(u,s,c));return{c(){n=X("ul");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){n=W(c,"UL",{class:!0});var l=se(n);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(A),this.h()},h(){N(n,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto")},m(c,l){te(c,n,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(c,l){if(l&2){s=et(Object.entries(c[1]));let d;for(d=0;d<s.length;d+=1){const _=Mi(c,s,d);o[d]?o[d].p(_,l):(o[d]=qi(_),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&A(n),Yt(o,c)}}}function qi(u){let n,s,o=u[9].completed?"â":"ð²",c,l,d=u[9].description+"",_,j,g=u[9].info+"",y,I;return{c(){n=X("li"),s=X("span"),c=ae(o),l=pe(),_=ae(d),j=pe(),y=ae(g),I=pe(),this.h()},l(p){n=W(p,"LI",{class:!0});var K=se(n);s=W(K,"SPAN",{class:!0});var F=se(s);c=oe(F,o),l=he(F),_=oe(F,d),j=he(F),y=oe(F,g),F.forEach(A),I=he(K),K.forEach(A),this.h()},h(){N(s,"class","mr-2"),N(n,"class","flex items-center")},m(p,K){te(p,n,K),R(n,s),R(s,c),R(s,l),R(s,_),R(s,j),R(s,y),R(n,I)},p(p,K){K&2&&o!==(o=p[9].completed?"â":"ð²")&&Be(c,o),K&2&&d!==(d=p[9].description+"")&&Be(_,d),K&2&&g!==(g=p[9].info+"")&&Be(y,g)},d(p){p&&A(n)}}}function Fi(u){let n,s,o=u[0].newlyCompletedTasks.length+"",c,l,d=u[0].newlyCompletedTasks.length===1?"":"s",_,j;return{c(){n=X("p"),s=ae("Nice! You just completed "),c=ae(o),l=ae(" task"),_=ae(d),j=ae("."),this.h()},l(g){n=W(g,"P",{class:!0});var y=se(n);s=oe(y,"Nice! You just completed "),c=oe(y,o),l=oe(y," task"),_=oe(y,d),j=oe(y,"."),y.forEach(A),this.h()},h(){N(n,"class","mt-2 text-sm text-accent-foreground")},m(g,y){te(g,n,y),R(n,s),R(n,c),R(n,l),R(n,_),R(n,j)},p(g,y){y&1&&o!==(o=g[0].newlyCompletedTasks.length+"")&&Be(c,o),y&1&&d!==(d=g[0].newlyCompletedTasks.length===1?"":"s")&&Be(_,d)},d(g){g&&A(n)}}}function ka(u){let n,s,o="Great practice!",c,l,d,_,j,g,y,I="Level tasks",p,K,F,ue,ce,z="Share",$,H,J,ve="Exit",ie,Z,ne=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org â</a></p> <p class="mt-2">This app was made by Arjun, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn â</a></p>`,Oe,Se,Ee=u[0].newStarRating>u[0].previousStarRating&&Ai(u),fe=et(Array(3)),le=[];for(let ye=0;ye<fe.length;ye+=1)le[ye]=Ni(Ri(u,fe,ye));function He(ye,_e){return ye[0].clickTimestamps.length>0?ga:_a}let Je=He(u),ge=Je(u);function Ke(ye,_e){if(ye[0].isNewPersonalBest&&ye[0].personalBest)return wa;if(ye[0].personalBest)return ba}let Me=Ke(u),Re=Me&&Me(u),Ie=u[1]&&Bi(u),Ve=u[0].newlyCompletedTasks.length>0&&Fi(u);return{c(){n=X("div"),s=X("h2"),s.textContent=o,c=pe(),Ee&&Ee.c(),l=pe(),d=X("div");for(let ye=0;ye<le.length;ye+=1)le[ye].c();_=pe(),ge.c(),j=pe(),Re&&Re.c(),g=pe(),y=X("h3"),y.textContent=I,p=pe(),Ie&&Ie.c(),K=pe(),Ve&&Ve.c(),F=pe(),ue=X("div"),ce=X("button"),ce.textContent=z,$=pe(),H=X("div"),J=X("button"),J.textContent=ve,ie=pe(),Z=X("div"),Z.innerHTML=ne,this.h()},l(ye){n=W(ye,"DIV",{class:!0});var _e=se(n);s=W(_e,"H2",{class:!0,"data-svelte-h":!0}),Ne(s)!=="svelte-1untj5h"&&(s.textContent=o),c=he(_e),Ee&&Ee.l(_e),l=he(_e),d=W(_e,"DIV",{class:!0});var Ae=se(d);for(let Dt=0;Dt<le.length;Dt+=1)le[Dt].l(Ae);Ae.forEach(A),_=he(_e),ge.l(_e),j=he(_e),Re&&Re.l(_e),g=he(_e),y=W(_e,"H3",{class:!0,"data-svelte-h":!0}),Ne(y)!=="svelte-8ylw1a"&&(y.textContent=I),p=he(_e),Ie&&Ie.l(_e),K=he(_e),Ve&&Ve.l(_e),F=he(_e),ue=W(_e,"DIV",{class:!0});var ot=se(ue);ce=W(ot,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(ce)!=="svelte-1wlydhx"&&(ce.textContent=z),ot.forEach(A),$=he(_e),H=W(_e,"DIV",{class:!0});var ft=se(H);J=W(ft,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(J)!=="svelte-1t5v3tb"&&(J.textContent=ve),ft.forEach(A),ie=he(_e),Z=W(_e,"DIV",{class:!0,"data-svelte-h":!0}),Ne(Z)!=="svelte-k92ud0"&&(Z.innerHTML=ne),_e.forEach(A),this.h()},h(){N(s,"class","text-2xl font-bold"),N(d,"class","mt-2 flex items-center space-x-1"),N(y,"class","mt-6 font-semibold"),N(ce,"class","btn variant-filled px-4 py-2"),N(ue,"class","mt-6 flex space-x-4"),N(J,"class","btn variant-outlined px-4 py-2"),N(H,"class","mt-6 flex space-x-4"),N(Z,"class","absolute bottom-6 text-center text-sm text-gray-500"),N(n,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(ye,_e){te(ye,n,_e),R(n,s),R(n,c),Ee&&Ee.m(n,null),R(n,l),R(n,d);for(let Ae=0;Ae<le.length;Ae+=1)le[Ae]&&le[Ae].m(d,null);R(n,_),ge.m(n,null),R(n,j),Re&&Re.m(n,null),R(n,g),R(n,y),R(n,p),Ie&&Ie.m(n,null),R(n,K),Ve&&Ve.m(n,null),R(n,F),R(n,ue),R(ue,ce),R(n,$),R(n,H),R(H,J),R(n,ie),R(n,Z),Oe||(Se=[pt(ce,"click",u[5]),pt(J,"click",u[6])],Oe=!0)},p(ye,[_e]){if(ye[0].newStarRating>ye[0].previousStarRating?Ee?Ee.p(ye,_e):(Ee=Ai(ye),Ee.c(),Ee.m(n,l)):Ee&&(Ee.d(1),Ee=null),_e&1){fe=et(Array(3));let Ae;for(Ae=0;Ae<fe.length;Ae+=1){const ot=Ri(ye,fe,Ae);le[Ae]?le[Ae].p(ot,_e):(le[Ae]=Ni(ot),le[Ae].c(),le[Ae].m(d,null))}for(;Ae<le.length;Ae+=1)le[Ae].d(1);le.length=fe.length}Je===(Je=He(ye))&&ge?ge.p(ye,_e):(ge.d(1),ge=Je(ye),ge&&(ge.c(),ge.m(n,j))),Me===(Me=Ke(ye))&&Re?Re.p(ye,_e):(Re&&Re.d(1),Re=Me&&Me(ye),Re&&(Re.c(),Re.m(n,g))),ye[1]?Ie?Ie.p(ye,_e):(Ie=Bi(ye),Ie.c(),Ie.m(n,K)):Ie&&(Ie.d(1),Ie=null),ye[0].newlyCompletedTasks.length>0?Ve?Ve.p(ye,_e):(Ve=Fi(ye),Ve.c(),Ve.m(n,F)):Ve&&(Ve.d(1),Ve=null)},i:We,o:We,d(ye){ye&&A(n),Ee&&Ee.d(),Yt(le,ye),ge.d(),Re&&Re.d(),Ie&&Ie.d(),Ve&&Ve.d(),Oe=!1,to(Se)}}}function xa(u,n,s){let{closeModal:o}=n,{meditationResults:c}=n;const l=c.clickTimestamps.length,d=l>0?(l/(c.durationMeditated/60)).toFixed(1):"0";let _={};Br(async()=>{c!=null&&c.levelId&&s(1,_=await Jn(c.levelId))});const j=I=>{const p=Math.floor(I/60),K=I%60;return p===0?K+" second"+(K===1?"":"s"):p+" minute"+(p===1?"":"s")+(K>0?" and "+K+" second"+(K===1?"":"s"):"")},g=()=>{if(navigator.share){const I=c.newStarRating-c.previousStarRating,p=da(c);ct.capture("results_shared",{total_taps:l,distractionRate:d,level:c.levelId,stars_gained:I,tasks_completed:c.newlyCompletedTasks.length,template_used:p,personal_best:c.isNewPersonalBest});const K=fa(c);navigator.share({text:K}).catch(F=>console.error("Sharing failed",F))}else console.log("Web Share API not supported")},y=()=>{ct.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:c.newStarRating-c.previousStarRating,tasks_completed:c.newlyCompletedTasks.length}),o()};return u.$$set=I=>{"closeModal"in I&&s(7,o=I.closeModal),"meditationResults"in I&&s(0,c=I.meditationResults)},[c,_,l,d,j,g,y,o]}class Ta extends Et{constructor(n){super(),Ct(this,n,xa,ka,Tt,{closeModal:7,meditationResults:0})}}function Li(u){let n,s,o,c,l,d,_;const j=[Ia,Sa,Ca,Ea],g=[];function y(I,p){return I[3]===1?0:I[3]===2?1:I[3]===3?2:3}return o=y(u),c=g[o]=j[o](u),{c(){n=X("div"),s=X("div"),c.c(),this.h()},l(I){n=W(I,"DIV",{class:!0});var p=se(n);s=W(p,"DIV",{class:!0});var K=se(s);c.l(K),K.forEach(A),p.forEach(A),this.h()},h(){N(s,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),N(n,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(I,p){te(I,n,p),R(n,s),g[o].m(s,null),_=!0},p(I,p){let K=o;o=y(I),o===K?g[o].p(I,p):(kt(),je(g[K],1,1,()=>{g[K]=null}),xt(),c=g[o],c?c.p(I,p):(c=g[o]=j[o](I),c.c()),Te(c,1),c.m(s,null))},i(I){_||(Te(c),I&&it(()=>{_&&(l||(l=qe(s,Fe,{duration:500},!0)),l.run(1))}),I&&it(()=>{_&&(d||(d=qe(n,Fe,{duration:500},!0)),d.run(1))}),_=!0)},o(I){je(c),I&&(l||(l=qe(s,Fe,{duration:500},!1)),l.run(0)),I&&(d||(d=qe(n,Fe,{duration:500},!1)),d.run(0)),_=!1},d(I){I&&A(n),g[o].d(),I&&l&&l.end(),I&&d&&d.end()}}}function Ea(u){let n,s,o,c;return s=new Ta({props:{closeModal:u[5],meditationResults:u[4]}}),{c(){n=X("div"),Pt(s.$$.fragment),this.h()},l(l){n=W(l,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,n,d),It(s,n,null),c=!0},p(l,d){const _={};d&16&&(_.meditationResults=l[4]),s.$set(_)},i(l){c||(Te(s.$$.fragment,l),l&&it(()=>{c&&(o||(o=qe(n,Fe,{duration:300},!0)),o.run(1))}),c=!0)},o(l){je(s.$$.fragment,l),l&&(o||(o=qe(n,Fe,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),St(s),l&&o&&o.end()}}}function Ca(u){let n,s,o,c;return s=new ca({props:{duration:u[1],nextStep:u[7],levelId:u[2]}}),s.$on("complete",u[8]),{c(){n=X("div"),Pt(s.$$.fragment),this.h()},l(l){n=W(l,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,n,d),It(s,n,null),c=!0},p(l,d){const _={};d&2&&(_.duration=l[1]),d&4&&(_.levelId=l[2]),s.$set(_)},i(l){c||(Te(s.$$.fragment,l),l&&it(()=>{c&&(o||(o=qe(n,Fe,{duration:300},!0)),o.run(1))}),c=!0)},o(l){je(s.$$.fragment,l),l&&(o||(o=qe(n,Fe,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),St(s),l&&o&&o.end()}}}function Sa(u){let n,s,o,c;return s=new ia({props:{nextStep:u[7],closeModal:u[5],levelId:u[2]}}),{c(){n=X("div"),Pt(s.$$.fragment),this.h()},l(l){n=W(l,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,n,d),It(s,n,null),c=!0},p(l,d){const _={};d&4&&(_.levelId=l[2]),s.$set(_)},i(l){c||(Te(s.$$.fragment,l),l&&it(()=>{c&&(o||(o=qe(n,Fe,{duration:300},!0)),o.run(1))}),c=!0)},o(l){je(s.$$.fragment,l),l&&(o||(o=qe(n,Fe,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),St(s),l&&o&&o.end()}}}function Ia(u){let n,s,o,c;return s=new Qo({props:{nextStep:u[7],duration:u[1],closeModal:u[5],levelId:u[2]}}),{c(){n=X("div"),Pt(s.$$.fragment),this.h()},l(l){n=W(l,"DIV",{class:!0});var d=se(n);Ot(s.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,n,d),It(s,n,null),c=!0},p(l,d){const _={};d&2&&(_.duration=l[1]),d&4&&(_.levelId=l[2]),s.$set(_)},i(l){c||(Te(s.$$.fragment,l),l&&it(()=>{c&&(o||(o=qe(n,Fe,{duration:300},!0)),o.run(1))}),c=!0)},o(l){je(s.$$.fragment,l),l&&(o||(o=qe(n,Fe,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),St(s),l&&o&&o.end()}}}function Oa(u){let n,s,o=u[0]&&Li(u);return{c(){o&&o.c(),n=Qn()},l(c){o&&o.l(c),n=Qn()},m(c,l){o&&o.m(c,l),te(c,n,l),s=!0},p(c,[l]){c[0]?o?(o.p(c,l),l&1&&Te(o,1)):(o=Li(c),o.c(),Te(o,1),o.m(n.parentNode,n)):o&&(kt(),je(o,1,1,()=>{o=null}),xt())},i(c){s||(Te(o),s=!0)},o(c){je(o),s=!1},d(c){c&&A(n),o&&o.d(c)}}}function Pa(u,n,s){let{show:o=!1}=n,{duration:c=Ye.ONE_MINUTE}=n,{levelId:l=null}=n,d=1,_;const j=()=>{s(0,o=!1),s(3,d=1)},g=async p=>{const{clickTimestamps:K,durationMeditated:F,completed:ue}=p.detail,ce=l||"L1",z=vn.find(ge=>ge.id===ce);if(!z)return;const $=await mn.sessions.where("levelId").equals(ce).toArray(),H=await Jn(ce),J=new Set(Object.entries(H).filter(([ge,Ke])=>Ke.completed).map(([ge])=>ge)),ve=$.map(ge=>new Set(z.completionTasks.filter(Ke=>{var Me;return(Me=lt[Ke.id])==null?void 0:Me.call(lt,[ge],z).completed}).map(Ke=>Ke.id))),ie=Nr(z.starRules,J,ve),Z={levelId:ce,duration:F,tapCount:K.length,tapTimestamps:K,timestamp:Date.now(),completed:ue};await mn.sessions.add(Z);const ne=await Jn(ce),Oe=new Set(Object.entries(ne).filter(([ge,Ke])=>Ke.completed).map(([ge])=>ge)),Se=Object.entries(ne).filter(([ge,Ke])=>{var Me;return Ke.completed&&!((Me=H[ge])!=null&&Me.completed)}).map(([ge])=>ge),Ee=await mn.sessions.where("levelId").equals(ce).toArray(),fe=Ee.map(ge=>new Set(z.completionTasks.filter(Ke=>{var Me;return(Me=lt[Ke.id])==null?void 0:Me.call(lt,[ge],z).completed}).map(Ke=>Ke.id))),le=Nr(z.starRules,Oe,fe),He=io(Ee),Je=He&&He.tapCount===K.length&&He.duration===F;s(4,_={...p.detail,levelId:ce,previousStarRating:ie,newStarRating:le,newlyCompletedTasks:Se,completionTaskResults:Object.fromEntries(Object.entries(ne).map(([ge,Ke])=>[ge,Ke.completed])),isNewPersonalBest:Je||!1,personalBest:He}),y()},y=()=>setTimeout(()=>s(3,d++,d),300),I=p=>g(p);return u.$$set=p=>{"show"in p&&s(0,o=p.show),"duration"in p&&s(1,c=p.duration),"levelId"in p&&s(2,l=p.levelId)},[o,c,l,d,_,j,g,y,I]}class Da extends Et{constructor(n){super(),Ct(this,n,Pa,Oa,Tt,{show:0,duration:1,levelId:2})}}function Ui(u,n,s){const o=u.slice();return o[6]=n[s],o}function Vi(u){let n,s=Rr[u[6]]+"",o;return{c(){n=X("option"),o=ae(s),this.h()},l(c){n=W(c,"OPTION",{});var l=se(n);o=oe(l,s),l.forEach(A),this.h()},h(){n.__value=u[6],Yo(n,n.__value)},m(c,l){te(c,n,l),R(n,o)},p:We,d(c){c&&A(n)}}}function ja(u){let n,s,o="Select Meditation Duration",c,l,d,_,j=et(u[2]),g=[];for(let y=0;y<j.length;y+=1)g[y]=Vi(Ui(u,j,y));return{c(){n=X("div"),s=X("label"),s.textContent=o,c=pe(),l=X("select");for(let y=0;y<g.length;y+=1)g[y].c();this.h()},l(y){n=W(y,"DIV",{class:!0});var I=se(n);s=W(I,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Ne(s)!=="svelte-g1prfd"&&(s.textContent=o),c=he(I),l=W(I,"SELECT",{id:!0,class:!0});var p=se(l);for(let K=0;K<g.length;K+=1)g[K].l(p);p.forEach(A),I.forEach(A),this.h()},h(){N(s,"for","duration"),N(s,"class","text-md font-medium"),N(l,"id","duration"),N(l,"class","select select-bordered w-full max-w-xs"),N(n,"class","flex flex-col items-start gap-1")},m(y,I){te(y,n,I),R(n,s),R(n,c),R(n,l);for(let p=0;p<g.length;p+=1)g[p]&&g[p].m(l,null);xi(l,u[1]),d||(_=pt(l,"change",u[5]),d=!0)},p(y,[I]){if(I&4){j=et(y[2]);let p;for(p=0;p<j.length;p+=1){const K=Ui(y,j,p);g[p]?g[p].p(K,I):(g[p]=Vi(K),g[p].c(),g[p].m(l,null))}for(;p<g.length;p+=1)g[p].d(1);g.length=j.length}I&6&&xi(l,y[1])},i:We,o:We,d(y){y&&A(n),Yt(g,y),d=!1,_()}}}function Ka(u,n,s){let{onDurationChange:o}=n,{minDuration:c=Ye.ONE_MINUTE}=n,{maxDuration:l=Ye.SIXTY_MINUTES}=n,{selectedDuration:d=c??Ye.ONE_MINUTE}=n;const _=Object.values(Ye).filter(g=>typeof g=="number").filter(g=>g>=c&&g<=l),j=g=>o(Number(g.currentTarget.value));return u.$$set=g=>{"onDurationChange"in g&&s(0,o=g.onDurationChange),"minDuration"in g&&s(3,c=g.minDuration),"maxDuration"in g&&s(4,l=g.maxDuration),"selectedDuration"in g&&s(1,d=g.selectedDuration)},[o,d,_,c,l,j]}class Ma extends Et{constructor(n){super(),Ct(this,n,Ka,ja,Tt,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Yi(u,n,s){const o=u.slice();return o[9]=n[s].level,o[10]=n[s].isUnlocked,o[11]=n[s].taskCompletion,o[12]=n[s].starRating,o[13]=n[s].bestSession,o[14]=n,o[15]=s,o}function Hi(u,n,s){const o=u.slice();return o[16]=n[s][0],o[17]=n[s][1],o}function zi(u,n,s){const o=u.slice();return o[16]=n[s],o[21]=s,o}function Ra(u){let n,s,o="Section 1: Focus",c,l,d,_="<h2>Section 2: Sharpness</h2> <i>Coming soon</i>",j,g=et(u[3]),y=[];for(let p=0;p<g.length;p+=1)y[p]=Zi(Yi(u,g,p));const I=p=>je(y[p],1,1,()=>{y[p]=null});return{c(){n=X("div"),s=X("h2"),s.textContent=o,c=pe();for(let p=0;p<y.length;p+=1)y[p].c();l=pe(),d=X("div"),d.innerHTML=_,this.h()},l(p){n=W(p,"DIV",{class:!0});var K=se(n);s=W(K,"H2",{class:!0,"data-svelte-h":!0}),Ne(s)!=="svelte-jjrz8w"&&(s.textContent=o),c=he(K);for(let F=0;F<y.length;F+=1)y[F].l(K);K.forEach(A),l=he(p),d=W(p,"DIV",{class:!0,"data-svelte-h":!0}),Ne(d)!=="svelte-1nrer3t"&&(d.innerHTML=_),this.h()},h(){N(s,"class","font-bold"),N(n,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full"),N(d,"class","mt-8")},m(p,K){te(p,n,K),R(n,s),R(n,c);for(let F=0;F<y.length;F+=1)y[F]&&y[F].m(n,null);te(p,l,K),te(p,d,K),j=!0},p(p,K){if(K&46){g=et(p[3]);let F;for(F=0;F<g.length;F+=1){const ue=Yi(p,g,F);y[F]?(y[F].p(ue,K),Te(y[F],1)):(y[F]=Zi(ue),y[F].c(),Te(y[F],1),y[F].m(n,null))}for(kt(),F=g.length;F<y.length;F+=1)I(F);xt()}},i(p){if(!j){for(let K=0;K<g.length;K+=1)Te(y[K]);j=!0}},o(p){y=y.filter(Boolean);for(let K=0;K<y.length;K+=1)je(y[K]);j=!1},d(p){p&&(A(n),A(l),A(d)),Yt(y,p)}}}function Aa(u){let n,s='<div class="loading loading-spinner loading-lg"></div>';return{c(){n=X("div"),n.innerHTML=s,this.h()},l(o){n=W(o,"DIV",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-1mgfhb9"&&(n.innerHTML=s),this.h()},h(){N(n,"class","flex justify-center items-center mt-8")},m(o,c){te(o,n,c)},p:We,i:We,o:We,d(o){o&&A(n)}}}function Gi(u){let n,s="ð";return{c(){n=X("span"),n.textContent=s,this.h()},l(o){n=W(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-19hy9gc"&&(n.textContent=s),this.h()},h(){N(n,"class","text-2xl")},m(o,c){te(o,n,c)},d(o){o&&A(n)}}}function Wi(u){let n,s=et(Array(3)),o=[];for(let c=0;c<s.length;c+=1)o[c]=Xi(zi(u,s,c));return{c(){n=X("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){n=W(c,"DIV",{class:!0});var l=se(n);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(A),this.h()},h(){N(n,"class","flex items-center")},m(c,l){te(c,n,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(c,l){if(l&8){s=et(Array(3));let d;for(d=0;d<s.length;d+=1){const _=zi(c,s,d);o[d]?o[d].p(_,l):(o[d]=Xi(_),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&A(n),Yt(o,c)}}}function Na(u){let n,s="â";return{c(){n=X("span"),n.textContent=s,this.h()},l(o){n=W(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-1tpxw7h"&&(n.textContent=s),this.h()},h(){N(n,"class","text-2xl text-gray-300")},m(o,c){te(o,n,c)},d(o){o&&A(n)}}}function Ba(u){let n,s="â­";return{c(){n=X("span"),n.textContent=s,this.h()},l(o){n=W(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-1jlkvsx"&&(n.textContent=s),this.h()},h(){N(n,"class","text-2xl")},m(o,c){te(o,n,c)},d(o){o&&A(n)}}}function Xi(u){let n;function s(l,d){return l[21]<l[12]?Ba:Na}let o=s(u),c=o(u);return{c(){c.c(),n=Qn()},l(l){c.l(l),n=Qn()},m(l,d){c.m(l,d),te(l,n,d)},p(l,d){o!==(o=s(l))&&(c.d(1),c=o(l),c&&(c.c(),c.m(n.parentNode,n)))},d(l){l&&A(n),c.d(l)}}}function Qi(u){let n,s,o=u[13].tapCount+"",c,l,d=Jt(u[13].duration)+"",_,j;return{c(){n=X("p"),s=ae("Your best: "),c=ae(o),l=ae(" taps Â· "),_=ae(d),j=ae(" min"),this.h()},l(g){n=W(g,"P",{class:!0});var y=se(n);s=oe(y,"Your best: "),c=oe(y,o),l=oe(y," taps Â· "),_=oe(y,d),j=oe(y," min"),y.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(g,y){te(g,n,y),R(n,s),R(n,c),R(n,l),R(n,_),R(n,j)},p(g,y){y&8&&o!==(o=g[13].tapCount+"")&&Be(c,o),y&8&&d!==(d=Jt(g[13].duration)+"")&&Be(_,d)},d(g){g&&A(n)}}}function $i(u){let n,s=et(Object.entries(u[11])),o=[];for(let c=0;c<s.length;c+=1)o[c]=Ji(Hi(u,s,c));return{c(){n=X("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){n=W(c,"DIV",{class:!0});var l=se(n);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(A),this.h()},h(){N(n,"class","space-y-0")},m(c,l){te(c,n,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(c,l){if(l&8){s=et(Object.entries(c[11]));let d;for(d=0;d<s.length;d+=1){const _=Hi(c,s,d);o[d]?o[d].p(_,l):(o[d]=Ji(_),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&A(n),Yt(o,c)}}}function Ji(u){let n,s,o=u[17].completed?"â":"ð²",c,l,d=u[17].description+"",_,j,g=u[17].info+"",y,I;return{c(){n=X("div"),s=X("span"),c=ae(o),l=pe(),_=ae(d),j=pe(),y=ae(g),I=pe(),this.h()},l(p){n=W(p,"DIV",{class:!0});var K=se(n);s=W(K,"SPAN",{class:!0});var F=se(s);c=oe(F,o),l=he(F),_=oe(F,d),j=he(F),y=oe(F,g),F.forEach(A),I=he(K),K.forEach(A),this.h()},h(){N(s,"class","mr-2 text-sm text-gray-500"),N(n,"class","flex items-center")},m(p,K){te(p,n,K),R(n,s),R(s,c),R(s,l),R(s,_),R(s,j),R(s,y),R(n,I)},p(p,K){K&8&&o!==(o=p[17].completed?"â":"ð²")&&Be(c,o),K&8&&d!==(d=p[17].description+"")&&Be(_,d),K&8&&g!==(g=p[17].info+"")&&Be(y,g)},d(p){p&&A(n)}}}function qa(u){let n,s='<p class="text-sm text-gray-500">Achieve 2 stars in previous levels to unlock</p>';return{c(){n=X("div"),n.innerHTML=s,this.h()},l(o){n=W(o,"DIV",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-agxr37"&&(n.innerHTML=s),this.h()},h(){N(n,"class","space-y-4 mt-8")},m(o,c){te(o,n,c)},p:We,i:We,o:We,d(o){o&&A(n)}}}function Fa(u){let n,s,o,c,l="Start meditation",d,_,j;function g(...I){return u[6](u[9],u[14],u[15],...I)}s=new Ma({props:{selectedDuration:u[9].selectedDuration,onDurationChange:g,minDuration:u[9].minDuration,maxDuration:u[9].maxDuration}});function y(){return u[7](u[9])}return{c(){n=X("div"),Pt(s.$$.fragment),o=pe(),c=X("button"),c.textContent=l,this.h()},l(I){n=W(I,"DIV",{class:!0});var p=se(n);Ot(s.$$.fragment,p),o=he(p),c=W(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(c)!=="svelte-egxc4d"&&(c.textContent=l),p.forEach(A),this.h()},h(){N(c,"class","btn variant-filled w-full"),N(n,"class","space-y-6 mt-8")},m(I,p){te(I,n,p),It(s,n,null),R(n,o),R(n,c),d=!0,_||(j=pt(c,"click",y),_=!0)},p(I,p){u=I;const K={};p&8&&(K.selectedDuration=u[9].selectedDuration),p&8&&(K.onDurationChange=g),p&8&&(K.minDuration=u[9].minDuration),p&8&&(K.maxDuration=u[9].maxDuration),s.$set(K)},i(I){d||(Te(s.$$.fragment,I),d=!0)},o(I){je(s.$$.fragment,I),d=!1},d(I){I&&A(n),St(s),_=!1,j()}}}function Zi(u){let n,s,o,c,l=u[9].name+"",d,_,j,g,y,I=u[9].description+"",p,K,F,ue,ce,z,$,H,J,ve=!u[10]&&Gi(),ie=u[12]!==void 0&&u[10]&&Wi(u),Z=u[13]&&u[10]&&Qi(u),ne=u[11]&&u[10]&&$i(u);const Oe=[Fa,qa],Se=[];function Ee(fe,le){return fe[10]?0:1}return ce=Ee(u),z=Se[ce]=Oe[ce](u),{c(){n=X("div"),s=X("div"),o=X("h3"),ve&&ve.c(),c=pe(),d=ae(l),_=pe(),ie&&ie.c(),j=pe(),g=X("div"),y=X("p"),p=ae(I),K=pe(),Z&&Z.c(),F=pe(),ne&&ne.c(),ue=pe(),z.c(),$=pe(),this.h()},l(fe){n=W(fe,"DIV",{class:!0});var le=se(n);s=W(le,"DIV",{class:!0});var He=se(s);o=W(He,"H3",{class:!0});var Je=se(o);ve&&ve.l(Je),c=he(Je),d=oe(Je,l),Je.forEach(A),_=he(He),ie&&ie.l(He),He.forEach(A),j=he(le),g=W(le,"DIV",{class:!0});var ge=se(g);y=W(ge,"P",{class:!0});var Ke=se(y);p=oe(Ke,I),Ke.forEach(A),K=he(ge),Z&&Z.l(ge),ge.forEach(A),F=he(le),ne&&ne.l(le),ue=he(le),z.l(le),$=he(le),le.forEach(A),this.h()},h(){N(o,"class","text-lg font-bold"),N(s,"class","flex justify-between items-center mb-2"),N(y,"class","text-sm text-muted-foreground mb-2"),N(g,"class","mb-2"),N(n,"class",H="card bg-[#ffffffa6] p-8 "+(u[10]?"":"opacity-60"))},m(fe,le){te(fe,n,le),R(n,s),R(s,o),ve&&ve.m(o,null),R(o,c),R(o,d),R(s,_),ie&&ie.m(s,null),R(n,j),R(n,g),R(g,y),R(y,p),R(g,K),Z&&Z.m(g,null),R(n,F),ne&&ne.m(n,null),R(n,ue),Se[ce].m(n,null),R(n,$),J=!0},p(fe,le){fe[10]?ve&&(ve.d(1),ve=null):ve||(ve=Gi(),ve.c(),ve.m(o,c)),(!J||le&8)&&l!==(l=fe[9].name+"")&&Be(d,l),fe[12]!==void 0&&fe[10]?ie?ie.p(fe,le):(ie=Wi(fe),ie.c(),ie.m(s,null)):ie&&(ie.d(1),ie=null),(!J||le&8)&&I!==(I=fe[9].description+"")&&Be(p,I),fe[13]&&fe[10]?Z?Z.p(fe,le):(Z=Qi(fe),Z.c(),Z.m(g,null)):Z&&(Z.d(1),Z=null),fe[11]&&fe[10]?ne?ne.p(fe,le):(ne=$i(fe),ne.c(),ne.m(n,ue)):ne&&(ne.d(1),ne=null);let He=ce;ce=Ee(fe),ce===He?Se[ce].p(fe,le):(kt(),je(Se[He],1,1,()=>{Se[He]=null}),xt(),z=Se[ce],z?z.p(fe,le):(z=Se[ce]=Oe[ce](fe),z.c()),Te(z,1),z.m(n,$)),(!J||le&8&&H!==(H="card bg-[#ffffffa6] p-8 "+(fe[10]?"":"opacity-60")))&&N(n,"class",H)},i(fe){J||(Te(z),J=!0)},o(fe){je(z),J=!1},d(fe){fe&&A(n),ve&&ve.d(),ie&&ie.d(),Z&&Z.d(),ne&&ne.d(),Se[ce].d()}}}function La(u){let n,s,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',c,l,d,_,j,g=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org â</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn â</a></p>`,y,I,p,K;const F=[Aa,Ra],ue=[];function ce(H,J){return H[4]?0:1}l=ce(u),d=ue[l]=F[l](u);function z(H){u[8](H)}let $={duration:u[1],levelId:u[2]};return u[0]!==void 0&&($.show=u[0]),I=new Da({props:$}),qr.push(()=>Lr(I,"show",z)),{c(){n=X("div"),s=X("div"),s.innerHTML=o,c=pe(),d.c(),_=pe(),j=X("div"),j.innerHTML=g,y=pe(),Pt(I.$$.fragment),this.h()},l(H){n=W(H,"DIV",{class:!0});var J=se(n);s=W(J,"DIV",{class:!0,"data-svelte-h":!0}),Ne(s)!=="svelte-50yq01"&&(s.innerHTML=o),c=he(J),d.l(J),_=he(J),j=W(J,"DIV",{class:!0,"data-svelte-h":!0}),Ne(j)!=="svelte-dgw8za"&&(j.innerHTML=g),J.forEach(A),y=he(H),Ot(I.$$.fragment,H),this.h()},h(){N(s,"class","space-y-6 text-center mt-10 mb-8"),N(j,"class","text-center text-sm text-gray-500 mt-40"),N(n,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(H,J){te(H,n,J),R(n,s),R(n,c),ue[l].m(n,null),R(n,_),R(n,j),te(H,y,J),It(I,H,J),K=!0},p(H,[J]){let ve=l;l=ce(H),l===ve?ue[l].p(H,J):(kt(),je(ue[ve],1,1,()=>{ue[ve]=null}),xt(),d=ue[l],d?d.p(H,J):(d=ue[l]=F[l](H),d.c()),Te(d,1),d.m(n,_));const ie={};J&2&&(ie.duration=H[1]),J&4&&(ie.levelId=H[2]),!p&&J&1&&(p=!0,ie.show=H[0],Fr(()=>p=!1)),I.$set(ie)},i(H){K||(Te(d),Te(I.$$.fragment,H),K=!0)},o(H){je(d),je(I.$$.fragment,H),K=!1},d(H){H&&(A(n),A(y)),ue[l].d(),St(I,H)}}}function Ua(u,n,s){let o=!1,c=Ye.ONE_MINUTE,l=null,d=[],_=!0;const j=()=>{window.audioContext||(window.audioContext=new(window.AudioContext||window.webkitAudioContext)),s(0,o=!0)},g=(p,K,F,ue)=>s(3,K[F].level.selectedDuration=ue,d),y=p=>{s(2,l=p.id),s(1,c=p.selectedDuration??p.minDuration),j()};function I(p){o=p,s(0,o)}return u.$$.update=()=>{u.$$.dirty&1&&(o||(s(4,_=!0),ma().then(p=>{s(3,d=p),p.forEach(({level:K})=>{K.selectedDuration=K.minDuration}),s(4,_=!1)}).catch(p=>{console.error("Failed to reload level statuses:",p),s(4,_=!1)})))},[o,c,l,d,_,j,g,y,I]}class is extends Et{constructor(n){super(),Ct(this,n,Ua,La,Tt,{})}}export{is as component};
