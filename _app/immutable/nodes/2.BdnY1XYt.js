var Uo=Object.defineProperty;var Vo=(u,r,a)=>r in u?Uo(u,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[r]=a;var Si=(u,r,a)=>Vo(u,typeof r!="symbol"?r+"":r,a);import{B as Yo,s as gt,n as Fe,d as R,Z as Bt,r as qr,a as Oe,i as te,b as K,U as lt,m as Ho,w as N,x as yt,c as G,e as ue,f as Q,g as ye,h as W,t as J,j as _e,q as Fr,_ as zo,$ as Go,a0 as Un,a1 as Vn,a2 as io,k as Wn,a3 as Wo,y as Lr,C as _t,a4 as Ur,a5 as qe,P as Nt,o as $n,a6 as Ii,a7 as $o}from"../chunks/Bem1OcWY.js";import{S as bt,i as wt,f as Vr,d as kt,t as Ye,h as We,a as Ne,m as xt,e as Tt,b as Et,g as fn,c as dn}from"../chunks/BqmXtoC9.js";import{p as je}from"../chunks/CmP4wuhm.js";import{b as Xo,d as Ci,w as Gn}from"../chunks/DfXhuIyQ.js";function Qe(u){return(u==null?void 0:u.length)!==void 0?u:Array.from(u)}function $e(u,{delay:r=0,duration:a=400,easing:o=Yo}={}){const c=+getComputedStyle(u).opacity;return{delay:r,duration:a,easing:o,css:l=>`opacity: ${l*c}`}}var Be=(u=>(u[u.ONE_MINUTE=60]="ONE_MINUTE",u[u.TWO_MINUTES=120]="TWO_MINUTES",u[u.FIVE_MINUTES=300]="FIVE_MINUTES",u[u.TEN_MINUTES=600]="TEN_MINUTES",u[u.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",u[u.THIRTY_MINUTES=1800]="THIRTY_MINUTES",u[u.SIXTY_MINUTES=3600]="SIXTY_MINUTES",u))(Be||{});const Mr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qo(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var oo={exports:{}};(function(u,r){(function(a,o){u.exports=o()})(Oi,function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function c(e,t,n){for(var i,s=0,f=t.length;s<f;s++)!i&&s in t||((i=i||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Oi,d=Object.keys,p=Array.isArray;function _(e,t){return typeof t!="object"||d(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var x=Object.getPrototypeOf,C={}.hasOwnProperty;function O(e,t){return C.call(e,t)}function y(e,t){typeof t=="function"&&(t=t(x(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(n){Z(e,n,t[n])})}var M=Object.defineProperty;function Z(e,t,n,i){M(e,t,_(n&&O(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function ce(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Z(e.prototype,"constructor",e),{extend:y.bind(null,e.prototype)}}}}var $=Object.getOwnPropertyDescriptor,F=[].slice;function oe(e,t,n){return F.call(e,t,n)}function z(e,t){return t(e)}function ee(e){if(!e)throw new Error("Assertion Failed")}function de(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function re(e,t){if(typeof t=="string"&&O(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],i=0,s=t.length;i<s;++i){var f=re(e,t[i]);n.push(f)}return n}var h=t.indexOf(".");if(h!==-1){var m=e[t.substr(0,h)];return m==null?void 0:re(m,t.substr(h+1))}}function ne(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){ee(typeof n!="string"&&"length"in n);for(var i=0,s=t.length;i<s;++i)ne(e,t[i],n[i])}else{var f,h,m=t.indexOf(".");m!==-1?(f=t.substr(0,m),(h=t.substr(m+1))===""?n===void 0?p(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=n:ne(m=!(m=e[f])||!O(e,f)?e[f]={}:m,h,n)):n===void 0?p(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function ie(e){var t,n={};for(t in e)O(e,t)&&(n[t]=e[t]);return n}var Pe=[].concat;function ve(e){return Pe.apply([],e)}var It="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ve([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),Le=new Set(It.map(function(e){return l[e]})),se=null;function Te(e){return se=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var i=se.get(n);if(i)return i;if(p(n)){i=[],se.set(n,i);for(var s=0,f=n.length;s<f;++s)i.push(t(n[s]))}else if(Le.has(n.constructor))i=n;else{var h,m=x(n);for(h in i=m===Object.prototype?{}:Object.create(m),se.set(n,i),n)O(n,h)&&(i[h]=t(n[h]))}return i}(e),se=null,e}var Me={}.toString;function Ae(e){return Me.call(e).slice(8,-1)}var he=typeof Symbol<"u"?Symbol.iterator:"@@iterator",we=typeof he=="symbol"?function(e){var t;return e!=null&&(t=e[he])&&t.apply(e)}:function(){return null};function fe(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var ke={};function Se(e){var t,n,i,s;if(arguments.length===1){if(p(e))return e.slice();if(this===ke&&typeof e=="string")return[e];if(s=we(e)){for(n=[];!(i=s.next()).done;)n.push(i.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var at=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},$t=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],et=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat($t),hn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function tt(e,t){this.name=e,this.message=t}function Hr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,i,s){return s.indexOf(n)===i}).join(`
`)}function pn(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=Hr(e,t)}function qt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Hr(e,this.failures)}ce(tt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ce(pn).from(tt),ce(qt).from(tt);var Zn=et.reduce(function(e,t){return e[t]=t+"Error",e},{}),co=tt,le=et.reduce(function(e,t){var n=t+"Error";function i(s,f){this.name=n,s?typeof s=="string"?(this.message="".concat(s).concat(f?`
 `+f:""),this.inner=f||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=hn[t]||n,this.inner=null)}return ce(i).from(co),e[t]=i,e},{});le.Syntax=SyntaxError,le.Type=TypeError,le.Range=RangeError;var zr=$t.reduce(function(e,t){return e[t+"Error"]=le[t],e},{}),mn=et.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=le[t]),e},{});function Ie(){}function Gt(e){return e}function fo(e,t){return e==null||e===Gt?t:function(n){return t(e(n))}}function St(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ho(e,t){return e===Ie?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var f=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?St(i,this.onsuccess):i),s&&(this.onerror=this.onerror?St(s,this.onerror):s),f!==void 0?f:n}}function po(e,t){return e===Ie?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?St(n,this.onsuccess):n),i&&(this.onerror=this.onerror?St(i,this.onerror):i)}}function mo(e,t){return e===Ie?t:function(n){var i=e.apply(this,arguments);_(n,i);var s=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?St(s,this.onsuccess):s),f&&(this.onerror=this.onerror?St(f,this.onerror):f),i===void 0?n===void 0?void 0:n:_(i,n)}}function vo(e,t){return e===Ie?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function er(e,t){return e===Ie?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,s=arguments.length,f=new Array(s);s--;)f[s]=arguments[s];return n.then(function(){return t.apply(i,f)})}return t.apply(this,arguments)}}mn.ModifyError=pn,mn.DexieError=tt,mn.BulkError=qt;var nt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Gr(e){nt=e}var Wt={},Wr=100,It=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,x(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,x(t),e]}(),$t=It[0],et=It[1],It=It[2],et=et&&et.then,Ct=$t&&$t.constructor,tr=!!It,Xt=function(e,t){Qt.push([e,t]),vn&&(queueMicrotask(_o),vn=!1)},nr=!0,vn=!0,Ot=[],yn=[],rr=Gt,ct={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ie,pgp:!1,env:{},finalize:Ie},ae=ct,Qt=[],Pt=0,_n=[];function H(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ae;if(typeof e!="function"){if(e!==Wt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&or(this,this._value))}this._state=null,this._value=null,++t.ref,function n(i,s){try{s(function(f){if(i._state===null){if(f===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Ft();f&&typeof f.then=="function"?n(i,function(m,g){f instanceof H?f._then(m,g):f.then(m,g)}):(i._state=!0,i._value=f,Xr(i)),h&&Lt()}},or.bind(null,i))}catch(f){or(i,f)}}(this,e)}var ir={get:function(){var e=ae,t=kn;function n(i,s){var f=this,h=!e.global&&(e!==ae||t!==kn),m=h&&!dt(),g=new H(function(w,E){ar(f,new $r(Jr(i,e,h,m),Jr(s,e,h,m),w,E,e))});return this._consoleTask&&(g._consoleTask=this._consoleTask),g}return n.prototype=Wt,n},set:function(e){Z(this,"then",e&&e.prototype===Wt?ir:{get:function(){return e},set:ir.set})}};function $r(e,t,n,i,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=i,this.psd=s}function or(e,t){var n,i;yn.push(t),e._state===null&&(n=e._lib&&Ft(),t=rr(t),e._state=!1,e._value=t,i=e,Ot.some(function(s){return s._value===i._value})||Ot.push(i),Xr(e),n&&Lt())}function Xr(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)ar(e,t[n]);var s=e._PSD;--s.ref||s.finalize(),Pt===0&&(++Pt,Xt(function(){--Pt==0&&sr()},[]))}function ar(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Pt,Xt(yo,[n,e,t])}else e._listeners.push(t)}function yo(e,t,n){try{var i,s=t._value;!t._state&&yn.length&&(yn=[]),i=nt&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),t._state||yn.indexOf(s)!==-1||function(f){for(var h=Ot.length;h;)if(Ot[--h]._value===f._value)return Ot.splice(h,1)}(t),n.resolve(i)}catch(f){n.reject(f)}finally{--Pt==0&&sr(),--n.psd.ref||n.psd.finalize()}}function _o(){Dt(ct,function(){Ft()&&Lt()})}function Ft(){var e=nr;return vn=nr=!1,e}function Lt(){var e,t,n;do for(;0<Qt.length;)for(e=Qt,Qt=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}while(0<Qt.length);vn=nr=!0}function sr(){var e=Ot;Ot=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=_n.slice(0),n=t.length;n;)t[--n]()}function gn(e){return new H(Wt,!1,e)}function De(e,t){var n=ae;return function(){var i=Ft(),s=ae;try{return ht(n,!0),e.apply(this,arguments)}catch(f){t&&t(f)}finally{ht(s,!1),i&&Lt()}}}y(H.prototype,{then:ir,_then:function(e,t){ar(this,new $r(null,null,e,t,ae))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?n:gn)(i)}):this.then(null,function(i){return(i&&i.name===t?n:gn)(i)})},finally:function(e){return this.then(function(t){return H.resolve(e()).then(function(){return t})},function(t){return H.resolve(e()).then(function(){return gn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new H(function(i,s){var f=setTimeout(function(){return s(new le.Timeout(t))},e);n.then(i,s).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Z(H.prototype,Symbol.toStringTag,"Dexie.Promise"),ct.env=Qr(),y(H,{all:function(){var e=Se.apply(null,arguments).map(xn);return new H(function(t,n){e.length===0&&t([]);var i=e.length;e.forEach(function(s,f){return H.resolve(s).then(function(h){e[f]=h,--i||t(e)},n)})})},resolve:function(e){return e instanceof H?e:e&&typeof e.then=="function"?new H(function(t,n){e.then(t,n)}):new H(Wt,!0,e)},reject:gn,race:function(){var e=Se.apply(null,arguments).map(xn);return new H(function(t,n){e.map(function(i){return H.resolve(i).then(t,n)})})},PSD:{get:function(){return ae},set:function(e){return ae=e}},totalEchoes:{get:function(){return kn}},newPSD:ft,usePSD:Dt,scheduler:{get:function(){return Xt},set:function(e){Xt=e}},rejectionMapper:{get:function(){return rr},set:function(e){rr=e}},follow:function(e,t){return new H(function(n,i){return ft(function(s,f){var h=ae;h.unhandleds=[],h.onunhandled=f,h.finalize=St(function(){var m,g=this;m=function(){g.unhandleds.length===0?s():f(g.unhandleds[0])},_n.push(function w(){m(),_n.splice(_n.indexOf(w),1)}),++Pt,Xt(function(){--Pt==0&&sr()},[])},h.finalize),e()},t,n,i)})}}),Ct&&(Ct.allSettled&&Z(H,"allSettled",function(){var e=Se.apply(null,arguments).map(xn);return new H(function(t){e.length===0&&t([]);var n=e.length,i=new Array(n);e.forEach(function(s,f){return H.resolve(s).then(function(h){return i[f]={status:"fulfilled",value:h}},function(h){return i[f]={status:"rejected",reason:h}}).then(function(){return--n||t(i)})})})}),Ct.any&&typeof AggregateError<"u"&&Z(H,"any",function(){var e=Se.apply(null,arguments).map(xn);return new H(function(t,n){e.length===0&&n(new AggregateError([]));var i=e.length,s=new Array(i);e.forEach(function(f,h){return H.resolve(f).then(function(m){return t(m)},function(m){s[h]=m,--i||n(new AggregateError(s))})})})}),Ct.withResolvers&&(H.withResolvers=Ct.withResolvers));var Ue={awaits:0,echoes:0,id:0},go=0,bn=[],wn=0,kn=0,bo=0;function ft(e,t,n,i){var s=ae,f=Object.create(s);return f.parent=s,f.ref=0,f.global=!1,f.id=++bo,ct.env,f.env=tr?{Promise:H,PromiseProp:{value:H,configurable:!0,writable:!0},all:H.all,race:H.race,allSettled:H.allSettled,any:H.any,resolve:H.resolve,reject:H.reject}:{},t&&_(f,t),++s.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Dt(f,e,n,i),f.ref===0&&f.finalize(),i}function Ut(){return Ue.id||(Ue.id=++go),++Ue.awaits,Ue.echoes+=Wr,Ue.id}function dt(){return!!Ue.awaits&&(--Ue.awaits==0&&(Ue.id=0),Ue.echoes=Ue.awaits*Wr,!0)}function xn(e){return Ue.echoes&&e&&e.constructor===Ct?(Ut(),e.then(function(t){return dt(),t},function(t){return dt(),Ke(t)})):e}function wo(){var e=bn[bn.length-1];bn.pop(),ht(e,!1)}function ht(e,t){var n,i=ae;(t?!Ue.echoes||wn++&&e===ae:!wn||--wn&&e===ae)||queueMicrotask(t?(function(s){++kn,Ue.echoes&&--Ue.echoes!=0||(Ue.echoes=Ue.awaits=Ue.id=0),bn.push(ae),ht(s,!0)}).bind(null,e):wo),e!==ae&&(ae=e,i===ct&&(ct.env=Qr()),tr&&(n=ct.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(l,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Qr(){var e=l.Promise;return tr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Dt(e,t,n,i,s){var f=ae;try{return ht(e,!0),t(n,i,s)}finally{ht(f,!1)}}function Jr(e,t,n,i){return typeof e!="function"?e:function(){var s=ae;n&&Ut(),ht(t,!0);try{return e.apply(this,arguments)}finally{ht(s,!1),i&&queueMicrotask(dt)}}}function ur(e){Promise===Ct&&Ue.echoes===0?wn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+et).indexOf("[native code]")===-1&&(Ut=dt=Ie);var Ke=H.reject,At="ï¿¿",st="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Zr="String expected.",Vt=[],Tn="__dbnames",lr="readonly",cr="readwrite";function jt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ei={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function En(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Te(t))[e],t}}function ti(){throw le.Type()}function xe(e,t){try{var n=ni(e),i=ni(t);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(s,f){for(var h=s.length,m=f.length,g=h<m?h:m,w=0;w<g;++w)if(s[w]!==f[w])return s[w]<f[w]?-1:1;return h===m?0:h<m?-1:1}(ri(e),ri(t));case"Array":return function(s,f){for(var h=s.length,m=f.length,g=h<m?h:m,w=0;w<g;++w){var E=xe(s[w],f[w]);if(E!==0)return E}return h===m?0:h<m?-1:1}(e,t)}}catch{}return NaN}function ni(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Ae(e),e==="ArrayBuffer"?"binary":e)}function ri(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ii=(Ce.prototype._trans=function(e,t,n){var i=this._tx||ae.trans,s=this.name,f=nt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(w,E,v){if(!v.schema[s])throw new le.NotFound("Table "+s+" not part of transaction");return t(v.idbtrans,v)}var m=Ft();try{var g=i&&i.db._novip===this.db._novip?i===ae.trans?i._promise(e,h,n):ft(function(){return i._promise(e,h,n)},{trans:i,transless:ae.transless||ae}):function w(E,v,I,b){if(E.idbdb&&(E._state.openComplete||ae.letThrough||E._vip)){var T=E._createTransaction(v,I,E._dbSchema);try{T.create(),E._state.PR1398_maxLoop=3}catch(S){return S.name===Zn.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return w(E,v,I,b)})):Ke(S)}return T._promise(v,function(S,k){return ft(function(){return ae.trans=T,b(S,k,T)})}).then(function(S){if(v==="readwrite")try{T.idbtrans.commit()}catch{}return v==="readonly"?S:T._completion.then(function(){return S})})}if(E._state.openComplete)return Ke(new le.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return Ke(new le.DatabaseClosed);E.open().catch(Ie)}return E._state.dbReadyPromise.then(function(){return w(E,v,I,b)})}(this.db,e,[this.name],h);return f&&(g._consoleTask=f,g=g.catch(function(w){return console.trace(w),Ke(w)})),g}finally{m&&Lt()}},Ce.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Ke(new le.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return n.core.get({trans:i,key:e}).then(function(s){return n.hook.reading.fire(s)})}).then(t)},Ce.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(p(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&t.every(function(w){return 0<=m.keyPath.indexOf(w)})){for(var g=0;g<t.length;++g)if(t.indexOf(m.keyPath[g])===-1)return!1;return!0}return!1}).sort(function(m,g){return m.keyPath.length-g.keyPath.length})[0];if(n&&this.db._maxKey!==At){var f=n.keyPath.slice(0,t.length);return this.where(f).equals(f.map(function(g){return e[g]}))}!n&&nt&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function s(m,g){return xe(m,g)===0}var h=t.reduce(function(v,g){var w=v[0],E=v[1],v=i[g],I=e[g];return[w||v,w||!v?jt(E,v&&v.multi?function(b){return b=re(b,g),p(b)&&b.some(function(T){return s(I,T)})}:function(b){return s(I,re(b,g))}):E]},[null,null]),f=h[0],h=h[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(h):n?this.filter(h):this.where(t).equals("")},Ce.prototype.filter=function(e){return this.toCollection().and(e)},Ce.prototype.count=function(e){return this.toCollection().count(e)},Ce.prototype.offset=function(e){return this.toCollection().offset(e)},Ce.prototype.limit=function(e){return this.toCollection().limit(e)},Ce.prototype.each=function(e){return this.toCollection().each(e)},Ce.prototype.toArray=function(e){return this.toCollection().toArray(e)},Ce.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ce.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,p(e)?"[".concat(e.join("+"),"]"):e))},Ce.prototype.reverse=function(){return this.toCollection().reverse()},Ce.prototype.mapToClass=function(e){var t,n=this.db,i=this.name;function s(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ti&&(function(g,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function E(){this.constructor=g}a(g,w),g.prototype=w===null?Object.create(w):(E.prototype=w.prototype,new E)}(s,t=e),Object.defineProperty(s.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),s.prototype.table=function(){return i},e=s);for(var f=new Set,h=e.prototype;h;h=x(h))Object.getOwnPropertyNames(h).forEach(function(g){return f.add(g)});function m(g){if(!g)return g;var w,E=Object.create(e.prototype);for(w in g)if(!f.has(w))try{E[w]=g[w]}catch{}return E}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),e},Ce.prototype.defineClass=function(){return this.mapToClass(function(e){_(this,e)})},Ce.prototype.add=function(e,t){var n=this,i=this.schema.primKey,s=i.auto,f=i.keyPath,h=e;return f&&s&&(h=En(f)(e)),this._trans("readwrite",function(m){return n.core.mutate({trans:m,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(m){return m.numFailures?H.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{ne(e,f,m)}catch{}return m})},Ce.prototype.update=function(e,t){return typeof e!="object"||p(e)?this.where(":id").equals(e).modify(t):(e=re(e,this.schema.primKey.keyPath),e===void 0?Ke(new le.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Ce.prototype.put=function(e,t){var n=this,i=this.schema.primKey,s=i.auto,f=i.keyPath,h=e;return f&&s&&(h=En(f)(e)),this._trans("readwrite",function(m){return n.core.mutate({trans:m,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(m){return m.numFailures?H.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{ne(e,f,m)}catch{}return m})},Ce.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?H.reject(n.failures[0]):void 0})},Ce.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:ei})}).then(function(t){return t.numFailures?H.reject(t.failures[0]):void 0})},Ce.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(i){return i.map(function(s){return t.hook.reading.fire(s)})})})},Ce.prototype.bulkAdd=function(e,t,n){var i=this,s=Array.isArray(t)?t:void 0,f=(n=n||(s?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var w=i.schema.primKey,m=w.auto,w=w.keyPath;if(w&&s)throw new le.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new le.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,w=w&&m?e.map(En(w)):e;return i.core.mutate({trans:h,type:"add",keys:s,values:w,wantResults:f}).then(function(T){var v=T.numFailures,I=T.results,b=T.lastResult,T=T.failures;if(v===0)return f?I:b;throw new qt("".concat(i.name,".bulkAdd(): ").concat(v," of ").concat(g," operations failed"),T)})})},Ce.prototype.bulkPut=function(e,t,n){var i=this,s=Array.isArray(t)?t:void 0,f=(n=n||(s?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var w=i.schema.primKey,m=w.auto,w=w.keyPath;if(w&&s)throw new le.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new le.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,w=w&&m?e.map(En(w)):e;return i.core.mutate({trans:h,type:"put",keys:s,values:w,wantResults:f}).then(function(T){var v=T.numFailures,I=T.results,b=T.lastResult,T=T.failures;if(v===0)return f?I:b;throw new qt("".concat(i.name,".bulkPut(): ").concat(v," of ").concat(g," operations failed"),T)})})},Ce.prototype.bulkUpdate=function(e){var t=this,n=this.core,i=e.map(function(h){return h.key}),s=e.map(function(h){return h.changes}),f=[];return this._trans("readwrite",function(h){return n.getMany({trans:h,keys:i,cache:"clone"}).then(function(m){var g=[],w=[];e.forEach(function(v,I){var b=v.key,T=v.changes,S=m[I];if(S){for(var k=0,P=Object.keys(T);k<P.length;k++){var D=P[k],A=T[D];if(D===t.schema.primKey.keyPath){if(xe(A,b)!==0)throw new le.Constraint("Cannot update primary key in bulkUpdate()")}else ne(S,D,A)}f.push(I),g.push(b),w.push(S)}});var E=g.length;return n.mutate({trans:h,type:"put",keys:g,values:w,updates:{keys:i,changeSpecs:s}}).then(function(v){var I=v.numFailures,b=v.failures;if(I===0)return E;for(var T=0,S=Object.keys(b);T<S.length;T++){var k,P=S[T],D=f[Number(P)];D!=null&&(k=b[P],delete b[P],b[D]=k)}throw new qt("".concat(t.name,".bulkUpdate(): ").concat(I," of ").concat(E," operations failed"),b)})})})},Ce.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var s=h.numFailures,f=h.lastResult,h=h.failures;if(s===0)return f;throw new qt("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(n," operations failed"),h)})},Ce);function Ce(){}function Jt(e){function t(h,m){if(m){for(var g=arguments.length,w=new Array(g-1);--g;)w[g-1]=arguments[g];return n[h].subscribe.apply(null,w),e}if(typeof h=="string")return n[h]}var n={};t.addEventType=f;for(var i=1,s=arguments.length;i<s;++i)f(arguments[i]);return t;function f(h,m,g){if(typeof h!="object"){var w;m=m||vo;var E={subscribers:[],fire:g=g||Ie,subscribe:function(v){E.subscribers.indexOf(v)===-1&&(E.subscribers.push(v),E.fire=m(E.fire,v))},unsubscribe:function(v){E.subscribers=E.subscribers.filter(function(I){return I!==v}),E.fire=E.subscribers.reduce(m,g)}};return n[h]=t[h]=E}d(w=h).forEach(function(v){var I=w[v];if(p(I))f(v,w[v][0],w[v][1]);else{if(I!=="asap")throw new le.InvalidArgument("Invalid event config");var b=f(v,Gt,function(){for(var T=arguments.length,S=new Array(T);T--;)S[T]=arguments[T];b.subscribers.forEach(function(k){de(function(){k.apply(null,S)})})})}})}}function Zt(e,t){return ce(t).from({prototype:e}),t}function Yt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function fr(e,t){e.filter=jt(e.filter,t)}function dr(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return jt(i(),t())}:t,e.justLimit=n&&!i}function Sn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new le.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function oi(e,t,n){var i=Sn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function In(e,t,n,i){var s=e.replayFilter?jt(e.filter,e.replayFilter()):e.filter;if(e.or){var f={},h=function(m,g,w){var E,v;s&&!s(g,w,function(I){return g.stop(I)},function(I){return g.fail(I)})||((v=""+(E=g.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(E)),O(f,v)||(f[v]=!0,t(m,g,w)))};return Promise.all([e.or._iterate(h,n),ai(oi(e,i,n),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ai(oi(e,i,n),jt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function ai(e,t,n,i){var s=De(i?function(f,h,m){return n(i(f),h,m)}:n);return e.then(function(f){if(f)return f.start(function(){var h=function(){return f.continue()};t&&!t(f,function(m){return h=m},function(m){f.stop(m),h=Ie},function(m){f.fail(m),h=Ie})||s(f.value,f,function(m){return h=m}),h()})})}var en=(si.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(p(n))return c(c([],p(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var i=t.remove;if(p(i))return p(e)?e.filter(function(s){return!i.includes(s)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},si);function si(e){this["@@propmod"]=e}var ko=(Ee.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Ke.bind(null,n.error)):n.table._trans("readonly",e).then(t)},Ee.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ke.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Ee.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=jt(t.algorithm,e)},Ee.prototype._iterate=function(e,t){return In(this._ctx,e,t,this._ctx.table.core)},Ee.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&_(n,e),t._ctx=n,t},Ee.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ee.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return In(t,e,n,t.table.core)})},Ee.prototype.count=function(e){var t=this;return this._read(function(n){var i=t._ctx,s=i.table.core;if(Yt(i,!0))return s.count({trans:n,query:{index:Sn(i,s.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var f=0;return In(i,function(){return++f,!1},n,s).then(function(){return f})}).then(e)},Ee.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],s=n.length-1;function f(g,w){return w?f(g[n[w]],w-1):g[i]}var h=this._ctx.dir==="next"?1:-1;function m(g,w){return xe(f(g,s),f(w,s))*h}return this.toArray(function(g){return g.sort(m)}).then(t)},Ee.prototype.toArray=function(e){var t=this;return this._read(function(n){var i=t._ctx;if(i.dir==="next"&&Yt(i,!0)&&0<i.limit){var s=i.valueMapper,f=Sn(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:f,range:i.range}}).then(function(m){return m=m.result,s?m.map(s):m})}var h=[];return In(i,function(m){return h.push(m)},n,i.table.core).then(function(){return h})},e)},Ee.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Yt(t)?dr(t,function(){var n=e;return function(i,s){return n===0||(n===1?--n:s(function(){i.advance(n),n=0}),!1)}}):dr(t,function(){var n=e;return function(){return--n<0}})),this},Ee.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),dr(this._ctx,function(){var t=e;return function(n,i,s){return--t<=0&&i(s),0<=t}},!0),this},Ee.prototype.until=function(e,t){return fr(this._ctx,function(n,i,s){return!e(n.value)||(i(s),t)}),this},Ee.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},Ee.prototype.last=function(e){return this.reverse().first(e)},Ee.prototype.filter=function(e){var t;return fr(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=jt(t.isMatch,e),this},Ee.prototype.and=function(e){return this.filter(e)},Ee.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Ee.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ee.prototype.desc=function(){return this.reverse()},Ee.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.key,i)})},Ee.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Ee.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.primaryKey,i)})},Ee.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,s){n.push(s.key)}).then(function(){return n}).then(e)},Ee.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Yt(t,!0)&&0<t.limit)return this._read(function(i){var s=Sn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,s){n.push(s.primaryKey)}).then(function(){return n}).then(e)},Ee.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Ee.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},Ee.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Ee.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return fr(this._ctx,function(s){var i=s.primaryKey.toString(),s=O(t,i);return t[i]=!0,!s}),this},Ee.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(i){var s,f,h;h=typeof e=="function"?e:(s=d(e),f=s.length,function(k){for(var P=!1,D=0;D<f;++D){var A=s[D],j=e[A],B=re(k,A);j instanceof en?(ne(k,A,j.execute(B)),P=!0):B!==j&&(ne(k,A,j),P=!0)}return P});var m=n.table.core,v=m.schema.primaryKey,g=v.outbound,w=v.extractKey,E=200,v=t.db._options.modifyChunkSize;v&&(E=typeof v=="object"?v[m.name]||v["*"]||200:v);function I(k,A){var D=A.failures,A=A.numFailures;T+=k-A;for(var j=0,B=d(D);j<B.length;j++){var V=B[j];b.push(D[V])}}var b=[],T=0,S=[];return t.clone().primaryKeys().then(function(k){function P(A){var j=Math.min(E,k.length-A);return m.getMany({trans:i,keys:k.slice(A,A+j),cache:"immutable"}).then(function(B){for(var V=[],q=[],L=g?[]:null,Y=[],U=0;U<j;++U){var X=B[U],me={value:Te(X),primKey:k[A+U]};h.call(me,me.value,me)!==!1&&(me.value==null?Y.push(k[A+U]):g||xe(w(X),w(me.value))===0?(q.push(me.value),g&&L.push(k[A+U])):(Y.push(k[A+U]),V.push(me.value)))}return Promise.resolve(0<V.length&&m.mutate({trans:i,type:"add",values:V}).then(function(ge){for(var be in ge.failures)Y.splice(parseInt(be),1);I(V.length,ge)})).then(function(){return(0<q.length||D&&typeof e=="object")&&m.mutate({trans:i,type:"put",keys:L,values:q,criteria:D,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<A}).then(function(ge){return I(q.length,ge)})}).then(function(){return(0<Y.length||D&&e===hr)&&m.mutate({trans:i,type:"delete",keys:Y,criteria:D,isAdditionalChunk:0<A}).then(function(ge){return I(Y.length,ge)})}).then(function(){return k.length>A+j&&P(A+E)})})}var D=Yt(n)&&n.limit===1/0&&(typeof e!="function"||e===hr)&&{index:n.index,range:n.range};return P(0).then(function(){if(0<b.length)throw new pn("Error modifying one or more objects",b,T,S);return k.length})})})},Ee.prototype.delete=function(){var e=this._ctx,t=e.range;return Yt(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var i=e.table.core.schema.primaryKey,s=t;return e.table.core.count({trans:n,query:{index:i,range:s}}).then(function(f){return e.table.core.mutate({trans:n,type:"deleteRange",range:s}).then(function(h){var m=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new pn("Could not delete some values",Object.keys(m).map(function(g){return m[g]}),f-h);return f-h})})}):this.modify(hr)},Ee);function Ee(){}var hr=function(e,t){return t.value=null};function xo(e,t){return e<t?-1:e===t?0:1}function To(e,t){return t<e?-1:e===t?0:1}function Je(e,t,n){return e=e instanceof li?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function Ht(e){return new e.Collection(e,function(){return ui("")}).limit(0)}function Cn(e,t,n,i){var s,f,h,m,g,w,E,v=n.length;if(!n.every(function(T){return typeof T=="string"}))return Je(e,Zr);function I(T){s=T==="next"?function(k){return k.toUpperCase()}:function(k){return k.toLowerCase()},f=T==="next"?function(k){return k.toLowerCase()}:function(k){return k.toUpperCase()},h=T==="next"?xo:To;var S=n.map(function(k){return{lower:f(k),upper:s(k)}}).sort(function(k,P){return h(k.lower,P.lower)});m=S.map(function(k){return k.upper}),g=S.map(function(k){return k.lower}),E=(w=T)==="next"?"":i}I("next"),e=new e.Collection(e,function(){return pt(m[0],g[v-1]+i)}),e._ondirectionchange=function(T){I(T)};var b=0;return e._addAlgorithm(function(T,S,k){var P=T.key;if(typeof P!="string")return!1;var D=f(P);if(t(D,g,b))return!0;for(var A=null,j=b;j<v;++j){var B=function(V,q,L,Y,U,X){for(var me=Math.min(V.length,Y.length),ge=-1,be=0;be<me;++be){var Ze=q[be];if(Ze!==Y[be])return U(V[be],L[be])<0?V.substr(0,be)+L[be]+L.substr(be+1):U(V[be],Y[be])<0?V.substr(0,be)+Y[be]+L.substr(be+1):0<=ge?V.substr(0,ge)+q[ge]+L.substr(ge+1):null;U(V[be],Ze)<0&&(ge=be)}return me<Y.length&&X==="next"?V+L.substr(V.length):me<V.length&&X==="prev"?V.substr(0,L.length):ge<0?null:V.substr(0,ge)+Y[ge]+L.substr(ge+1)}(P,D,m[j],g[j],h,w);B===null&&A===null?b=j+1:(A===null||0<h(A,B))&&(A=B)}return S(A!==null?function(){T.continue(A+E)}:k),!1}),e}function pt(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function ui(e){return{type:1,lower:e,upper:e}}var li=(Object.defineProperty(Ve.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ve.prototype.between=function(e,t,n,i){n=n!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||i)&&(!n||!i)?Ht(this):new this.Collection(this,function(){return pt(e,t,!n,!i)})}catch{return Je(this,st)}},Ve.prototype.equals=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return ui(e)})},Ve.prototype.above=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return pt(e,void 0,!0)})},Ve.prototype.aboveOrEqual=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return pt(e,void 0,!1)})},Ve.prototype.below=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return pt(void 0,e,!1,!0)})},Ve.prototype.belowOrEqual=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return pt(void 0,e)})},Ve.prototype.startsWith=function(e){return typeof e!="string"?Je(this,Zr):this.between(e,e+At,!0,!0)},Ve.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Cn(this,function(t,n){return t.indexOf(n[0])===0},[e],At)},Ve.prototype.equalsIgnoreCase=function(e){return Cn(this,function(t,n){return t===n[0]},[e],"")},Ve.prototype.anyOfIgnoreCase=function(){var e=Se.apply(ke,arguments);return e.length===0?Ht(this):Cn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},Ve.prototype.startsWithAnyOfIgnoreCase=function(){var e=Se.apply(ke,arguments);return e.length===0?Ht(this):Cn(this,function(t,n){return n.some(function(i){return t.indexOf(i)===0})},e,At)},Ve.prototype.anyOf=function(){var e=this,t=Se.apply(ke,arguments),n=this._cmp;try{t.sort(n)}catch{return Je(this,st)}if(t.length===0)return Ht(this);var i=new this.Collection(this,function(){return pt(t[0],t[t.length-1])});i._ondirectionchange=function(f){n=f==="next"?e._ascending:e._descending,t.sort(n)};var s=0;return i._addAlgorithm(function(f,h,m){for(var g=f.key;0<n(g,t[s]);)if(++s===t.length)return h(m),!1;return n(g,t[s])===0||(h(function(){f.continue(t[s])}),!1)}),i},Ve.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ve.prototype.noneOf=function(){var e=Se.apply(ke,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Je(this,st)}var t=e.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ve.prototype.inAnyRange=function(P,t){var n=this,i=this._cmp,s=this._ascending,f=this._descending,h=this._min,m=this._max;if(P.length===0)return Ht(this);if(!P.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&s(D[0],D[1])<=0}))return Je(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",le.InvalidArgument);var g=!t||t.includeLowers!==!1,w=t&&t.includeUppers===!0,E,v=s;function I(D,A){return v(D[0],A[0])}try{(E=P.reduce(function(D,A){for(var j=0,B=D.length;j<B;++j){var V=D[j];if(i(A[0],V[1])<0&&0<i(A[1],V[0])){V[0]=h(V[0],A[0]),V[1]=m(V[1],A[1]);break}}return j===B&&D.push(A),D},[])).sort(I)}catch{return Je(this,st)}var b=0,T=w?function(D){return 0<s(D,E[b][1])}:function(D){return 0<=s(D,E[b][1])},S=g?function(D){return 0<f(D,E[b][0])}:function(D){return 0<=f(D,E[b][0])},k=T,P=new this.Collection(this,function(){return pt(E[0][0],E[E.length-1][1],!g,!w)});return P._ondirectionchange=function(D){v=D==="next"?(k=T,s):(k=S,f),E.sort(I)},P._addAlgorithm(function(D,A,j){for(var B,V=D.key;k(V);)if(++b===E.length)return A(j),!1;return!T(B=V)&&!S(B)||(n._cmp(V,E[b][1])===0||n._cmp(V,E[b][0])===0||A(function(){v===s?D.continue(E[b][0]):D.continue(E[b][1])}),!1)}),P},Ve.prototype.startsWithAnyOf=function(){var e=Se.apply(ke,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Ht(this):this.inAnyRange(e.map(function(t){return[t,t+At]})):Je(this,"startsWithAnyOf() only works with strings")},Ve);function Ve(){}function rt(e){return De(function(t){return tn(t),e(t.target.error),!1})}function tn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var nn="storagemutated",pr="x-storagemutated-1",mt=Jt(null,nn),Eo=(it.prototype._lock=function(){return ee(!ae.global),++this._reculock,this._reculock!==1||ae.global||(ae.lockOwnerFor=this),this},it.prototype._unlock=function(){if(ee(!ae.global),--this._reculock==0)for(ae.global||(ae.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Dt(e[1],e[0])}catch{}}return this},it.prototype._locked=function(){return this._reculock&&ae.lockOwnerFor!==this},it.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(ee(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new le.DatabaseClosed(i);case"MissingAPIError":throw new le.MissingAPI(i.message,i);default:throw new le.OpenFailed(i)}if(!this.active)throw new le.TransactionInactive;return ee(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=De(function(s){tn(s),t._reject(e.error)}),e.onabort=De(function(s){tn(s),t.active&&t._reject(new le.Abort(e.error)),t.active=!1,t.on("abort").fire(s)}),e.oncomplete=De(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&mt.storagemutated.fire(e.mutatedParts)}),this},it.prototype._promise=function(e,t,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return Ke(new le.ReadOnly("Transaction is readonly"));if(!this.active)return Ke(new le.TransactionInactive);if(this._locked())return new H(function(f,h){i._blockedFuncs.push([function(){i._promise(e,t,n).then(f,h)},ae])});if(n)return ft(function(){var f=new H(function(h,m){i._lock();var g=t(h,m,i);g&&g.then&&g.then(h,m)});return f.finally(function(){return i._unlock()}),f._lib=!0,f});var s=new H(function(f,h){var m=t(f,h,i);m&&m.then&&m.then(f,h)});return s._lib=!0,s},it.prototype._root=function(){return this.parent?this.parent._root():this},it.prototype.waitFor=function(e){var t,n=this._root(),i=H.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return i}):(n._waitingFor=i,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function f(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=f)}());var s=n._waitingFor;return new H(function(f,h){i.then(function(m){return n._waitingQueue.push(De(f.bind(null,m)))},function(m){return n._waitingQueue.push(De(h.bind(null,m)))}).finally(function(){n._waitingFor===s&&(n._waitingFor=null)})})},it.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new le.Abort))},it.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(O(t,e))return t[e];var n=this.schema[e];if(!n)throw new le.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},it);function it(){}function mr(e,t,n,i,s,f,h){return{name:e,keyPath:t,unique:n,multi:i,auto:s,compound:f,src:(n&&!h?"&":"")+(i?"*":"")+(s?"++":"")+ci(t)}}function ci(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function vr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(i=function(s){return[s.name,s]},n.reduce(function(s,f,h){return h=i(f,h),h&&(s[h[0]]=h[1]),s},{}))};var i}var rn=function(e){try{return e.only([[]]),rn=function(){return[[]]},[[]]}catch{return rn=function(){return At},At}};function yr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return re(n,t)}:function(n){return re(n,e)};var t}function fi(e){return[].slice.call(e)}var So=0;function on(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Io(e,t,g){function i(k){if(k.type===3)return null;if(k.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=k.lower,T=k.upper,S=k.lowerOpen,k=k.upperOpen;return b===void 0?T===void 0?null:t.upperBound(T,!!k):T===void 0?t.lowerBound(b,!!S):t.bound(b,T,!!S,!!k)}function s(I){var b,T=I.name;return{name:T,schema:I,mutate:function(S){var k=S.trans,P=S.type,D=S.keys,A=S.values,j=S.range;return new Promise(function(B,V){B=De(B);var q=k.objectStore(T),L=q.keyPath==null,Y=P==="put"||P==="add";if(!Y&&P!=="delete"&&P!=="deleteRange")throw new Error("Invalid operation type: "+P);var U,X=(D||A||{length:1}).length;if(D&&A&&D.length!==A.length)throw new Error("Given keys array must have same length as given values array.");if(X===0)return B({numFailures:0,failures:{},results:[],lastResult:void 0});function me(Xe){++Ze,tn(Xe)}var ge=[],be=[],Ze=0;if(P==="deleteRange"){if(j.type===4)return B({numFailures:Ze,failures:be,results:[],lastResult:void 0});j.type===3?ge.push(U=q.clear()):ge.push(U=q.delete(i(j)))}else{var L=Y?L?[A,D]:[A,null]:[D,null],pe=L[0],ze=L[1];if(Y)for(var Ge=0;Ge<X;++Ge)ge.push(U=ze&&ze[Ge]!==void 0?q[P](pe[Ge],ze[Ge]):q[P](pe[Ge])),U.onerror=me;else for(Ge=0;Ge<X;++Ge)ge.push(U=q[P](pe[Ge])),U.onerror=me}function Ln(Xe){Xe=Xe.target.result,ge.forEach(function(Mt,Rr){return Mt.error!=null&&(be[Rr]=Mt.error)}),B({numFailures:Ze,failures:be,results:P==="delete"?D:ge.map(function(Mt){return Mt.result}),lastResult:Xe})}U.onerror=function(Xe){me(Xe),Ln(Xe)},U.onsuccess=Ln})},getMany:function(S){var k=S.trans,P=S.keys;return new Promise(function(D,A){D=De(D);for(var j,B=k.objectStore(T),V=P.length,q=new Array(V),L=0,Y=0,U=function(ge){ge=ge.target,q[ge._pos]=ge.result,++Y===L&&D(q)},X=rt(A),me=0;me<V;++me)P[me]!=null&&((j=B.get(P[me]))._pos=me,j.onsuccess=U,j.onerror=X,++L);L===0&&D(q)})},get:function(S){var k=S.trans,P=S.key;return new Promise(function(D,A){D=De(D);var j=k.objectStore(T).get(P);j.onsuccess=function(B){return D(B.target.result)},j.onerror=rt(A)})},query:(b=w,function(S){return new Promise(function(k,P){k=De(k);var D,A,j,L=S.trans,B=S.values,V=S.limit,U=S.query,q=V===1/0?void 0:V,Y=U.index,U=U.range,L=L.objectStore(T),Y=Y.isPrimaryKey?L:L.index(Y.name),U=i(U);if(V===0)return k({result:[]});b?((q=B?Y.getAll(U,q):Y.getAllKeys(U,q)).onsuccess=function(X){return k({result:X.target.result})},q.onerror=rt(P)):(D=0,A=!B&&"openKeyCursor"in Y?Y.openKeyCursor(U):Y.openCursor(U),j=[],A.onsuccess=function(X){var me=A.result;return me?(j.push(B?me.value:me.primaryKey),++D===V?k({result:j}):void me.continue()):k({result:j})},A.onerror=rt(P))})}),openCursor:function(S){var k=S.trans,P=S.values,D=S.query,A=S.reverse,j=S.unique;return new Promise(function(B,V){B=De(B);var Y=D.index,q=D.range,L=k.objectStore(T),L=Y.isPrimaryKey?L:L.index(Y.name),Y=A?j?"prevunique":"prev":j?"nextunique":"next",U=!P&&"openKeyCursor"in L?L.openKeyCursor(i(q),Y):L.openCursor(i(q),Y);U.onerror=rt(V),U.onsuccess=De(function(X){var me,ge,be,Ze,pe=U.result;pe?(pe.___id=++So,pe.done=!1,me=pe.continue.bind(pe),ge=(ge=pe.continuePrimaryKey)&&ge.bind(pe),be=pe.advance.bind(pe),Ze=function(){throw new Error("Cursor not stopped")},pe.trans=k,pe.stop=pe.continue=pe.continuePrimaryKey=pe.advance=function(){throw new Error("Cursor not started")},pe.fail=De(V),pe.next=function(){var ze=this,Ge=1;return this.start(function(){return Ge--?ze.continue():ze.stop()}).then(function(){return ze})},pe.start=function(ze){function Ge(){if(U.result)try{ze()}catch(Xe){pe.fail(Xe)}else pe.done=!0,pe.start=function(){throw new Error("Cursor behind last entry")},pe.stop()}var Ln=new Promise(function(Xe,Mt){Xe=De(Xe),U.onerror=rt(Mt),pe.fail=Mt,pe.stop=function(Rr){pe.stop=pe.continue=pe.continuePrimaryKey=pe.advance=Ze,Xe(Rr)}});return U.onsuccess=De(function(Xe){U.onsuccess=Ge,Ge()}),pe.continue=me,pe.continuePrimaryKey=ge,pe.advance=be,Ge(),Ln},B(pe)):B(null)},V)})},count:function(S){var k=S.query,P=S.trans,D=k.index,A=k.range;return new Promise(function(j,B){var V=P.objectStore(T),q=D.isPrimaryKey?V:V.index(D.name),V=i(A),q=V?q.count(V):q.count();q.onsuccess=De(function(L){return j(L.target.result)}),q.onerror=rt(B)})}}}var f,h,m,E=(h=g,m=fi((f=e).objectStoreNames),{schema:{name:f.name,tables:m.map(function(I){return h.objectStore(I)}).map(function(I){var b=I.keyPath,k=I.autoIncrement,T=p(b),S={},k={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:T,keyPath:b,autoIncrement:k,unique:!0,extractKey:yr(b)},indexes:fi(I.indexNames).map(function(P){return I.index(P)}).map(function(j){var D=j.name,A=j.unique,B=j.multiEntry,j=j.keyPath,B={name:D,compound:p(j),keyPath:j,unique:A,multiEntry:B,extractKey:yr(j)};return S[on(j)]=B}),getIndexByKeyPath:function(P){return S[on(P)]}};return S[":id"]=k.primaryKey,b!=null&&(S[on(b)]=k.primaryKey),k})},hasGetAll:0<m.length&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),g=E.schema,w=E.hasGetAll,E=g.tables.map(s),v={};return E.forEach(function(I){return v[I.name]=I}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(I){if(!v[I])throw new Error("Table '".concat(I,"' not found"));return v[I]},MIN_KEY:-1/0,MAX_KEY:rn(t),schema:g}}function Co(e,t,n,i){var s=n.IDBKeyRange;return n.indexedDB,{dbcore:(i=Io(t,s,i),e.dbcore.reduce(function(f,h){return h=h.create,o(o({},f),h(f))},i))}}function On(e,i){var n=i.db,i=Co(e._middlewares,n,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(s){var f=s.name;e.core.schema.tables.some(function(h){return h.name===f})&&(s.core=e.core.table(f),e[f]instanceof e.Table&&(e[f].core=s.core))})}function Pn(e,t,n,i){n.forEach(function(s){var f=i[s];t.forEach(function(h){var m=function g(w,E){return $(w,E)||(w=x(w))&&g(w,E)}(h,s);(!m||"value"in m&&m.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?Z(h,s,{get:function(){return this.table(s)},set:function(g){M(this,s,{value:g,writable:!0,configurable:!0,enumerable:!0})}}):h[s]=new e.Table(s,f))})})}function _r(e,t){t.forEach(function(n){for(var i in n)n[i]instanceof e.Table&&delete n[i]})}function Oo(e,t){return e._cfg.version-t._cfg.version}function Po(e,t,n,i){var s=e._dbSchema;n.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=vr("$meta",hi("")[0],[]),e._storeNames.push("$meta"));var f=e._createTransaction("readwrite",e._storeNames,s);f.create(n),f._completion.catch(i);var h=f._reject.bind(f),m=ae.transless||ae;ft(function(){return ae.trans=f,ae.transless=m,t!==0?(On(e,n),w=t,((g=f).storeNames.includes("$meta")?g.table("$meta").get("version").then(function(E){return E??w}):H.resolve(w)).then(function(E){return I=E,b=f,T=n,S=[],E=(v=e)._versions,k=v._dbSchema=An(0,v.idbdb,T),(E=E.filter(function(P){return P._cfg.version>=I})).length!==0?(E.forEach(function(P){S.push(function(){var D=k,A=P._cfg.dbschema;jn(v,D,T),jn(v,A,T),k=v._dbSchema=A;var j=gr(D,A);j.add.forEach(function(Y){br(T,Y[0],Y[1].primKey,Y[1].indexes)}),j.change.forEach(function(Y){if(Y.recreate)throw new le.Upgrade("Not yet support for changing primary key");var U=T.objectStore(Y.name);Y.add.forEach(function(X){return Dn(U,X)}),Y.change.forEach(function(X){U.deleteIndex(X.name),Dn(U,X)}),Y.del.forEach(function(X){return U.deleteIndex(X)})});var B=P._cfg.contentUpgrade;if(B&&P._cfg.version>I){On(v,T),b._memoizedTables={};var V=ie(A);j.del.forEach(function(Y){V[Y]=D[Y]}),_r(v,[v.Transaction.prototype]),Pn(v,[v.Transaction.prototype],d(V),V),b.schema=V;var q,L=at(B);return L&&Ut(),j=H.follow(function(){var Y;(q=B(b))&&L&&(Y=dt.bind(null,null),q.then(Y,Y))}),q&&typeof q.then=="function"?H.resolve(q):j.then(function(){return q})}}),S.push(function(D){var A,j,B=P._cfg.dbschema;A=B,j=D,[].slice.call(j.db.objectStoreNames).forEach(function(V){return A[V]==null&&j.db.deleteObjectStore(V)}),_r(v,[v.Transaction.prototype]),Pn(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),b.schema=v._dbSchema}),S.push(function(D){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===P._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(A){return A!=="$meta"})):D.objectStore("$meta").put(P._cfg.version,"version"))})}),function P(){return S.length?H.resolve(S.shift()(b.idbtrans)).then(P):H.resolve()}().then(function(){di(k,T)})):H.resolve();var v,I,b,T,S,k}).catch(h)):(d(s).forEach(function(E){br(n,E,s[E].primKey,s[E].indexes)}),On(e,n),void H.follow(function(){return e.on.populate.fire(f)}).catch(h));var g,w})}function Do(e,t){di(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=An(0,e.idbdb,t);jn(e,e._dbSchema,t);for(var i=0,s=gr(n,e._dbSchema).change;i<s.length;i++){var f=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=t.objectStore(h.name);h.add.forEach(function(g){nt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(g.src)),Dn(m,g)})}(s[i]);if(typeof f=="object")return f.value}}function gr(e,t){var n,i={del:[],add:[],change:[]};for(n in e)t[n]||i.del.push(n);for(n in t){var s=e[n],f=t[n];if(s){var h={name:n,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||s.primKey.auto!==f.primKey.auto)h.recreate=!0,i.change.push(h);else{var m=s.idxByName,g=f.idxByName,w=void 0;for(w in m)g[w]||h.del.push(w);for(w in g){var E=m[w],v=g[w];E?E.src!==v.src&&h.change.push(v):h.add.push(v)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([n,f])}return i}function br(e,t,n,i){var s=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(f){return Dn(s,f)}),s}function di(e,t){d(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(nt&&console.debug("Dexie: Creating missing table",n),br(t,n,e[n].primKey,e[n].indexes))})}function Dn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function An(e,t,n){var i={};return oe(t.objectStoreNames,0).forEach(function(s){for(var f=n.objectStore(s),h=mr(ci(w=f.keyPath),w||"",!0,!1,!!f.autoIncrement,w&&typeof w!="string",!0),m=[],g=0;g<f.indexNames.length;++g){var E=f.index(f.indexNames[g]),w=E.keyPath,E=mr(E.name,w,!!E.unique,!!E.multiEntry,!1,w&&typeof w!="string",!1);m.push(E)}i[s]=vr(s,h,m)}),i}function jn(e,t,n){for(var i=n.db.objectStoreNames,s=0;s<i.length;++s){var f=i[s],h=n.objectStore(f);e._hasGetAll="getAll"in h;for(var m=0;m<h.indexNames.length;++m){var g=h.indexNames[m],w=h.index(g).keyPath,E=typeof w=="string"?w:"["+oe(w).join("+")+"]";!t[f]||(w=t[f].idxByName[E])&&(w.name=g,delete t[f].idxByName[E],t[f].idxByName[g]=w)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function hi(e){return e.split(",").map(function(t,n){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),s=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return mr(i,s||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),p(s),n===0)})}var Ao=(Kn.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(n){if(e[n]!==null){var i=hi(e[n]),s=i.shift();if(s.unique=!0,s.multi)throw new le.Schema("Primary key cannot be multi-valued");i.forEach(function(f){if(f.auto)throw new le.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new le.Schema("Index must have a name and cannot be an empty string")}),t[n]=vr(n,s,i)}})},Kn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?_(this._cfg.storesSource,n):n;var n=t._versions,i={},s={};return n.forEach(function(f){_(i,f._cfg.storesSource),s=f._cfg.dbschema={},f._parseStoresSpec(i,s)}),t._dbSchema=s,_r(t,[t._allTables,t,t.Transaction.prototype]),Pn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(s),s),t._storeNames=d(s),this},Kn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=er(this._cfg.contentUpgrade||Ie,e),this},Kn);function Kn(){}function wr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ut(Tn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function kr(e){return e&&typeof e.databases=="function"}function xr(e){return ft(function(){return ae.letThrough=!0,e()})}function Tr(e){return!("from"in e)}var He=function(e,t){if(!this){var n=new He;return e&&"d"in e&&_(n,e),n}_(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function an(e,t,n){var i=xe(t,n);if(!isNaN(i)){if(0<i)throw RangeError();if(Tr(e))return _(e,{from:t,to:n,d:1});var s=e.l,i=e.r;if(xe(n,e.from)<0)return s?an(s,t,n):e.l={from:t,to:n,d:1,l:null,r:null},mi(e);if(0<xe(t,e.to))return i?an(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},mi(e);xe(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<xe(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,s&&!e.l&&sn(e,s),i&&n&&sn(e,i)}}function sn(e,t){Tr(t)||function n(i,g){var f=g.from,h=g.to,m=g.l,g=g.r;an(i,f,h),m&&n(i,m),g&&n(i,g)}(e,t)}function pi(e,t){var n=Rn(t),i=n.next();if(i.done)return!1;for(var s=i.value,f=Rn(e),h=f.next(s.from),m=h.value;!i.done&&!h.done;){if(xe(m.from,s.to)<=0&&0<=xe(m.to,s.from))return!0;xe(s.from,m.from)<0?s=(i=n.next(m.from)).value:m=(h=f.next(s.from)).value}return!1}function Rn(e){var t=Tr(e)?null:{s:0,n:e};return{next:function(n){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&xe(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||xe(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mi(e){var t,n,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),s=1<i?"r":i<-1?"l":"";s&&(t=s=="r"?"l":"r",n=o({},e),i=e[s],e.from=i.from,e.to=i.to,e[s]=i[s],n[s]=i[t],(e[t]=n).d=vi(n)),e.d=vi(e)}function vi(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Mn(e,t){return d(t).forEach(function(n){e[n]?sn(e[n],t[n]):e[n]=function i(s){var f,h,m={};for(f in s)O(s,f)&&(h=s[f],m[f]=!h||typeof h!="object"||Le.has(h.constructor)?h:i(h));return m}(t[n])}),e}function Er(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&pi(t[n],e[n])})}y(He.prototype,((et={add:function(e){return sn(this,e),this},addKey:function(e){return an(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return an(t,n,n)}),this},hasKey:function(e){var t=Rn(this).next(e).value;return t&&xe(t.from,e)<=0&&0<=xe(t.to,e)}})[he]=function(){return Rn(this)},et));var Kt={},Sr={},Ir=!1;function Nn(e){Mn(Sr,e),Ir||(Ir=!0,setTimeout(function(){Ir=!1,Cr(Sr,!(Sr={}))},0))}function Cr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var i=0,s=Object.values(Kt);i<s.length;i++)yi(h=s[i],e,n,t);else for(var f in e){var h,m=/^idb\:\/\/(.*)\/(.*)\//.exec(f);m&&(f=m[1],m=m[2],(h=Kt["idb://".concat(f,"/").concat(m)])&&yi(h,e,n,t))}n.forEach(function(g){return g()})}function yi(e,t,n,i){for(var s=[],f=0,h=Object.entries(e.queries.query);f<h.length;f++){for(var m=h[f],g=m[0],w=[],E=0,v=m[1];E<v.length;E++){var I=v[E];Er(t,I.obsSet)?I.subscribers.forEach(function(k){return n.add(k)}):i&&w.push(I)}i&&s.push([g,w])}if(i)for(var b=0,T=s;b<T.length;b++){var S=T[b],g=S[0],w=S[1];e.queries.query[g]=w}}function jo(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ke(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,s=Math.round(10*e.verno),f=!1;function h(){if(t.openCanceller!==i)throw new le.DatabaseClosed("db.open() was cancelled")}function m(){return new H(function(I,b){if(h(),!n)throw new le.MissingAPI;var T=e.name,S=t.autoSchema||!s?n.open(T):n.open(T,s);if(!S)throw new le.MissingAPI;S.onerror=rt(b),S.onblocked=De(e._fireOnBlocked),S.onupgradeneeded=De(function(k){var P;E=S.transaction,t.autoSchema&&!e._options.allowEmptyDB?(S.onerror=tn,E.abort(),S.result.close(),(P=n.deleteDatabase(T)).onsuccess=P.onerror=De(function(){b(new le.NoSuchDatabase("Database ".concat(T," doesnt exist")))})):(E.onerror=rt(b),k=k.oldVersion>Math.pow(2,62)?0:k.oldVersion,v=k<1,e.idbdb=S.result,f&&Do(e,E),Po(e,k/10,E,b))},b),S.onsuccess=De(function(){E=null;var k,P,D,A,j,B=e.idbdb=S.result,V=oe(B.objectStoreNames);if(0<V.length)try{var q=B.transaction((A=V).length===1?A[0]:A,"readonly");if(t.autoSchema)P=B,D=q,(k=e).verno=P.version/10,D=k._dbSchema=An(0,P,D),k._storeNames=oe(P.objectStoreNames,0),Pn(k,[k._allTables],d(D),D);else if(jn(e,e._dbSchema,q),((j=gr(An(0,(j=e).idbdb,q),j._dbSchema)).add.length||j.change.some(function(L){return L.add.length||L.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),B.close(),s=B.version+1,f=!0,I(m());On(e,q)}catch{}Vt.push(e),B.onversionchange=De(function(L){t.vcFired=!0,e.on("versionchange").fire(L)}),B.onclose=De(function(L){e.on("close").fire(L)}),v&&(j=e._deps,q=T,B=j.indexedDB,j=j.IDBKeyRange,kr(B)||q===Tn||wr(B,j).put({name:q}).catch(Ie)),I()},b)}).catch(function(I){switch(I==null?void 0:I.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<s)return s=0,m()}return H.reject(I)})}var g,w=t.dbReadyResolve,E=null,v=!1;return H.race([i,(typeof navigator>"u"?H.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function b(){return indexedDB.databases().finally(I)}g=setInterval(b,100),b()}).finally(function(){return clearInterval(g)}):Promise.resolve()).then(m)]).then(function(){return h(),t.onReadyBeingFired=[],H.resolve(xr(function(){return e.on.ready.fire(e.vip)})).then(function I(){if(0<t.onReadyBeingFired.length){var b=t.onReadyBeingFired.reduce(er,Ie);return t.onReadyBeingFired=[],H.resolve(xr(function(){return b(e.vip)})).then(I)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(I){t.dbOpenError=I;try{E&&E.abort()}catch{}return i===t.openCanceller&&e._close(),Ke(I)}).finally(function(){t.openComplete=!0,w()}).then(function(){var I;return v&&(I={},e.tables.forEach(function(b){b.schema.indexes.forEach(function(T){T.name&&(I["idb://".concat(e.name,"/").concat(b.name,"/").concat(T.name)]=new He(-1/0,[[[]]]))}),I["idb://".concat(e.name,"/").concat(b.name,"/")]=I["idb://".concat(e.name,"/").concat(b.name,"/:dels")]=new He(-1/0,[[[]]])}),mt(nn).fire(I),Cr(I,!0)),e})}function Or(e){function t(f){return e.next(f)}var n=s(t),i=s(function(f){return e.throw(f)});function s(f){return function(g){var m=f(g),g=m.value;return m.done?g:g&&typeof g.then=="function"?g.then(n,i):p(g)?Promise.all(g).then(n,i):n(g)}}return s(t)()}function Bn(e,t,n){for(var i=p(e)?e.slice():[e],s=0;s<n;++s)i.push(t);return i}var Ko={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema,s={},f=[];function h(v,I,b){var T=on(v),S=s[T]=s[T]||[],k=v==null?0:typeof v=="string"?1:v.length,P=0<I,P=o(o({},b),{name:P?"".concat(T,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:P,keyTail:I,keyLength:k,extractKey:yr(v),unique:!P&&b.unique});return S.push(P),P.isPrimaryKey||f.push(P),1<k&&h(k===2?v[0]:v.slice(0,k-1),I+1,b),S.sort(function(D,A){return D.keyTail-A.keyTail}),P}t=h(i.primaryKey.keyPath,0,i.primaryKey),s[":id"]=[t];for(var m=0,g=i.indexes;m<g.length;m++){var w=g[m];h(w.keyPath,0,w)}function E(v){var I,b=v.query.index;return b.isVirtual?o(o({},v),{query:{index:b.lowLevelIndex,range:(I=v.query.range,b=b.keyTail,{type:I.type===1?2:I.type,lower:Bn(I.lower,I.lowerOpen?e.MAX_KEY:e.MIN_KEY,b),lowerOpen:!0,upper:Bn(I.upper,I.upperOpen?e.MIN_KEY:e.MAX_KEY,b),upperOpen:!0})}}):v}return o(o({},n),{schema:o(o({},i),{primaryKey:t,indexes:f,getIndexByKeyPath:function(v){return(v=s[on(v)])&&v[0]}}),count:function(v){return n.count(E(v))},query:function(v){return n.query(E(v))},openCursor:function(v){var I=v.query.index,b=I.keyTail,T=I.isVirtual,S=I.keyLength;return T?n.openCursor(E(v)).then(function(P){return P&&k(P)}):n.openCursor(v);function k(P){return Object.create(P,{continue:{value:function(D){D!=null?P.continue(Bn(D,v.reverse?e.MAX_KEY:e.MIN_KEY,b)):v.unique?P.continue(P.key.slice(0,S).concat(v.reverse?e.MIN_KEY:e.MAX_KEY,b)):P.continue()}},continuePrimaryKey:{value:function(D,A){P.continuePrimaryKey(Bn(D,e.MAX_KEY,b),A)}},primaryKey:{get:function(){return P.primaryKey}},key:{get:function(){var D=P.key;return S===1?D[0]:D.slice(0,S)}},value:{get:function(){return P.value}}})}}})}})}};function Pr(e,t,n,i){return n=n||{},i=i||"",d(e).forEach(function(s){var f,h,m;O(t,s)?(f=e[s],h=t[s],typeof f=="object"&&typeof h=="object"&&f&&h?(m=Ae(f))!==Ae(h)?n[i+s]=t[s]:m==="Object"?Pr(f,h,n,i+s+"."):f!==h&&(n[i+s]=t[s]):f!==h&&(n[i+s]=t[s])):n[i+s]=void 0}),d(t).forEach(function(s){O(e,s)||(n[i+s]=t[s])}),n}function Dr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ro={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return o(o({},n),{mutate:function(s){var f=ae.trans,h=f.table(t).hook,m=h.deleting,g=h.creating,w=h.updating;switch(s.type){case"add":if(g.fire===Ie)break;return f._promise("readwrite",function(){return E(s)},!0);case"put":if(g.fire===Ie&&w.fire===Ie)break;return f._promise("readwrite",function(){return E(s)},!0);case"delete":if(m.fire===Ie)break;return f._promise("readwrite",function(){return E(s)},!0);case"deleteRange":if(m.fire===Ie)break;return f._promise("readwrite",function(){return function v(I,b,T){return n.query({trans:I,values:!1,query:{index:i,range:b},limit:T}).then(function(S){var k=S.result;return E({type:"delete",keys:k,trans:I}).then(function(P){return 0<P.numFailures?Promise.reject(P.failures[0]):k.length<T?{failures:[],numFailures:0,lastResult:void 0}:v(I,o(o({},b),{lower:k[k.length-1],lowerOpen:!0}),T)})})}(s.trans,s.range,1e4)},!0)}return n.mutate(s);function E(v){var I,b,T,S=ae.trans,k=v.keys||Dr(i,v);if(!k)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?o(o({},v),{keys:k}):o({},v)).type!=="delete"&&(v.values=c([],v.values)),v.keys&&(v.keys=c([],v.keys)),I=n,T=k,((b=v).type==="add"?Promise.resolve([]):I.getMany({trans:b.trans,keys:T,cache:"immutable"})).then(function(P){var D=k.map(function(A,j){var B,V,q,L=P[j],Y={onerror:null,onsuccess:null};return v.type==="delete"?m.fire.call(Y,A,L,S):v.type==="add"||L===void 0?(B=g.fire.call(Y,A,v.values[j],S),A==null&&B!=null&&(v.keys[j]=A=B,i.outbound||ne(v.values[j],i.keyPath,A))):(B=Pr(L,v.values[j]),(V=w.fire.call(Y,B,A,L,S))&&(q=v.values[j],Object.keys(V).forEach(function(U){O(q,U)?q[U]=V[U]:ne(q,U,V[U])}))),Y});return n.mutate(v).then(function(A){for(var j=A.failures,B=A.results,V=A.numFailures,A=A.lastResult,q=0;q<k.length;++q){var L=(B||k)[q],Y=D[q];L==null?Y.onerror&&Y.onerror(j[q]):Y.onsuccess&&Y.onsuccess(v.type==="put"&&P[q]?v.values[q]:L)}return{failures:j,results:B,numFailures:V,lastResult:A}}).catch(function(A){return D.forEach(function(j){return j.onerror&&j.onerror(A)}),Promise.reject(A)})})}}})}})}};function _i(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var i=[],s=0,f=0;s<t.keys.length&&f<e.length;++s)xe(t.keys[s],e[f])===0&&(i.push(n?Te(t.values[s]):t.values[s]),++f);return i.length===e.length?i:null}catch{return null}}var Mo={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return o(o({},n),{getMany:function(i){if(!i.cache)return n.getMany(i);var s=_i(i.keys,i.trans._cache,i.cache==="clone");return s?H.resolve(s):n.getMany(i).then(function(f){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?Te(f):f},f})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),n.mutate(i)}})}}}};function gi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function bi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var No={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new He(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,s,f){if(ae.subscr&&s!=="readonly")throw new le.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ae.querier));return e.transaction(i,s,f)},table:function(i){var s=e.table(i),f=s.schema,h=f.primaryKey,v=f.indexes,m=h.extractKey,g=h.outbound,w=h.autoIncrement&&v.filter(function(b){return b.compound&&b.keyPath.includes(h.keyPath)}),E=o(o({},s),{mutate:function(b){function T(U){return U="idb://".concat(t,"/").concat(i,"/").concat(U),A[U]||(A[U]=new He)}var S,k,P,D=b.trans,A=b.mutatedParts||(b.mutatedParts={}),j=T(""),B=T(":dels"),V=b.type,Y=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[Dr(h,b).filter(function(U){return U}),b.values]:[],q=Y[0],L=Y[1],Y=b.trans._cache;return p(q)?(j.addKeys(q),(Y=V==="delete"||q.length===L.length?_i(q,Y):null)||B.addKeys(q),(Y||L)&&(S=T,k=Y,P=L,f.indexes.forEach(function(U){var X=S(U.name||"");function me(be){return be!=null?U.extractKey(be):null}function ge(be){return U.multiEntry&&p(be)?be.forEach(function(Ze){return X.addKey(Ze)}):X.addKey(be)}(k||P).forEach(function(be,ze){var pe=k&&me(k[ze]),ze=P&&me(P[ze]);xe(pe,ze)!==0&&(pe!=null&&ge(pe),ze!=null&&ge(ze))})}))):q?(L={from:(L=q.lower)!==null&&L!==void 0?L:e.MIN_KEY,to:(L=q.upper)!==null&&L!==void 0?L:e.MAX_KEY},B.add(L),j.add(L)):(j.add(n),B.add(n),f.indexes.forEach(function(U){return T(U.name).add(n)})),s.mutate(b).then(function(U){return!q||b.type!=="add"&&b.type!=="put"||(j.addKeys(U.results),w&&w.forEach(function(X){for(var me=b.values.map(function(pe){return X.extractKey(pe)}),ge=X.keyPath.findIndex(function(pe){return pe===h.keyPath}),be=0,Ze=U.results.length;be<Ze;++be)me[be][ge]=U.results[be];T(X.name).addKeys(me)})),D.mutatedParts=Mn(D.mutatedParts||{},A),U})}}),v=function(T){var S=T.query,T=S.index,S=S.range;return[T,new He((T=S.lower)!==null&&T!==void 0?T:e.MIN_KEY,(S=S.upper)!==null&&S!==void 0?S:e.MAX_KEY)]},I={get:function(b){return[h,new He(b.key)]},getMany:function(b){return[h,new He().addKeys(b.keys)]},count:v,query:v,openCursor:v};return d(I).forEach(function(b){E[b]=function(T){var S=ae.subscr,k=!!S,P=gi(ae,s)&&bi(b,T)?T.obsSet={}:S;if(k){var D=function(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),P[L]||(P[L]=new He)},A=D(""),j=D(":dels"),S=I[b](T),k=S[0],S=S[1];if((b==="query"&&k.isPrimaryKey&&!T.values?j:D(k.name||"")).add(S),!k.isPrimaryKey){if(b!=="count"){var B=b==="query"&&g&&T.values&&s.query(o(o({},T),{values:!1}));return s[b].apply(this,arguments).then(function(L){if(b==="query"){if(g&&T.values)return B.then(function(me){return me=me.result,A.addKeys(me),L});var Y=T.values?L.result.map(m):L.result;(T.values?A:j).addKeys(Y)}else if(b==="openCursor"){var U=L,X=T.values;return U&&Object.create(U,{key:{get:function(){return j.addKey(U.primaryKey),U.key}},primaryKey:{get:function(){var me=U.primaryKey;return j.addKey(me),me}},value:{get:function(){return X&&A.addKey(U.primaryKey),U.value}}})}return L})}j.add(n)}}return s[b].apply(this,arguments)}}),E}})}};function wi(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===i?null:(t=o({},t),p(t.keys)&&(t.keys=t.keys.filter(function(s,f){return!(f in n.failures)})),"values"in t&&p(t.values)&&(t.values=t.values.filter(function(s,f){return!(f in n.failures)})),t)}function Ar(e,t){return n=e,((i=t).lower===void 0||(i.lowerOpen?0<xe(n,i.lower):0<=xe(n,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?xe(e,t.upper)<0:xe(e,t.upper)<=0));var n,i}function ki(e,t,I,i,s,f){if(!I||I.length===0)return e;var h=t.query.index,m=h.multiEntry,g=t.query.range,w=i.schema.primaryKey.extractKey,E=h.extractKey,v=(h.lowLevelIndex||h).extractKey,I=I.reduce(function(b,T){var S=b,k=[];if(T.type==="add"||T.type==="put")for(var P=new He,D=T.values.length-1;0<=D;--D){var A,j=T.values[D],B=w(j);P.hasKey(B)||(A=E(j),(m&&p(A)?A.some(function(U){return Ar(U,g)}):Ar(A,g))&&(P.addKey(B),k.push(j)))}switch(T.type){case"add":var V=new He().addKeys(t.values?b.map(function(X){return w(X)}):b),S=b.concat(t.values?k.filter(function(X){return X=w(X),!V.hasKey(X)&&(V.addKey(X),!0)}):k.map(function(X){return w(X)}).filter(function(X){return!V.hasKey(X)&&(V.addKey(X),!0)}));break;case"put":var q=new He().addKeys(T.values.map(function(X){return w(X)}));S=b.filter(function(X){return!q.hasKey(t.values?w(X):X)}).concat(t.values?k:k.map(function(X){return w(X)}));break;case"delete":var L=new He().addKeys(T.keys);S=b.filter(function(X){return!L.hasKey(t.values?w(X):X)});break;case"deleteRange":var Y=T.range;S=b.filter(function(X){return!Ar(w(X),Y)})}return S},e);return I===e?e:(I.sort(function(b,T){return xe(v(b),v(T))||xe(w(b),w(T))}),t.limit&&t.limit<1/0&&(I.length>t.limit?I.length=t.limit:e.length===t.limit&&I.length<t.limit&&(s.dirty=!0)),f?Object.freeze(I):I)}function xi(e,t){return xe(e.lower,t.lower)===0&&xe(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Bo(e,t){return function(n,i,s,f){if(n===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=xe(n,i))===0){if(s&&f)return 0;if(s)return 1;if(f)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,i,s,f){if(n===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=xe(n,i))===0){if(s&&f)return 0;if(s)return-1;if(f)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function qo(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",function(){var s,f;e.subscribers.delete(n),e.subscribers.size===0&&(s=e,f=t,setTimeout(function(){s.subscribers.size===0&&fe(f,s)},3e3))})}var Fo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(n,i,s){var f,h,m=e.transaction(n,i,s);return i==="readwrite"&&(h=(f=new AbortController).signal,s=function(g){return function(){if(f.abort(),i==="readwrite"){for(var w=new Set,E=0,v=n;E<v.length;E++){var I=v[E],b=Kt["idb://".concat(t,"/").concat(I)];if(b){var T=e.table(I),S=b.optimisticOps.filter(function(X){return X.trans===m});if(m._explicit&&g&&m.mutatedParts)for(var k=0,P=Object.values(b.queries.query);k<P.length;k++)for(var D=0,A=(V=P[k]).slice();D<A.length;D++)Er((q=A[D]).obsSet,m.mutatedParts)&&(fe(V,q),q.subscribers.forEach(function(X){return w.add(X)}));else if(0<S.length){b.optimisticOps=b.optimisticOps.filter(function(X){return X.trans!==m});for(var j=0,B=Object.values(b.queries.query);j<B.length;j++)for(var V,q,L,Y=0,U=(V=B[j]).slice();Y<U.length;Y++)(q=U[Y]).res!=null&&m.mutatedParts&&(g&&!q.dirty?(L=Object.isFrozen(q.res),L=ki(q.res,q.req,S,T,q,L),q.dirty?(fe(V,q),q.subscribers.forEach(function(X){return w.add(X)})):L!==q.res&&(q.res=L,q.promise=H.resolve({result:L}))):(q.dirty&&fe(V,q),q.subscribers.forEach(function(X){return w.add(X)})))}}}w.forEach(function(X){return X()})}}},m.addEventListener("abort",s(!1),{signal:h}),m.addEventListener("error",s(!1),{signal:h}),m.addEventListener("complete",s(!0),{signal:h})),m},table:function(n){var i=e.table(n),s=i.schema.primaryKey;return o(o({},i),{mutate:function(f){var h=ae.trans;if(s.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(f);var m=Kt["idb://".concat(t,"/").concat(n)];return m?(h=i.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||Dr(s,f).some(function(g){return g==null}))?(m.optimisticOps.push(f),f.mutatedParts&&Nn(f.mutatedParts),h.then(function(g){0<g.numFailures&&(fe(m.optimisticOps,f),(g=wi(0,f,g))&&m.optimisticOps.push(g),f.mutatedParts&&Nn(f.mutatedParts))}),h.catch(function(){fe(m.optimisticOps,f),f.mutatedParts&&Nn(f.mutatedParts)})):h.then(function(g){var w=wi(0,o(o({},f),{values:f.values.map(function(E,v){var I;return g.failures[v]?E:(E=(I=s.keyPath)!==null&&I!==void 0&&I.includes(".")?Te(E):o({},E),ne(E,s.keyPath,g.results[v]),E)})}),g);m.optimisticOps.push(w),queueMicrotask(function(){return f.mutatedParts&&Nn(f.mutatedParts)})}),h):i.mutate(f)},query:function(f){if(!gi(ae,i)||!bi("query",f))return i.query(f);var h=((w=ae.trans)===null||w===void 0?void 0:w.db._options.cache)==="immutable",v=ae,m=v.requery,g=v.signal,w=function(T,S,k,P){var D=Kt["idb://".concat(T,"/").concat(S)];if(!D)return[];if(!(S=D.queries[k]))return[null,!1,D,null];var A=S[(P.query?P.query.index.name:null)||""];if(!A)return[null,!1,D,null];switch(k){case"query":var j=A.find(function(B){return B.req.limit===P.limit&&B.req.values===P.values&&xi(B.req.query.range,P.query.range)});return j?[j,!0,D,A]:[A.find(function(B){return("limit"in B.req?B.req.limit:1/0)>=P.limit&&(!P.values||B.req.values)&&Bo(B.req.query.range,P.query.range)}),!1,D,A];case"count":return j=A.find(function(B){return xi(B.req.query.range,P.query.range)}),[j,!!j,D,A]}}(t,n,"query",f),E=w[0],v=w[1],I=w[2],b=w[3];return E&&v?E.obsSet=f.obsSet:(v=i.query(f).then(function(T){var S=T.result;if(E&&(E.res=S),h){for(var k=0,P=S.length;k<P;++k)Object.freeze(S[k]);Object.freeze(S)}else T.result=Te(S);return T}).catch(function(T){return b&&E&&fe(b,E),Promise.reject(T)}),E={obsSet:f.obsSet,promise:v,subscribers:new Set,type:"query",req:f,dirty:!1},b?b.push(E):(b=[E],(I=I||(Kt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=b)),qo(E,b,m,g),E.promise.then(function(T){return{result:ki(T.result,f,I==null?void 0:I.optimisticOps,i,E,h)}})}})}})}};function qn(e,t){return new Proxy(e,{get:function(n,i,s){return i==="db"?t:Reflect.get(n,i,s)}})}var ut=(Re.prototype.version=function(e){if(isNaN(e)||e<.1)throw new le.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new le.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(i){return i._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Oo),n.stores({}),this._state.autoSchema=!1,n)},Re.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ae.letThrough||this._vip)?e():new H(function(n,i){if(t._state.openComplete)return i(new le.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new le.DatabaseClosed);t.open().catch(Ie)}t._state.dbReadyPromise.then(n,i)}).then(e)},Re.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,s=e.name;return s&&this.unuse({stack:t,name:s}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:i??10,name:s}),e.sort(function(f,h){return f.level-h.level}),this},Re.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(s){return i?s.create!==i:!!n&&s.name!==n})),this},Re.prototype.open=function(){var e=this;return Dt(ct,function(){return jo(e)})},Re.prototype._close=function(){var e=this._state,t=Vt.indexOf(this);if(0<=t&&Vt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new H(function(n){e.dbReadyResolve=n}),e.openCanceller=new H(function(n,i){e.cancelOpen=i}))},Re.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new le.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new le.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Re.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new H(function(s,f){function h(){t.close(e);var m=t._deps.indexedDB.deleteDatabase(t.name);m.onsuccess=De(function(){var g,w,E;g=t._deps,w=t.name,E=g.indexedDB,g=g.IDBKeyRange,kr(E)||w===Tn||wr(E,g).delete(w).catch(Ie),s()}),m.onerror=rt(f),m.onblocked=t._fireOnBlocked}if(n)throw new le.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Re.prototype.backendDB=function(){return this.idbdb},Re.prototype.isOpen=function(){return this.idbdb!==null},Re.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Re.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Re.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Re.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Re.prototype.transaction=function(){var e=(function(t,n,i){var s=arguments.length;if(s<2)throw new le.InvalidArgument("Too few arguments");for(var f=new Array(s-1);--s;)f[s-1]=arguments[s];return i=f.pop(),[t,ve(f),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Re.prototype._transaction=function(e,t,n){var i=this,s=ae.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);var f,h,m=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(w){if(w=w instanceof i.Table?w.name:w,typeof w!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return w}),e=="r"||e===lr)f=lr;else{if(e!="rw"&&e!=cr)throw new le.InvalidArgument("Invalid transaction mode: "+e);f=cr}if(s){if(s.mode===lr&&f===cr){if(!m)throw new le.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&h.forEach(function(w){if(s&&s.storeNames.indexOf(w)===-1){if(!m)throw new le.SubTransaction("Table "+w+" not included in parent transaction.");s=null}}),m&&s&&!s.active&&(s=null)}}catch(w){return s?s._promise(null,function(E,v){v(w)}):Ke(w)}var g=(function w(E,v,I,b,T){return H.resolve().then(function(){var S=ae.transless||ae,k=E._createTransaction(v,I,E._dbSchema,b);if(k.explicit=!0,S={trans:k,transless:S},b)k.idbtrans=b.idbtrans;else try{k.create(),k.idbtrans._explicit=!0,E._state.PR1398_maxLoop=3}catch(A){return A.name===Zn.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return w(E,v,I,null,T)})):Ke(A)}var P,D=at(T);return D&&Ut(),S=H.follow(function(){var A;(P=T.call(k,k))&&(D?(A=dt.bind(null,null),P.then(A,A)):typeof P.next=="function"&&typeof P.throw=="function"&&(P=Or(P)))},S),(P&&typeof P.then=="function"?H.resolve(P).then(function(A){return k.active?A:Ke(new le.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):S.then(function(){return P})).then(function(A){return b&&k._resolve(),k._completion.then(function(){return A})}).catch(function(A){return k._reject(A),Ke(A)})})}).bind(null,this,f,h,s,n);return s?s._promise(f,g,"lock"):ae.trans?Dt(ae.transless,function(){return i._whenReady(g)}):this._whenReady(g)},Re.prototype.table=function(e){if(!O(this._allTables,e))throw new le.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Re);function Re(e,t){var n=this;this._middlewares={},this.verno=0;var i=Re.dependencies;this._options=t=o({addons:Re.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,f,h,m,g,w={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ie,dbReadyPromise:null,cancelOpen:Ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};w.dbReadyPromise=new H(function(v){w.dbReadyResolve=v}),w.openCanceller=new H(function(v,I){w.cancelOpen=I}),this._state=w,this.name=e,this.on=Jt(this,"populate","blocked","versionchange","close",{ready:[er,Ie]}),this.on.ready.subscribe=z(this.on.ready.subscribe,function(v){return function(I,b){Re.vip(function(){var T,S=n._state;S.openComplete?(S.dbOpenError||H.resolve().then(I),b&&v(I)):S.onReadyBeingFired?(S.onReadyBeingFired.push(I),b&&v(I)):(v(I),T=n,b||v(function k(){T.on.ready.unsubscribe(I),T.on.ready.unsubscribe(k)}))})}}),this.Collection=(s=this,Zt(ko.prototype,function(P,k){this.db=s;var b=ei,T=null;if(k)try{b=k()}catch(D){T=D}var S=P._ctx,k=S.table,P=k.hook.reading.fire;this._ctx={table:k,index:S.index,isPrimKey:!S.index||k.schema.primKey.keyPath&&S.index===k.schema.primKey.name,range:b,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:T,or:S.or,valueMapper:P!==Gt?P:null}})),this.Table=(f=this,Zt(ii.prototype,function(v,I,b){this.db=f,this._tx=b,this.name=v,this.schema=I,this.hook=f._allTables[v]?f._allTables[v].hook:Jt(null,{creating:[ho,Ie],reading:[fo,Gt],updating:[mo,Ie],deleting:[po,Ie]})})),this.Transaction=(h=this,Zt(Eo.prototype,function(v,I,b,T,S){var k=this;this.db=h,this.mode=v,this.storeNames=I,this.schema=b,this.chromeTransactionDurability=T,this.idbtrans=null,this.on=Jt(this,"complete","error","abort"),this.parent=S||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new H(function(P,D){k._resolve=P,k._reject=D}),this._completion.then(function(){k.active=!1,k.on.complete.fire()},function(P){var D=k.active;return k.active=!1,k.on.error.fire(P),k.parent?k.parent._reject(P):D&&k.idbtrans&&k.idbtrans.abort(),Ke(P)})})),this.Version=(m=this,Zt(Ao.prototype,function(v){this.db=m,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Zt(li.prototype,function(v,I,b){if(this.db=g,this._ctx={table:v,index:I===":id"?null:I,or:b},this._cmp=this._ascending=xe,this._descending=function(T,S){return xe(S,T)},this._max=function(T,S){return 0<xe(T,S)?T:S},this._min=function(T,S){return xe(T,S)<0?T:S},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new le.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=rn(t.IDBKeyRange),this._createTransaction=function(v,I,b,T){return new n.Transaction(v,I,b,n._options.chromeTransactionDurability,T)},this._fireOnBlocked=function(v){n.on("blocked").fire(v),Vt.filter(function(I){return I.name===n.name&&I!==n&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(v)})},this.use(Mo),this.use(Fo),this.use(No),this.use(Ko),this.use(Ro);var E=new Proxy(this,{get:function(v,I,b){if(I==="_vip")return!0;if(I==="table")return function(S){return qn(n.table(S),E)};var T=Reflect.get(v,I,b);return T instanceof ii?qn(T,E):I==="tables"?T.map(function(S){return qn(S,E)}):I==="_createTransaction"?function(){return qn(T.apply(this,arguments),E)}:T}});this.vip=E,i.forEach(function(v){return v(n)})}var Fn,et=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Lo=(jr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},jr.prototype[et]=function(){return this},jr);function jr(e){this._subscribe=e}try{Fn={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Fn={indexedDB:null,IDBKeyRange:null}}function Ti(e){var t,n=!1,i=new Lo(function(s){var f=at(e),h,m=!1,g={},w={},E={get closed(){return m},unsubscribe:function(){m||(m=!0,h&&h.abort(),v&&mt.storagemutated.unsubscribe(b))}};s.start&&s.start(E);var v=!1,I=function(){return ur(T)},b=function(S){Mn(g,S),Er(w,g)&&I()},T=function(){var S,k,P;!m&&Fn.indexedDB&&(g={},S={},h&&h.abort(),h=new AbortController,P=function(D){var A=Ft();try{f&&Ut();var j=ft(e,D);return j=f?j.finally(dt):j}finally{A&&Lt()}}(k={subscr:S,signal:h.signal,requery:I,querier:e,trans:null}),Promise.resolve(P).then(function(D){n=!0,t=D,m||k.signal.aborted||(g={},function(A){for(var j in A)if(O(A,j))return;return 1}(w=S)||v||(mt(nn,b),v=!0),ur(function(){return!m&&s.next&&s.next(D)}))},function(D){n=!1,["DatabaseClosedError","AbortError"].includes(D==null?void 0:D.name)||m||ur(function(){m||s.error&&s.error(D)})}))};return setTimeout(I,0),E});return i.hasValue=function(){return n},i.getValue=function(){return t},i}var Rt=ut;function Kr(e){var t=vt;try{vt=!0,mt.storagemutated.fire(e),Cr(e,!0)}finally{vt=t}}y(Rt,o(o({},mn),{delete:function(e){return new Rt(e,{addons:[]}).delete()},exists:function(e){return new Rt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Rt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(kr(n)?Promise.resolve(n.databases()).then(function(i){return i.map(function(s){return s.name}).filter(function(s){return s!==Tn})}):wr(n,t).toCollection().primaryKeys()).then(e)}catch{return Ke(new le.MissingAPI)}var t,n},defineClass:function(){return function(e){_(this,e)}},ignoreTransaction:function(e){return ae.trans?Dt(ae.transless,e):e()},vip:xr,async:function(e){return function(){try{var t=Or(e.apply(this,arguments));return t&&typeof t.then=="function"?t:H.resolve(t)}catch(n){return Ke(n)}}},spawn:function(e,t,n){try{var i=Or(e.apply(n,t||[]));return i&&typeof i.then=="function"?i:H.resolve(i)}catch(s){return Ke(s)}},currentTransaction:{get:function(){return ae.trans||null}},waitFor:function(e,t){return t=H.resolve(typeof e=="function"?Rt.ignoreTransaction(e):e).timeout(t||6e4),ae.trans?ae.trans.waitFor(t):t},Promise:H,debug:{get:function(){return nt},set:function(e){Gr(e)}},derive:ce,extend:_,props:y,override:z,Events:Jt,on:mt,liveQuery:Ti,extendObservabilitySet:Mn,getByKeyPath:re,setByKeyPath:ne,delByKeyPath:function(e,t){typeof t=="string"?ne(e,t,void 0):"length"in t&&[].map.call(t,function(n){ne(e,n,void 0)})},shallowClone:ie,deepClone:Te,getObjectDiff:Pr,cmp:xe,asap:de,minKey:-1/0,addons:[],connections:Vt,errnames:Zn,dependencies:Fn,cache:Kt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Rt.maxKey=rn(Rt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(mt(nn,function(e){vt||(e=new CustomEvent(pr,{detail:e}),vt=!0,dispatchEvent(e),vt=!1)}),addEventListener(pr,function(e){e=e.detail,vt||Kr(e)}));var zt,vt=!1,Ei=function(){};return typeof BroadcastChannel<"u"&&((Ei=function(){(zt=new BroadcastChannel(pr)).onmessage=function(e){return e.data&&Kr(e.data)}})(),typeof zt.unref=="function"&&zt.unref(),mt(nn,function(e){vt||zt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!ut.disableBfCache&&e.persisted){nt&&console.debug("Dexie: handling persisted pagehide"),zt!=null&&zt.close();for(var t=0,n=Vt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ut.disableBfCache&&e.persisted&&(nt&&console.debug("Dexie: handling persisted pageshow"),Ei(),Kr({all:new He(-1/0,[[]])}))})),H.rejectionMapper=function(e,t){return!e||e instanceof tt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!zr[e.name]?e:(t=new zr[e.name](t||e.message,e),"stack"in e&&Z(t,"stack",{get:function(){return this.inner.stack}}),t)},Gr(nt),o(ut,Object.freeze({__proto__:null,Dexie:ut,liveQuery:Ti,Entity:ti,cmp:xe,PropModification:en,replacePrefix:function(e,t){return new en({replacePrefix:[e,t]})},add:function(e){return new en({add:e})},remove:function(e){return new en({remove:e})},default:ut,RangeSet:He,mergeRanges:sn,rangesOverlap:pi}),{default:ut}),ut})})(oo);var Jo=oo.exports;const Nr=Qo(Jo),Pi=Symbol.for("Dexie"),Xn=globalThis[Pi]||(globalThis[Pi]=Nr);if(Nr.semVer!==Xn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Nr.semVer} and ${Xn.semVer}`);const{liveQuery:rs,mergeRanges:is,rangesOverlap:os,RangeSet:as,cmp:ss,Entity:us,PropModification:ls,replacePrefix:cs,add:fs,remove:ds}=Xn;class Zo extends Xn{constructor(){super("MeditationGameDB");Si(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const ln=new Zo,cn=[{id:"L1",name:"Level 1",minDuration:Be.ONE_MINUTE,maxDuration:Be.FIVE_MINUTES,description:"Sit. Breathe. Notice the mind.",instructions:["Sit comfortably","Focus on the feeling of breath through your nose","Tap when you notice the mind has wandered","Gently return to the breath each time"],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:Be.TWO_MINUTES,maxDuration:Be.TEN_MINUTES,description:"Let go of counting and images.",instructions:["Focus on the breath through your nose","Donât count, visualize, or repeat words","Tap when your mind wanders","Return to the breath, without mental help"],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:Be.FIVE_MINUTES,maxDuration:Be.FIFTEEN_MINUTES,description:"Observe thoughts as they arise.",instructions:["Focus on the breath through your nose","Donât use any counting or mental images","Tap when distracted, then silently observe the thought","Label it if you can (e.g. âplanning,â âjudgingâ)","Let it go and return to the breath"],completionTasks:[{id:"two_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]},{id:"L4",name:"Level 4",minDuration:Be.FIVE_MINUTES,maxDuration:Be.FIFTEEN_MINUTES,description:"Notice how you react to yourself.",instructions:["Keep observing the breath","No counting or images","Tap when distracted, observe the thought","Then notice how you feel about getting distracted","If thereâs frustration or judgment, notice that too â and let it go"],completionTasks:[{id:"two_sessions_under_5_taps",description:"Have 2 sessions in a row with fewer than 5 taps"},{id:"one_min_no_taps_twice",description:"Go 1 minute without a tap in 2 separate sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions","max_duration"]}}]},{id:"L5",name:"Level 5",minDuration:Be.TEN_MINUTES,maxDuration:Be.THIRTY_MINUTES,description:"Everything changes. Keep observing.",instructions:["Keep observing breath and distractions","Tap when the mind wanders, observe the thought, notice your reaction","Then remember: everything changes â including this","Let the distraction and your reaction pass","Return to the breath with calm awareness"],completionTasks:[{id:"session_with_3_or_fewer_taps",description:"Have one session with 3 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"two_min_no_taps",description:"Go 2 minutes without tapping"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps","max_duration"]}}]},{id:"L6",name:"Level 6",minDuration:Be.FIFTEEN_MINUTES,maxDuration:Be.SIXTY_MINUTES,description:"Sit still. Stay with discomfort.",instructions:["Observe breath, distractions, and reactions as before","Sit still in your chosen posture for the full session","If discomfort arises, donât shift â just observe it","Notice the discomfort, let it change, and return to breath","Everything will pass"],completionTasks:[{id:"three_min_no_taps",description:"Go 3 minutes without a tap"},{id:"session_with_2_or_fewer_taps",description:"Have a session with 2 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"distractions_early_on",description:"Finish a sit with multiple distractions early on"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions","distractions_early_on","max_duration"]}}]}];function Di(u,r,a){const o=u.slice();return o[9]=r[a],o[11]=a,o}function Ai(u){let r,a,o=u[9]+"";return{c(){r=W("p"),a=new Go(!1),this.h()},l(c){r=G(c,"P",{class:!0,style:!0});var l=ue(r);a=zo(l,!1),l.forEach(R),this.h()},h(){a.a=null,N(r,"class","text-lg max-w-sm fade-in svelte-1quun7c"),yt(r,"animation-delay",u[11]+"s")},m(c,l){te(c,r,l),a.m(o,r)},p:Fe,d(c){c&&R(r)}}}function ea(u){let r,a,o,c,l,d,p,_,x,C,O,y=Mr[u[1]]+"",M,Z,ce,$=Qe(u[2]),F=[];for(let oe=0;oe<$.length;oe+=1)F[oe]=Ai(Di(u,$,oe));return{c(){r=W("div"),a=W("button"),o=J("Exit Meditation"),c=_e();for(let oe=0;oe<F.length;oe+=1)F[oe].c();l=_e(),d=W("div"),p=W("button"),_=J("Start meditation countdown"),x=_e(),C=W("i"),O=J("Meditating for "),M=J(y),this.h()},l(oe){r=G(oe,"DIV",{class:!0});var z=ue(r);a=G(z,"BUTTON",{class:!0,style:!0});var ee=ue(a);o=Q(ee,"Exit Meditation"),ee.forEach(R),c=ye(z);for(let ie=0;ie<F.length;ie+=1)F[ie].l(z);l=ye(z),d=G(z,"DIV",{class:!0});var de=ue(d);p=G(de,"BUTTON",{class:!0,style:!0});var re=ue(p);_=Q(re,"Start meditation countdown"),re.forEach(R),x=ye(de),C=G(de,"I",{class:!0,style:!0});var ne=ue(C);O=Q(ne,"Meditating for "),M=Q(ne,y),ne.forEach(R),de.forEach(R),z.forEach(R),this.h()},h(){N(a,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 fade-in svelte-1quun7c"),yt(a,"animation-delay",u[2].length+"s"),N(p,"class","btn variant-filled px-4 py-2 mt-8 fade-in svelte-1quun7c"),yt(p,"animation-delay",u[2].length+"s"),N(C,"class","text-sm text-gray-500 fade-in svelte-1quun7c"),yt(C,"animation-delay",u[2].length+"s"),N(d,"class","flex flex-col items-center space-y-4"),N(r,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(oe,z){te(oe,r,z),K(r,a),K(a,o),K(r,c);for(let ee=0;ee<F.length;ee+=1)F[ee]&&F[ee].m(r,null);K(r,l),K(r,d),K(d,p),K(p,_),K(d,x),K(d,C),K(C,O),K(C,M),Z||(ce=[lt(a,"click",u[3]),lt(p,"click",function(){Ho(u[0])&&u[0].apply(this,arguments)})],Z=!0)},p(oe,[z]){if(u=oe,z&4){$=Qe(u[2]);let ee;for(ee=0;ee<$.length;ee+=1){const de=Di(u,$,ee);F[ee]?F[ee].p(de,z):(F[ee]=Ai(de),F[ee].c(),F[ee].m(r,l))}for(;ee<F.length;ee+=1)F[ee].d(1);F.length=$.length}z&2&&y!==(y=Mr[u[1]]+"")&&Oe(M,y)},i:Fe,o:Fe,d(oe){oe&&R(r),Bt(F,oe),Z=!1,qr(ce)}}}function ta(u,r,a){let{nextStep:o}=r,{closeModal:c}=r,{duration:l}=r,{levelId:d="L1"}=r;const p=cn.find(y=>y.id===d),_=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],x=(p==null?void 0:p.instructions)||_;let C=0;Fr(()=>{je.capture("instructions_viewed",{level:d});const y=setInterval(()=>{C<x.length+1?C+=1:clearInterval(y)},1e3)});const O=()=>{je.capture("instructions_exit",{instructions_viewed:C,level:d}),c()};return u.$$set=y=>{"nextStep"in y&&a(0,o=y.nextStep),"closeModal"in y&&a(4,c=y.closeModal),"duration"in y&&a(1,l=y.duration),"levelId"in y&&a(5,d=y.levelId)},[o,l,x,O,c,d]}class na extends bt{constructor(r){super(),wt(this,r,ta,ea,gt,{nextStep:0,closeModal:4,duration:1,levelId:5})}}const ra=u=>{const r=u%60;return(u/60>1?`${Math.floor(u/60)}:`:"")+`${r<10?"0":""}${r}`};function Qn(u){const r=u/60;return Number.isInteger(r)?r:Math.round(r*10)/10}let Yn=null,Hn=null;const ji=`${Xo}/sounds/gong.mp4`;function Yr(){return Yn||(Yn=new(window.AudioContext||window.webkitAudioContext),je.capture("audio_context_created",{state:Yn.state,user_agent:navigator.userAgent})),Yn}async function ao(){try{const u=Yr();u.state==="suspended"&&(await u.resume(),je.capture("audio_context_resumed",{state:u.state,user_agent:navigator.userAgent}))}catch(u){je.capture("audio_context_resume_failed",{error:String(u),user_agent:navigator.userAgent})}}async function so(){if(Hn)return Hn;try{const u=Yr(),r=await fetch(ji),a=r.headers.get("Content-Type"),o=r.headers.get("Content-Length");je.capture("audio_fetch_response",{status:r.status,ok:r.ok,content_type:a,content_length:o,user_agent:navigator.userAgent});const c=await r.arrayBuffer();je.capture("audio_arraybuffer_fetched",{byte_length:c.byteLength,user_agent:navigator.userAgent});try{return Hn=await u.decodeAudioData(c),je.capture("audio_buffer_loaded",{buffer_byte_length:c.byteLength,user_agent:navigator.userAgent}),Hn}catch(l){throw je.capture("audio_buffer_decode_failed",{error:String(l),byte_length:c.byteLength,content_type:a,url:ji,user_agent:navigator.userAgent,language:navigator.language}),l}}catch(u){throw je.capture("audio_buffer_load_failed",{error:String(u),user_agent:navigator.userAgent}),u}}async function ia(){try{await ao(),await so(),je.capture("audio_preload_success",{user_agent:navigator.userAgent})}catch(u){je.capture("audio_preload_failed",{error:String(u),user_agent:navigator.userAgent})}}function oa(u){let r,a,o,c,l,d;return{c(){r=Vn("svg"),a=Vn("circle"),o=Vn("circle"),l=Vn("text"),d=J(u[1]),this.h()},l(p){r=Un(p,"svg",{class:!0,viewBox:!0});var _=ue(r);a=Un(_,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),ue(a).forEach(R),o=Un(_,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),ue(o).forEach(R),l=Un(_,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var x=ue(l);d=Q(x,u[1]),x.forEach(R),_.forEach(R),this.h()},h(){N(a,"cx","50"),N(a,"cy","50"),N(a,"r","40"),N(a,"stroke","gray"),N(a,"stroke-width","5"),N(a,"fill","none"),N(o,"cx","50"),N(o,"cy","50"),N(o,"r","40"),N(o,"stroke","blue"),N(o,"stroke-width","5"),N(o,"fill","none"),N(o,"stroke-dasharray","251.2"),N(o,"stroke-dashoffset",c=251.2*u[0]),N(o,"transform","rotate(-90 50 50)"),N(l,"x","50"),N(l,"y","55"),N(l,"font-size","14"),N(l,"text-anchor","middle"),N(l,"fill","black"),N(r,"class","w-32 h-32"),N(r,"viewBox","0 0 100 100")},m(p,_){te(p,r,_),K(r,a),K(r,o),K(r,l),K(l,d)},p(p,[_]){_&1&&c!==(c=251.2*p[0])&&N(o,"stroke-dashoffset",c),_&2&&Oe(d,p[1])},i:Fe,o:Fe,d(p){p&&R(r)}}}function aa(u,r,a){let o,c,{duration:l}=r,{startTimestamp:d}=r;const p=io();let _=Gn(l),x=null,C;const O=Ci(_,$=>ra($));Wn(u,O,$=>a(1,c=$));const y=Ci(_,$=>$/l);Wn(u,y,$=>a(0,o=$));const M=async()=>{try{const $=Yr();await ao();const F=await so(),oe=$.createBufferSource();oe.buffer=F,oe.connect($.destination),oe.start(0),je.capture("audio_played_successfully",{context_state:$.state,user_agent:navigator.userAgent})}catch($){je.capture("audio_play_failed",{error:String($),user_agent:navigator.userAgent,language:navigator.language})}},Z=()=>{clearInterval(C),M(),p("complete")},ce=async $=>{try{if(!("wakeLock"in navigator))return;$?x=await navigator.wakeLock.request("screen"):x&&(await x.release(),x=null)}catch(F){console.error(`Wake Lock ${$?"request":"release"} failed:`,F)}};return Fr(()=>{a(4,d=Date.now()),C=setInterval(()=>{_.update($=>$>0?$-1:(Z(),0))},1e3),ce(!0)}),Wo(()=>{clearInterval(C),ce(!1)}),u.$$set=$=>{"duration"in $&&a(5,l=$.duration),"startTimestamp"in $&&a(4,d=$.startTimestamp)},[o,c,O,y,d,l]}class uo extends bt{constructor(r){super(),wt(this,r,aa,oa,gt,{duration:5,startTimestamp:4})}}function sa(u){let r,a,o,c="Your meditation starts in:",l,d,p,_,x,C="Exit Meditation",O,y,M,Z;function ce(F){u[6](F)}let $={duration:ua};return u[0]!==void 0&&($.startTimestamp=u[0]),d=new uo({props:$}),Lr.push(()=>Vr(d,"startTimestamp",ce)),d.$on("complete",u[1]),{c(){r=W("div"),a=W("div"),o=W("p"),o.textContent=c,l=_e(),Et(d.$$.fragment),_=_e(),x=W("button"),x.textContent=C,this.h()},l(F){r=G(F,"DIV",{class:!0});var oe=ue(r);a=G(oe,"DIV",{class:!0});var z=ue(a);o=G(z,"P",{class:!0,"data-svelte-h":!0}),qe(o)!=="svelte-1tp8zka"&&(o.textContent=c),l=ye(z),Tt(d.$$.fragment,z),z.forEach(R),_=ye(oe),x=G(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(x)!=="svelte-hy6wnc"&&(x.textContent=C),oe.forEach(R),this.h()},h(){N(o,"class","text-lg mt-4 text-center"),N(a,"class","absolute flex flex-col items-center pointer-events-auto"),N(x,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(F,oe){te(F,r,oe),K(r,a),K(a,o),K(a,l),xt(d,a,null),K(r,_),K(r,x),y=!0,M||(Z=lt(x,"click",u[2]),M=!0)},p(F,[oe]){const z={};!p&&oe&1&&(p=!0,z.startTimestamp=F[0],Ur(()=>p=!1)),d.$set(z)},i(F){y||(Ne(d.$$.fragment,F),F&&_t(()=>{y&&(O||(O=We(x,$e,{},!0)),O.run(1))}),y=!0)},o(F){Ye(d.$$.fragment,F),F&&(O||(O=We(x,$e,{},!1)),O.run(0)),y=!1},d(F){F&&R(r),kt(d),F&&O&&O.end(),M=!1,Z()}}}const ua=10;function la(u,r,a){let{nextStep:o}=r,{closeModal:c}=r,{levelId:l="L1"}=r,d=0;je.capture("countdown_started",{level:l});const p=()=>{je.capture("countdown_complete",{level:l}),o()},_=()=>{je.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:l}),c()};function x(C){d=C,a(0,d)}return u.$$set=C=>{"nextStep"in C&&a(3,o=C.nextStep),"closeModal"in C&&a(4,c=C.closeModal),"levelId"in C&&a(5,l=C.levelId)},[d,p,_,o,c,l,x]}class ca extends bt{constructor(r){super(),wt(this,r,la,sa,gt,{nextStep:3,closeModal:4,levelId:5})}}function fa(u){let r,a;return{c(){r=W("br"),a=W("br")},l(o){r=G(o,"BR",{}),a=G(o,"BR",{})},m(o,c){te(o,r,c),te(o,a,c)},p:Fe,d(o){o&&(R(r),R(a))}}}function da(u){let r,a,o;return{c(){r=W("i"),a=J(u[2]),o=J(" distraction"),this.h()},l(c){r=G(c,"I",{class:!0});var l=ue(r);a=Q(l,u[2]),o=Q(l," distraction"),l.forEach(R),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(c,l){te(c,r,l),K(r,a),K(r,o)},p(c,l){l&4&&Oe(a,c[2])},d(c){c&&R(r)}}}function ha(u){let r,a,o;return{c(){r=W("i"),a=J(u[2]),o=J(" distractions"),this.h()},l(c){r=G(c,"I",{class:!0});var l=ue(r);a=Q(l,u[2]),o=Q(l," distractions"),l.forEach(R),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(c,l){te(c,r,l),K(r,a),K(r,o)},p(c,l){l&4&&Oe(a,c[2])},d(c){c&&R(r)}}}function Ki(u){let r;return{c(){r=W("div"),this.h()},l(a){r=G(a,"DIV",{class:!0,style:!0}),ue(r).forEach(R),this.h()},h(){N(r,"class","ripple svelte-1wv6db6"),yt(r,"top",u[3].y+"px"),yt(r,"left",u[3].x+"px")},m(a,o){te(a,r,o)},p(a,o){o&8&&yt(r,"top",a[3].y+"px"),o&8&&yt(r,"left",a[3].x+"px")},d(a){a&&R(r)}}}function pa(u){let r,a,o,c,l,d,p="Tap anywhere on the screen to record your distractions",_,x,C,O,y,M="Exit Meditation",Z,ce,$,F;function oe(ie){u[11](ie)}let z={duration:u[0]};u[1]!==void 0&&(z.startTimestamp=u[1]),o=new uo({props:z}),Lr.push(()=>Vr(o,"startTimestamp",oe)),o.$on("complete",u[8]);function ee(ie,Pe){return ie[2]>1||ie[2]==0?ha:ie[2]==1?da:fa}let de=ee(u),re=de(u),ne=u[3]&&Ki(u);return{c(){r=W("div"),a=W("div"),Et(o.$$.fragment),l=_e(),d=W("p"),d.textContent=p,_=_e(),re.c(),x=_e(),C=W("button"),ne&&ne.c(),O=_e(),y=W("button"),y.textContent=M,this.h()},l(ie){r=G(ie,"DIV",{class:!0});var Pe=ue(r);a=G(Pe,"DIV",{class:!0});var ve=ue(a);Tt(o.$$.fragment,ve),l=ye(ve),d=G(ve,"P",{class:!0,"data-svelte-h":!0}),qe(d)!=="svelte-1uyhl39"&&(d.textContent=p),_=ye(ve),re.l(ve),ve.forEach(R),x=ye(Pe),C=G(Pe,"BUTTON",{class:!0});var Le=ue(C);ne&&ne.l(Le),Le.forEach(R),O=ye(Pe),y=G(Pe,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(y)!=="svelte-hy6wnc"&&(y.textContent=M),Pe.forEach(R),this.h()},h(){N(d,"class","text-lg mt-4 text-center"),N(a,"class","absolute flex flex-col items-center pointer-events-auto p-6"),N(C,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),N(y,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(ie,Pe){te(ie,r,Pe),K(r,a),xt(o,a,null),K(a,l),K(a,d),K(a,_),re.m(a,null),K(r,x),K(r,C),ne&&ne.m(C,null),K(r,O),K(r,y),ce=!0,$||(F=[lt(C,"click",u[6]),lt(y,"click",u[7])],$=!0)},p(ie,[Pe]){const ve={};Pe&1&&(ve.duration=ie[0]),!c&&Pe&2&&(c=!0,ve.startTimestamp=ie[1],Ur(()=>c=!1)),o.$set(ve),de===(de=ee(ie))&&re?re.p(ie,Pe):(re.d(1),re=de(ie),re&&(re.c(),re.m(a,null))),ie[3]?ne?ne.p(ie,Pe):(ne=Ki(ie),ne.c(),ne.m(C,null)):ne&&(ne.d(1),ne=null)},i(ie){ce||(Ne(o.$$.fragment,ie),ie&&_t(()=>{ce&&(Z||(Z=We(y,$e,{},!0)),Z.run(1))}),ce=!0)},o(ie){Ye(o.$$.fragment,ie),ie&&(Z||(Z=We(y,$e,{},!1)),Z.run(0)),ce=!1},d(ie){ie&&R(r),kt(o),re.d(),ne&&ne.d(),ie&&Z&&Z.end(),$=!1,qr(F)}}}function ma(u,r,a){let o,c,{nextStep:l}=r,{duration:d}=r,{levelId:p="L1"}=r;const _=io();let x=0;const C=Gn(0);Wn(u,C,F=>a(2,o=F));const O=Gn([]),y=Gn(null);Wn(u,y,F=>a(3,c=F));const M=F=>{const oe=(Date.now()-x)/1e3;C.update(ne=>ne+1),O.update(ne=>[...ne,oe]),console.log(`Click ${Nt(C)} recorded at ${oe} seconds`),je.capture("game_tap",{timestamp:oe,total_taps:Nt(C),level:p,button:"distracted"});const{clientX:z,clientY:ee,currentTarget:de}=F,re=de.getBoundingClientRect();y.set({x:z-re.left,y:ee-re.top}),setTimeout(()=>y.set(null),600)},Z=()=>{const F=(Date.now()-x)/1e3;je.capture("meditation_exit",{duration_meditated:F,total_taps:Nt(O).length,level:p}),_("complete",{clickTimestamps:Nt(O),durationMeditated:F,completed:d-F<5}),l()},ce=()=>{console.log("Meditation complete! Click data:",Nt(O)),je.capture("meditation_completed",{duration:d,total_taps:Nt(O).length,level:p}),_("complete",{clickTimestamps:Nt(O),durationMeditated:d,completed:!0}),l()};function $(F){x=F,a(1,x)}return u.$$set=F=>{"nextStep"in F&&a(9,l=F.nextStep),"duration"in F&&a(0,d=F.duration),"levelId"in F&&a(10,p=F.levelId)},[d,x,o,c,C,y,M,Z,ce,l,p,$]}class va extends bt{constructor(r){super(),wt(this,r,ma,pa,gt,{nextStep:9,duration:0,levelId:10})}}function ya(u){const r=Math.floor(u.durationMeditated/60),a=u.clickTimestamps.length,o=u.newStarRating-u.previousStarRating,c="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share",l=u.levelId.replace(/^\D+/g,""),d=Object.entries(u.completionTaskResults).map(p=>p[1]?"â":"ð²").join("");return o>0?`Major win! ð§ââï¸  I just earned a new â­ in The Meditation Game!
I did a ${r}âmin meditation with only ${a} distractions.
I'm at ${"â­".repeat(u.newStarRating)} on Level ${l} (${d})!
Learn and practice meditation here: ${c}`:u.isNewPersonalBest?`Miniâwin in The Meditation Game: my new personal best!
${r}âmin sit â¢ only ${a} ${a===1?"mind-wander":"mind-wanders"} â¢ ${"â­".repeat(u.newStarRating)} on Level ${l} (${d})
Learn and practice meditation here: ${c}`:`Sharing todays practice in The Meditation Game.
I did a ${r}âmin meditation with only ${a} distractions.
I'm at ${"â­".repeat(u.newStarRating)} on Level ${l} (${d}).
Learn and practice meditation here: ${c}`}function _a(u){return u.newStarRating-u.previousStarRating>0?"A":u.isNewPersonalBest?"B":"C"}function lo(u){return u.filter(r=>r.completed).sort((r,a)=>a.duration!==r.duration?a.duration-r.duration:r.tapCount!==a.tapCount?r.tapCount-a.tapCount:a.timestamp-r.timestamp)[0]??null}function ga(u,r,a){const{scope:o,requirement:c}=u;return o==="cumulative"?Ri(c,r):a.some(l=>Ri(c,l))}function Ri(u,r){if(u.type==="minTasks"){const{count:a,from:o}=u;return o==="all"?r.size>=a:o.filter(l=>r.has(l)).length>=a}return u.type==="specificTasks"?u.taskIds.every(a=>r.has(a)):!1}function Br(u,r,a){const o=[...u].sort((c,l)=>l.stars-c.stars);for(const c of o)if(ga(c,r,a))return c.stars;return 0}function ba(u){if(u.length<2)return 0;const r=[...u].sort((o,c)=>o.timestamp-c.timestamp);let a=0;for(let o=1;o<r.length;o++){const c=r[o-1],l=r[o],d=c.tapCount/Math.max(c.duration,1),p=l.tapCount/Math.max(l.duration,1);(p<d||Math.abs(p-d)<=.005&&l.duration>c.duration)&&a++}return a}function zn(u){if(!u.tapTimestamps||u.tapTimestamps.length===0)return u.duration/60;const r=[];r.push(u.tapTimestamps[0]);for(let o=1;o<u.tapTimestamps.length;o++)r.push(u.tapTimestamps[o]-u.tapTimestamps[o-1]);const a=u.tapTimestamps[u.tapTimestamps.length-1];return r.push(u.duration-a),Math.max(...r)}const Mi=(u,r)=>u.filter(r).length,un=(u,r)=>u.some(r),ot={tap_once:([u])=>({completed:(u==null?void 0:u.tapCount)>=1,info:""}),no_early_exit:([u])=>({completed:(u==null?void 0:u.completed)===!0,info:""}),session_under_5_taps:([u])=>({completed:(u==null?void 0:u.tapCount)<=5,info:""}),session_with_2_or_fewer_taps:u=>({completed:un(u,r=>r.tapCount<=2),info:""}),session_with_3_or_fewer_taps:u=>({completed:un(u,r=>r.tapCount<=3),info:""}),distractions_early_on:([u])=>{var r;return{completed:((r=u==null?void 0:u.tapTimestamps)==null?void 0:r.filter(a=>a<=60).length)>=2,info:""}},complete_2_sessions:u=>({completed:u.length>=2,info:u.length===0||u.length>=2?"":"(1/2 complete)"}),complete_3_sessions:u=>({completed:u.length>=3,info:u.length===0||u.length>=3?"":`(${u.length}/3 complete)`}),two_sessions_under_5_taps:u=>{let r=0;for(let a=u.length-1;a>=0;a--)if(u[a].tapCount<5){if(r++,r===2)break}else r=0;return{completed:r===2,info:u.length===0||r===2?"":`(${Math.min(r,1)}/2 complete)`}},two_sessions_under_8_taps:u=>{const r=Mi(u,a=>a.tapCount<=8);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},one_min_no_taps:u=>({completed:un(u,r=>zn(r)>=60),info:""}),one_min_no_taps_twice:u=>{const r=Mi(u,a=>zn(a)>=60);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},two_min_no_taps:u=>({completed:un(u,r=>zn(r)>=120),info:""}),three_min_no_taps:u=>({completed:un(u,r=>zn(r)>=180),info:""}),improve_tap_count_2_sessions:u=>{const r=ba(u);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},max_duration:(u,r)=>({completed:u.some(a=>a.duration>=r.maxDuration),info:""})};async function Jn(u){const r=cn.find(c=>c.id===u);if(!r)return{};const a=await ln.sessions.where("levelId").equals(u).toArray(),o={};for(const c of r.completionTasks){const l=ot[c.id];if(!l){console.warn(`Missing evaluator for task '${c.id}' in level '${u}'`),o[c.id]={completed:!1};continue}o[c.id]={...c,...l(a,r)}}return o}async function wa(){var r;const u=[];for(let a=0;a<cn.length;a++){const o=cn[a],c=await ln.sessions.where("levelId").equals(o.id).toArray(),l=a===0||(((r=u[a-1])==null?void 0:r.starRating)??0)>1;let d=null,p,_=null;if(l){d=await Jn(o.id);const x=new Set(Object.entries(d).filter(([O,y])=>y.completed).map(([O])=>O)),C=c.map(O=>new Set(o.completionTasks.filter(y=>{var M;return(M=ot[y.id])==null?void 0:M.call(ot,[O],o).completed}).map(y=>y.id)));p=Br(o.starRules,x,C),_=lo(c)}u.push({level:o,isUnlocked:l,taskCompletion:d,starRating:p,bestSession:_})}return u}function Ni(u,r,a){const o=u.slice();return o[9]=r[a][0],o[10]=r[a][1],o}function Bi(u,r,a){const o=u.slice();return o[9]=r[a],o[14]=a,o}function qi(u){let r;function a(l,d){return l[0].newStarRating===3?xa:ka}let o=a(u),c=o(u);return{c(){r=W("p"),c.c(),this.h()},l(l){r=G(l,"P",{class:!0});var d=ue(r);c.l(d),d.forEach(R),this.h()},h(){N(r,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(l,d){te(l,r,d),c.m(r,null)},p(l,d){o===(o=a(l))&&c?c.p(l,d):(c.d(1),c=o(l),c&&(c.c(),c.m(r,null)))},d(l){l&&R(r),c.d()}}}function ka(u){let r,a=u[0].newStarRating-u[0].previousStarRating+"",o,c;return{c(){r=J("You earned +"),o=J(a),c=J(" â­ â keep going!")},l(l){r=Q(l,"You earned +"),o=Q(l,a),c=Q(l," â­ â keep going!")},m(l,d){te(l,r,d),te(l,o,d),te(l,c,d)},p(l,d){d&1&&a!==(a=l[0].newStarRating-l[0].previousStarRating+"")&&Oe(o,a)},d(l){l&&(R(r),R(o),R(c))}}}function xa(u){let r;return{c(){r=J("You've mastered this level! â¨")},l(a){r=Q(a,"You've mastered this level! â¨")},m(a,o){te(a,r,o)},p:Fe,d(a){a&&R(r)}}}function Fi(u){let r,a=u[14]<u[0].newStarRating?"â­":"â",o,c;return{c(){r=W("span"),o=J(a),c=_e(),this.h()},l(l){r=G(l,"SPAN",{class:!0});var d=ue(r);o=Q(d,a),c=ye(d),d.forEach(R),this.h()},h(){N(r,"class","text-xl")},m(l,d){te(l,r,d),K(r,o),K(r,c)},p(l,d){d&1&&a!==(a=l[14]<l[0].newStarRating?"â­":"â")&&Oe(o,a)},d(l){l&&R(r)}}}function Ta(u){let r,a="You completed your meditation distraction-free!";return{c(){r=W("p"),r.textContent=a,this.h()},l(o){r=G(o,"P",{class:!0,"data-svelte-h":!0}),qe(r)!=="svelte-j87uf1"&&(r.textContent=a),this.h()},h(){N(r,"class","text-lg mt-4")},m(o,c){te(o,r,c)},p:Fe,d(o){o&&R(r)}}}function Ea(u){let r,a,o,c,l,d=Number(u[3])===1?"":"s",p,_;function x(y,M){return y[0].isNewPersonalBest&&y[0].personalBest?Ia:Sa}let C=x(u),O=C(u);return{c(){O.c(),r=_e(),a=W("p"),o=J("That's about "),c=J(u[3]),l=J(" distraction"),p=J(d),_=J(" per minute."),this.h()},l(y){O.l(y),r=ye(y),a=G(y,"P",{class:!0});var M=ue(a);o=Q(M,"That's about "),c=Q(M,u[3]),l=Q(M," distraction"),p=Q(M,d),_=Q(M," per minute."),M.forEach(R),this.h()},h(){N(a,"class","text-lg mt-2")},m(y,M){O.m(y,M),te(y,r,M),te(y,a,M),K(a,o),K(a,c),K(a,l),K(a,p),K(a,_)},p(y,M){C===(C=x(y))&&O?O.p(y,M):(O.d(1),O=C(y),O&&(O.c(),O.m(r.parentNode,r)))},d(y){y&&(R(r),R(a)),O.d(y)}}}function Sa(u){let r,a,o=u[4](u[0].durationMeditated)+"",c,l,d,p,_=u[2]===1?"":"s",x,C;return{c(){r=W("p"),a=J("You meditated for "),c=J(o),l=J(" and recorded "),d=J(u[2]),p=J(" distraction"),x=J(_),C=J("."),this.h()},l(O){r=G(O,"P",{class:!0});var y=ue(r);a=Q(y,"You meditated for "),c=Q(y,o),l=Q(y," and recorded "),d=Q(y,u[2]),p=Q(y," distraction"),x=Q(y,_),C=Q(y,"."),y.forEach(R),this.h()},h(){N(r,"class","text-lg mt-4")},m(O,y){te(O,r,y),K(r,a),K(r,c),K(r,l),K(r,d),K(r,p),K(r,x),K(r,C)},p(O,y){y&1&&o!==(o=O[4](O[0].durationMeditated)+"")&&Oe(c,o)},d(O){O&&R(r)}}}function Ia(u){let r,a,o,c,l=u[2]?"":"s",d,p,_=u[4](u[0].durationMeditated)+"",x,C;return{c(){r=W("p"),a=J("New personal best ð â "),o=J(u[2]),c=J(" tap"),d=J(l),p=J(" over "),x=J(_),C=J("."),this.h()},l(O){r=G(O,"P",{class:!0});var y=ue(r);a=Q(y,"New personal best ð â "),o=Q(y,u[2]),c=Q(y," tap"),d=Q(y,l),p=Q(y," over "),x=Q(y,_),C=Q(y,"."),y.forEach(R),this.h()},h(){N(r,"class","text-lg mt-4 text-green-600")},m(O,y){te(O,r,y),K(r,a),K(r,o),K(r,c),K(r,d),K(r,p),K(r,x),K(r,C)},p(O,y){y&1&&_!==(_=O[4](O[0].durationMeditated)+"")&&Oe(x,_)},d(O){O&&R(r)}}}function Li(u){let r,a,o=u[0].personalBest.tapCount+"",c,l,d=Qn(u[0].personalBest.duration)+"",p,_;return{c(){r=W("p"),a=J("Best so far: "),c=J(o),l=J(" taps Â· "),p=J(d),_=J(" min."),this.h()},l(x){r=G(x,"P",{class:!0});var C=ue(r);a=Q(C,"Best so far: "),c=Q(C,o),l=Q(C," taps Â· "),p=Q(C,d),_=Q(C," min."),C.forEach(R),this.h()},h(){N(r,"class","mt-4 text-muted-foreground")},m(x,C){te(x,r,C),K(r,a),K(r,c),K(r,l),K(r,p),K(r,_)},p(x,C){C&1&&o!==(o=x[0].personalBest.tapCount+"")&&Oe(c,o),C&1&&d!==(d=Qn(x[0].personalBest.duration)+"")&&Oe(p,d)},d(x){x&&R(r)}}}function Ui(u){let r,a,o=u[0].newlyCompletedTasks.length>0&&Vi(u),c=Qe(Object.entries(u[1])),l=[];for(let d=0;d<c.length;d+=1)l[d]=Yi(Ni(u,c,d));return{c(){o&&o.c(),r=_e(),a=W("ul");for(let d=0;d<l.length;d+=1)l[d].c();this.h()},l(d){o&&o.l(d),r=ye(d),a=G(d,"UL",{class:!0});var p=ue(a);for(let _=0;_<l.length;_+=1)l[_].l(p);p.forEach(R),this.h()},h(){N(a,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto")},m(d,p){o&&o.m(d,p),te(d,r,p),te(d,a,p);for(let _=0;_<l.length;_+=1)l[_]&&l[_].m(a,null)},p(d,p){if(d[0].newlyCompletedTasks.length>0?o?o.p(d,p):(o=Vi(d),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null),p&3){c=Qe(Object.entries(d[1]));let _;for(_=0;_<c.length;_+=1){const x=Ni(d,c,_);l[_]?l[_].p(x,p):(l[_]=Yi(x),l[_].c(),l[_].m(a,null))}for(;_<l.length;_+=1)l[_].d(1);l.length=c.length}},d(d){d&&(R(r),R(a)),o&&o.d(d),Bt(l,d)}}}function Vi(u){let r,a,o=u[0].newlyCompletedTasks.length+"",c,l,d=u[0].newlyCompletedTasks.length===1?"":"s",p,_;return{c(){r=W("p"),a=J("Nice! You just completed "),c=J(o),l=J(" new task"),p=J(d),_=J("."),this.h()},l(x){r=G(x,"P",{class:!0});var C=ue(r);a=Q(C,"Nice! You just completed "),c=Q(C,o),l=Q(C," new task"),p=Q(C,d),_=Q(C,"."),C.forEach(R),this.h()},h(){N(r,"class","mt-2 text-sm text-accent-foreground")},m(x,C){te(x,r,C),K(r,a),K(r,c),K(r,l),K(r,p),K(r,_)},p(x,C){C&1&&o!==(o=x[0].newlyCompletedTasks.length+"")&&Oe(c,o),C&1&&d!==(d=x[0].newlyCompletedTasks.length===1?"":"s")&&Oe(p,d)},d(x){x&&R(r)}}}function Ca(u){let r,a=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){r=J("ð² "),o=J(a),c=_e(),d=J(l)},l(p){r=Q(p,"ð² "),o=Q(p,a),c=ye(p),d=Q(p,l)},m(p,_){te(p,r,_),te(p,o,_),te(p,c,_),te(p,d,_)},p(p,_){_&2&&a!==(a=p[10].description+"")&&Oe(o,a),_&2&&l!==(l=p[10].info+"")&&Oe(d,l)},d(p){p&&(R(r),R(o),R(c),R(d))}}}function Oa(u){let r,a=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){r=J("â "),o=J(a),c=_e(),d=J(l)},l(p){r=Q(p,"â "),o=Q(p,a),c=ye(p),d=Q(p,l)},m(p,_){te(p,r,_),te(p,o,_),te(p,c,_),te(p,d,_)},p(p,_){_&2&&a!==(a=p[10].description+"")&&Oe(o,a),_&2&&l!==(l=p[10].info+"")&&Oe(d,l)},d(p){p&&(R(r),R(o),R(c),R(d))}}}function Pa(u){let r,a=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){r=J("â ðð "),o=J(a),c=_e(),d=J(l)},l(p){r=Q(p,"â ðð "),o=Q(p,a),c=ye(p),d=Q(p,l)},m(p,_){te(p,r,_),te(p,o,_),te(p,c,_),te(p,d,_)},p(p,_){_&2&&a!==(a=p[10].description+"")&&Oe(o,a),_&2&&l!==(l=p[10].info+"")&&Oe(d,l)},d(p){p&&(R(r),R(o),R(c),R(d))}}}function Yi(u){let r,a,o,c;function l(...x){return u[8](u[10],...x)}function d(x,C){return C&3&&(o=null),o==null&&(o=!!x[0].newlyCompletedTasks.some(l)),o?Pa:x[10].completed?Oa:Ca}let p=d(u,-1),_=p(u);return{c(){r=W("li"),a=W("span"),_.c(),c=_e(),this.h()},l(x){r=G(x,"LI",{class:!0});var C=ue(r);a=G(C,"SPAN",{class:!0});var O=ue(a);_.l(O),O.forEach(R),c=ye(C),C.forEach(R),this.h()},h(){N(a,"class","mr-2"),N(r,"class","flex items-center")},m(x,C){te(x,r,C),K(r,a),_.m(a,null),K(r,c)},p(x,C){u=x,p===(p=d(u,C))&&_?_.p(u,C):(_.d(1),_=p(u),_&&(_.c(),_.m(a,null)))},d(x){x&&R(r),_.d()}}}function Da(u){let r,a,o="Great practice!",c,l,d,p,_,x,C,O="Level tasks",y,M,Z,ce,$="Share",F,oe,z,ee="Exit",de,re,ne=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org â</a></p>`,ie,Pe,ve=u[0].newStarRating>u[0].previousStarRating&&qi(u),Le=Qe(Array(3)),se=[];for(let fe=0;fe<Le.length;fe+=1)se[fe]=Fi(Bi(u,Le,fe));function Te(fe,ke){return fe[0].clickTimestamps.length>0?Ea:Ta}let Me=Te(u),Ae=Me(u),he=u[0].personalBest&&!u[0].isNewPersonalBest&&Li(u),we=u[1]&&Ui(u);return{c(){r=W("div"),a=W("h2"),a.textContent=o,c=_e(),ve&&ve.c(),l=_e(),d=W("div");for(let fe=0;fe<se.length;fe+=1)se[fe].c();p=_e(),Ae.c(),_=_e(),he&&he.c(),x=_e(),C=W("h3"),C.textContent=O,y=_e(),we&&we.c(),M=_e(),Z=W("div"),ce=W("button"),ce.textContent=$,F=_e(),oe=W("div"),z=W("button"),z.textContent=ee,de=_e(),re=W("div"),re.innerHTML=ne,this.h()},l(fe){r=G(fe,"DIV",{class:!0});var ke=ue(r);a=G(ke,"H2",{class:!0,"data-svelte-h":!0}),qe(a)!=="svelte-1untj5h"&&(a.textContent=o),c=ye(ke),ve&&ve.l(ke),l=ye(ke),d=G(ke,"DIV",{class:!0});var Se=ue(d);for(let tt=0;tt<se.length;tt+=1)se[tt].l(Se);Se.forEach(R),p=ye(ke),Ae.l(ke),_=ye(ke),he&&he.l(ke),x=ye(ke),C=G(ke,"H3",{class:!0,"data-svelte-h":!0}),qe(C)!=="svelte-8ylw1a"&&(C.textContent=O),y=ye(ke),we&&we.l(ke),M=ye(ke),Z=G(ke,"DIV",{class:!0});var at=ue(Z);ce=G(at,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(ce)!=="svelte-1wlydhx"&&(ce.textContent=$),at.forEach(R),F=ye(ke),oe=G(ke,"DIV",{class:!0});var hn=ue(oe);z=G(hn,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(z)!=="svelte-1t5v3tb"&&(z.textContent=ee),hn.forEach(R),de=ye(ke),re=G(ke,"DIV",{class:!0,"data-svelte-h":!0}),qe(re)!=="svelte-oheyom"&&(re.innerHTML=ne),ke.forEach(R),this.h()},h(){N(a,"class","text-2xl font-bold"),N(d,"class","mt-2 flex items-center space-x-1"),N(C,"class","mt-6 font-semibold"),N(ce,"class","btn variant-filled px-4 py-2"),N(Z,"class","mt-6 flex space-x-4"),N(z,"class","btn variant-outlined px-4 py-2"),N(oe,"class","mt-6 flex space-x-4"),N(re,"class","absolute bottom-6 text-center text-sm text-gray-500"),N(r,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(fe,ke){te(fe,r,ke),K(r,a),K(r,c),ve&&ve.m(r,null),K(r,l),K(r,d);for(let Se=0;Se<se.length;Se+=1)se[Se]&&se[Se].m(d,null);K(r,p),Ae.m(r,null),K(r,_),he&&he.m(r,null),K(r,x),K(r,C),K(r,y),we&&we.m(r,null),K(r,M),K(r,Z),K(Z,ce),K(r,F),K(r,oe),K(oe,z),K(r,de),K(r,re),ie||(Pe=[lt(ce,"click",u[5]),lt(z,"click",u[6])],ie=!0)},p(fe,[ke]){if(fe[0].newStarRating>fe[0].previousStarRating?ve?ve.p(fe,ke):(ve=qi(fe),ve.c(),ve.m(r,l)):ve&&(ve.d(1),ve=null),ke&1){Le=Qe(Array(3));let Se;for(Se=0;Se<Le.length;Se+=1){const at=Bi(fe,Le,Se);se[Se]?se[Se].p(at,ke):(se[Se]=Fi(at),se[Se].c(),se[Se].m(d,null))}for(;Se<se.length;Se+=1)se[Se].d(1);se.length=Le.length}Me===(Me=Te(fe))&&Ae?Ae.p(fe,ke):(Ae.d(1),Ae=Me(fe),Ae&&(Ae.c(),Ae.m(r,_))),fe[0].personalBest&&!fe[0].isNewPersonalBest?he?he.p(fe,ke):(he=Li(fe),he.c(),he.m(r,x)):he&&(he.d(1),he=null),fe[1]?we?we.p(fe,ke):(we=Ui(fe),we.c(),we.m(r,M)):we&&(we.d(1),we=null)},i:Fe,o:Fe,d(fe){fe&&R(r),ve&&ve.d(),Bt(se,fe),Ae.d(),he&&he.d(),we&&we.d(),ie=!1,qr(Pe)}}}function Aa(u,r,a){let{closeModal:o}=r,{meditationResults:c}=r;const l=c.clickTimestamps.length,d=l>0?(l/(c.durationMeditated/60)).toFixed(1):"0";let p={};Fr(async()=>{c!=null&&c.levelId&&a(1,p=await Jn(c.levelId))});const _=y=>{const M=Math.floor(y/60),Z=Math.round(y%60*100)/100;return M===0?Z+" second"+(Z===1?"":"s"):M+" minute"+(M===1?"":"s")+(Z>0?" and "+Z+" second"+(Z===1?"":"s"):"")},x=()=>{if(navigator.share){const y=c.newStarRating-c.previousStarRating,M=_a(c);je.capture("results_shared",{total_taps:l,distractionRate:d,level:c.levelId,stars_gained:y,tasks_completed:c.newlyCompletedTasks.length,template_used:M,personal_best:c.isNewPersonalBest});const Z=ya(c);navigator.share({text:Z}).catch(ce=>console.error("Sharing failed",ce))}else console.log("Web Share API not supported")},C=()=>{je.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:c.newStarRating-c.previousStarRating,tasks_completed:c.newlyCompletedTasks.length}),o()},O=(y,M)=>M===y.id;return u.$$set=y=>{"closeModal"in y&&a(7,o=y.closeModal),"meditationResults"in y&&a(0,c=y.meditationResults)},[c,p,l,d,_,x,C,o,O]}class ja extends bt{constructor(r){super(),wt(this,r,Aa,Da,gt,{closeModal:7,meditationResults:0})}}function Hi(u){let r,a,o,c,l,d,p;const _=[Na,Ma,Ra,Ka],x=[];function C(O,y){return O[3]===1?0:O[3]===2?1:O[3]===3?2:3}return o=C(u),c=x[o]=_[o](u),{c(){r=W("div"),a=W("div"),c.c(),this.h()},l(O){r=G(O,"DIV",{class:!0});var y=ue(r);a=G(y,"DIV",{class:!0});var M=ue(a);c.l(M),M.forEach(R),y.forEach(R),this.h()},h(){N(a,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),N(r,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(O,y){te(O,r,y),K(r,a),x[o].m(a,null),p=!0},p(O,y){let M=o;o=C(O),o===M?x[o].p(O,y):(fn(),Ye(x[M],1,1,()=>{x[M]=null}),dn(),c=x[o],c?c.p(O,y):(c=x[o]=_[o](O),c.c()),Ne(c,1),c.m(a,null))},i(O){p||(Ne(c),O&&_t(()=>{p&&(l||(l=We(a,$e,{duration:500},!0)),l.run(1))}),O&&_t(()=>{p&&(d||(d=We(r,$e,{duration:500},!0)),d.run(1))}),p=!0)},o(O){Ye(c),O&&(l||(l=We(a,$e,{duration:500},!1)),l.run(0)),O&&(d||(d=We(r,$e,{duration:500},!1)),d.run(0)),p=!1},d(O){O&&R(r),x[o].d(),O&&l&&l.end(),O&&d&&d.end()}}}function Ka(u){let r,a,o,c;return a=new ja({props:{closeModal:u[5],meditationResults:u[4]}}),{c(){r=W("div"),Et(a.$$.fragment),this.h()},l(l){r=G(l,"DIV",{class:!0});var d=ue(r);Tt(a.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,r,d),xt(a,r,null),c=!0},p(l,d){const p={};d&16&&(p.meditationResults=l[4]),a.$set(p)},i(l){c||(Ne(a.$$.fragment,l),l&&_t(()=>{c&&(o||(o=We(r,$e,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ye(a.$$.fragment,l),l&&(o||(o=We(r,$e,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&R(r),kt(a),l&&o&&o.end()}}}function Ra(u){let r,a,o,c;return a=new va({props:{duration:u[1],nextStep:u[7],levelId:u[2]}}),a.$on("complete",u[8]),{c(){r=W("div"),Et(a.$$.fragment),this.h()},l(l){r=G(l,"DIV",{class:!0});var d=ue(r);Tt(a.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,r,d),xt(a,r,null),c=!0},p(l,d){const p={};d&2&&(p.duration=l[1]),d&4&&(p.levelId=l[2]),a.$set(p)},i(l){c||(Ne(a.$$.fragment,l),l&&_t(()=>{c&&(o||(o=We(r,$e,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ye(a.$$.fragment,l),l&&(o||(o=We(r,$e,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&R(r),kt(a),l&&o&&o.end()}}}function Ma(u){let r,a,o,c;return a=new ca({props:{nextStep:u[7],closeModal:u[5],levelId:u[2]}}),{c(){r=W("div"),Et(a.$$.fragment),this.h()},l(l){r=G(l,"DIV",{class:!0});var d=ue(r);Tt(a.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,r,d),xt(a,r,null),c=!0},p(l,d){const p={};d&4&&(p.levelId=l[2]),a.$set(p)},i(l){c||(Ne(a.$$.fragment,l),l&&_t(()=>{c&&(o||(o=We(r,$e,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ye(a.$$.fragment,l),l&&(o||(o=We(r,$e,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&R(r),kt(a),l&&o&&o.end()}}}function Na(u){let r,a,o,c;return a=new na({props:{nextStep:u[7],duration:u[1],closeModal:u[5],levelId:u[2]}}),{c(){r=W("div"),Et(a.$$.fragment),this.h()},l(l){r=G(l,"DIV",{class:!0});var d=ue(r);Tt(a.$$.fragment,d),d.forEach(R),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){te(l,r,d),xt(a,r,null),c=!0},p(l,d){const p={};d&2&&(p.duration=l[1]),d&4&&(p.levelId=l[2]),a.$set(p)},i(l){c||(Ne(a.$$.fragment,l),l&&_t(()=>{c&&(o||(o=We(r,$e,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ye(a.$$.fragment,l),l&&(o||(o=We(r,$e,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&R(r),kt(a),l&&o&&o.end()}}}function Ba(u){let r,a,o=u[0]&&Hi(u);return{c(){o&&o.c(),r=$n()},l(c){o&&o.l(c),r=$n()},m(c,l){o&&o.m(c,l),te(c,r,l),a=!0},p(c,[l]){c[0]?o?(o.p(c,l),l&1&&Ne(o,1)):(o=Hi(c),o.c(),Ne(o,1),o.m(r.parentNode,r)):o&&(fn(),Ye(o,1,1,()=>{o=null}),dn())},i(c){a||(Ne(o),a=!0)},o(c){Ye(o),a=!1},d(c){c&&R(r),o&&o.d(c)}}}function qa(u,r,a){let{show:o=!1}=r,{duration:c=Be.ONE_MINUTE}=r,{levelId:l=null}=r,d=1,p;const _=()=>{a(0,o=!1),a(3,d=1)},x=async y=>{const{clickTimestamps:M,durationMeditated:Z,completed:ce}=y.detail,$=l||"L1",F=cn.find(he=>he.id===$);if(!F)return;const oe=await ln.sessions.where("levelId").equals($).toArray(),z=await Jn($),ee=new Set(Object.entries(z).filter(([he,we])=>we.completed).map(([he])=>he)),de=oe.map(he=>new Set(F.completionTasks.filter(we=>{var fe;return(fe=ot[we.id])==null?void 0:fe.call(ot,[he],F).completed}).map(we=>we.id))),re=Br(F.starRules,ee,de),ne={levelId:$,duration:Z,tapCount:M.length,tapTimestamps:M,timestamp:Date.now(),completed:ce};await ln.sessions.add(ne);const ie=await Jn($),Pe=new Set(Object.entries(ie).filter(([he,we])=>we.completed).map(([he])=>he)),ve=Object.entries(ie).filter(([he,we])=>{var fe;return we.completed&&!((fe=z[he])!=null&&fe.completed)}).map(([he])=>he),Le=await ln.sessions.where("levelId").equals($).toArray(),se=Le.map(he=>new Set(F.completionTasks.filter(we=>{var fe;return(fe=ot[we.id])==null?void 0:fe.call(ot,[he],F).completed}).map(we=>we.id))),Te=Br(F.starRules,Pe,se),Me=lo(Le),Ae=Me&&Me.tapCount===M.length&&Me.duration===Z;a(4,p={...y.detail,levelId:$,previousStarRating:re,newStarRating:Te,newlyCompletedTasks:ve,completionTaskResults:Object.fromEntries(Object.entries(ie).map(([he,we])=>[he,we.completed])),isNewPersonalBest:Ae||!1,personalBest:Me}),C()},C=()=>setTimeout(()=>a(3,d++,d),300),O=y=>x(y);return u.$$set=y=>{"show"in y&&a(0,o=y.show),"duration"in y&&a(1,c=y.duration),"levelId"in y&&a(2,l=y.levelId)},[o,c,l,d,p,_,x,C,O]}class Fa extends bt{constructor(r){super(),wt(this,r,qa,Ba,gt,{show:0,duration:1,levelId:2})}}function zi(u,r,a){const o=u.slice();return o[6]=r[a],o}function Gi(u){let r,a=Mr[u[6]]+"",o;return{c(){r=W("option"),o=J(a),this.h()},l(c){r=G(c,"OPTION",{});var l=ue(r);o=Q(l,a),l.forEach(R),this.h()},h(){r.__value=u[6],$o(r,r.__value)},m(c,l){te(c,r,l),K(r,o)},p:Fe,d(c){c&&R(r)}}}function La(u){let r,a,o="Select Meditation Duration",c,l,d,p,_=Qe(u[2]),x=[];for(let C=0;C<_.length;C+=1)x[C]=Gi(zi(u,_,C));return{c(){r=W("div"),a=W("label"),a.textContent=o,c=_e(),l=W("select");for(let C=0;C<x.length;C+=1)x[C].c();this.h()},l(C){r=G(C,"DIV",{class:!0});var O=ue(r);a=G(O,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),qe(a)!=="svelte-g1prfd"&&(a.textContent=o),c=ye(O),l=G(O,"SELECT",{id:!0,class:!0});var y=ue(l);for(let M=0;M<x.length;M+=1)x[M].l(y);y.forEach(R),O.forEach(R),this.h()},h(){N(a,"for","duration"),N(a,"class","text-md font-medium"),N(l,"id","duration"),N(l,"class","select select-bordered w-full max-w-xs"),N(r,"class","flex flex-col items-start gap-1")},m(C,O){te(C,r,O),K(r,a),K(r,c),K(r,l);for(let y=0;y<x.length;y+=1)x[y]&&x[y].m(l,null);Ii(l,u[1]),d||(p=lt(l,"change",u[5]),d=!0)},p(C,[O]){if(O&4){_=Qe(C[2]);let y;for(y=0;y<_.length;y+=1){const M=zi(C,_,y);x[y]?x[y].p(M,O):(x[y]=Gi(M),x[y].c(),x[y].m(l,null))}for(;y<x.length;y+=1)x[y].d(1);x.length=_.length}O&6&&Ii(l,C[1])},i:Fe,o:Fe,d(C){C&&R(r),Bt(x,C),d=!1,p()}}}function Ua(u,r,a){let{onDurationChange:o}=r,{minDuration:c=Be.ONE_MINUTE}=r,{maxDuration:l=Be.SIXTY_MINUTES}=r,{selectedDuration:d=c??Be.ONE_MINUTE}=r;const p=Object.values(Be).filter(x=>typeof x=="number").filter(x=>x>=c&&x<=l),_=x=>o(Number(x.currentTarget.value));return u.$$set=x=>{"onDurationChange"in x&&a(0,o=x.onDurationChange),"minDuration"in x&&a(3,c=x.minDuration),"maxDuration"in x&&a(4,l=x.maxDuration),"selectedDuration"in x&&a(1,d=x.selectedDuration)},[o,d,p,c,l,_]}class Va extends bt{constructor(r){super(),wt(this,r,Ua,La,gt,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Wi(u,r,a){const o=u.slice();return o[9]=r[a].level,o[10]=r[a].isUnlocked,o[11]=r[a].taskCompletion,o[12]=r[a].starRating,o[13]=r[a].bestSession,o[14]=r,o[15]=a,o}function $i(u,r,a){const o=u.slice();return o[16]=r[a][0],o[17]=r[a][1],o}function Xi(u,r,a){const o=u.slice();return o[16]=r[a],o[21]=a,o}function Ya(u){let r,a,o=Qe(u[3]),c=[];for(let d=0;d<o.length;d+=1)c[d]=ro(Wi(u,o,d));const l=d=>Ye(c[d],1,1,()=>{c[d]=null});return{c(){r=W("div");for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){r=G(d,"DIV",{class:!0});var p=ue(r);for(let _=0;_<c.length;_+=1)c[_].l(p);p.forEach(R),this.h()},h(){N(r,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full")},m(d,p){te(d,r,p);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(r,null);a=!0},p(d,p){if(p&46){o=Qe(d[3]);let _;for(_=0;_<o.length;_+=1){const x=Wi(d,o,_);c[_]?(c[_].p(x,p),Ne(c[_],1)):(c[_]=ro(x),c[_].c(),Ne(c[_],1),c[_].m(r,null))}for(fn(),_=o.length;_<c.length;_+=1)l(_);dn()}},i(d){if(!a){for(let p=0;p<o.length;p+=1)Ne(c[p]);a=!0}},o(d){c=c.filter(Boolean);for(let p=0;p<c.length;p+=1)Ye(c[p]);a=!1},d(d){d&&R(r),Bt(c,d)}}}function Ha(u){let r,a='<div class="loading loading-spinner loading-lg"></div>';return{c(){r=W("div"),r.innerHTML=a,this.h()},l(o){r=G(o,"DIV",{class:!0,"data-svelte-h":!0}),qe(r)!=="svelte-1mgfhb9"&&(r.innerHTML=a),this.h()},h(){N(r,"class","flex justify-center items-center mt-8")},m(o,c){te(o,r,c)},p:Fe,i:Fe,o:Fe,d(o){o&&R(r)}}}function Qi(u){let r,a="ð";return{c(){r=W("span"),r.textContent=a,this.h()},l(o){r=G(o,"SPAN",{class:!0,"data-svelte-h":!0}),qe(r)!=="svelte-19hy9gc"&&(r.textContent=a),this.h()},h(){N(r,"class","text-2xl")},m(o,c){te(o,r,c)},d(o){o&&R(r)}}}function Ji(u){let r,a=Qe(Array(3)),o=[];for(let c=0;c<a.length;c+=1)o[c]=Zi(Xi(u,a,c));return{c(){r=W("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r=G(c,"DIV",{class:!0});var l=ue(r);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(R),this.h()},h(){N(r,"class","flex items-center")},m(c,l){te(c,r,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(c,l){if(l&8){a=Qe(Array(3));let d;for(d=0;d<a.length;d+=1){const p=Xi(c,a,d);o[d]?o[d].p(p,l):(o[d]=Zi(p),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=a.length}},d(c){c&&R(r),Bt(o,c)}}}function za(u){let r,a="â";return{c(){r=W("span"),r.textContent=a,this.h()},l(o){r=G(o,"SPAN",{class:!0,"data-svelte-h":!0}),qe(r)!=="svelte-1tpxw7h"&&(r.textContent=a),this.h()},h(){N(r,"class","text-2xl text-gray-300")},m(o,c){te(o,r,c)},d(o){o&&R(r)}}}function Ga(u){let r,a="â­";return{c(){r=W("span"),r.textContent=a,this.h()},l(o){r=G(o,"SPAN",{class:!0,"data-svelte-h":!0}),qe(r)!=="svelte-1jlkvsx"&&(r.textContent=a),this.h()},h(){N(r,"class","text-2xl")},m(o,c){te(o,r,c)},d(o){o&&R(r)}}}function Zi(u){let r;function a(l,d){return l[21]<l[12]?Ga:za}let o=a(u),c=o(u);return{c(){c.c(),r=$n()},l(l){c.l(l),r=$n()},m(l,d){c.m(l,d),te(l,r,d)},p(l,d){o!==(o=a(l))&&(c.d(1),c=o(l),c&&(c.c(),c.m(r.parentNode,r)))},d(l){l&&R(r),c.d(l)}}}function eo(u){let r,a,o=u[13].tapCount+"",c,l,d=Qn(u[13].duration)+"",p,_;return{c(){r=W("p"),a=J("Your best: "),c=J(o),l=J(" taps Â· "),p=J(d),_=J(" min"),this.h()},l(x){r=G(x,"P",{class:!0});var C=ue(r);a=Q(C,"Your best: "),c=Q(C,o),l=Q(C," taps Â· "),p=Q(C,d),_=Q(C," min"),C.forEach(R),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(x,C){te(x,r,C),K(r,a),K(r,c),K(r,l),K(r,p),K(r,_)},p(x,C){C&8&&o!==(o=x[13].tapCount+"")&&Oe(c,o),C&8&&d!==(d=Qn(x[13].duration)+"")&&Oe(p,d)},d(x){x&&R(r)}}}function to(u){let r,a=Qe(Object.entries(u[11])),o=[];for(let c=0;c<a.length;c+=1)o[c]=no($i(u,a,c));return{c(){r=W("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r=G(c,"DIV",{class:!0});var l=ue(r);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(R),this.h()},h(){N(r,"class","space-y-0")},m(c,l){te(c,r,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(c,l){if(l&8){a=Qe(Object.entries(c[11]));let d;for(d=0;d<a.length;d+=1){const p=$i(c,a,d);o[d]?o[d].p(p,l):(o[d]=no(p),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=a.length}},d(c){c&&R(r),Bt(o,c)}}}function no(u){let r,a,o=u[17].completed?"â":"ð²",c,l,d=u[17].description+"",p,_,x=u[17].info+"",C,O;return{c(){r=W("div"),a=W("span"),c=J(o),l=_e(),p=J(d),_=_e(),C=J(x),O=_e(),this.h()},l(y){r=G(y,"DIV",{class:!0});var M=ue(r);a=G(M,"SPAN",{class:!0});var Z=ue(a);c=Q(Z,o),l=ye(Z),p=Q(Z,d),_=ye(Z),C=Q(Z,x),Z.forEach(R),O=ye(M),M.forEach(R),this.h()},h(){N(a,"class","mr-2 text-sm text-gray-500"),N(r,"class","flex items-center")},m(y,M){te(y,r,M),K(r,a),K(a,c),K(a,l),K(a,p),K(a,_),K(a,C),K(r,O)},p(y,M){M&8&&o!==(o=y[17].completed?"â":"ð²")&&Oe(c,o),M&8&&d!==(d=y[17].description+"")&&Oe(p,d),M&8&&x!==(x=y[17].info+"")&&Oe(C,x)},d(y){y&&R(r)}}}function Wa(u){let r,a='<p class="text-sm text-gray-500">Achieve 2 stars in previous levels to unlock</p>';return{c(){r=W("div"),r.innerHTML=a,this.h()},l(o){r=G(o,"DIV",{class:!0,"data-svelte-h":!0}),qe(r)!=="svelte-agxr37"&&(r.innerHTML=a),this.h()},h(){N(r,"class","space-y-4 mt-8")},m(o,c){te(o,r,c)},p:Fe,i:Fe,o:Fe,d(o){o&&R(r)}}}function $a(u){let r,a,o,c,l="Start meditation",d,p,_;function x(...O){return u[6](u[9],u[14],u[15],...O)}a=new Va({props:{selectedDuration:u[9].selectedDuration,onDurationChange:x,minDuration:u[9].minDuration,maxDuration:u[9].maxDuration}});function C(){return u[7](u[9])}return{c(){r=W("div"),Et(a.$$.fragment),o=_e(),c=W("button"),c.textContent=l,this.h()},l(O){r=G(O,"DIV",{class:!0});var y=ue(r);Tt(a.$$.fragment,y),o=ye(y),c=G(y,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(c)!=="svelte-egxc4d"&&(c.textContent=l),y.forEach(R),this.h()},h(){N(c,"class","btn variant-filled w-full"),N(r,"class","space-y-6 mt-8")},m(O,y){te(O,r,y),xt(a,r,null),K(r,o),K(r,c),d=!0,p||(_=lt(c,"click",C),p=!0)},p(O,y){u=O;const M={};y&8&&(M.selectedDuration=u[9].selectedDuration),y&8&&(M.onDurationChange=x),y&8&&(M.minDuration=u[9].minDuration),y&8&&(M.maxDuration=u[9].maxDuration),a.$set(M)},i(O){d||(Ne(a.$$.fragment,O),d=!0)},o(O){Ye(a.$$.fragment,O),d=!1},d(O){O&&R(r),kt(a),p=!1,_()}}}function ro(u){let r,a,o,c,l=u[9].name+"",d,p,_,x,C,O=u[9].description+"",y,M,Z,ce,$,F,oe,z,ee,de=!u[10]&&Qi(),re=u[12]!==void 0&&u[10]&&Ji(u),ne=u[13]&&u[10]&&eo(u),ie=u[11]&&u[10]&&to(u);const Pe=[$a,Wa],ve=[];function Le(se,Te){return se[10]?0:1}return $=Le(u),F=ve[$]=Pe[$](u),{c(){r=W("div"),a=W("div"),o=W("h3"),de&&de.c(),c=_e(),d=J(l),p=_e(),re&&re.c(),_=_e(),x=W("div"),C=W("p"),y=J(O),M=_e(),ne&&ne.c(),Z=_e(),ie&&ie.c(),ce=_e(),F.c(),oe=_e(),this.h()},l(se){r=G(se,"DIV",{class:!0});var Te=ue(r);a=G(Te,"DIV",{class:!0});var Me=ue(a);o=G(Me,"H3",{class:!0});var Ae=ue(o);de&&de.l(Ae),c=ye(Ae),d=Q(Ae,l),Ae.forEach(R),p=ye(Me),re&&re.l(Me),Me.forEach(R),_=ye(Te),x=G(Te,"DIV",{class:!0});var he=ue(x);C=G(he,"P",{class:!0});var we=ue(C);y=Q(we,O),we.forEach(R),M=ye(he),ne&&ne.l(he),he.forEach(R),Z=ye(Te),ie&&ie.l(Te),ce=ye(Te),F.l(Te),oe=ye(Te),Te.forEach(R),this.h()},h(){N(o,"class","text-lg font-bold"),N(a,"class","flex justify-between items-center mb-2"),N(C,"class","text-sm text-muted-foreground mb-2"),N(x,"class","mb-2"),N(r,"class",z="card bg-[#ffffffa6] p-8 "+(u[10]?"":"opacity-60"))},m(se,Te){te(se,r,Te),K(r,a),K(a,o),de&&de.m(o,null),K(o,c),K(o,d),K(a,p),re&&re.m(a,null),K(r,_),K(r,x),K(x,C),K(C,y),K(x,M),ne&&ne.m(x,null),K(r,Z),ie&&ie.m(r,null),K(r,ce),ve[$].m(r,null),K(r,oe),ee=!0},p(se,Te){se[10]?de&&(de.d(1),de=null):de||(de=Qi(),de.c(),de.m(o,c)),(!ee||Te&8)&&l!==(l=se[9].name+"")&&Oe(d,l),se[12]!==void 0&&se[10]?re?re.p(se,Te):(re=Ji(se),re.c(),re.m(a,null)):re&&(re.d(1),re=null),(!ee||Te&8)&&O!==(O=se[9].description+"")&&Oe(y,O),se[13]&&se[10]?ne?ne.p(se,Te):(ne=eo(se),ne.c(),ne.m(x,null)):ne&&(ne.d(1),ne=null),se[11]&&se[10]?ie?ie.p(se,Te):(ie=to(se),ie.c(),ie.m(r,ce)):ie&&(ie.d(1),ie=null);let Me=$;$=Le(se),$===Me?ve[$].p(se,Te):(fn(),Ye(ve[Me],1,1,()=>{ve[Me]=null}),dn(),F=ve[$],F?F.p(se,Te):(F=ve[$]=Pe[$](se),F.c()),Ne(F,1),F.m(r,oe)),(!ee||Te&8&&z!==(z="card bg-[#ffffffa6] p-8 "+(se[10]?"":"opacity-60")))&&N(r,"class",z)},i(se){ee||(Ne(F),ee=!0)},o(se){Ye(F),ee=!1},d(se){se&&R(r),de&&de.d(),re&&re.d(),ne&&ne.d(),ie&&ie.d(),ve[$].d()}}}function Xa(u){let r,a,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',c,l,d,p,_,x=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org â</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn â</a></p>`,C,O,y,M;const Z=[Ha,Ya],ce=[];function $(z,ee){return z[4]?0:1}l=$(u),d=ce[l]=Z[l](u);function F(z){u[8](z)}let oe={duration:u[1],levelId:u[2]};return u[0]!==void 0&&(oe.show=u[0]),O=new Fa({props:oe}),Lr.push(()=>Vr(O,"show",F)),{c(){r=W("div"),a=W("div"),a.innerHTML=o,c=_e(),d.c(),p=_e(),_=W("div"),_.innerHTML=x,C=_e(),Et(O.$$.fragment),this.h()},l(z){r=G(z,"DIV",{class:!0});var ee=ue(r);a=G(ee,"DIV",{class:!0,"data-svelte-h":!0}),qe(a)!=="svelte-50yq01"&&(a.innerHTML=o),c=ye(ee),d.l(ee),p=ye(ee),_=G(ee,"DIV",{class:!0,"data-svelte-h":!0}),qe(_)!=="svelte-dgw8za"&&(_.innerHTML=x),ee.forEach(R),C=ye(z),Tt(O.$$.fragment,z),this.h()},h(){N(a,"class","space-y-6 text-center mt-10 mb-8"),N(_,"class","text-center text-sm text-gray-500 mt-40"),N(r,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(z,ee){te(z,r,ee),K(r,a),K(r,c),ce[l].m(r,null),K(r,p),K(r,_),te(z,C,ee),xt(O,z,ee),M=!0},p(z,[ee]){let de=l;l=$(z),l===de?ce[l].p(z,ee):(fn(),Ye(ce[de],1,1,()=>{ce[de]=null}),dn(),d=ce[l],d?d.p(z,ee):(d=ce[l]=Z[l](z),d.c()),Ne(d,1),d.m(r,p));const re={};ee&2&&(re.duration=z[1]),ee&4&&(re.levelId=z[2]),!y&&ee&1&&(y=!0,re.show=z[0],Ur(()=>y=!1)),O.$set(re)},i(z){M||(Ne(d),Ne(O.$$.fragment,z),M=!0)},o(z){Ye(d),Ye(O.$$.fragment,z),M=!1},d(z){z&&(R(r),R(C)),ce[l].d(),kt(O,z)}}}function Qa(u,r,a){let o=!1,c=Be.ONE_MINUTE,l=null,d=[],p=!0;const _=async()=>{await ia(),a(0,o=!0)},x=(y,M,Z,ce)=>a(3,M[Z].level.selectedDuration=ce,d),C=y=>{a(2,l=y.id),a(1,c=y.selectedDuration??y.minDuration),_()};function O(y){o=y,a(0,o)}return u.$$.update=()=>{u.$$.dirty&1&&(o||(a(4,p=!0),wa().then(y=>{a(3,d=y),y.forEach(({level:M})=>{M.selectedDuration=M.minDuration}),a(4,p=!1)}).catch(y=>{console.error("Failed to reload level statuses:",y),a(4,p=!1)})))},[o,c,l,d,p,_,x,C,O]}class hs extends bt{constructor(r){super(),wt(this,r,Qa,Xa,gt,{})}}export{hs as component};
