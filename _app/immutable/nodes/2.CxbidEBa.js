var Lo=Object.defineProperty;var Uo=(u,r,s)=>r in u?Lo(u,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[r]=s;var Si=(u,r,s)=>Uo(u,typeof r!="symbol"?r+"":r,s);import{B as Vo,s as yt,n as Be,d as K,Z as Mt,r as qr,a as Oe,i as ne,b as R,U as st,m as Yo,w as N,x as mt,c as X,e as le,f as re,g as _e,h as Q,t as ie,j as ge,q as Fr,_ as zo,$ as Go,a0 as Vn,a1 as Yn,a2 as ro,k as $n,a3 as Wo,y as Lr,C as vt,a4 as Ur,a5 as Le,P as Rt,o as Xn,a6 as Ci,a7 as Ho}from"../chunks/Bem1OcWY.js";import{S as _t,i as gt,f as Vr,d as bt,t as Ue,h as We,a as Me,m as wt,e as kt,b as xt,g as hn,c as pn}from"../chunks/BqmXtoC9.js";import{p as je}from"../chunks/CmP4wuhm.js";import{b as $o,d as Ii,w as Hn}from"../chunks/D_6RGgJS.js";function Qe(u){return(u==null?void 0:u.length)!==void 0?u:Array.from(u)}function He(u,{delay:r=0,duration:s=400,easing:o=Vo}={}){const c=+getComputedStyle(u).opacity;return{delay:r,duration:s,easing:o,css:l=>`opacity: ${l*c}`}}var Ne=(u=>(u[u.ONE_MINUTE=60]="ONE_MINUTE",u[u.TWO_MINUTES=120]="TWO_MINUTES",u[u.FIVE_MINUTES=300]="FIVE_MINUTES",u[u.TEN_MINUTES=600]="TEN_MINUTES",u[u.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",u[u.THIRTY_MINUTES=1800]="THIRTY_MINUTES",u[u.SIXTY_MINUTES=3600]="SIXTY_MINUTES",u))(Ne||{});const Mr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xo(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var io={exports:{}};(function(u,r){(function(s,o){u.exports=o()})(Oi,function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function c(e,t,n){for(var i,a=0,f=t.length;a<f;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Oi,d=Object.keys,p=Array.isArray;function g(e,t){return typeof t!="object"||d(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var k=Object.getPrototypeOf,I={}.hasOwnProperty;function A(e,t){return I.call(e,t)}function S(e,t){typeof t=="function"&&(t=t(k(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(n){Z(e,n,t[n])})}var F=Object.defineProperty;function Z(e,t,n,i){F(e,t,g(n&&A(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function se(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Z(e.prototype,"constructor",e),{extend:S.bind(null,e.prototype)}}}}var $=Object.getOwnPropertyDescriptor,M=[].slice;function ee(e,t,n){return M.call(e,t,n)}function U(e,t){return t(e)}function z(e){if(!e)throw new Error("Assertion Failed")}function fe(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function ue(e,t){if(typeof t=="string"&&A(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],i=0,a=t.length;i<a;++i){var f=ue(e,t[i]);n.push(f)}return n}var h=t.indexOf(".");if(h!==-1){var m=e[t.substr(0,h)];return m==null?void 0:ue(m,t.substr(h+1))}}function W(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){z(typeof n!="string"&&"length"in n);for(var i=0,a=t.length;i<a;++i)W(e,t[i],n[i])}else{var f,h,m=t.indexOf(".");m!==-1?(f=t.substr(0,m),(h=t.substr(m+1))===""?n===void 0?p(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=n:W(m=!(m=e[f])||!A(e,f)?e[f]={}:m,h,n)):n===void 0?p(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function te(e){var t,n={};for(t in e)A(e,t)&&(n[t]=e[t]);return n}var ye=[].concat;function Se(e){return ye.apply([],e)}var Et="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Se([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),Ve=new Set(Et.map(function(e){return l[e]})),de=null;function xe(e){return de=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var i=de.get(n);if(i)return i;if(p(n)){i=[],de.set(n,i);for(var a=0,f=n.length;a<f;++a)i.push(t(n[a]))}else if(Ve.has(n.constructor))i=n;else{var h,m=k(n);for(h in i=m===Object.prototype?{}:Object.create(m),de.set(n,i),n)A(n,h)&&(i[h]=t(n[h]))}return i}(e),de=null,e}var Ae={}.toString;function Ce(e){return Ae.call(e).slice(8,-1)}var pe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ae=typeof pe=="symbol"?function(e){var t;return e!=null&&(t=e[pe])&&t.apply(e)}:function(){return null};function he(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Ie={};function $e(e){var t,n,i,a;if(arguments.length===1){if(p(e))return e.slice();if(this===Ie&&typeof e=="string")return[e];if(a=ae(e)){for(n=[];!(i=a.next()).done;)n.push(i.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Nt=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Qt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],et=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Qt),Ht={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Bt(e,t){this.name=e,this.message=t}function zr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,i,a){return a.indexOf(n)===i}).join(`
`)}function mn(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=zr(e,t)}function qt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=zr(e,this.failures)}se(Bt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),se(mn).from(Bt),se(qt).from(Bt);var Zn=et.reduce(function(e,t){return e[t]=t+"Error",e},{}),lo=Bt,ce=et.reduce(function(e,t){var n=t+"Error";function i(a,f){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(f?`
 `+f:""),this.inner=f||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Ht[t]||n,this.inner=null)}return se(i).from(lo),e[t]=i,e},{});ce.Syntax=SyntaxError,ce.Type=TypeError,ce.Range=RangeError;var Gr=Qt.reduce(function(e,t){return e[t+"Error"]=ce[t],e},{}),vn=et.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ce[t]),e},{});function Ee(){}function $t(e){return e}function co(e,t){return e==null||e===$t?t:function(n){return t(e(n))}}function Tt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function fo(e,t){return e===Ee?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var f=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Tt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Tt(a,this.onerror):a),f!==void 0?f:n}}function ho(e,t){return e===Ee?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Tt(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Tt(i,this.onerror):i)}}function po(e,t){return e===Ee?t:function(n){var i=e.apply(this,arguments);g(n,i);var a=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?Tt(a,this.onsuccess):a),f&&(this.onerror=this.onerror?Tt(f,this.onerror):f),i===void 0?n===void 0?void 0:n:g(i,n)}}function mo(e,t){return e===Ee?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function er(e,t){return e===Ee?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,a=arguments.length,f=new Array(a);a--;)f[a]=arguments[a];return n.then(function(){return t.apply(i,f)})}return t.apply(this,arguments)}}vn.ModifyError=mn,vn.DexieError=Bt,vn.BulkError=qt;var tt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Wr(e){tt=e}var Xt={},Hr=100,Et=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,k(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,k(t),e]}(),Qt=Et[0],et=Et[1],Et=Et[2],et=et&&et.then,St=Qt&&Qt.constructor,tr=!!Et,Jt=function(e,t){Zt.push([e,t]),yn&&(queueMicrotask(yo),yn=!1)},nr=!0,yn=!0,Ct=[],_n=[],rr=$t,ut={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ee,pgp:!1,env:{},finalize:Ee},oe=ut,Zt=[],It=0,gn=[];function H(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=oe;if(typeof e!="function"){if(e!==Xt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&or(this,this._value))}this._state=null,this._value=null,++t.ref,function n(i,a){try{a(function(f){if(i._state===null){if(f===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Ft();f&&typeof f.then=="function"?n(i,function(m,y){f instanceof H?f._then(m,y):f.then(m,y)}):(i._state=!0,i._value=f,Xr(i)),h&&Lt()}},or.bind(null,i))}catch(f){or(i,f)}}(this,e)}var ir={get:function(){var e=oe,t=xn;function n(i,a){var f=this,h=!e.global&&(e!==oe||t!==xn),m=h&&!ct(),y=new H(function(b,T){ar(f,new $r(Jr(i,e,h,m),Jr(a,e,h,m),b,T,e))});return this._consoleTask&&(y._consoleTask=this._consoleTask),y}return n.prototype=Xt,n},set:function(e){Z(this,"then",e&&e.prototype===Xt?ir:{get:function(){return e},set:ir.set})}};function $r(e,t,n,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=i,this.psd=a}function or(e,t){var n,i;_n.push(t),e._state===null&&(n=e._lib&&Ft(),t=rr(t),e._state=!1,e._value=t,i=e,Ct.some(function(a){return a._value===i._value})||Ct.push(i),Xr(e),n&&Lt())}function Xr(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)ar(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),It===0&&(++It,Jt(function(){--It==0&&sr()},[]))}function ar(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++It,Jt(vo,[n,e,t])}else e._listeners.push(t)}function vo(e,t,n){try{var i,a=t._value;!t._state&&_n.length&&(_n=[]),i=tt&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||_n.indexOf(a)!==-1||function(f){for(var h=Ct.length;h;)if(Ct[--h]._value===f._value)return Ct.splice(h,1)}(t),n.resolve(i)}catch(f){n.reject(f)}finally{--It==0&&sr(),--n.psd.ref||n.psd.finalize()}}function yo(){Ot(ut,function(){Ft()&&Lt()})}function Ft(){var e=nr;return yn=nr=!1,e}function Lt(){var e,t,n;do for(;0<Zt.length;)for(e=Zt,Zt=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}while(0<Zt.length);yn=nr=!0}function sr(){var e=Ct;Ct=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=gn.slice(0),n=t.length;n;)t[--n]()}function bn(e){return new H(Xt,!1,e)}function De(e,t){var n=oe;return function(){var i=Ft(),a=oe;try{return ft(n,!0),e.apply(this,arguments)}catch(f){t&&t(f)}finally{ft(a,!1),i&&Lt()}}}S(H.prototype,{then:ir,_then:function(e,t){ar(this,new $r(null,null,e,t,oe))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?n:bn)(i)}):this.then(null,function(i){return(i&&i.name===t?n:bn)(i)})},finally:function(e){return this.then(function(t){return H.resolve(e()).then(function(){return t})},function(t){return H.resolve(e()).then(function(){return bn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new H(function(i,a){var f=setTimeout(function(){return a(new ce.Timeout(t))},e);n.then(i,a).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Z(H.prototype,Symbol.toStringTag,"Dexie.Promise"),ut.env=Qr(),S(H,{all:function(){var e=$e.apply(null,arguments).map(Tn);return new H(function(t,n){e.length===0&&t([]);var i=e.length;e.forEach(function(a,f){return H.resolve(a).then(function(h){e[f]=h,--i||t(e)},n)})})},resolve:function(e){return e instanceof H?e:e&&typeof e.then=="function"?new H(function(t,n){e.then(t,n)}):new H(Xt,!0,e)},reject:bn,race:function(){var e=$e.apply(null,arguments).map(Tn);return new H(function(t,n){e.map(function(i){return H.resolve(i).then(t,n)})})},PSD:{get:function(){return oe},set:function(e){return oe=e}},totalEchoes:{get:function(){return xn}},newPSD:lt,usePSD:Ot,scheduler:{get:function(){return Jt},set:function(e){Jt=e}},rejectionMapper:{get:function(){return rr},set:function(e){rr=e}},follow:function(e,t){return new H(function(n,i){return lt(function(a,f){var h=oe;h.unhandleds=[],h.onunhandled=f,h.finalize=Tt(function(){var m,y=this;m=function(){y.unhandleds.length===0?a():f(y.unhandleds[0])},gn.push(function b(){m(),gn.splice(gn.indexOf(b),1)}),++It,Jt(function(){--It==0&&sr()},[])},h.finalize),e()},t,n,i)})}}),St&&(St.allSettled&&Z(H,"allSettled",function(){var e=$e.apply(null,arguments).map(Tn);return new H(function(t){e.length===0&&t([]);var n=e.length,i=new Array(n);e.forEach(function(a,f){return H.resolve(a).then(function(h){return i[f]={status:"fulfilled",value:h}},function(h){return i[f]={status:"rejected",reason:h}}).then(function(){return--n||t(i)})})})}),St.any&&typeof AggregateError<"u"&&Z(H,"any",function(){var e=$e.apply(null,arguments).map(Tn);return new H(function(t,n){e.length===0&&n(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(f,h){return H.resolve(f).then(function(m){return t(m)},function(m){a[h]=m,--i||n(new AggregateError(a))})})})}),St.withResolvers&&(H.withResolvers=St.withResolvers));var qe={awaits:0,echoes:0,id:0},_o=0,wn=[],kn=0,xn=0,go=0;function lt(e,t,n,i){var a=oe,f=Object.create(a);return f.parent=a,f.ref=0,f.global=!1,f.id=++go,ut.env,f.env=tr?{Promise:H,PromiseProp:{value:H,configurable:!0,writable:!0},all:H.all,race:H.race,allSettled:H.allSettled,any:H.any,resolve:H.resolve,reject:H.reject}:{},t&&g(f,t),++a.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Ot(f,e,n,i),f.ref===0&&f.finalize(),i}function Ut(){return qe.id||(qe.id=++_o),++qe.awaits,qe.echoes+=Hr,qe.id}function ct(){return!!qe.awaits&&(--qe.awaits==0&&(qe.id=0),qe.echoes=qe.awaits*Hr,!0)}function Tn(e){return qe.echoes&&e&&e.constructor===St?(Ut(),e.then(function(t){return ct(),t},function(t){return ct(),Ke(t)})):e}function bo(){var e=wn[wn.length-1];wn.pop(),ft(e,!1)}function ft(e,t){var n,i=oe;(t?!qe.echoes||kn++&&e===oe:!kn||--kn&&e===oe)||queueMicrotask(t?(function(a){++xn,qe.echoes&&--qe.echoes!=0||(qe.echoes=qe.awaits=qe.id=0),wn.push(oe),ft(a,!0)}).bind(null,e):bo),e!==oe&&(oe=e,i===ut&&(ut.env=Qr()),tr&&(n=ut.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(l,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Qr(){var e=l.Promise;return tr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ot(e,t,n,i,a){var f=oe;try{return ft(e,!0),t(n,i,a)}finally{ft(f,!1)}}function Jr(e,t,n,i){return typeof e!="function"?e:function(){var a=oe;n&&Ut(),ft(t,!0);try{return e.apply(this,arguments)}finally{ft(a,!1),i&&queueMicrotask(ct)}}}function ur(e){Promise===St&&qe.echoes===0?kn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+et).indexOf("[native code]")===-1&&(Ut=ct=Ee);var Ke=H.reject,Pt="￿",ot="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Zr="String expected.",Vt=[],En="__dbnames",lr="readonly",cr="readwrite";function Dt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ei={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=xe(t))[e],t}}function ti(){throw ce.Type()}function ke(e,t){try{var n=ni(e),i=ni(t);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,f){for(var h=a.length,m=f.length,y=h<m?h:m,b=0;b<y;++b)if(a[b]!==f[b])return a[b]<f[b]?-1:1;return h===m?0:h<m?-1:1}(ri(e),ri(t));case"Array":return function(a,f){for(var h=a.length,m=f.length,y=h<m?h:m,b=0;b<y;++b){var T=ke(a[b],f[b]);if(T!==0)return T}return h===m?0:h<m?-1:1}(e,t)}}catch{}return NaN}function ni(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Ce(e),e==="ArrayBuffer"?"binary":e)}function ri(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ii=(Pe.prototype._trans=function(e,t,n){var i=this._tx||oe.trans,a=this.name,f=tt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(b,T,v){if(!v.schema[a])throw new ce.NotFound("Table "+a+" not part of transaction");return t(v.idbtrans,v)}var m=Ft();try{var y=i&&i.db._novip===this.db._novip?i===oe.trans?i._promise(e,h,n):lt(function(){return i._promise(e,h,n)},{trans:i,transless:oe.transless||oe}):function b(T,v,C,_){if(T.idbdb&&(T._state.openComplete||oe.letThrough||T._vip)){var x=T._createTransaction(v,C,T._dbSchema);try{x.create(),T._state.PR1398_maxLoop=3}catch(E){return E.name===Zn.InvalidState&&T.isOpen()&&0<--T._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),T.close({disableAutoOpen:!1}),T.open().then(function(){return b(T,v,C,_)})):Ke(E)}return x._promise(v,function(E,w){return lt(function(){return oe.trans=x,_(E,w,x)})}).then(function(E){if(v==="readwrite")try{x.idbtrans.commit()}catch{}return v==="readonly"?E:x._completion.then(function(){return E})})}if(T._state.openComplete)return Ke(new ce.DatabaseClosed(T._state.dbOpenError));if(!T._state.isBeingOpened){if(!T._state.autoOpen)return Ke(new ce.DatabaseClosed);T.open().catch(Ee)}return T._state.dbReadyPromise.then(function(){return b(T,v,C,_)})}(this.db,e,[this.name],h);return f&&(y._consoleTask=f,y=y.catch(function(b){return console.trace(b),Ke(b)})),y}finally{m&&Lt()}},Pe.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Ke(new ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return n.core.get({trans:i,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},Pe.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(p(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&t.every(function(b){return 0<=m.keyPath.indexOf(b)})){for(var y=0;y<t.length;++y)if(t.indexOf(m.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(m,y){return m.keyPath.length-y.keyPath.length})[0];if(n&&this.db._maxKey!==Pt){var f=n.keyPath.slice(0,t.length);return this.where(f).equals(f.map(function(y){return e[y]}))}!n&&tt&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(m,y){return ke(m,y)===0}var h=t.reduce(function(v,y){var b=v[0],T=v[1],v=i[y],C=e[y];return[b||v,b||!v?Dt(T,v&&v.multi?function(_){return _=ue(_,y),p(_)&&_.some(function(x){return a(C,x)})}:function(_){return a(C,ue(_,y))}):T]},[null,null]),f=h[0],h=h[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(h):n?this.filter(h):this.where(t).equals("")},Pe.prototype.filter=function(e){return this.toCollection().and(e)},Pe.prototype.count=function(e){return this.toCollection().count(e)},Pe.prototype.offset=function(e){return this.toCollection().offset(e)},Pe.prototype.limit=function(e){return this.toCollection().limit(e)},Pe.prototype.each=function(e){return this.toCollection().each(e)},Pe.prototype.toArray=function(e){return this.toCollection().toArray(e)},Pe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Pe.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,p(e)?"[".concat(e.join("+"),"]"):e))},Pe.prototype.reverse=function(){return this.toCollection().reverse()},Pe.prototype.mapToClass=function(e){var t,n=this.db,i=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ti&&(function(y,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function T(){this.constructor=y}s(y,b),y.prototype=b===null?Object.create(b):(T.prototype=b.prototype,new T)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},e=a);for(var f=new Set,h=e.prototype;h;h=k(h))Object.getOwnPropertyNames(h).forEach(function(y){return f.add(y)});function m(y){if(!y)return y;var b,T=Object.create(e.prototype);for(b in y)if(!f.has(b))try{T[b]=y[b]}catch{}return T}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),e},Pe.prototype.defineClass=function(){return this.mapToClass(function(e){g(this,e)})},Pe.prototype.add=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,f=i.keyPath,h=e;return f&&a&&(h=Sn(f)(e)),this._trans("readwrite",function(m){return n.core.mutate({trans:m,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(m){return m.numFailures?H.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{W(e,f,m)}catch{}return m})},Pe.prototype.update=function(e,t){return typeof e!="object"||p(e)?this.where(":id").equals(e).modify(t):(e=ue(e,this.schema.primKey.keyPath),e===void 0?Ke(new ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Pe.prototype.put=function(e,t){var n=this,i=this.schema.primKey,a=i.auto,f=i.keyPath,h=e;return f&&a&&(h=Sn(f)(e)),this._trans("readwrite",function(m){return n.core.mutate({trans:m,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(m){return m.numFailures?H.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{W(e,f,m)}catch{}return m})},Pe.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?H.reject(n.failures[0]):void 0})},Pe.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:ei})}).then(function(t){return t.numFailures?H.reject(t.failures[0]):void 0})},Pe.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},Pe.prototype.bulkAdd=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,f=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var b=i.schema.primKey,m=b.auto,b=b.keyPath;if(b&&a)throw new ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,b=b&&m?e.map(Sn(b)):e;return i.core.mutate({trans:h,type:"add",keys:a,values:b,wantResults:f}).then(function(x){var v=x.numFailures,C=x.results,_=x.lastResult,x=x.failures;if(v===0)return f?C:_;throw new qt("".concat(i.name,".bulkAdd(): ").concat(v," of ").concat(y," operations failed"),x)})})},Pe.prototype.bulkPut=function(e,t,n){var i=this,a=Array.isArray(t)?t:void 0,f=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(h){var b=i.schema.primKey,m=b.auto,b=b.keyPath;if(b&&a)throw new ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,b=b&&m?e.map(Sn(b)):e;return i.core.mutate({trans:h,type:"put",keys:a,values:b,wantResults:f}).then(function(x){var v=x.numFailures,C=x.results,_=x.lastResult,x=x.failures;if(v===0)return f?C:_;throw new qt("".concat(i.name,".bulkPut(): ").concat(v," of ").concat(y," operations failed"),x)})})},Pe.prototype.bulkUpdate=function(e){var t=this,n=this.core,i=e.map(function(h){return h.key}),a=e.map(function(h){return h.changes}),f=[];return this._trans("readwrite",function(h){return n.getMany({trans:h,keys:i,cache:"clone"}).then(function(m){var y=[],b=[];e.forEach(function(v,C){var _=v.key,x=v.changes,E=m[C];if(E){for(var w=0,O=Object.keys(x);w<O.length;w++){var P=O[w],D=x[P];if(P===t.schema.primKey.keyPath){if(ke(D,_)!==0)throw new ce.Constraint("Cannot update primary key in bulkUpdate()")}else W(E,P,D)}f.push(C),y.push(_),b.push(E)}});var T=y.length;return n.mutate({trans:h,type:"put",keys:y,values:b,updates:{keys:i,changeSpecs:a}}).then(function(v){var C=v.numFailures,_=v.failures;if(C===0)return T;for(var x=0,E=Object.keys(_);x<E.length;x++){var w,O=E[x],P=f[Number(O)];P!=null&&(w=_[O],delete _[O],_[P]=w)}throw new qt("".concat(t.name,".bulkUpdate(): ").concat(C," of ").concat(T," operations failed"),_)})})})},Pe.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var a=h.numFailures,f=h.lastResult,h=h.failures;if(a===0)return f;throw new qt("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),h)})},Pe);function Pe(){}function en(e){function t(h,m){if(m){for(var y=arguments.length,b=new Array(y-1);--y;)b[y-1]=arguments[y];return n[h].subscribe.apply(null,b),e}if(typeof h=="string")return n[h]}var n={};t.addEventType=f;for(var i=1,a=arguments.length;i<a;++i)f(arguments[i]);return t;function f(h,m,y){if(typeof h!="object"){var b;m=m||mo;var T={subscribers:[],fire:y=y||Ee,subscribe:function(v){T.subscribers.indexOf(v)===-1&&(T.subscribers.push(v),T.fire=m(T.fire,v))},unsubscribe:function(v){T.subscribers=T.subscribers.filter(function(C){return C!==v}),T.fire=T.subscribers.reduce(m,y)}};return n[h]=t[h]=T}d(b=h).forEach(function(v){var C=b[v];if(p(C))f(v,b[v][0],b[v][1]);else{if(C!=="asap")throw new ce.InvalidArgument("Invalid event config");var _=f(v,$t,function(){for(var x=arguments.length,E=new Array(x);x--;)E[x]=arguments[x];_.subscribers.forEach(function(w){fe(function(){w.apply(null,E)})})})}})}}function tn(e,t){return se(t).from({prototype:e}),t}function Yt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function fr(e,t){e.filter=Dt(e.filter,t)}function dr(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return Dt(i(),t())}:t,e.justLimit=n&&!i}function Cn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ce.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function oi(e,t,n){var i=Cn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function In(e,t,n,i){var a=e.replayFilter?Dt(e.filter,e.replayFilter()):e.filter;if(e.or){var f={},h=function(m,y,b){var T,v;a&&!a(y,b,function(C){return y.stop(C)},function(C){return y.fail(C)})||((v=""+(T=y.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(T)),A(f,v)||(f[v]=!0,t(m,y,b)))};return Promise.all([e.or._iterate(h,n),ai(oi(e,i,n),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ai(oi(e,i,n),Dt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function ai(e,t,n,i){var a=De(i?function(f,h,m){return n(i(f),h,m)}:n);return e.then(function(f){if(f)return f.start(function(){var h=function(){return f.continue()};t&&!t(f,function(m){return h=m},function(m){f.stop(m),h=Ee},function(m){f.fail(m),h=Ee})||a(f.value,f,function(m){return h=m}),h()})})}var nn=(si.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(p(n))return c(c([],p(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var i=t.remove;if(p(i))return p(e)?e.filter(function(a){return!i.includes(a)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},si);function si(e){this["@@propmod"]=e}var wo=(Te.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Ke.bind(null,n.error)):n.table._trans("readonly",e).then(t)},Te.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ke.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Te.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Dt(t.algorithm,e)},Te.prototype._iterate=function(e,t){return In(this._ctx,e,t,this._ctx.table.core)},Te.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&g(n,e),t._ctx=n,t},Te.prototype.raw=function(){return this._ctx.valueMapper=null,this},Te.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return In(t,e,n,t.table.core)})},Te.prototype.count=function(e){var t=this;return this._read(function(n){var i=t._ctx,a=i.table.core;if(Yt(i,!0))return a.count({trans:n,query:{index:Cn(i,a.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var f=0;return In(i,function(){return++f,!1},n,a).then(function(){return f})}).then(e)},Te.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],a=n.length-1;function f(y,b){return b?f(y[n[b]],b-1):y[i]}var h=this._ctx.dir==="next"?1:-1;function m(y,b){return ke(f(y,a),f(b,a))*h}return this.toArray(function(y){return y.sort(m)}).then(t)},Te.prototype.toArray=function(e){var t=this;return this._read(function(n){var i=t._ctx;if(i.dir==="next"&&Yt(i,!0)&&0<i.limit){var a=i.valueMapper,f=Cn(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:f,range:i.range}}).then(function(m){return m=m.result,a?m.map(a):m})}var h=[];return In(i,function(m){return h.push(m)},n,i.table.core).then(function(){return h})},e)},Te.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Yt(t)?dr(t,function(){var n=e;return function(i,a){return n===0||(n===1?--n:a(function(){i.advance(n),n=0}),!1)}}):dr(t,function(){var n=e;return function(){return--n<0}})),this},Te.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),dr(this._ctx,function(){var t=e;return function(n,i,a){return--t<=0&&i(a),0<=t}},!0),this},Te.prototype.until=function(e,t){return fr(this._ctx,function(n,i,a){return!e(n.value)||(i(a),t)}),this},Te.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},Te.prototype.last=function(e){return this.reverse().first(e)},Te.prototype.filter=function(e){var t;return fr(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=Dt(t.isMatch,e),this},Te.prototype.and=function(e){return this.filter(e)},Te.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Te.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Te.prototype.desc=function(){return this.reverse()},Te.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.key,i)})},Te.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Te.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,i){e(i.primaryKey,i)})},Te.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.key)}).then(function(){return n}).then(e)},Te.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Yt(t,!0)&&0<t.limit)return this._read(function(i){var a=Cn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(i,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},Te.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Te.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},Te.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Te.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return fr(this._ctx,function(a){var i=a.primaryKey.toString(),a=A(t,i);return t[i]=!0,!a}),this},Te.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(i){var a,f,h;h=typeof e=="function"?e:(a=d(e),f=a.length,function(w){for(var O=!1,P=0;P<f;++P){var D=a[P],j=e[D],B=ue(w,D);j instanceof nn?(W(w,D,j.execute(B)),O=!0):B!==j&&(W(w,D,j),O=!0)}return O});var m=n.table.core,v=m.schema.primaryKey,y=v.outbound,b=v.extractKey,T=200,v=t.db._options.modifyChunkSize;v&&(T=typeof v=="object"?v[m.name]||v["*"]||200:v);function C(w,D){var P=D.failures,D=D.numFailures;x+=w-D;for(var j=0,B=d(P);j<B.length;j++){var Y=B[j];_.push(P[Y])}}var _=[],x=0,E=[];return t.clone().primaryKeys().then(function(w){function O(D){var j=Math.min(T,w.length-D);return m.getMany({trans:i,keys:w.slice(D,D+j),cache:"immutable"}).then(function(B){for(var Y=[],q=[],L=y?[]:null,G=[],V=0;V<j;++V){var J=B[V],ve={value:xe(J),primKey:w[D+V]};h.call(ve,ve.value,ve)!==!1&&(ve.value==null?G.push(w[D+V]):y||ke(b(J),b(ve.value))===0?(q.push(ve.value),y&&L.push(w[D+V])):(G.push(w[D+V]),Y.push(ve.value)))}return Promise.resolve(0<Y.length&&m.mutate({trans:i,type:"add",values:Y}).then(function(be){for(var we in be.failures)G.splice(parseInt(we),1);C(Y.length,be)})).then(function(){return(0<q.length||P&&typeof e=="object")&&m.mutate({trans:i,type:"put",keys:L,values:q,criteria:P,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<D}).then(function(be){return C(q.length,be)})}).then(function(){return(0<G.length||P&&e===hr)&&m.mutate({trans:i,type:"delete",keys:G,criteria:P,isAdditionalChunk:0<D}).then(function(be){return C(G.length,be)})}).then(function(){return w.length>D+j&&O(D+T)})})}var P=Yt(n)&&n.limit===1/0&&(typeof e!="function"||e===hr)&&{index:n.index,range:n.range};return O(0).then(function(){if(0<_.length)throw new mn("Error modifying one or more objects",_,x,E);return w.length})})})},Te.prototype.delete=function(){var e=this._ctx,t=e.range;return Yt(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var i=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:i,range:a}}).then(function(f){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(h){var m=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new mn("Could not delete some values",Object.keys(m).map(function(y){return m[y]}),f-h);return f-h})})}):this.modify(hr)},Te);function Te(){}var hr=function(e,t){return t.value=null};function ko(e,t){return e<t?-1:e===t?0:1}function xo(e,t){return t<e?-1:e===t?0:1}function Je(e,t,n){return e=e instanceof li?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function zt(e){return new e.Collection(e,function(){return ui("")}).limit(0)}function On(e,t,n,i){var a,f,h,m,y,b,T,v=n.length;if(!n.every(function(x){return typeof x=="string"}))return Je(e,Zr);function C(x){a=x==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},f=x==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},h=x==="next"?ko:xo;var E=n.map(function(w){return{lower:f(w),upper:a(w)}}).sort(function(w,O){return h(w.lower,O.lower)});m=E.map(function(w){return w.upper}),y=E.map(function(w){return w.lower}),T=(b=x)==="next"?"":i}C("next"),e=new e.Collection(e,function(){return dt(m[0],y[v-1]+i)}),e._ondirectionchange=function(x){C(x)};var _=0;return e._addAlgorithm(function(x,E,w){var O=x.key;if(typeof O!="string")return!1;var P=f(O);if(t(P,y,_))return!0;for(var D=null,j=_;j<v;++j){var B=function(Y,q,L,G,V,J){for(var ve=Math.min(Y.length,G.length),be=-1,we=0;we<ve;++we){var Ze=q[we];if(Ze!==G[we])return V(Y[we],L[we])<0?Y.substr(0,we)+L[we]+L.substr(we+1):V(Y[we],G[we])<0?Y.substr(0,we)+G[we]+L.substr(we+1):0<=be?Y.substr(0,be)+q[be]+L.substr(be+1):null;V(Y[we],Ze)<0&&(be=we)}return ve<G.length&&J==="next"?Y+L.substr(Y.length):ve<Y.length&&J==="prev"?Y.substr(0,L.length):be<0?null:Y.substr(0,be)+G[be]+L.substr(be+1)}(O,P,m[j],y[j],h,b);B===null&&D===null?_=j+1:(D===null||0<h(D,B))&&(D=B)}return E(D!==null?function(){x.continue(D+T)}:w),!1}),e}function dt(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function ui(e){return{type:1,lower:e,upper:e}}var li=(Object.defineProperty(Fe.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Fe.prototype.between=function(e,t,n,i){n=n!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||i)&&(!n||!i)?zt(this):new this.Collection(this,function(){return dt(e,t,!n,!i)})}catch{return Je(this,ot)}},Fe.prototype.equals=function(e){return e==null?Je(this,ot):new this.Collection(this,function(){return ui(e)})},Fe.prototype.above=function(e){return e==null?Je(this,ot):new this.Collection(this,function(){return dt(e,void 0,!0)})},Fe.prototype.aboveOrEqual=function(e){return e==null?Je(this,ot):new this.Collection(this,function(){return dt(e,void 0,!1)})},Fe.prototype.below=function(e){return e==null?Je(this,ot):new this.Collection(this,function(){return dt(void 0,e,!1,!0)})},Fe.prototype.belowOrEqual=function(e){return e==null?Je(this,ot):new this.Collection(this,function(){return dt(void 0,e)})},Fe.prototype.startsWith=function(e){return typeof e!="string"?Je(this,Zr):this.between(e,e+Pt,!0,!0)},Fe.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):On(this,function(t,n){return t.indexOf(n[0])===0},[e],Pt)},Fe.prototype.equalsIgnoreCase=function(e){return On(this,function(t,n){return t===n[0]},[e],"")},Fe.prototype.anyOfIgnoreCase=function(){var e=$e.apply(Ie,arguments);return e.length===0?zt(this):On(this,function(t,n){return n.indexOf(t)!==-1},e,"")},Fe.prototype.startsWithAnyOfIgnoreCase=function(){var e=$e.apply(Ie,arguments);return e.length===0?zt(this):On(this,function(t,n){return n.some(function(i){return t.indexOf(i)===0})},e,Pt)},Fe.prototype.anyOf=function(){var e=this,t=$e.apply(Ie,arguments),n=this._cmp;try{t.sort(n)}catch{return Je(this,ot)}if(t.length===0)return zt(this);var i=new this.Collection(this,function(){return dt(t[0],t[t.length-1])});i._ondirectionchange=function(f){n=f==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return i._addAlgorithm(function(f,h,m){for(var y=f.key;0<n(y,t[a]);)if(++a===t.length)return h(m),!1;return n(y,t[a])===0||(h(function(){f.continue(t[a])}),!1)}),i},Fe.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Fe.prototype.noneOf=function(){var e=$e.apply(Ie,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Je(this,ot)}var t=e.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Fe.prototype.inAnyRange=function(O,t){var n=this,i=this._cmp,a=this._ascending,f=this._descending,h=this._min,m=this._max;if(O.length===0)return zt(this);if(!O.every(function(P){return P[0]!==void 0&&P[1]!==void 0&&a(P[0],P[1])<=0}))return Je(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ce.InvalidArgument);var y=!t||t.includeLowers!==!1,b=t&&t.includeUppers===!0,T,v=a;function C(P,D){return v(P[0],D[0])}try{(T=O.reduce(function(P,D){for(var j=0,B=P.length;j<B;++j){var Y=P[j];if(i(D[0],Y[1])<0&&0<i(D[1],Y[0])){Y[0]=h(Y[0],D[0]),Y[1]=m(Y[1],D[1]);break}}return j===B&&P.push(D),P},[])).sort(C)}catch{return Je(this,ot)}var _=0,x=b?function(P){return 0<a(P,T[_][1])}:function(P){return 0<=a(P,T[_][1])},E=y?function(P){return 0<f(P,T[_][0])}:function(P){return 0<=f(P,T[_][0])},w=x,O=new this.Collection(this,function(){return dt(T[0][0],T[T.length-1][1],!y,!b)});return O._ondirectionchange=function(P){v=P==="next"?(w=x,a):(w=E,f),T.sort(C)},O._addAlgorithm(function(P,D,j){for(var B,Y=P.key;w(Y);)if(++_===T.length)return D(j),!1;return!x(B=Y)&&!E(B)||(n._cmp(Y,T[_][1])===0||n._cmp(Y,T[_][0])===0||D(function(){v===a?P.continue(T[_][0]):P.continue(T[_][1])}),!1)}),O},Fe.prototype.startsWithAnyOf=function(){var e=$e.apply(Ie,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?zt(this):this.inAnyRange(e.map(function(t){return[t,t+Pt]})):Je(this,"startsWithAnyOf() only works with strings")},Fe);function Fe(){}function nt(e){return De(function(t){return rn(t),e(t.target.error),!1})}function rn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var on="storagemutated",pr="x-storagemutated-1",ht=en(null,on),To=(rt.prototype._lock=function(){return z(!oe.global),++this._reculock,this._reculock!==1||oe.global||(oe.lockOwnerFor=this),this},rt.prototype._unlock=function(){if(z(!oe.global),--this._reculock==0)for(oe.global||(oe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Ot(e[1],e[0])}catch{}}return this},rt.prototype._locked=function(){return this._reculock&&oe.lockOwnerFor!==this},rt.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(z(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new ce.DatabaseClosed(i);case"MissingAPIError":throw new ce.MissingAPI(i.message,i);default:throw new ce.OpenFailed(i)}if(!this.active)throw new ce.TransactionInactive;return z(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=De(function(a){rn(a),t._reject(e.error)}),e.onabort=De(function(a){rn(a),t.active&&t._reject(new ce.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=De(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&ht.storagemutated.fire(e.mutatedParts)}),this},rt.prototype._promise=function(e,t,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return Ke(new ce.ReadOnly("Transaction is readonly"));if(!this.active)return Ke(new ce.TransactionInactive);if(this._locked())return new H(function(f,h){i._blockedFuncs.push([function(){i._promise(e,t,n).then(f,h)},oe])});if(n)return lt(function(){var f=new H(function(h,m){i._lock();var y=t(h,m,i);y&&y.then&&y.then(h,m)});return f.finally(function(){return i._unlock()}),f._lib=!0,f});var a=new H(function(f,h){var m=t(f,h,i);m&&m.then&&m.then(f,h)});return a._lib=!0,a},rt.prototype._root=function(){return this.parent?this.parent._root():this},rt.prototype.waitFor=function(e){var t,n=this._root(),i=H.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return i}):(n._waitingFor=i,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function f(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=f)}());var a=n._waitingFor;return new H(function(f,h){i.then(function(m){return n._waitingQueue.push(De(f.bind(null,m)))},function(m){return n._waitingQueue.push(De(h.bind(null,m)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},rt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ce.Abort))},rt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(A(t,e))return t[e];var n=this.schema[e];if(!n)throw new ce.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},rt);function rt(){}function mr(e,t,n,i,a,f,h){return{name:e,keyPath:t,unique:n,multi:i,auto:a,compound:f,src:(n&&!h?"&":"")+(i?"*":"")+(a?"++":"")+ci(t)}}function ci(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function vr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(i=function(a){return[a.name,a]},n.reduce(function(a,f,h){return h=i(f,h),h&&(a[h[0]]=h[1]),a},{}))};var i}var an=function(e){try{return e.only([[]]),an=function(){return[[]]},[[]]}catch{return an=function(){return Pt},Pt}};function yr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return ue(n,t)}:function(n){return ue(n,e)};var t}function fi(e){return[].slice.call(e)}var Eo=0;function sn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function So(e,t,y){function i(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var _=w.lower,x=w.upper,E=w.lowerOpen,w=w.upperOpen;return _===void 0?x===void 0?null:t.upperBound(x,!!w):x===void 0?t.lowerBound(_,!!E):t.bound(_,x,!!E,!!w)}function a(C){var _,x=C.name;return{name:x,schema:C,mutate:function(E){var w=E.trans,O=E.type,P=E.keys,D=E.values,j=E.range;return new Promise(function(B,Y){B=De(B);var q=w.objectStore(x),L=q.keyPath==null,G=O==="put"||O==="add";if(!G&&O!=="delete"&&O!=="deleteRange")throw new Error("Invalid operation type: "+O);var V,J=(P||D||{length:1}).length;if(P&&D&&P.length!==D.length)throw new Error("Given keys array must have same length as given values array.");if(J===0)return B({numFailures:0,failures:{},results:[],lastResult:void 0});function ve(Xe){++Ze,rn(Xe)}var be=[],we=[],Ze=0;if(O==="deleteRange"){if(j.type===4)return B({numFailures:Ze,failures:we,results:[],lastResult:void 0});j.type===3?be.push(V=q.clear()):be.push(V=q.delete(i(j)))}else{var L=G?L?[D,P]:[D,null]:[P,null],me=L[0],ze=L[1];if(G)for(var Ge=0;Ge<J;++Ge)be.push(V=ze&&ze[Ge]!==void 0?q[O](me[Ge],ze[Ge]):q[O](me[Ge])),V.onerror=ve;else for(Ge=0;Ge<J;++Ge)be.push(V=q[O](me[Ge])),V.onerror=ve}function Un(Xe){Xe=Xe.target.result,be.forEach(function(Kt,Rr){return Kt.error!=null&&(we[Rr]=Kt.error)}),B({numFailures:Ze,failures:we,results:O==="delete"?P:be.map(function(Kt){return Kt.result}),lastResult:Xe})}V.onerror=function(Xe){ve(Xe),Un(Xe)},V.onsuccess=Un})},getMany:function(E){var w=E.trans,O=E.keys;return new Promise(function(P,D){P=De(P);for(var j,B=w.objectStore(x),Y=O.length,q=new Array(Y),L=0,G=0,V=function(be){be=be.target,q[be._pos]=be.result,++G===L&&P(q)},J=nt(D),ve=0;ve<Y;++ve)O[ve]!=null&&((j=B.get(O[ve]))._pos=ve,j.onsuccess=V,j.onerror=J,++L);L===0&&P(q)})},get:function(E){var w=E.trans,O=E.key;return new Promise(function(P,D){P=De(P);var j=w.objectStore(x).get(O);j.onsuccess=function(B){return P(B.target.result)},j.onerror=nt(D)})},query:(_=b,function(E){return new Promise(function(w,O){w=De(w);var P,D,j,L=E.trans,B=E.values,Y=E.limit,V=E.query,q=Y===1/0?void 0:Y,G=V.index,V=V.range,L=L.objectStore(x),G=G.isPrimaryKey?L:L.index(G.name),V=i(V);if(Y===0)return w({result:[]});_?((q=B?G.getAll(V,q):G.getAllKeys(V,q)).onsuccess=function(J){return w({result:J.target.result})},q.onerror=nt(O)):(P=0,D=!B&&"openKeyCursor"in G?G.openKeyCursor(V):G.openCursor(V),j=[],D.onsuccess=function(J){var ve=D.result;return ve?(j.push(B?ve.value:ve.primaryKey),++P===Y?w({result:j}):void ve.continue()):w({result:j})},D.onerror=nt(O))})}),openCursor:function(E){var w=E.trans,O=E.values,P=E.query,D=E.reverse,j=E.unique;return new Promise(function(B,Y){B=De(B);var G=P.index,q=P.range,L=w.objectStore(x),L=G.isPrimaryKey?L:L.index(G.name),G=D?j?"prevunique":"prev":j?"nextunique":"next",V=!O&&"openKeyCursor"in L?L.openKeyCursor(i(q),G):L.openCursor(i(q),G);V.onerror=nt(Y),V.onsuccess=De(function(J){var ve,be,we,Ze,me=V.result;me?(me.___id=++Eo,me.done=!1,ve=me.continue.bind(me),be=(be=me.continuePrimaryKey)&&be.bind(me),we=me.advance.bind(me),Ze=function(){throw new Error("Cursor not stopped")},me.trans=w,me.stop=me.continue=me.continuePrimaryKey=me.advance=function(){throw new Error("Cursor not started")},me.fail=De(Y),me.next=function(){var ze=this,Ge=1;return this.start(function(){return Ge--?ze.continue():ze.stop()}).then(function(){return ze})},me.start=function(ze){function Ge(){if(V.result)try{ze()}catch(Xe){me.fail(Xe)}else me.done=!0,me.start=function(){throw new Error("Cursor behind last entry")},me.stop()}var Un=new Promise(function(Xe,Kt){Xe=De(Xe),V.onerror=nt(Kt),me.fail=Kt,me.stop=function(Rr){me.stop=me.continue=me.continuePrimaryKey=me.advance=Ze,Xe(Rr)}});return V.onsuccess=De(function(Xe){V.onsuccess=Ge,Ge()}),me.continue=ve,me.continuePrimaryKey=be,me.advance=we,Ge(),Un},B(me)):B(null)},Y)})},count:function(E){var w=E.query,O=E.trans,P=w.index,D=w.range;return new Promise(function(j,B){var Y=O.objectStore(x),q=P.isPrimaryKey?Y:Y.index(P.name),Y=i(D),q=Y?q.count(Y):q.count();q.onsuccess=De(function(L){return j(L.target.result)}),q.onerror=nt(B)})}}}var f,h,m,T=(h=y,m=fi((f=e).objectStoreNames),{schema:{name:f.name,tables:m.map(function(C){return h.objectStore(C)}).map(function(C){var _=C.keyPath,w=C.autoIncrement,x=p(_),E={},w={name:C.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_==null,compound:x,keyPath:_,autoIncrement:w,unique:!0,extractKey:yr(_)},indexes:fi(C.indexNames).map(function(O){return C.index(O)}).map(function(j){var P=j.name,D=j.unique,B=j.multiEntry,j=j.keyPath,B={name:P,compound:p(j),keyPath:j,unique:D,multiEntry:B,extractKey:yr(j)};return E[sn(j)]=B}),getIndexByKeyPath:function(O){return E[sn(O)]}};return E[":id"]=w.primaryKey,_!=null&&(E[sn(_)]=w.primaryKey),w})},hasGetAll:0<m.length&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),y=T.schema,b=T.hasGetAll,T=y.tables.map(a),v={};return T.forEach(function(C){return v[C.name]=C}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(C){if(!v[C])throw new Error("Table '".concat(C,"' not found"));return v[C]},MIN_KEY:-1/0,MAX_KEY:an(t),schema:y}}function Co(e,t,n,i){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(i=So(t,a,i),e.dbcore.reduce(function(f,h){return h=h.create,o(o({},f),h(f))},i))}}function Pn(e,i){var n=i.db,i=Co(e._middlewares,n,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(a){var f=a.name;e.core.schema.tables.some(function(h){return h.name===f})&&(a.core=e.core.table(f),e[f]instanceof e.Table&&(e[f].core=a.core))})}function Dn(e,t,n,i){n.forEach(function(a){var f=i[a];t.forEach(function(h){var m=function y(b,T){return $(b,T)||(b=k(b))&&y(b,T)}(h,a);(!m||"value"in m&&m.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?Z(h,a,{get:function(){return this.table(a)},set:function(y){F(this,a,{value:y,writable:!0,configurable:!0,enumerable:!0})}}):h[a]=new e.Table(a,f))})})}function _r(e,t){t.forEach(function(n){for(var i in n)n[i]instanceof e.Table&&delete n[i]})}function Io(e,t){return e._cfg.version-t._cfg.version}function Oo(e,t,n,i){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=vr("$meta",hi("")[0],[]),e._storeNames.push("$meta"));var f=e._createTransaction("readwrite",e._storeNames,a);f.create(n),f._completion.catch(i);var h=f._reject.bind(f),m=oe.transless||oe;lt(function(){return oe.trans=f,oe.transless=m,t!==0?(Pn(e,n),b=t,((y=f).storeNames.includes("$meta")?y.table("$meta").get("version").then(function(T){return T??b}):H.resolve(b)).then(function(T){return C=T,_=f,x=n,E=[],T=(v=e)._versions,w=v._dbSchema=jn(0,v.idbdb,x),(T=T.filter(function(O){return O._cfg.version>=C})).length!==0?(T.forEach(function(O){E.push(function(){var P=w,D=O._cfg.dbschema;Kn(v,P,x),Kn(v,D,x),w=v._dbSchema=D;var j=gr(P,D);j.add.forEach(function(G){br(x,G[0],G[1].primKey,G[1].indexes)}),j.change.forEach(function(G){if(G.recreate)throw new ce.Upgrade("Not yet support for changing primary key");var V=x.objectStore(G.name);G.add.forEach(function(J){return An(V,J)}),G.change.forEach(function(J){V.deleteIndex(J.name),An(V,J)}),G.del.forEach(function(J){return V.deleteIndex(J)})});var B=O._cfg.contentUpgrade;if(B&&O._cfg.version>C){Pn(v,x),_._memoizedTables={};var Y=te(D);j.del.forEach(function(G){Y[G]=P[G]}),_r(v,[v.Transaction.prototype]),Dn(v,[v.Transaction.prototype],d(Y),Y),_.schema=Y;var q,L=Nt(B);return L&&Ut(),j=H.follow(function(){var G;(q=B(_))&&L&&(G=ct.bind(null,null),q.then(G,G))}),q&&typeof q.then=="function"?H.resolve(q):j.then(function(){return q})}}),E.push(function(P){var D,j,B=O._cfg.dbschema;D=B,j=P,[].slice.call(j.db.objectStoreNames).forEach(function(Y){return D[Y]==null&&j.db.deleteObjectStore(Y)}),_r(v,[v.Transaction.prototype]),Dn(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),_.schema=v._dbSchema}),E.push(function(P){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===O._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(D){return D!=="$meta"})):P.objectStore("$meta").put(O._cfg.version,"version"))})}),function O(){return E.length?H.resolve(E.shift()(_.idbtrans)).then(O):H.resolve()}().then(function(){di(w,x)})):H.resolve();var v,C,_,x,E,w}).catch(h)):(d(a).forEach(function(T){br(n,T,a[T].primKey,a[T].indexes)}),Pn(e,n),void H.follow(function(){return e.on.populate.fire(f)}).catch(h));var y,b})}function Po(e,t){di(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=jn(0,e.idbdb,t);Kn(e,e._dbSchema,t);for(var i=0,a=gr(n,e._dbSchema).change;i<a.length;i++){var f=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=t.objectStore(h.name);h.add.forEach(function(y){tt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(y.src)),An(m,y)})}(a[i]);if(typeof f=="object")return f.value}}function gr(e,t){var n,i={del:[],add:[],change:[]};for(n in e)t[n]||i.del.push(n);for(n in t){var a=e[n],f=t[n];if(a){var h={name:n,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||a.primKey.auto!==f.primKey.auto)h.recreate=!0,i.change.push(h);else{var m=a.idxByName,y=f.idxByName,b=void 0;for(b in m)y[b]||h.del.push(b);for(b in y){var T=m[b],v=y[b];T?T.src!==v.src&&h.change.push(v):h.add.push(v)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([n,f])}return i}function br(e,t,n,i){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(f){return An(a,f)}),a}function di(e,t){d(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(tt&&console.debug("Dexie: Creating missing table",n),br(t,n,e[n].primKey,e[n].indexes))})}function An(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function jn(e,t,n){var i={};return ee(t.objectStoreNames,0).forEach(function(a){for(var f=n.objectStore(a),h=mr(ci(b=f.keyPath),b||"",!0,!1,!!f.autoIncrement,b&&typeof b!="string",!0),m=[],y=0;y<f.indexNames.length;++y){var T=f.index(f.indexNames[y]),b=T.keyPath,T=mr(T.name,b,!!T.unique,!!T.multiEntry,!1,b&&typeof b!="string",!1);m.push(T)}i[a]=vr(a,h,m)}),i}function Kn(e,t,n){for(var i=n.db.objectStoreNames,a=0;a<i.length;++a){var f=i[a],h=n.objectStore(f);e._hasGetAll="getAll"in h;for(var m=0;m<h.indexNames.length;++m){var y=h.indexNames[m],b=h.index(y).keyPath,T=typeof b=="string"?b:"["+ee(b).join("+")+"]";!t[f]||(b=t[f].idxByName[T])&&(b.name=y,delete t[f].idxByName[T],t[f].idxByName[y]=b)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function hi(e){return e.split(",").map(function(t,n){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return mr(i,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),p(a),n===0)})}var Do=(Rn.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(n){if(e[n]!==null){var i=hi(e[n]),a=i.shift();if(a.unique=!0,a.multi)throw new ce.Schema("Primary key cannot be multi-valued");i.forEach(function(f){if(f.auto)throw new ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new ce.Schema("Index must have a name and cannot be an empty string")}),t[n]=vr(n,a,i)}})},Rn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,n):n;var n=t._versions,i={},a={};return n.forEach(function(f){g(i,f._cfg.storesSource),a=f._cfg.dbschema={},f._parseStoresSpec(i,a)}),t._dbSchema=a,_r(t,[t._allTables,t,t.Transaction.prototype]),Dn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(a),a),t._storeNames=d(a),this},Rn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=er(this._cfg.contentUpgrade||Ee,e),this},Rn);function Rn(){}function wr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new at(En,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function kr(e){return e&&typeof e.databases=="function"}function xr(e){return lt(function(){return oe.letThrough=!0,e()})}function Tr(e){return!("from"in e)}var Ye=function(e,t){if(!this){var n=new Ye;return e&&"d"in e&&g(n,e),n}g(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function un(e,t,n){var i=ke(t,n);if(!isNaN(i)){if(0<i)throw RangeError();if(Tr(e))return g(e,{from:t,to:n,d:1});var a=e.l,i=e.r;if(ke(n,e.from)<0)return a?un(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},mi(e);if(0<ke(t,e.to))return i?un(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},mi(e);ke(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<ke(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&ln(e,a),i&&n&&ln(e,i)}}function ln(e,t){Tr(t)||function n(i,y){var f=y.from,h=y.to,m=y.l,y=y.r;un(i,f,h),m&&n(i,m),y&&n(i,y)}(e,t)}function pi(e,t){var n=Mn(t),i=n.next();if(i.done)return!1;for(var a=i.value,f=Mn(e),h=f.next(a.from),m=h.value;!i.done&&!h.done;){if(ke(m.from,a.to)<=0&&0<=ke(m.to,a.from))return!0;ke(a.from,m.from)<0?a=(i=n.next(m.from)).value:m=(h=f.next(a.from)).value}return!1}function Mn(e){var t=Tr(e)?null:{s:0,n:e};return{next:function(n){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&ke(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||ke(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mi(e){var t,n,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<i?"r":i<-1?"l":"";a&&(t=a=="r"?"l":"r",n=o({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],n[a]=i[t],(e[t]=n).d=vi(n)),e.d=vi(e)}function vi(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Nn(e,t){return d(t).forEach(function(n){e[n]?ln(e[n],t[n]):e[n]=function i(a){var f,h,m={};for(f in a)A(a,f)&&(h=a[f],m[f]=!h||typeof h!="object"||Ve.has(h.constructor)?h:i(h));return m}(t[n])}),e}function Er(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&pi(t[n],e[n])})}S(Ye.prototype,((et={add:function(e){return ln(this,e),this},addKey:function(e){return un(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return un(t,n,n)}),this},hasKey:function(e){var t=Mn(this).next(e).value;return t&&ke(t.from,e)<=0&&0<=ke(t.to,e)}})[pe]=function(){return Mn(this)},et));var At={},Sr={},Cr=!1;function Bn(e){Nn(Sr,e),Cr||(Cr=!0,setTimeout(function(){Cr=!1,Ir(Sr,!(Sr={}))},0))}function Ir(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var i=0,a=Object.values(At);i<a.length;i++)yi(h=a[i],e,n,t);else for(var f in e){var h,m=/^idb\:\/\/(.*)\/(.*)\//.exec(f);m&&(f=m[1],m=m[2],(h=At["idb://".concat(f,"/").concat(m)])&&yi(h,e,n,t))}n.forEach(function(y){return y()})}function yi(e,t,n,i){for(var a=[],f=0,h=Object.entries(e.queries.query);f<h.length;f++){for(var m=h[f],y=m[0],b=[],T=0,v=m[1];T<v.length;T++){var C=v[T];Er(t,C.obsSet)?C.subscribers.forEach(function(w){return n.add(w)}):i&&b.push(C)}i&&a.push([y,b])}if(i)for(var _=0,x=a;_<x.length;_++){var E=x[_],y=E[0],b=E[1];e.queries.query[y]=b}}function Ao(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ke(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),f=!1;function h(){if(t.openCanceller!==i)throw new ce.DatabaseClosed("db.open() was cancelled")}function m(){return new H(function(C,_){if(h(),!n)throw new ce.MissingAPI;var x=e.name,E=t.autoSchema||!a?n.open(x):n.open(x,a);if(!E)throw new ce.MissingAPI;E.onerror=nt(_),E.onblocked=De(e._fireOnBlocked),E.onupgradeneeded=De(function(w){var O;T=E.transaction,t.autoSchema&&!e._options.allowEmptyDB?(E.onerror=rn,T.abort(),E.result.close(),(O=n.deleteDatabase(x)).onsuccess=O.onerror=De(function(){_(new ce.NoSuchDatabase("Database ".concat(x," doesnt exist")))})):(T.onerror=nt(_),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,v=w<1,e.idbdb=E.result,f&&Po(e,T),Oo(e,w/10,T,_))},_),E.onsuccess=De(function(){T=null;var w,O,P,D,j,B=e.idbdb=E.result,Y=ee(B.objectStoreNames);if(0<Y.length)try{var q=B.transaction((D=Y).length===1?D[0]:D,"readonly");if(t.autoSchema)O=B,P=q,(w=e).verno=O.version/10,P=w._dbSchema=jn(0,O,P),w._storeNames=ee(O.objectStoreNames,0),Dn(w,[w._allTables],d(P),P);else if(Kn(e,e._dbSchema,q),((j=gr(jn(0,(j=e).idbdb,q),j._dbSchema)).add.length||j.change.some(function(L){return L.add.length||L.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),B.close(),a=B.version+1,f=!0,C(m());Pn(e,q)}catch{}Vt.push(e),B.onversionchange=De(function(L){t.vcFired=!0,e.on("versionchange").fire(L)}),B.onclose=De(function(L){e.on("close").fire(L)}),v&&(j=e._deps,q=x,B=j.indexedDB,j=j.IDBKeyRange,kr(B)||q===En||wr(B,j).put({name:q}).catch(Ee)),C()},_)}).catch(function(C){switch(C==null?void 0:C.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<a)return a=0,m()}return H.reject(C)})}var y,b=t.dbReadyResolve,T=null,v=!1;return H.race([i,(typeof navigator>"u"?H.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(C){function _(){return indexedDB.databases().finally(C)}y=setInterval(_,100),_()}).finally(function(){return clearInterval(y)}):Promise.resolve()).then(m)]).then(function(){return h(),t.onReadyBeingFired=[],H.resolve(xr(function(){return e.on.ready.fire(e.vip)})).then(function C(){if(0<t.onReadyBeingFired.length){var _=t.onReadyBeingFired.reduce(er,Ee);return t.onReadyBeingFired=[],H.resolve(xr(function(){return _(e.vip)})).then(C)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(C){t.dbOpenError=C;try{T&&T.abort()}catch{}return i===t.openCanceller&&e._close(),Ke(C)}).finally(function(){t.openComplete=!0,b()}).then(function(){var C;return v&&(C={},e.tables.forEach(function(_){_.schema.indexes.forEach(function(x){x.name&&(C["idb://".concat(e.name,"/").concat(_.name,"/").concat(x.name)]=new Ye(-1/0,[[[]]]))}),C["idb://".concat(e.name,"/").concat(_.name,"/")]=C["idb://".concat(e.name,"/").concat(_.name,"/:dels")]=new Ye(-1/0,[[[]]])}),ht(on).fire(C),Ir(C,!0)),e})}function Or(e){function t(f){return e.next(f)}var n=a(t),i=a(function(f){return e.throw(f)});function a(f){return function(y){var m=f(y),y=m.value;return m.done?y:y&&typeof y.then=="function"?y.then(n,i):p(y)?Promise.all(y).then(n,i):n(y)}}return a(t)()}function qn(e,t,n){for(var i=p(e)?e.slice():[e],a=0;a<n;++a)i.push(t);return i}var jo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema,a={},f=[];function h(v,C,_){var x=sn(v),E=a[x]=a[x]||[],w=v==null?0:typeof v=="string"?1:v.length,O=0<C,O=o(o({},_),{name:O?"".concat(x,"(virtual-from:").concat(_.name,")"):_.name,lowLevelIndex:_,isVirtual:O,keyTail:C,keyLength:w,extractKey:yr(v),unique:!O&&_.unique});return E.push(O),O.isPrimaryKey||f.push(O),1<w&&h(w===2?v[0]:v.slice(0,w-1),C+1,_),E.sort(function(P,D){return P.keyTail-D.keyTail}),O}t=h(i.primaryKey.keyPath,0,i.primaryKey),a[":id"]=[t];for(var m=0,y=i.indexes;m<y.length;m++){var b=y[m];h(b.keyPath,0,b)}function T(v){var C,_=v.query.index;return _.isVirtual?o(o({},v),{query:{index:_.lowLevelIndex,range:(C=v.query.range,_=_.keyTail,{type:C.type===1?2:C.type,lower:qn(C.lower,C.lowerOpen?e.MAX_KEY:e.MIN_KEY,_),lowerOpen:!0,upper:qn(C.upper,C.upperOpen?e.MIN_KEY:e.MAX_KEY,_),upperOpen:!0})}}):v}return o(o({},n),{schema:o(o({},i),{primaryKey:t,indexes:f,getIndexByKeyPath:function(v){return(v=a[sn(v)])&&v[0]}}),count:function(v){return n.count(T(v))},query:function(v){return n.query(T(v))},openCursor:function(v){var C=v.query.index,_=C.keyTail,x=C.isVirtual,E=C.keyLength;return x?n.openCursor(T(v)).then(function(O){return O&&w(O)}):n.openCursor(v);function w(O){return Object.create(O,{continue:{value:function(P){P!=null?O.continue(qn(P,v.reverse?e.MAX_KEY:e.MIN_KEY,_)):v.unique?O.continue(O.key.slice(0,E).concat(v.reverse?e.MIN_KEY:e.MAX_KEY,_)):O.continue()}},continuePrimaryKey:{value:function(P,D){O.continuePrimaryKey(qn(P,e.MAX_KEY,_),D)}},primaryKey:{get:function(){return O.primaryKey}},key:{get:function(){var P=O.key;return E===1?P[0]:P.slice(0,E)}},value:{get:function(){return O.value}}})}}})}})}};function Pr(e,t,n,i){return n=n||{},i=i||"",d(e).forEach(function(a){var f,h,m;A(t,a)?(f=e[a],h=t[a],typeof f=="object"&&typeof h=="object"&&f&&h?(m=Ce(f))!==Ce(h)?n[i+a]=t[a]:m==="Object"?Pr(f,h,n,i+a+"."):f!==h&&(n[i+a]=t[a]):f!==h&&(n[i+a]=t[a])):n[i+a]=void 0}),d(t).forEach(function(a){A(e,a)||(n[i+a]=t[a])}),n}function Dr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ko={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return o(o({},n),{mutate:function(a){var f=oe.trans,h=f.table(t).hook,m=h.deleting,y=h.creating,b=h.updating;switch(a.type){case"add":if(y.fire===Ee)break;return f._promise("readwrite",function(){return T(a)},!0);case"put":if(y.fire===Ee&&b.fire===Ee)break;return f._promise("readwrite",function(){return T(a)},!0);case"delete":if(m.fire===Ee)break;return f._promise("readwrite",function(){return T(a)},!0);case"deleteRange":if(m.fire===Ee)break;return f._promise("readwrite",function(){return function v(C,_,x){return n.query({trans:C,values:!1,query:{index:i,range:_},limit:x}).then(function(E){var w=E.result;return T({type:"delete",keys:w,trans:C}).then(function(O){return 0<O.numFailures?Promise.reject(O.failures[0]):w.length<x?{failures:[],numFailures:0,lastResult:void 0}:v(C,o(o({},_),{lower:w[w.length-1],lowerOpen:!0}),x)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function T(v){var C,_,x,E=oe.trans,w=v.keys||Dr(i,v);if(!w)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?o(o({},v),{keys:w}):o({},v)).type!=="delete"&&(v.values=c([],v.values)),v.keys&&(v.keys=c([],v.keys)),C=n,x=w,((_=v).type==="add"?Promise.resolve([]):C.getMany({trans:_.trans,keys:x,cache:"immutable"})).then(function(O){var P=w.map(function(D,j){var B,Y,q,L=O[j],G={onerror:null,onsuccess:null};return v.type==="delete"?m.fire.call(G,D,L,E):v.type==="add"||L===void 0?(B=y.fire.call(G,D,v.values[j],E),D==null&&B!=null&&(v.keys[j]=D=B,i.outbound||W(v.values[j],i.keyPath,D))):(B=Pr(L,v.values[j]),(Y=b.fire.call(G,B,D,L,E))&&(q=v.values[j],Object.keys(Y).forEach(function(V){A(q,V)?q[V]=Y[V]:W(q,V,Y[V])}))),G});return n.mutate(v).then(function(D){for(var j=D.failures,B=D.results,Y=D.numFailures,D=D.lastResult,q=0;q<w.length;++q){var L=(B||w)[q],G=P[q];L==null?G.onerror&&G.onerror(j[q]):G.onsuccess&&G.onsuccess(v.type==="put"&&O[q]?v.values[q]:L)}return{failures:j,results:B,numFailures:Y,lastResult:D}}).catch(function(D){return P.forEach(function(j){return j.onerror&&j.onerror(D)}),Promise.reject(D)})})}}})}})}};function _i(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,f=0;a<t.keys.length&&f<e.length;++a)ke(t.keys[a],e[f])===0&&(i.push(n?xe(t.values[a]):t.values[a]),++f);return i.length===e.length?i:null}catch{return null}}var Ro={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return o(o({},n),{getMany:function(i){if(!i.cache)return n.getMany(i);var a=_i(i.keys,i.trans._cache,i.cache==="clone");return a?H.resolve(a):n.getMany(i).then(function(f){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?xe(f):f},f})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),n.mutate(i)}})}}}};function gi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function bi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Mo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Ye(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,a,f){if(oe.subscr&&a!=="readonly")throw new ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(oe.querier));return e.transaction(i,a,f)},table:function(i){var a=e.table(i),f=a.schema,h=f.primaryKey,v=f.indexes,m=h.extractKey,y=h.outbound,b=h.autoIncrement&&v.filter(function(_){return _.compound&&_.keyPath.includes(h.keyPath)}),T=o(o({},a),{mutate:function(_){function x(V){return V="idb://".concat(t,"/").concat(i,"/").concat(V),D[V]||(D[V]=new Ye)}var E,w,O,P=_.trans,D=_.mutatedParts||(_.mutatedParts={}),j=x(""),B=x(":dels"),Y=_.type,G=_.type==="deleteRange"?[_.range]:_.type==="delete"?[_.keys]:_.values.length<50?[Dr(h,_).filter(function(V){return V}),_.values]:[],q=G[0],L=G[1],G=_.trans._cache;return p(q)?(j.addKeys(q),(G=Y==="delete"||q.length===L.length?_i(q,G):null)||B.addKeys(q),(G||L)&&(E=x,w=G,O=L,f.indexes.forEach(function(V){var J=E(V.name||"");function ve(we){return we!=null?V.extractKey(we):null}function be(we){return V.multiEntry&&p(we)?we.forEach(function(Ze){return J.addKey(Ze)}):J.addKey(we)}(w||O).forEach(function(we,ze){var me=w&&ve(w[ze]),ze=O&&ve(O[ze]);ke(me,ze)!==0&&(me!=null&&be(me),ze!=null&&be(ze))})}))):q?(L={from:(L=q.lower)!==null&&L!==void 0?L:e.MIN_KEY,to:(L=q.upper)!==null&&L!==void 0?L:e.MAX_KEY},B.add(L),j.add(L)):(j.add(n),B.add(n),f.indexes.forEach(function(V){return x(V.name).add(n)})),a.mutate(_).then(function(V){return!q||_.type!=="add"&&_.type!=="put"||(j.addKeys(V.results),b&&b.forEach(function(J){for(var ve=_.values.map(function(me){return J.extractKey(me)}),be=J.keyPath.findIndex(function(me){return me===h.keyPath}),we=0,Ze=V.results.length;we<Ze;++we)ve[we][be]=V.results[we];x(J.name).addKeys(ve)})),P.mutatedParts=Nn(P.mutatedParts||{},D),V})}}),v=function(x){var E=x.query,x=E.index,E=E.range;return[x,new Ye((x=E.lower)!==null&&x!==void 0?x:e.MIN_KEY,(E=E.upper)!==null&&E!==void 0?E:e.MAX_KEY)]},C={get:function(_){return[h,new Ye(_.key)]},getMany:function(_){return[h,new Ye().addKeys(_.keys)]},count:v,query:v,openCursor:v};return d(C).forEach(function(_){T[_]=function(x){var E=oe.subscr,w=!!E,O=gi(oe,a)&&bi(_,x)?x.obsSet={}:E;if(w){var P=function(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),O[L]||(O[L]=new Ye)},D=P(""),j=P(":dels"),E=C[_](x),w=E[0],E=E[1];if((_==="query"&&w.isPrimaryKey&&!x.values?j:P(w.name||"")).add(E),!w.isPrimaryKey){if(_!=="count"){var B=_==="query"&&y&&x.values&&a.query(o(o({},x),{values:!1}));return a[_].apply(this,arguments).then(function(L){if(_==="query"){if(y&&x.values)return B.then(function(ve){return ve=ve.result,D.addKeys(ve),L});var G=x.values?L.result.map(m):L.result;(x.values?D:j).addKeys(G)}else if(_==="openCursor"){var V=L,J=x.values;return V&&Object.create(V,{key:{get:function(){return j.addKey(V.primaryKey),V.key}},primaryKey:{get:function(){var ve=V.primaryKey;return j.addKey(ve),ve}},value:{get:function(){return J&&D.addKey(V.primaryKey),V.value}}})}return L})}j.add(n)}}return a[_].apply(this,arguments)}}),T}})}};function wi(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===i?null:(t=o({},t),p(t.keys)&&(t.keys=t.keys.filter(function(a,f){return!(f in n.failures)})),"values"in t&&p(t.values)&&(t.values=t.values.filter(function(a,f){return!(f in n.failures)})),t)}function Ar(e,t){return n=e,((i=t).lower===void 0||(i.lowerOpen?0<ke(n,i.lower):0<=ke(n,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ke(e,t.upper)<0:ke(e,t.upper)<=0));var n,i}function ki(e,t,C,i,a,f){if(!C||C.length===0)return e;var h=t.query.index,m=h.multiEntry,y=t.query.range,b=i.schema.primaryKey.extractKey,T=h.extractKey,v=(h.lowLevelIndex||h).extractKey,C=C.reduce(function(_,x){var E=_,w=[];if(x.type==="add"||x.type==="put")for(var O=new Ye,P=x.values.length-1;0<=P;--P){var D,j=x.values[P],B=b(j);O.hasKey(B)||(D=T(j),(m&&p(D)?D.some(function(V){return Ar(V,y)}):Ar(D,y))&&(O.addKey(B),w.push(j)))}switch(x.type){case"add":var Y=new Ye().addKeys(t.values?_.map(function(J){return b(J)}):_),E=_.concat(t.values?w.filter(function(J){return J=b(J),!Y.hasKey(J)&&(Y.addKey(J),!0)}):w.map(function(J){return b(J)}).filter(function(J){return!Y.hasKey(J)&&(Y.addKey(J),!0)}));break;case"put":var q=new Ye().addKeys(x.values.map(function(J){return b(J)}));E=_.filter(function(J){return!q.hasKey(t.values?b(J):J)}).concat(t.values?w:w.map(function(J){return b(J)}));break;case"delete":var L=new Ye().addKeys(x.keys);E=_.filter(function(J){return!L.hasKey(t.values?b(J):J)});break;case"deleteRange":var G=x.range;E=_.filter(function(J){return!Ar(b(J),G)})}return E},e);return C===e?e:(C.sort(function(_,x){return ke(v(_),v(x))||ke(b(_),b(x))}),t.limit&&t.limit<1/0&&(C.length>t.limit?C.length=t.limit:e.length===t.limit&&C.length<t.limit&&(a.dirty=!0)),f?Object.freeze(C):C)}function xi(e,t){return ke(e.lower,t.lower)===0&&ke(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function No(e,t){return function(n,i,a,f){if(n===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=ke(n,i))===0){if(a&&f)return 0;if(a)return 1;if(f)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,i,a,f){if(n===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=ke(n,i))===0){if(a&&f)return 0;if(a)return-1;if(f)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Bo(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",function(){var a,f;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,f=t,setTimeout(function(){a.subscribers.size===0&&he(f,a)},3e3))})}var qo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(n,i,a){var f,h,m=e.transaction(n,i,a);return i==="readwrite"&&(h=(f=new AbortController).signal,a=function(y){return function(){if(f.abort(),i==="readwrite"){for(var b=new Set,T=0,v=n;T<v.length;T++){var C=v[T],_=At["idb://".concat(t,"/").concat(C)];if(_){var x=e.table(C),E=_.optimisticOps.filter(function(J){return J.trans===m});if(m._explicit&&y&&m.mutatedParts)for(var w=0,O=Object.values(_.queries.query);w<O.length;w++)for(var P=0,D=(Y=O[w]).slice();P<D.length;P++)Er((q=D[P]).obsSet,m.mutatedParts)&&(he(Y,q),q.subscribers.forEach(function(J){return b.add(J)}));else if(0<E.length){_.optimisticOps=_.optimisticOps.filter(function(J){return J.trans!==m});for(var j=0,B=Object.values(_.queries.query);j<B.length;j++)for(var Y,q,L,G=0,V=(Y=B[j]).slice();G<V.length;G++)(q=V[G]).res!=null&&m.mutatedParts&&(y&&!q.dirty?(L=Object.isFrozen(q.res),L=ki(q.res,q.req,E,x,q,L),q.dirty?(he(Y,q),q.subscribers.forEach(function(J){return b.add(J)})):L!==q.res&&(q.res=L,q.promise=H.resolve({result:L}))):(q.dirty&&he(Y,q),q.subscribers.forEach(function(J){return b.add(J)})))}}}b.forEach(function(J){return J()})}}},m.addEventListener("abort",a(!1),{signal:h}),m.addEventListener("error",a(!1),{signal:h}),m.addEventListener("complete",a(!0),{signal:h})),m},table:function(n){var i=e.table(n),a=i.schema.primaryKey;return o(o({},i),{mutate:function(f){var h=oe.trans;if(a.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(f);var m=At["idb://".concat(t,"/").concat(n)];return m?(h=i.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||Dr(a,f).some(function(y){return y==null}))?(m.optimisticOps.push(f),f.mutatedParts&&Bn(f.mutatedParts),h.then(function(y){0<y.numFailures&&(he(m.optimisticOps,f),(y=wi(0,f,y))&&m.optimisticOps.push(y),f.mutatedParts&&Bn(f.mutatedParts))}),h.catch(function(){he(m.optimisticOps,f),f.mutatedParts&&Bn(f.mutatedParts)})):h.then(function(y){var b=wi(0,o(o({},f),{values:f.values.map(function(T,v){var C;return y.failures[v]?T:(T=(C=a.keyPath)!==null&&C!==void 0&&C.includes(".")?xe(T):o({},T),W(T,a.keyPath,y.results[v]),T)})}),y);m.optimisticOps.push(b),queueMicrotask(function(){return f.mutatedParts&&Bn(f.mutatedParts)})}),h):i.mutate(f)},query:function(f){if(!gi(oe,i)||!bi("query",f))return i.query(f);var h=((b=oe.trans)===null||b===void 0?void 0:b.db._options.cache)==="immutable",v=oe,m=v.requery,y=v.signal,b=function(x,E,w,O){var P=At["idb://".concat(x,"/").concat(E)];if(!P)return[];if(!(E=P.queries[w]))return[null,!1,P,null];var D=E[(O.query?O.query.index.name:null)||""];if(!D)return[null,!1,P,null];switch(w){case"query":var j=D.find(function(B){return B.req.limit===O.limit&&B.req.values===O.values&&xi(B.req.query.range,O.query.range)});return j?[j,!0,P,D]:[D.find(function(B){return("limit"in B.req?B.req.limit:1/0)>=O.limit&&(!O.values||B.req.values)&&No(B.req.query.range,O.query.range)}),!1,P,D];case"count":return j=D.find(function(B){return xi(B.req.query.range,O.query.range)}),[j,!!j,P,D]}}(t,n,"query",f),T=b[0],v=b[1],C=b[2],_=b[3];return T&&v?T.obsSet=f.obsSet:(v=i.query(f).then(function(x){var E=x.result;if(T&&(T.res=E),h){for(var w=0,O=E.length;w<O;++w)Object.freeze(E[w]);Object.freeze(E)}else x.result=xe(E);return x}).catch(function(x){return _&&T&&he(_,T),Promise.reject(x)}),T={obsSet:f.obsSet,promise:v,subscribers:new Set,type:"query",req:f,dirty:!1},_?_.push(T):(_=[T],(C=C||(At["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=_)),Bo(T,_,m,y),T.promise.then(function(x){return{result:ki(x.result,f,C==null?void 0:C.optimisticOps,i,T,h)}})}})}})}};function Fn(e,t){return new Proxy(e,{get:function(n,i,a){return i==="db"?t:Reflect.get(n,i,a)}})}var at=(Re.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ce.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(i){return i._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Io),n.stores({}),this._state.autoSchema=!1,n)},Re.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||oe.letThrough||this._vip)?e():new H(function(n,i){if(t._state.openComplete)return i(new ce.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new ce.DatabaseClosed);t.open().catch(Ee)}t._state.dbReadyPromise.then(n,i)}).then(e)},Re.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:i??10,name:a}),e.sort(function(f,h){return f.level-h.level}),this},Re.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:!!n&&a.name!==n})),this},Re.prototype.open=function(){var e=this;return Ot(ut,function(){return Ao(e)})},Re.prototype._close=function(){var e=this._state,t=Vt.indexOf(this);if(0<=t&&Vt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new H(function(n){e.dbReadyResolve=n}),e.openCanceller=new H(function(n,i){e.cancelOpen=i}))},Re.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new ce.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new ce.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Re.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new H(function(a,f){function h(){t.close(e);var m=t._deps.indexedDB.deleteDatabase(t.name);m.onsuccess=De(function(){var y,b,T;y=t._deps,b=t.name,T=y.indexedDB,y=y.IDBKeyRange,kr(T)||b===En||wr(T,y).delete(b).catch(Ee),a()}),m.onerror=nt(f),m.onblocked=t._fireOnBlocked}if(n)throw new ce.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Re.prototype.backendDB=function(){return this.idbdb},Re.prototype.isOpen=function(){return this.idbdb!==null},Re.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Re.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Re.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Re.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Re.prototype.transaction=function(){var e=(function(t,n,i){var a=arguments.length;if(a<2)throw new ce.InvalidArgument("Too few arguments");for(var f=new Array(a-1);--a;)f[a-1]=arguments[a];return i=f.pop(),[t,Se(f),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Re.prototype._transaction=function(e,t,n){var i=this,a=oe.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var f,h,m=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(b){if(b=b instanceof i.Table?b.name:b,typeof b!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return b}),e=="r"||e===lr)f=lr;else{if(e!="rw"&&e!=cr)throw new ce.InvalidArgument("Invalid transaction mode: "+e);f=cr}if(a){if(a.mode===lr&&f===cr){if(!m)throw new ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&h.forEach(function(b){if(a&&a.storeNames.indexOf(b)===-1){if(!m)throw new ce.SubTransaction("Table "+b+" not included in parent transaction.");a=null}}),m&&a&&!a.active&&(a=null)}}catch(b){return a?a._promise(null,function(T,v){v(b)}):Ke(b)}var y=(function b(T,v,C,_,x){return H.resolve().then(function(){var E=oe.transless||oe,w=T._createTransaction(v,C,T._dbSchema,_);if(w.explicit=!0,E={trans:w,transless:E},_)w.idbtrans=_.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,T._state.PR1398_maxLoop=3}catch(D){return D.name===Zn.InvalidState&&T.isOpen()&&0<--T._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),T.close({disableAutoOpen:!1}),T.open().then(function(){return b(T,v,C,null,x)})):Ke(D)}var O,P=Nt(x);return P&&Ut(),E=H.follow(function(){var D;(O=x.call(w,w))&&(P?(D=ct.bind(null,null),O.then(D,D)):typeof O.next=="function"&&typeof O.throw=="function"&&(O=Or(O)))},E),(O&&typeof O.then=="function"?H.resolve(O).then(function(D){return w.active?D:Ke(new ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):E.then(function(){return O})).then(function(D){return _&&w._resolve(),w._completion.then(function(){return D})}).catch(function(D){return w._reject(D),Ke(D)})})}).bind(null,this,f,h,a,n);return a?a._promise(f,y,"lock"):oe.trans?Ot(oe.transless,function(){return i._whenReady(y)}):this._whenReady(y)},Re.prototype.table=function(e){if(!A(this._allTables,e))throw new ce.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Re);function Re(e,t){var n=this;this._middlewares={},this.verno=0;var i=Re.dependencies;this._options=t=o({addons:Re.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,f,h,m,y,b={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ee,dbReadyPromise:null,cancelOpen:Ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};b.dbReadyPromise=new H(function(v){b.dbReadyResolve=v}),b.openCanceller=new H(function(v,C){b.cancelOpen=C}),this._state=b,this.name=e,this.on=en(this,"populate","blocked","versionchange","close",{ready:[er,Ee]}),this.on.ready.subscribe=U(this.on.ready.subscribe,function(v){return function(C,_){Re.vip(function(){var x,E=n._state;E.openComplete?(E.dbOpenError||H.resolve().then(C),_&&v(C)):E.onReadyBeingFired?(E.onReadyBeingFired.push(C),_&&v(C)):(v(C),x=n,_||v(function w(){x.on.ready.unsubscribe(C),x.on.ready.unsubscribe(w)}))})}}),this.Collection=(a=this,tn(wo.prototype,function(O,w){this.db=a;var _=ei,x=null;if(w)try{_=w()}catch(P){x=P}var E=O._ctx,w=E.table,O=w.hook.reading.fire;this._ctx={table:w,index:E.index,isPrimKey:!E.index||w.schema.primKey.keyPath&&E.index===w.schema.primKey.name,range:_,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:x,or:E.or,valueMapper:O!==$t?O:null}})),this.Table=(f=this,tn(ii.prototype,function(v,C,_){this.db=f,this._tx=_,this.name=v,this.schema=C,this.hook=f._allTables[v]?f._allTables[v].hook:en(null,{creating:[fo,Ee],reading:[co,$t],updating:[po,Ee],deleting:[ho,Ee]})})),this.Transaction=(h=this,tn(To.prototype,function(v,C,_,x,E){var w=this;this.db=h,this.mode=v,this.storeNames=C,this.schema=_,this.chromeTransactionDurability=x,this.idbtrans=null,this.on=en(this,"complete","error","abort"),this.parent=E||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new H(function(O,P){w._resolve=O,w._reject=P}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(O){var P=w.active;return w.active=!1,w.on.error.fire(O),w.parent?w.parent._reject(O):P&&w.idbtrans&&w.idbtrans.abort(),Ke(O)})})),this.Version=(m=this,tn(Do.prototype,function(v){this.db=m,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(y=this,tn(li.prototype,function(v,C,_){if(this.db=y,this._ctx={table:v,index:C===":id"?null:C,or:_},this._cmp=this._ascending=ke,this._descending=function(x,E){return ke(E,x)},this._max=function(x,E){return 0<ke(x,E)?x:E},this._min=function(x,E){return ke(x,E)<0?x:E},this._IDBKeyRange=y._deps.IDBKeyRange,!this._IDBKeyRange)throw new ce.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=an(t.IDBKeyRange),this._createTransaction=function(v,C,_,x){return new n.Transaction(v,C,_,n._options.chromeTransactionDurability,x)},this._fireOnBlocked=function(v){n.on("blocked").fire(v),Vt.filter(function(C){return C.name===n.name&&C!==n&&!C._state.vcFired}).map(function(C){return C.on("versionchange").fire(v)})},this.use(Ro),this.use(qo),this.use(Mo),this.use(jo),this.use(Ko);var T=new Proxy(this,{get:function(v,C,_){if(C==="_vip")return!0;if(C==="table")return function(E){return Fn(n.table(E),T)};var x=Reflect.get(v,C,_);return x instanceof ii?Fn(x,T):C==="tables"?x.map(function(E){return Fn(E,T)}):C==="_createTransaction"?function(){return Fn(x.apply(this,arguments),T)}:x}});this.vip=T,i.forEach(function(v){return v(n)})}var Ln,et=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Fo=(jr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},jr.prototype[et]=function(){return this},jr);function jr(e){this._subscribe=e}try{Ln={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Ln={indexedDB:null,IDBKeyRange:null}}function Ti(e){var t,n=!1,i=new Fo(function(a){var f=Nt(e),h,m=!1,y={},b={},T={get closed(){return m},unsubscribe:function(){m||(m=!0,h&&h.abort(),v&&ht.storagemutated.unsubscribe(_))}};a.start&&a.start(T);var v=!1,C=function(){return ur(x)},_=function(E){Nn(y,E),Er(b,y)&&C()},x=function(){var E,w,O;!m&&Ln.indexedDB&&(y={},E={},h&&h.abort(),h=new AbortController,O=function(P){var D=Ft();try{f&&Ut();var j=lt(e,P);return j=f?j.finally(ct):j}finally{D&&Lt()}}(w={subscr:E,signal:h.signal,requery:C,querier:e,trans:null}),Promise.resolve(O).then(function(P){n=!0,t=P,m||w.signal.aborted||(y={},function(D){for(var j in D)if(A(D,j))return;return 1}(b=E)||v||(ht(on,_),v=!0),ur(function(){return!m&&a.next&&a.next(P)}))},function(P){n=!1,["DatabaseClosedError","AbortError"].includes(P==null?void 0:P.name)||m||ur(function(){m||a.error&&a.error(P)})}))};return setTimeout(C,0),T});return i.hasValue=function(){return n},i.getValue=function(){return t},i}var jt=at;function Kr(e){var t=pt;try{pt=!0,ht.storagemutated.fire(e),Ir(e,!0)}finally{pt=t}}S(jt,o(o({},vn),{delete:function(e){return new jt(e,{addons:[]}).delete()},exists:function(e){return new jt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=jt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(kr(n)?Promise.resolve(n.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==En})}):wr(n,t).toCollection().primaryKeys()).then(e)}catch{return Ke(new ce.MissingAPI)}var t,n},defineClass:function(){return function(e){g(this,e)}},ignoreTransaction:function(e){return oe.trans?Ot(oe.transless,e):e()},vip:xr,async:function(e){return function(){try{var t=Or(e.apply(this,arguments));return t&&typeof t.then=="function"?t:H.resolve(t)}catch(n){return Ke(n)}}},spawn:function(e,t,n){try{var i=Or(e.apply(n,t||[]));return i&&typeof i.then=="function"?i:H.resolve(i)}catch(a){return Ke(a)}},currentTransaction:{get:function(){return oe.trans||null}},waitFor:function(e,t){return t=H.resolve(typeof e=="function"?jt.ignoreTransaction(e):e).timeout(t||6e4),oe.trans?oe.trans.waitFor(t):t},Promise:H,debug:{get:function(){return tt},set:function(e){Wr(e)}},derive:se,extend:g,props:S,override:U,Events:en,on:ht,liveQuery:Ti,extendObservabilitySet:Nn,getByKeyPath:ue,setByKeyPath:W,delByKeyPath:function(e,t){typeof t=="string"?W(e,t,void 0):"length"in t&&[].map.call(t,function(n){W(e,n,void 0)})},shallowClone:te,deepClone:xe,getObjectDiff:Pr,cmp:ke,asap:fe,minKey:-1/0,addons:[],connections:Vt,errnames:Zn,dependencies:Ln,cache:At,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),jt.maxKey=an(jt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ht(on,function(e){pt||(e=new CustomEvent(pr,{detail:e}),pt=!0,dispatchEvent(e),pt=!1)}),addEventListener(pr,function(e){e=e.detail,pt||Kr(e)}));var Gt,pt=!1,Ei=function(){};return typeof BroadcastChannel<"u"&&((Ei=function(){(Gt=new BroadcastChannel(pr)).onmessage=function(e){return e.data&&Kr(e.data)}})(),typeof Gt.unref=="function"&&Gt.unref(),ht(on,function(e){pt||Gt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!at.disableBfCache&&e.persisted){tt&&console.debug("Dexie: handling persisted pagehide"),Gt!=null&&Gt.close();for(var t=0,n=Vt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!at.disableBfCache&&e.persisted&&(tt&&console.debug("Dexie: handling persisted pageshow"),Ei(),Kr({all:new Ye(-1/0,[[]])}))})),H.rejectionMapper=function(e,t){return!e||e instanceof Bt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Gr[e.name]?e:(t=new Gr[e.name](t||e.message,e),"stack"in e&&Z(t,"stack",{get:function(){return this.inner.stack}}),t)},Wr(tt),o(at,Object.freeze({__proto__:null,Dexie:at,liveQuery:Ti,Entity:ti,cmp:ke,PropModification:nn,replacePrefix:function(e,t){return new nn({replacePrefix:[e,t]})},add:function(e){return new nn({add:e})},remove:function(e){return new nn({remove:e})},default:at,RangeSet:Ye,mergeRanges:ln,rangesOverlap:pi}),{default:at}),at})})(io);var Qo=io.exports;const Nr=Xo(Qo),Pi=Symbol.for("Dexie"),Qn=globalThis[Pi]||(globalThis[Pi]=Nr);if(Nr.semVer!==Qn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Nr.semVer} and ${Qn.semVer}`);const{liveQuery:ns,mergeRanges:rs,rangesOverlap:is,RangeSet:os,cmp:as,Entity:ss,PropModification:us,replacePrefix:ls,add:cs,remove:fs}=Qn;class Jo extends Qn{constructor(){super("MeditationGameDB");Si(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const fn=new Jo,dn=[{id:"L1",name:"Level 1",minDuration:Ne.ONE_MINUTE,maxDuration:Ne.FIVE_MINUTES,description:"Sit. Breathe. Notice the mind.",instructions:["Sit comfortably","Focus on the feeling of breath through your nose","Tap when you notice the mind has wandered","Gently return to the breath each time"],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:Ne.TWO_MINUTES,maxDuration:Ne.TEN_MINUTES,description:"Let go of counting and images.",instructions:["Focus on the breath through your nose","Don’t count, visualize, or repeat words","Tap when your mind wanders","Return to the breath, without mental help"],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:Ne.FIVE_MINUTES,maxDuration:Ne.FIFTEEN_MINUTES,description:"Observe thoughts as they arise.",instructions:["Focus on the breath through your nose","Don’t use any counting or mental images","Tap when distracted, then silently observe the thought","Label it if you can (e.g. “planning,” “judging”)","Let it go and return to the breath"],completionTasks:[{id:"two_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]},{id:"L4",name:"Level 4",minDuration:Ne.FIVE_MINUTES,maxDuration:Ne.FIFTEEN_MINUTES,description:"Notice how you react to yourself.",instructions:["Keep observing the breath","No counting or images","Tap when distracted, observe the thought","Then notice how you feel about getting distracted","If there’s frustration or judgment, notice that too — and let it go"],completionTasks:[{id:"two_sessions_under_5_taps",description:"Have 2 sessions in a row with fewer than 5 taps"},{id:"one_min_no_taps_twice",description:"Go 1 minute without a tap in 2 separate sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions","max_duration"]}}]},{id:"L5",name:"Level 5",minDuration:Ne.TEN_MINUTES,maxDuration:Ne.THIRTY_MINUTES,description:"Everything changes. Keep observing.",instructions:["Keep observing breath and distractions","Tap when the mind wanders, observe the thought, notice your reaction","Then remember: everything changes — including this","Let the distraction and your reaction pass","Return to the breath with calm awareness"],completionTasks:[{id:"session_with_3_or_fewer_taps",description:"Have one session with 3 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"two_min_no_taps",description:"Go 2 minutes without tapping"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps","max_duration"]}}]},{id:"L6",name:"Level 6",minDuration:Ne.FIFTEEN_MINUTES,maxDuration:Ne.SIXTY_MINUTES,description:"Sit still. Stay with discomfort.",instructions:["Observe breath, distractions, and reactions as before","Sit still in your chosen posture for the full session","If discomfort arises, don’t shift — just observe it","Notice the discomfort, let it change, and return to breath","Everything will pass"],completionTasks:[{id:"three_min_no_taps",description:"Go 3 minutes without a tap"},{id:"session_with_2_or_fewer_taps",description:"Have a session with 2 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"distractions_early_on",description:"Finish a sit with multiple distractions early on"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions","distractions_early_on","max_duration"]}}]}];function Di(u,r,s){const o=u.slice();return o[9]=r[s],o[11]=s,o}function Ai(u){let r,s,o=u[9]+"";return{c(){r=Q("p"),s=new Go(!1),this.h()},l(c){r=X(c,"P",{class:!0,style:!0});var l=le(r);s=zo(l,!1),l.forEach(K),this.h()},h(){s.a=null,N(r,"class","text-lg max-w-sm fade-in svelte-1quun7c"),mt(r,"animation-delay",u[11]+"s")},m(c,l){ne(c,r,l),s.m(o,r)},p:Be,d(c){c&&K(r)}}}function Zo(u){let r,s,o,c,l,d,p,g,k,I,A,S=Mr[u[1]]+"",F,Z,se,$=Qe(u[2]),M=[];for(let ee=0;ee<$.length;ee+=1)M[ee]=Ai(Di(u,$,ee));return{c(){r=Q("div"),s=Q("button"),o=ie("Exit Meditation"),c=ge();for(let ee=0;ee<M.length;ee+=1)M[ee].c();l=ge(),d=Q("div"),p=Q("button"),g=ie("Start meditation countdown"),k=ge(),I=Q("i"),A=ie("Meditating for "),F=ie(S),this.h()},l(ee){r=X(ee,"DIV",{class:!0});var U=le(r);s=X(U,"BUTTON",{class:!0,style:!0});var z=le(s);o=re(z,"Exit Meditation"),z.forEach(K),c=_e(U);for(let te=0;te<M.length;te+=1)M[te].l(U);l=_e(U),d=X(U,"DIV",{class:!0});var fe=le(d);p=X(fe,"BUTTON",{class:!0,style:!0});var ue=le(p);g=re(ue,"Start meditation countdown"),ue.forEach(K),k=_e(fe),I=X(fe,"I",{class:!0,style:!0});var W=le(I);A=re(W,"Meditating for "),F=re(W,S),W.forEach(K),fe.forEach(K),U.forEach(K),this.h()},h(){N(s,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 fade-in svelte-1quun7c"),mt(s,"animation-delay",u[2].length+"s"),N(p,"class","btn variant-filled px-4 py-2 mt-8 fade-in svelte-1quun7c"),mt(p,"animation-delay",u[2].length+"s"),N(I,"class","text-sm text-gray-500 fade-in svelte-1quun7c"),mt(I,"animation-delay",u[2].length+"s"),N(d,"class","flex flex-col items-center space-y-4"),N(r,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(ee,U){ne(ee,r,U),R(r,s),R(s,o),R(r,c);for(let z=0;z<M.length;z+=1)M[z]&&M[z].m(r,null);R(r,l),R(r,d),R(d,p),R(p,g),R(d,k),R(d,I),R(I,A),R(I,F),Z||(se=[st(s,"click",u[3]),st(p,"click",function(){Yo(u[0])&&u[0].apply(this,arguments)})],Z=!0)},p(ee,[U]){if(u=ee,U&4){$=Qe(u[2]);let z;for(z=0;z<$.length;z+=1){const fe=Di(u,$,z);M[z]?M[z].p(fe,U):(M[z]=Ai(fe),M[z].c(),M[z].m(r,l))}for(;z<M.length;z+=1)M[z].d(1);M.length=$.length}U&2&&S!==(S=Mr[u[1]]+"")&&Oe(F,S)},i:Be,o:Be,d(ee){ee&&K(r),Mt(M,ee),Z=!1,qr(se)}}}function ea(u,r,s){let{nextStep:o}=r,{closeModal:c}=r,{duration:l}=r,{levelId:d="L1"}=r;const p=dn.find(S=>S.id===d),g=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],k=(p==null?void 0:p.instructions)||g;let I=0;Fr(()=>{je.capture("instructions_viewed",{level:d});const S=setInterval(()=>{I<k.length+1?I+=1:clearInterval(S)},1e3)});const A=()=>{je.capture("instructions_exit",{instructions_viewed:I,level:d}),c()};return u.$$set=S=>{"nextStep"in S&&s(0,o=S.nextStep),"closeModal"in S&&s(4,c=S.closeModal),"duration"in S&&s(1,l=S.duration),"levelId"in S&&s(5,d=S.levelId)},[o,l,k,A,c,d]}class ta extends _t{constructor(r){super(),gt(this,r,ea,Zo,yt,{nextStep:0,closeModal:4,duration:1,levelId:5})}}const na=u=>{const r=u%60;return(u/60>1?`${Math.floor(u/60)}:`:"")+`${r<10?"0":""}${r}`};function Wt(u){const r=u/60;return Number.isInteger(r)?r:Math.round(r*10)/10}let zn=null,Gn=null;const ji=`${$o}/sounds/gong.mp4`;function Yr(){return zn||(zn=new(window.AudioContext||window.webkitAudioContext),je.capture("audio_context_created",{state:zn.state,user_agent:navigator.userAgent})),zn}async function oo(){try{const u=Yr();u.state==="suspended"&&(await u.resume(),je.capture("audio_context_resumed",{state:u.state,user_agent:navigator.userAgent}))}catch(u){je.capture("audio_context_resume_failed",{error:String(u),user_agent:navigator.userAgent})}}async function ao(){if(Gn)return Gn;try{const u=Yr(),r=await fetch(ji),s=r.headers.get("Content-Type"),o=r.headers.get("Content-Length");je.capture("audio_fetch_response",{status:r.status,ok:r.ok,content_type:s,content_length:o,user_agent:navigator.userAgent});const c=await r.arrayBuffer();je.capture("audio_arraybuffer_fetched",{byte_length:c.byteLength,user_agent:navigator.userAgent});try{return Gn=await u.decodeAudioData(c),je.capture("audio_buffer_loaded",{buffer_byte_length:c.byteLength,user_agent:navigator.userAgent}),Gn}catch(l){throw je.capture("audio_buffer_decode_failed",{error:String(l),byte_length:c.byteLength,content_type:s,url:ji,user_agent:navigator.userAgent,language:navigator.language}),l}}catch(u){throw je.capture("audio_buffer_load_failed",{error:String(u),user_agent:navigator.userAgent}),u}}async function ra(){try{await oo(),await ao(),je.capture("audio_preload_success",{user_agent:navigator.userAgent})}catch(u){je.capture("audio_preload_failed",{error:String(u),user_agent:navigator.userAgent})}}function ia(u){let r,s,o,c,l,d;return{c(){r=Yn("svg"),s=Yn("circle"),o=Yn("circle"),l=Yn("text"),d=ie(u[1]),this.h()},l(p){r=Vn(p,"svg",{class:!0,viewBox:!0});var g=le(r);s=Vn(g,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),le(s).forEach(K),o=Vn(g,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),le(o).forEach(K),l=Vn(g,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var k=le(l);d=re(k,u[1]),k.forEach(K),g.forEach(K),this.h()},h(){N(s,"cx","50"),N(s,"cy","50"),N(s,"r","40"),N(s,"stroke","gray"),N(s,"stroke-width","5"),N(s,"fill","none"),N(o,"cx","50"),N(o,"cy","50"),N(o,"r","40"),N(o,"stroke","blue"),N(o,"stroke-width","5"),N(o,"fill","none"),N(o,"stroke-dasharray","251.2"),N(o,"stroke-dashoffset",c=251.2*u[0]),N(o,"transform","rotate(-90 50 50)"),N(l,"x","50"),N(l,"y","55"),N(l,"font-size","14"),N(l,"text-anchor","middle"),N(l,"fill","black"),N(r,"class","w-32 h-32"),N(r,"viewBox","0 0 100 100")},m(p,g){ne(p,r,g),R(r,s),R(r,o),R(r,l),R(l,d)},p(p,[g]){g&1&&c!==(c=251.2*p[0])&&N(o,"stroke-dashoffset",c),g&2&&Oe(d,p[1])},i:Be,o:Be,d(p){p&&K(r)}}}function oa(u,r,s){let o,c,{duration:l}=r,{startTimestamp:d}=r;const p=ro();let g=Hn(l),k=null,I;const A=Ii(g,$=>na($));$n(u,A,$=>s(1,c=$));const S=Ii(g,$=>$/l);$n(u,S,$=>s(0,o=$));const F=async()=>{try{const $=Yr();await oo();const M=await ao(),ee=$.createBufferSource();ee.buffer=M,ee.connect($.destination),ee.start(0),je.capture("audio_played_successfully",{context_state:$.state,user_agent:navigator.userAgent})}catch($){je.capture("audio_play_failed",{error:String($),user_agent:navigator.userAgent,language:navigator.language})}},Z=()=>{clearInterval(I),F(),p("complete")},se=async $=>{try{if(!("wakeLock"in navigator))return;$?k=await navigator.wakeLock.request("screen"):k&&(await k.release(),k=null)}catch(M){console.error(`Wake Lock ${$?"request":"release"} failed:`,M)}};return Fr(()=>{s(4,d=Date.now()),I=setInterval(()=>{g.update($=>$>0?$-1:(Z(),0))},1e3),se(!0)}),Wo(()=>{clearInterval(I),se(!1)}),u.$$set=$=>{"duration"in $&&s(5,l=$.duration),"startTimestamp"in $&&s(4,d=$.startTimestamp)},[o,c,A,S,d,l]}class so extends _t{constructor(r){super(),gt(this,r,oa,ia,yt,{duration:5,startTimestamp:4})}}function aa(u){let r,s,o,c="Your meditation starts in:",l,d,p,g,k,I="Exit Meditation",A,S,F,Z;function se(M){u[6](M)}let $={duration:sa};return u[0]!==void 0&&($.startTimestamp=u[0]),d=new so({props:$}),Lr.push(()=>Vr(d,"startTimestamp",se)),d.$on("complete",u[1]),{c(){r=Q("div"),s=Q("div"),o=Q("p"),o.textContent=c,l=ge(),xt(d.$$.fragment),g=ge(),k=Q("button"),k.textContent=I,this.h()},l(M){r=X(M,"DIV",{class:!0});var ee=le(r);s=X(ee,"DIV",{class:!0});var U=le(s);o=X(U,"P",{class:!0,"data-svelte-h":!0}),Le(o)!=="svelte-1tp8zka"&&(o.textContent=c),l=_e(U),kt(d.$$.fragment,U),U.forEach(K),g=_e(ee),k=X(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(k)!=="svelte-hy6wnc"&&(k.textContent=I),ee.forEach(K),this.h()},h(){N(o,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto"),N(k,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(M,ee){ne(M,r,ee),R(r,s),R(s,o),R(s,l),wt(d,s,null),R(r,g),R(r,k),S=!0,F||(Z=st(k,"click",u[2]),F=!0)},p(M,[ee]){const U={};!p&&ee&1&&(p=!0,U.startTimestamp=M[0],Ur(()=>p=!1)),d.$set(U)},i(M){S||(Me(d.$$.fragment,M),M&&vt(()=>{S&&(A||(A=We(k,He,{},!0)),A.run(1))}),S=!0)},o(M){Ue(d.$$.fragment,M),M&&(A||(A=We(k,He,{},!1)),A.run(0)),S=!1},d(M){M&&K(r),bt(d),M&&A&&A.end(),F=!1,Z()}}}const sa=10;function ua(u,r,s){let{nextStep:o}=r,{closeModal:c}=r,{levelId:l="L1"}=r,d=0;je.capture("countdown_started",{level:l});const p=()=>{je.capture("countdown_complete",{level:l}),o()},g=()=>{je.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:l}),c()};function k(I){d=I,s(0,d)}return u.$$set=I=>{"nextStep"in I&&s(3,o=I.nextStep),"closeModal"in I&&s(4,c=I.closeModal),"levelId"in I&&s(5,l=I.levelId)},[d,p,g,o,c,l,k]}class la extends _t{constructor(r){super(),gt(this,r,ua,aa,yt,{nextStep:3,closeModal:4,levelId:5})}}function ca(u){let r,s;return{c(){r=Q("br"),s=Q("br")},l(o){r=X(o,"BR",{}),s=X(o,"BR",{})},m(o,c){ne(o,r,c),ne(o,s,c)},p:Be,d(o){o&&(K(r),K(s))}}}function fa(u){let r,s,o;return{c(){r=Q("i"),s=ie(u[2]),o=ie(" distraction"),this.h()},l(c){r=X(c,"I",{class:!0});var l=le(r);s=re(l,u[2]),o=re(l," distraction"),l.forEach(K),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(c,l){ne(c,r,l),R(r,s),R(r,o)},p(c,l){l&4&&Oe(s,c[2])},d(c){c&&K(r)}}}function da(u){let r,s,o;return{c(){r=Q("i"),s=ie(u[2]),o=ie(" distractions"),this.h()},l(c){r=X(c,"I",{class:!0});var l=le(r);s=re(l,u[2]),o=re(l," distractions"),l.forEach(K),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(c,l){ne(c,r,l),R(r,s),R(r,o)},p(c,l){l&4&&Oe(s,c[2])},d(c){c&&K(r)}}}function Ki(u){let r;return{c(){r=Q("div"),this.h()},l(s){r=X(s,"DIV",{class:!0,style:!0}),le(r).forEach(K),this.h()},h(){N(r,"class","ripple svelte-1wv6db6"),mt(r,"top",u[3].y+"px"),mt(r,"left",u[3].x+"px")},m(s,o){ne(s,r,o)},p(s,o){o&8&&mt(r,"top",s[3].y+"px"),o&8&&mt(r,"left",s[3].x+"px")},d(s){s&&K(r)}}}function ha(u){let r,s,o,c,l,d,p="Tap anywhere on the screen to record your distractions",g,k,I,A,S,F="Exit Meditation",Z,se,$,M;function ee(te){u[11](te)}let U={duration:u[0]};u[1]!==void 0&&(U.startTimestamp=u[1]),o=new so({props:U}),Lr.push(()=>Vr(o,"startTimestamp",ee)),o.$on("complete",u[8]);function z(te,ye){return te[2]>1||te[2]==0?da:te[2]==1?fa:ca}let fe=z(u),ue=fe(u),W=u[3]&&Ki(u);return{c(){r=Q("div"),s=Q("div"),xt(o.$$.fragment),l=ge(),d=Q("p"),d.textContent=p,g=ge(),ue.c(),k=ge(),I=Q("button"),W&&W.c(),A=ge(),S=Q("button"),S.textContent=F,this.h()},l(te){r=X(te,"DIV",{class:!0});var ye=le(r);s=X(ye,"DIV",{class:!0});var Se=le(s);kt(o.$$.fragment,Se),l=_e(Se),d=X(Se,"P",{class:!0,"data-svelte-h":!0}),Le(d)!=="svelte-1uyhl39"&&(d.textContent=p),g=_e(Se),ue.l(Se),Se.forEach(K),k=_e(ye),I=X(ye,"BUTTON",{class:!0});var Ve=le(I);W&&W.l(Ve),Ve.forEach(K),A=_e(ye),S=X(ye,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(S)!=="svelte-hy6wnc"&&(S.textContent=F),ye.forEach(K),this.h()},h(){N(d,"class","text-lg mt-4 text-center"),N(s,"class","absolute flex flex-col items-center pointer-events-auto p-6"),N(I,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),N(S,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(r,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(te,ye){ne(te,r,ye),R(r,s),wt(o,s,null),R(s,l),R(s,d),R(s,g),ue.m(s,null),R(r,k),R(r,I),W&&W.m(I,null),R(r,A),R(r,S),se=!0,$||(M=[st(I,"click",u[6]),st(S,"click",u[7])],$=!0)},p(te,[ye]){const Se={};ye&1&&(Se.duration=te[0]),!c&&ye&2&&(c=!0,Se.startTimestamp=te[1],Ur(()=>c=!1)),o.$set(Se),fe===(fe=z(te))&&ue?ue.p(te,ye):(ue.d(1),ue=fe(te),ue&&(ue.c(),ue.m(s,null))),te[3]?W?W.p(te,ye):(W=Ki(te),W.c(),W.m(I,null)):W&&(W.d(1),W=null)},i(te){se||(Me(o.$$.fragment,te),te&&vt(()=>{se&&(Z||(Z=We(S,He,{},!0)),Z.run(1))}),se=!0)},o(te){Ue(o.$$.fragment,te),te&&(Z||(Z=We(S,He,{},!1)),Z.run(0)),se=!1},d(te){te&&K(r),bt(o),ue.d(),W&&W.d(),te&&Z&&Z.end(),$=!1,qr(M)}}}function pa(u,r,s){let o,c,{nextStep:l}=r,{duration:d}=r,{levelId:p="L1"}=r;const g=ro();let k=0;const I=Hn(0);$n(u,I,M=>s(2,o=M));const A=Hn([]),S=Hn(null);$n(u,S,M=>s(3,c=M));const F=M=>{const ee=(Date.now()-k)/1e3;I.update(W=>W+1),A.update(W=>[...W,ee]),console.log(`Click ${Rt(I)} recorded at ${ee} seconds`),je.capture("game_tap",{timestamp:ee,total_taps:Rt(I),level:p,button:"distracted"});const{clientX:U,clientY:z,currentTarget:fe}=M,ue=fe.getBoundingClientRect();S.set({x:U-ue.left,y:z-ue.top}),setTimeout(()=>S.set(null),600)},Z=()=>{const M=(Date.now()-k)/1e3;je.capture("meditation_exit",{duration_meditated:M,total_taps:Rt(A).length,level:p}),g("complete",{clickTimestamps:Rt(A),durationMeditated:M,completed:d-M<5}),l()},se=()=>{console.log("Meditation complete! Click data:",Rt(A)),je.capture("meditation_completed",{duration:d,total_taps:Rt(A).length,level:p}),g("complete",{clickTimestamps:Rt(A),durationMeditated:d,completed:!0}),l()};function $(M){k=M,s(1,k)}return u.$$set=M=>{"nextStep"in M&&s(9,l=M.nextStep),"duration"in M&&s(0,d=M.duration),"levelId"in M&&s(10,p=M.levelId)},[d,k,o,c,I,S,F,Z,se,l,p,$]}class ma extends _t{constructor(r){super(),gt(this,r,pa,ha,yt,{nextStep:9,duration:0,levelId:10})}}function va(u){const r=Math.floor(u.durationMeditated/60),s=u.clickTimestamps.length,o=u.newStarRating-u.previousStarRating,c="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share",l=u.levelId.replace(/^\D+/g,""),d=Object.entries(u.completionTaskResults).map(p=>p[1]?"✅":"🔲").join("");return o>0?`Major win! 🧘‍♂️  I just earned a new ⭐ in The Meditation Game!
I did a ${r}‑min meditation with only ${s} distractions.
I'm at ${"⭐".repeat(u.newStarRating)} on Level ${l} (${d})!
Learn and practice meditation here: ${c}`:u.isNewPersonalBest?`Mini‑win in The Meditation Game: my new personal best!
${r}‑min sit • only ${s} ${s===1?"mind-wander":"mind-wanders"} • ${"⭐".repeat(u.newStarRating)} on Level ${l} (${d})
Learn and practice meditation here: ${c}`:`Sharing todays practice in The Meditation Game.
I did a ${r}‑min meditation with only ${s} distractions.
I'm at ${"⭐".repeat(u.newStarRating)} on Level ${l} (${d}).
Learn and practice meditation here: ${c}`}function ya(u){return u.newStarRating-u.previousStarRating>0?"A":u.isNewPersonalBest?"B":"C"}function uo(u){return u.filter(r=>r.completed).sort((r,s)=>s.duration!==r.duration?s.duration-r.duration:r.tapCount!==s.tapCount?r.tapCount-s.tapCount:s.timestamp-r.timestamp)[0]??null}function _a(u,r,s){const{scope:o,requirement:c}=u;return o==="cumulative"?Ri(c,r):s.some(l=>Ri(c,l))}function Ri(u,r){if(u.type==="minTasks"){const{count:s,from:o}=u;return o==="all"?r.size>=s:o.filter(l=>r.has(l)).length>=s}return u.type==="specificTasks"?u.taskIds.every(s=>r.has(s)):!1}function Br(u,r,s){const o=[...u].sort((c,l)=>l.stars-c.stars);for(const c of o)if(_a(c,r,s))return c.stars;return 0}function ga(u){if(u.length<2)return 0;const r=[...u].sort((o,c)=>o.timestamp-c.timestamp);let s=0;for(let o=1;o<r.length;o++){const c=r[o-1],l=r[o],d=c.tapCount/Math.max(c.duration,1),p=l.tapCount/Math.max(l.duration,1);(p<d||Math.abs(p-d)<=.005&&l.duration>c.duration)&&s++}return s}function Wn(u){if(!u.tapTimestamps||u.tapTimestamps.length===0)return u.duration/60;const r=[];r.push(u.tapTimestamps[0]);for(let o=1;o<u.tapTimestamps.length;o++)r.push(u.tapTimestamps[o]-u.tapTimestamps[o-1]);const s=u.tapTimestamps[u.tapTimestamps.length-1];return r.push(u.duration-s),Math.max(...r)}const Mi=(u,r)=>u.filter(r).length,cn=(u,r)=>u.some(r),it={tap_once:([u])=>({completed:(u==null?void 0:u.tapCount)>=1,info:""}),no_early_exit:([u])=>({completed:(u==null?void 0:u.completed)===!0,info:""}),session_under_5_taps:([u])=>({completed:(u==null?void 0:u.tapCount)<=5,info:""}),session_with_2_or_fewer_taps:u=>({completed:cn(u,r=>r.tapCount<=2),info:""}),session_with_3_or_fewer_taps:u=>({completed:cn(u,r=>r.tapCount<=3),info:""}),distractions_early_on:([u])=>{var r;return{completed:((r=u==null?void 0:u.tapTimestamps)==null?void 0:r.filter(s=>s<=60).length)>=2,info:""}},complete_2_sessions:u=>({completed:u.length>=2,info:u.length===0||u.length>=2?"":"(1/2 complete)"}),complete_3_sessions:u=>({completed:u.length>=3,info:u.length===0||u.length>=3?"":`(${u.length}/3 complete)`}),two_sessions_under_5_taps:u=>{let r=0;for(let s=u.length-1;s>=0;s--)if(u[s].tapCount<5){if(r++,r===2)break}else r=0;return{completed:r===2,info:u.length===0||r===2?"":`(${Math.min(r,1)}/2 complete)`}},two_sessions_under_8_taps:u=>{const r=Mi(u,s=>s.tapCount<=8);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},one_min_no_taps:u=>({completed:cn(u,r=>Wn(r)>=60),info:""}),one_min_no_taps_twice:u=>{const r=Mi(u,s=>Wn(s)>=60);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},two_min_no_taps:u=>({completed:cn(u,r=>Wn(r)>=120),info:""}),three_min_no_taps:u=>({completed:cn(u,r=>Wn(r)>=180),info:""}),improve_tap_count_2_sessions:u=>{const r=ga(u);return{completed:r>=2,info:u.length===0||r>=2?"":`(${r}/2 complete)`}},max_duration:(u,r)=>({completed:u.some(s=>s.duration>=r.maxDuration),info:""})};async function Jn(u){const r=dn.find(c=>c.id===u);if(!r)return{};const s=await fn.sessions.where("levelId").equals(u).toArray(),o={};for(const c of r.completionTasks){const l=it[c.id];if(!l){console.warn(`Missing evaluator for task '${c.id}' in level '${u}'`),o[c.id]={completed:!1};continue}o[c.id]={...c,...l(s,r)}}return o}async function ba(){var r;const u=[];for(let s=0;s<dn.length;s++){const o=dn[s],c=await fn.sessions.where("levelId").equals(o.id).toArray(),l=s===0||(((r=u[s-1])==null?void 0:r.starRating)??0)>1;let d=null,p,g=null;if(l){d=await Jn(o.id);const k=new Set(Object.entries(d).filter(([A,S])=>S.completed).map(([A])=>A)),I=c.map(A=>new Set(o.completionTasks.filter(S=>{var F;return(F=it[S.id])==null?void 0:F.call(it,[A],o).completed}).map(S=>S.id)));p=Br(o.starRules,k,I),g=uo(c)}u.push({level:o,isUnlocked:l,taskCompletion:d,starRating:p,bestSession:g})}return u}function Ni(u,r,s){const o=u.slice();return o[9]=r[s][0],o[10]=r[s][1],o}function Bi(u,r,s){const o=u.slice();return o[9]=r[s],o[14]=s,o}function qi(u){let r;function s(l,d){return l[0].newStarRating===3?ka:wa}let o=s(u),c=o(u);return{c(){r=Q("p"),c.c(),this.h()},l(l){r=X(l,"P",{class:!0});var d=le(r);c.l(d),d.forEach(K),this.h()},h(){N(r,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(l,d){ne(l,r,d),c.m(r,null)},p(l,d){o===(o=s(l))&&c?c.p(l,d):(c.d(1),c=o(l),c&&(c.c(),c.m(r,null)))},d(l){l&&K(r),c.d()}}}function wa(u){let r,s=u[0].newStarRating-u[0].previousStarRating+"",o,c;return{c(){r=ie("You earned +"),o=ie(s),c=ie(" ⭐ — keep going!")},l(l){r=re(l,"You earned +"),o=re(l,s),c=re(l," ⭐ — keep going!")},m(l,d){ne(l,r,d),ne(l,o,d),ne(l,c,d)},p(l,d){d&1&&s!==(s=l[0].newStarRating-l[0].previousStarRating+"")&&Oe(o,s)},d(l){l&&(K(r),K(o),K(c))}}}function ka(u){let r;return{c(){r=ie("You've mastered this level! ✨")},l(s){r=re(s,"You've mastered this level! ✨")},m(s,o){ne(s,r,o)},p:Be,d(s){s&&K(r)}}}function Fi(u){let r,s=u[14]<u[0].newStarRating?"⭐":"☆",o,c;return{c(){r=Q("span"),o=ie(s),c=ge(),this.h()},l(l){r=X(l,"SPAN",{class:!0});var d=le(r);o=re(d,s),c=_e(d),d.forEach(K),this.h()},h(){N(r,"class","text-xl")},m(l,d){ne(l,r,d),R(r,o),R(r,c)},p(l,d){d&1&&s!==(s=l[14]<l[0].newStarRating?"⭐":"☆")&&Oe(o,s)},d(l){l&&K(r)}}}function xa(u){let r,s="You completed your meditation distraction-free!";return{c(){r=Q("p"),r.textContent=s,this.h()},l(o){r=X(o,"P",{class:!0,"data-svelte-h":!0}),Le(r)!=="svelte-j87uf1"&&(r.textContent=s),this.h()},h(){N(r,"class","text-lg mt-4")},m(o,c){ne(o,r,c)},p:Be,d(o){o&&K(r)}}}function Ta(u){let r,s,o=u[4](u[0].durationMeditated)+"",c,l,d,p,g=u[2]===1?"":"s",k,I,A,S,F,Z,se,$=Number(u[3])===1?"":"s",M,ee;return{c(){r=Q("p"),s=ie("You meditated for "),c=ie(o),l=ie(" and recorded "),d=ie(u[2]),p=ie(" distraction"),k=ie(g),I=ie("."),A=ge(),S=Q("p"),F=ie("That's about "),Z=ie(u[3]),se=ie(" distraction"),M=ie($),ee=ie(" per minute."),this.h()},l(U){r=X(U,"P",{class:!0});var z=le(r);s=re(z,"You meditated for "),c=re(z,o),l=re(z," and recorded "),d=re(z,u[2]),p=re(z," distraction"),k=re(z,g),I=re(z,"."),z.forEach(K),A=_e(U),S=X(U,"P",{class:!0});var fe=le(S);F=re(fe,"That's about "),Z=re(fe,u[3]),se=re(fe," distraction"),M=re(fe,$),ee=re(fe," per minute."),fe.forEach(K),this.h()},h(){N(r,"class","text-lg mt-4"),N(S,"class","text-lg mt-2")},m(U,z){ne(U,r,z),R(r,s),R(r,c),R(r,l),R(r,d),R(r,p),R(r,k),R(r,I),ne(U,A,z),ne(U,S,z),R(S,F),R(S,Z),R(S,se),R(S,M),R(S,ee)},p(U,z){z&1&&o!==(o=U[4](U[0].durationMeditated)+"")&&Oe(c,o)},d(U){U&&(K(r),K(A),K(S))}}}function Ea(u){let r,s,o=u[0].personalBest.tapCount+"",c,l,d=Wt(u[0].personalBest.duration)+"",p,g;return{c(){r=Q("p"),s=ie("Best so far: "),c=ie(o),l=ie(" taps · "),p=ie(d),g=ie(" min."),this.h()},l(k){r=X(k,"P",{class:!0});var I=le(r);s=re(I,"Best so far: "),c=re(I,o),l=re(I," taps · "),p=re(I,d),g=re(I," min."),I.forEach(K),this.h()},h(){N(r,"class","mt-4 text-muted-foreground")},m(k,I){ne(k,r,I),R(r,s),R(r,c),R(r,l),R(r,p),R(r,g)},p(k,I){I&1&&o!==(o=k[0].personalBest.tapCount+"")&&Oe(c,o),I&1&&d!==(d=Wt(k[0].personalBest.duration)+"")&&Oe(p,d)},d(k){k&&K(r)}}}function Sa(u){let r,s,o=u[0].personalBest.tapCount+"",c,l,d=Wt(u[0].personalBest.duration)+"",p,g;return{c(){r=Q("p"),s=ie("New personal best 🎉 — "),c=ie(o),l=ie(" taps over "),p=ie(d),g=ie(" min."),this.h()},l(k){r=X(k,"P",{class:!0});var I=le(r);s=re(I,"New personal best 🎉 — "),c=re(I,o),l=re(I," taps over "),p=re(I,d),g=re(I," min."),I.forEach(K),this.h()},h(){N(r,"class","mt-4 text-green-600 font-medium animate-fade-in svelte-tnqxsb")},m(k,I){ne(k,r,I),R(r,s),R(r,c),R(r,l),R(r,p),R(r,g)},p(k,I){I&1&&o!==(o=k[0].personalBest.tapCount+"")&&Oe(c,o),I&1&&d!==(d=Wt(k[0].personalBest.duration)+"")&&Oe(p,d)},d(k){k&&K(r)}}}function Li(u){let r,s,o=u[0].newlyCompletedTasks.length>0&&Ui(u),c=Qe(Object.entries(u[1])),l=[];for(let d=0;d<c.length;d+=1)l[d]=Vi(Ni(u,c,d));return{c(){o&&o.c(),r=ge(),s=Q("ul");for(let d=0;d<l.length;d+=1)l[d].c();this.h()},l(d){o&&o.l(d),r=_e(d),s=X(d,"UL",{class:!0});var p=le(s);for(let g=0;g<l.length;g+=1)l[g].l(p);p.forEach(K),this.h()},h(){N(s,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto")},m(d,p){o&&o.m(d,p),ne(d,r,p),ne(d,s,p);for(let g=0;g<l.length;g+=1)l[g]&&l[g].m(s,null)},p(d,p){if(d[0].newlyCompletedTasks.length>0?o?o.p(d,p):(o=Ui(d),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null),p&3){c=Qe(Object.entries(d[1]));let g;for(g=0;g<c.length;g+=1){const k=Ni(d,c,g);l[g]?l[g].p(k,p):(l[g]=Vi(k),l[g].c(),l[g].m(s,null))}for(;g<l.length;g+=1)l[g].d(1);l.length=c.length}},d(d){d&&(K(r),K(s)),o&&o.d(d),Mt(l,d)}}}function Ui(u){let r,s,o=u[0].newlyCompletedTasks.length+"",c,l,d=u[0].newlyCompletedTasks.length===1?"":"s",p,g;return{c(){r=Q("p"),s=ie("Nice! You just completed "),c=ie(o),l=ie(" new task"),p=ie(d),g=ie("."),this.h()},l(k){r=X(k,"P",{class:!0});var I=le(r);s=re(I,"Nice! You just completed "),c=re(I,o),l=re(I," new task"),p=re(I,d),g=re(I,"."),I.forEach(K),this.h()},h(){N(r,"class","mt-2 text-sm text-accent-foreground")},m(k,I){ne(k,r,I),R(r,s),R(r,c),R(r,l),R(r,p),R(r,g)},p(k,I){I&1&&o!==(o=k[0].newlyCompletedTasks.length+"")&&Oe(c,o),I&1&&d!==(d=k[0].newlyCompletedTasks.length===1?"":"s")&&Oe(p,d)},d(k){k&&K(r)}}}function Ca(u){let r,s=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){r=ie("🔲 "),o=ie(s),c=ge(),d=ie(l)},l(p){r=re(p,"🔲 "),o=re(p,s),c=_e(p),d=re(p,l)},m(p,g){ne(p,r,g),ne(p,o,g),ne(p,c,g),ne(p,d,g)},p(p,g){g&2&&s!==(s=p[10].description+"")&&Oe(o,s),g&2&&l!==(l=p[10].info+"")&&Oe(d,l)},d(p){p&&(K(r),K(o),K(c),K(d))}}}function Ia(u){let r,s=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){r=ie("✅ "),o=ie(s),c=ge(),d=ie(l)},l(p){r=re(p,"✅ "),o=re(p,s),c=_e(p),d=re(p,l)},m(p,g){ne(p,r,g),ne(p,o,g),ne(p,c,g),ne(p,d,g)},p(p,g){g&2&&s!==(s=p[10].description+"")&&Oe(o,s),g&2&&l!==(l=p[10].info+"")&&Oe(d,l)},d(p){p&&(K(r),K(o),K(c),K(d))}}}function Oa(u){let r,s=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){r=ie("✅ 🆕🏆 "),o=ie(s),c=ge(),d=ie(l)},l(p){r=re(p,"✅ 🆕🏆 "),o=re(p,s),c=_e(p),d=re(p,l)},m(p,g){ne(p,r,g),ne(p,o,g),ne(p,c,g),ne(p,d,g)},p(p,g){g&2&&s!==(s=p[10].description+"")&&Oe(o,s),g&2&&l!==(l=p[10].info+"")&&Oe(d,l)},d(p){p&&(K(r),K(o),K(c),K(d))}}}function Vi(u){let r,s,o,c;function l(...k){return u[8](u[10],...k)}function d(k,I){return I&3&&(o=null),o==null&&(o=!!k[0].newlyCompletedTasks.some(l)),o?Oa:k[10].completed?Ia:Ca}let p=d(u,-1),g=p(u);return{c(){r=Q("li"),s=Q("span"),g.c(),c=ge(),this.h()},l(k){r=X(k,"LI",{class:!0});var I=le(r);s=X(I,"SPAN",{class:!0});var A=le(s);g.l(A),A.forEach(K),c=_e(I),I.forEach(K),this.h()},h(){N(s,"class","mr-2"),N(r,"class","flex items-center")},m(k,I){ne(k,r,I),R(r,s),g.m(s,null),R(r,c)},p(k,I){u=k,p===(p=d(u,I))&&g?g.p(u,I):(g.d(1),g=p(u),g&&(g.c(),g.m(s,null)))},d(k){k&&K(r),g.d()}}}function Pa(u){let r,s,o="Great practice!",c,l,d,p,g,k,I,A="Level tasks",S,F,Z,se,$="Share",M,ee,U,z="Exit",fe,ue,W=u[0].newStarRating>u[0].previousStarRating&&qi(u),te=Qe(Array(3)),ye=[];for(let ae=0;ae<te.length;ae+=1)ye[ae]=Fi(Bi(u,te,ae));function Se(ae,he){return ae[0].clickTimestamps.length>0?Ta:xa}let Ve=Se(u),de=Ve(u);function xe(ae,he){if(ae[0].isNewPersonalBest&&ae[0].personalBest)return Sa;if(ae[0].personalBest)return Ea}let Ae=xe(u),Ce=Ae&&Ae(u),pe=u[1]&&Li(u);return{c(){r=Q("div"),s=Q("h2"),s.textContent=o,c=ge(),W&&W.c(),l=ge(),d=Q("div");for(let ae=0;ae<ye.length;ae+=1)ye[ae].c();p=ge(),de.c(),g=ge(),Ce&&Ce.c(),k=ge(),I=Q("h3"),I.textContent=A,S=ge(),pe&&pe.c(),F=ge(),Z=Q("div"),se=Q("button"),se.textContent=$,M=ge(),ee=Q("div"),U=Q("button"),U.textContent=z,this.h()},l(ae){r=X(ae,"DIV",{class:!0});var he=le(r);s=X(he,"H2",{class:!0,"data-svelte-h":!0}),Le(s)!=="svelte-1untj5h"&&(s.textContent=o),c=_e(he),W&&W.l(he),l=_e(he),d=X(he,"DIV",{class:!0});var Ie=le(d);for(let Ht=0;Ht<ye.length;Ht+=1)ye[Ht].l(Ie);Ie.forEach(K),p=_e(he),de.l(he),g=_e(he),Ce&&Ce.l(he),k=_e(he),I=X(he,"H3",{class:!0,"data-svelte-h":!0}),Le(I)!=="svelte-8ylw1a"&&(I.textContent=A),S=_e(he),pe&&pe.l(he),F=_e(he),Z=X(he,"DIV",{class:!0});var $e=le(Z);se=X($e,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(se)!=="svelte-1wlydhx"&&(se.textContent=$),$e.forEach(K),M=_e(he),ee=X(he,"DIV",{class:!0});var Nt=le(ee);U=X(Nt,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(U)!=="svelte-1t5v3tb"&&(U.textContent=z),Nt.forEach(K),he.forEach(K),this.h()},h(){N(s,"class","text-2xl font-bold"),N(d,"class","mt-2 flex items-center space-x-1"),N(I,"class","mt-6 font-semibold"),N(se,"class","btn variant-filled px-4 py-2"),N(Z,"class","mt-6 flex space-x-4"),N(U,"class","btn variant-outlined px-4 py-2"),N(ee,"class","mt-6 flex space-x-4"),N(r,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(ae,he){ne(ae,r,he),R(r,s),R(r,c),W&&W.m(r,null),R(r,l),R(r,d);for(let Ie=0;Ie<ye.length;Ie+=1)ye[Ie]&&ye[Ie].m(d,null);R(r,p),de.m(r,null),R(r,g),Ce&&Ce.m(r,null),R(r,k),R(r,I),R(r,S),pe&&pe.m(r,null),R(r,F),R(r,Z),R(Z,se),R(r,M),R(r,ee),R(ee,U),fe||(ue=[st(se,"click",u[5]),st(U,"click",u[6])],fe=!0)},p(ae,[he]){if(ae[0].newStarRating>ae[0].previousStarRating?W?W.p(ae,he):(W=qi(ae),W.c(),W.m(r,l)):W&&(W.d(1),W=null),he&1){te=Qe(Array(3));let Ie;for(Ie=0;Ie<te.length;Ie+=1){const $e=Bi(ae,te,Ie);ye[Ie]?ye[Ie].p($e,he):(ye[Ie]=Fi($e),ye[Ie].c(),ye[Ie].m(d,null))}for(;Ie<ye.length;Ie+=1)ye[Ie].d(1);ye.length=te.length}Ve===(Ve=Se(ae))&&de?de.p(ae,he):(de.d(1),de=Ve(ae),de&&(de.c(),de.m(r,g))),Ae===(Ae=xe(ae))&&Ce?Ce.p(ae,he):(Ce&&Ce.d(1),Ce=Ae&&Ae(ae),Ce&&(Ce.c(),Ce.m(r,k))),ae[1]?pe?pe.p(ae,he):(pe=Li(ae),pe.c(),pe.m(r,F)):pe&&(pe.d(1),pe=null)},i:Be,o:Be,d(ae){ae&&K(r),W&&W.d(),Mt(ye,ae),de.d(),Ce&&Ce.d(),pe&&pe.d(),fe=!1,qr(ue)}}}function Da(u,r,s){let{closeModal:o}=r,{meditationResults:c}=r;const l=c.clickTimestamps.length,d=l>0?(l/(c.durationMeditated/60)).toFixed(1):"0";let p={};Fr(async()=>{c!=null&&c.levelId&&s(1,p=await Jn(c.levelId))});const g=S=>{const F=Math.floor(S/60),Z=Math.round(S%60*100)/100;return F===0?Z+" second"+(Z===1?"":"s"):F+" minute"+(F===1?"":"s")+(Z>0?" and "+Z+" second"+(Z===1?"":"s"):"")},k=()=>{if(navigator.share){const S=c.newStarRating-c.previousStarRating,F=ya(c);je.capture("results_shared",{total_taps:l,distractionRate:d,level:c.levelId,stars_gained:S,tasks_completed:c.newlyCompletedTasks.length,template_used:F,personal_best:c.isNewPersonalBest});const Z=va(c);navigator.share({text:Z}).catch(se=>console.error("Sharing failed",se))}else console.log("Web Share API not supported")},I=()=>{je.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:c.newStarRating-c.previousStarRating,tasks_completed:c.newlyCompletedTasks.length}),o()},A=(S,F)=>F===S.id;return u.$$set=S=>{"closeModal"in S&&s(7,o=S.closeModal),"meditationResults"in S&&s(0,c=S.meditationResults)},[c,p,l,d,g,k,I,o,A]}class Aa extends _t{constructor(r){super(),gt(this,r,Da,Pa,yt,{closeModal:7,meditationResults:0})}}function Yi(u){let r,s,o,c,l,d,p;const g=[Ma,Ra,Ka,ja],k=[];function I(A,S){return A[3]===1?0:A[3]===2?1:A[3]===3?2:3}return o=I(u),c=k[o]=g[o](u),{c(){r=Q("div"),s=Q("div"),c.c(),this.h()},l(A){r=X(A,"DIV",{class:!0});var S=le(r);s=X(S,"DIV",{class:!0});var F=le(s);c.l(F),F.forEach(K),S.forEach(K),this.h()},h(){N(s,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),N(r,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(A,S){ne(A,r,S),R(r,s),k[o].m(s,null),p=!0},p(A,S){let F=o;o=I(A),o===F?k[o].p(A,S):(hn(),Ue(k[F],1,1,()=>{k[F]=null}),pn(),c=k[o],c?c.p(A,S):(c=k[o]=g[o](A),c.c()),Me(c,1),c.m(s,null))},i(A){p||(Me(c),A&&vt(()=>{p&&(l||(l=We(s,He,{duration:500},!0)),l.run(1))}),A&&vt(()=>{p&&(d||(d=We(r,He,{duration:500},!0)),d.run(1))}),p=!0)},o(A){Ue(c),A&&(l||(l=We(s,He,{duration:500},!1)),l.run(0)),A&&(d||(d=We(r,He,{duration:500},!1)),d.run(0)),p=!1},d(A){A&&K(r),k[o].d(),A&&l&&l.end(),A&&d&&d.end()}}}function ja(u){let r,s,o,c;return s=new Aa({props:{closeModal:u[5],meditationResults:u[4]}}),{c(){r=Q("div"),xt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=le(r);kt(s.$$.fragment,d),d.forEach(K),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){ne(l,r,d),wt(s,r,null),c=!0},p(l,d){const p={};d&16&&(p.meditationResults=l[4]),s.$set(p)},i(l){c||(Me(s.$$.fragment,l),l&&vt(()=>{c&&(o||(o=We(r,He,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ue(s.$$.fragment,l),l&&(o||(o=We(r,He,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&K(r),bt(s),l&&o&&o.end()}}}function Ka(u){let r,s,o,c;return s=new ma({props:{duration:u[1],nextStep:u[7],levelId:u[2]}}),s.$on("complete",u[8]),{c(){r=Q("div"),xt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=le(r);kt(s.$$.fragment,d),d.forEach(K),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){ne(l,r,d),wt(s,r,null),c=!0},p(l,d){const p={};d&2&&(p.duration=l[1]),d&4&&(p.levelId=l[2]),s.$set(p)},i(l){c||(Me(s.$$.fragment,l),l&&vt(()=>{c&&(o||(o=We(r,He,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ue(s.$$.fragment,l),l&&(o||(o=We(r,He,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&K(r),bt(s),l&&o&&o.end()}}}function Ra(u){let r,s,o,c;return s=new la({props:{nextStep:u[7],closeModal:u[5],levelId:u[2]}}),{c(){r=Q("div"),xt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=le(r);kt(s.$$.fragment,d),d.forEach(K),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){ne(l,r,d),wt(s,r,null),c=!0},p(l,d){const p={};d&4&&(p.levelId=l[2]),s.$set(p)},i(l){c||(Me(s.$$.fragment,l),l&&vt(()=>{c&&(o||(o=We(r,He,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ue(s.$$.fragment,l),l&&(o||(o=We(r,He,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&K(r),bt(s),l&&o&&o.end()}}}function Ma(u){let r,s,o,c;return s=new ta({props:{nextStep:u[7],duration:u[1],closeModal:u[5],levelId:u[2]}}),{c(){r=Q("div"),xt(s.$$.fragment),this.h()},l(l){r=X(l,"DIV",{class:!0});var d=le(r);kt(s.$$.fragment,d),d.forEach(K),this.h()},h(){N(r,"class","absolute inset-0 flex flex-col")},m(l,d){ne(l,r,d),wt(s,r,null),c=!0},p(l,d){const p={};d&2&&(p.duration=l[1]),d&4&&(p.levelId=l[2]),s.$set(p)},i(l){c||(Me(s.$$.fragment,l),l&&vt(()=>{c&&(o||(o=We(r,He,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Ue(s.$$.fragment,l),l&&(o||(o=We(r,He,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&K(r),bt(s),l&&o&&o.end()}}}function Na(u){let r,s,o=u[0]&&Yi(u);return{c(){o&&o.c(),r=Xn()},l(c){o&&o.l(c),r=Xn()},m(c,l){o&&o.m(c,l),ne(c,r,l),s=!0},p(c,[l]){c[0]?o?(o.p(c,l),l&1&&Me(o,1)):(o=Yi(c),o.c(),Me(o,1),o.m(r.parentNode,r)):o&&(hn(),Ue(o,1,1,()=>{o=null}),pn())},i(c){s||(Me(o),s=!0)},o(c){Ue(o),s=!1},d(c){c&&K(r),o&&o.d(c)}}}function Ba(u,r,s){let{show:o=!1}=r,{duration:c=Ne.ONE_MINUTE}=r,{levelId:l=null}=r,d=1,p;const g=()=>{s(0,o=!1),s(3,d=1)},k=async S=>{const{clickTimestamps:F,durationMeditated:Z,completed:se}=S.detail,$=l||"L1",M=dn.find(pe=>pe.id===$);if(!M)return;const ee=await fn.sessions.where("levelId").equals($).toArray(),U=await Jn($),z=new Set(Object.entries(U).filter(([pe,ae])=>ae.completed).map(([pe])=>pe)),fe=ee.map(pe=>new Set(M.completionTasks.filter(ae=>{var he;return(he=it[ae.id])==null?void 0:he.call(it,[pe],M).completed}).map(ae=>ae.id))),ue=Br(M.starRules,z,fe),W={levelId:$,duration:Z,tapCount:F.length,tapTimestamps:F,timestamp:Date.now(),completed:se};await fn.sessions.add(W);const te=await Jn($),ye=new Set(Object.entries(te).filter(([pe,ae])=>ae.completed).map(([pe])=>pe)),Se=Object.entries(te).filter(([pe,ae])=>{var he;return ae.completed&&!((he=U[pe])!=null&&he.completed)}).map(([pe])=>pe),Ve=await fn.sessions.where("levelId").equals($).toArray(),de=Ve.map(pe=>new Set(M.completionTasks.filter(ae=>{var he;return(he=it[ae.id])==null?void 0:he.call(it,[pe],M).completed}).map(ae=>ae.id))),xe=Br(M.starRules,ye,de),Ae=uo(Ve),Ce=Ae&&Ae.tapCount===F.length&&Ae.duration===Z;s(4,p={...S.detail,levelId:$,previousStarRating:ue,newStarRating:xe,newlyCompletedTasks:Se,completionTaskResults:Object.fromEntries(Object.entries(te).map(([pe,ae])=>[pe,ae.completed])),isNewPersonalBest:Ce||!1,personalBest:Ae}),I()},I=()=>setTimeout(()=>s(3,d++,d),300),A=S=>k(S);return u.$$set=S=>{"show"in S&&s(0,o=S.show),"duration"in S&&s(1,c=S.duration),"levelId"in S&&s(2,l=S.levelId)},[o,c,l,d,p,g,k,I,A]}class qa extends _t{constructor(r){super(),gt(this,r,Ba,Na,yt,{show:0,duration:1,levelId:2})}}function zi(u,r,s){const o=u.slice();return o[6]=r[s],o}function Gi(u){let r,s=Mr[u[6]]+"",o;return{c(){r=Q("option"),o=ie(s),this.h()},l(c){r=X(c,"OPTION",{});var l=le(r);o=re(l,s),l.forEach(K),this.h()},h(){r.__value=u[6],Ho(r,r.__value)},m(c,l){ne(c,r,l),R(r,o)},p:Be,d(c){c&&K(r)}}}function Fa(u){let r,s,o="Select Meditation Duration",c,l,d,p,g=Qe(u[2]),k=[];for(let I=0;I<g.length;I+=1)k[I]=Gi(zi(u,g,I));return{c(){r=Q("div"),s=Q("label"),s.textContent=o,c=ge(),l=Q("select");for(let I=0;I<k.length;I+=1)k[I].c();this.h()},l(I){r=X(I,"DIV",{class:!0});var A=le(r);s=X(A,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Le(s)!=="svelte-g1prfd"&&(s.textContent=o),c=_e(A),l=X(A,"SELECT",{id:!0,class:!0});var S=le(l);for(let F=0;F<k.length;F+=1)k[F].l(S);S.forEach(K),A.forEach(K),this.h()},h(){N(s,"for","duration"),N(s,"class","text-md font-medium"),N(l,"id","duration"),N(l,"class","select select-bordered w-full max-w-xs"),N(r,"class","flex flex-col items-start gap-1")},m(I,A){ne(I,r,A),R(r,s),R(r,c),R(r,l);for(let S=0;S<k.length;S+=1)k[S]&&k[S].m(l,null);Ci(l,u[1]),d||(p=st(l,"change",u[5]),d=!0)},p(I,[A]){if(A&4){g=Qe(I[2]);let S;for(S=0;S<g.length;S+=1){const F=zi(I,g,S);k[S]?k[S].p(F,A):(k[S]=Gi(F),k[S].c(),k[S].m(l,null))}for(;S<k.length;S+=1)k[S].d(1);k.length=g.length}A&6&&Ci(l,I[1])},i:Be,o:Be,d(I){I&&K(r),Mt(k,I),d=!1,p()}}}function La(u,r,s){let{onDurationChange:o}=r,{minDuration:c=Ne.ONE_MINUTE}=r,{maxDuration:l=Ne.SIXTY_MINUTES}=r,{selectedDuration:d=c??Ne.ONE_MINUTE}=r;const p=Object.values(Ne).filter(k=>typeof k=="number").filter(k=>k>=c&&k<=l),g=k=>o(Number(k.currentTarget.value));return u.$$set=k=>{"onDurationChange"in k&&s(0,o=k.onDurationChange),"minDuration"in k&&s(3,c=k.minDuration),"maxDuration"in k&&s(4,l=k.maxDuration),"selectedDuration"in k&&s(1,d=k.selectedDuration)},[o,d,p,c,l,g]}class Ua extends _t{constructor(r){super(),gt(this,r,La,Fa,yt,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Wi(u,r,s){const o=u.slice();return o[9]=r[s].level,o[10]=r[s].isUnlocked,o[11]=r[s].taskCompletion,o[12]=r[s].starRating,o[13]=r[s].bestSession,o[14]=r,o[15]=s,o}function Hi(u,r,s){const o=u.slice();return o[16]=r[s][0],o[17]=r[s][1],o}function $i(u,r,s){const o=u.slice();return o[16]=r[s],o[21]=s,o}function Va(u){let r,s,o=Qe(u[3]),c=[];for(let d=0;d<o.length;d+=1)c[d]=no(Wi(u,o,d));const l=d=>Ue(c[d],1,1,()=>{c[d]=null});return{c(){r=Q("div");for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){r=X(d,"DIV",{class:!0});var p=le(r);for(let g=0;g<c.length;g+=1)c[g].l(p);p.forEach(K),this.h()},h(){N(r,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full")},m(d,p){ne(d,r,p);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(r,null);s=!0},p(d,p){if(p&46){o=Qe(d[3]);let g;for(g=0;g<o.length;g+=1){const k=Wi(d,o,g);c[g]?(c[g].p(k,p),Me(c[g],1)):(c[g]=no(k),c[g].c(),Me(c[g],1),c[g].m(r,null))}for(hn(),g=o.length;g<c.length;g+=1)l(g);pn()}},i(d){if(!s){for(let p=0;p<o.length;p+=1)Me(c[p]);s=!0}},o(d){c=c.filter(Boolean);for(let p=0;p<c.length;p+=1)Ue(c[p]);s=!1},d(d){d&&K(r),Mt(c,d)}}}function Ya(u){let r,s='<div class="loading loading-spinner loading-lg"></div>';return{c(){r=Q("div"),r.innerHTML=s,this.h()},l(o){r=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Le(r)!=="svelte-1mgfhb9"&&(r.innerHTML=s),this.h()},h(){N(r,"class","flex justify-center items-center mt-8")},m(o,c){ne(o,r,c)},p:Be,i:Be,o:Be,d(o){o&&K(r)}}}function Xi(u){let r,s="🔒";return{c(){r=Q("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Le(r)!=="svelte-19hy9gc"&&(r.textContent=s),this.h()},h(){N(r,"class","text-2xl")},m(o,c){ne(o,r,c)},d(o){o&&K(r)}}}function Qi(u){let r,s=Qe(Array(3)),o=[];for(let c=0;c<s.length;c+=1)o[c]=Ji($i(u,s,c));return{c(){r=Q("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r=X(c,"DIV",{class:!0});var l=le(r);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(K),this.h()},h(){N(r,"class","flex items-center")},m(c,l){ne(c,r,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(c,l){if(l&8){s=Qe(Array(3));let d;for(d=0;d<s.length;d+=1){const p=$i(c,s,d);o[d]?o[d].p(p,l):(o[d]=Ji(p),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&K(r),Mt(o,c)}}}function za(u){let r,s="★";return{c(){r=Q("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Le(r)!=="svelte-1tpxw7h"&&(r.textContent=s),this.h()},h(){N(r,"class","text-2xl text-gray-300")},m(o,c){ne(o,r,c)},d(o){o&&K(r)}}}function Ga(u){let r,s="⭐";return{c(){r=Q("span"),r.textContent=s,this.h()},l(o){r=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Le(r)!=="svelte-1jlkvsx"&&(r.textContent=s),this.h()},h(){N(r,"class","text-2xl")},m(o,c){ne(o,r,c)},d(o){o&&K(r)}}}function Ji(u){let r;function s(l,d){return l[21]<l[12]?Ga:za}let o=s(u),c=o(u);return{c(){c.c(),r=Xn()},l(l){c.l(l),r=Xn()},m(l,d){c.m(l,d),ne(l,r,d)},p(l,d){o!==(o=s(l))&&(c.d(1),c=o(l),c&&(c.c(),c.m(r.parentNode,r)))},d(l){l&&K(r),c.d(l)}}}function Zi(u){let r,s,o=u[13].tapCount+"",c,l,d=Wt(u[13].duration)+"",p,g;return{c(){r=Q("p"),s=ie("Your best: "),c=ie(o),l=ie(" taps · "),p=ie(d),g=ie(" min"),this.h()},l(k){r=X(k,"P",{class:!0});var I=le(r);s=re(I,"Your best: "),c=re(I,o),l=re(I," taps · "),p=re(I,d),g=re(I," min"),I.forEach(K),this.h()},h(){N(r,"class","text-sm text-gray-500")},m(k,I){ne(k,r,I),R(r,s),R(r,c),R(r,l),R(r,p),R(r,g)},p(k,I){I&8&&o!==(o=k[13].tapCount+"")&&Oe(c,o),I&8&&d!==(d=Wt(k[13].duration)+"")&&Oe(p,d)},d(k){k&&K(r)}}}function eo(u){let r,s=Qe(Object.entries(u[11])),o=[];for(let c=0;c<s.length;c+=1)o[c]=to(Hi(u,s,c));return{c(){r=Q("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r=X(c,"DIV",{class:!0});var l=le(r);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(K),this.h()},h(){N(r,"class","space-y-0")},m(c,l){ne(c,r,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(r,null)},p(c,l){if(l&8){s=Qe(Object.entries(c[11]));let d;for(d=0;d<s.length;d+=1){const p=Hi(c,s,d);o[d]?o[d].p(p,l):(o[d]=to(p),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(c){c&&K(r),Mt(o,c)}}}function to(u){let r,s,o=u[17].completed?"✅":"🔲",c,l,d=u[17].description+"",p,g,k=u[17].info+"",I,A;return{c(){r=Q("div"),s=Q("span"),c=ie(o),l=ge(),p=ie(d),g=ge(),I=ie(k),A=ge(),this.h()},l(S){r=X(S,"DIV",{class:!0});var F=le(r);s=X(F,"SPAN",{class:!0});var Z=le(s);c=re(Z,o),l=_e(Z),p=re(Z,d),g=_e(Z),I=re(Z,k),Z.forEach(K),A=_e(F),F.forEach(K),this.h()},h(){N(s,"class","mr-2 text-sm text-gray-500"),N(r,"class","flex items-center")},m(S,F){ne(S,r,F),R(r,s),R(s,c),R(s,l),R(s,p),R(s,g),R(s,I),R(r,A)},p(S,F){F&8&&o!==(o=S[17].completed?"✅":"🔲")&&Oe(c,o),F&8&&d!==(d=S[17].description+"")&&Oe(p,d),F&8&&k!==(k=S[17].info+"")&&Oe(I,k)},d(S){S&&K(r)}}}function Wa(u){let r,s='<p class="text-sm text-gray-500">Achieve 2 stars in previous levels to unlock</p>';return{c(){r=Q("div"),r.innerHTML=s,this.h()},l(o){r=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Le(r)!=="svelte-agxr37"&&(r.innerHTML=s),this.h()},h(){N(r,"class","space-y-4 mt-8")},m(o,c){ne(o,r,c)},p:Be,i:Be,o:Be,d(o){o&&K(r)}}}function Ha(u){let r,s,o,c,l="Start meditation",d,p,g;function k(...A){return u[6](u[9],u[14],u[15],...A)}s=new Ua({props:{selectedDuration:u[9].selectedDuration,onDurationChange:k,minDuration:u[9].minDuration,maxDuration:u[9].maxDuration}});function I(){return u[7](u[9])}return{c(){r=Q("div"),xt(s.$$.fragment),o=ge(),c=Q("button"),c.textContent=l,this.h()},l(A){r=X(A,"DIV",{class:!0});var S=le(r);kt(s.$$.fragment,S),o=_e(S),c=X(S,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(c)!=="svelte-egxc4d"&&(c.textContent=l),S.forEach(K),this.h()},h(){N(c,"class","btn variant-filled w-full"),N(r,"class","space-y-6 mt-8")},m(A,S){ne(A,r,S),wt(s,r,null),R(r,o),R(r,c),d=!0,p||(g=st(c,"click",I),p=!0)},p(A,S){u=A;const F={};S&8&&(F.selectedDuration=u[9].selectedDuration),S&8&&(F.onDurationChange=k),S&8&&(F.minDuration=u[9].minDuration),S&8&&(F.maxDuration=u[9].maxDuration),s.$set(F)},i(A){d||(Me(s.$$.fragment,A),d=!0)},o(A){Ue(s.$$.fragment,A),d=!1},d(A){A&&K(r),bt(s),p=!1,g()}}}function no(u){let r,s,o,c,l=u[9].name+"",d,p,g,k,I,A=u[9].description+"",S,F,Z,se,$,M,ee,U,z,fe=!u[10]&&Xi(),ue=u[12]!==void 0&&u[10]&&Qi(u),W=u[13]&&u[10]&&Zi(u),te=u[11]&&u[10]&&eo(u);const ye=[Ha,Wa],Se=[];function Ve(de,xe){return de[10]?0:1}return $=Ve(u),M=Se[$]=ye[$](u),{c(){r=Q("div"),s=Q("div"),o=Q("h3"),fe&&fe.c(),c=ge(),d=ie(l),p=ge(),ue&&ue.c(),g=ge(),k=Q("div"),I=Q("p"),S=ie(A),F=ge(),W&&W.c(),Z=ge(),te&&te.c(),se=ge(),M.c(),ee=ge(),this.h()},l(de){r=X(de,"DIV",{class:!0});var xe=le(r);s=X(xe,"DIV",{class:!0});var Ae=le(s);o=X(Ae,"H3",{class:!0});var Ce=le(o);fe&&fe.l(Ce),c=_e(Ce),d=re(Ce,l),Ce.forEach(K),p=_e(Ae),ue&&ue.l(Ae),Ae.forEach(K),g=_e(xe),k=X(xe,"DIV",{class:!0});var pe=le(k);I=X(pe,"P",{class:!0});var ae=le(I);S=re(ae,A),ae.forEach(K),F=_e(pe),W&&W.l(pe),pe.forEach(K),Z=_e(xe),te&&te.l(xe),se=_e(xe),M.l(xe),ee=_e(xe),xe.forEach(K),this.h()},h(){N(o,"class","text-lg font-bold"),N(s,"class","flex justify-between items-center mb-2"),N(I,"class","text-sm text-muted-foreground mb-2"),N(k,"class","mb-2"),N(r,"class",U="card bg-[#ffffffa6] p-8 "+(u[10]?"":"opacity-60"))},m(de,xe){ne(de,r,xe),R(r,s),R(s,o),fe&&fe.m(o,null),R(o,c),R(o,d),R(s,p),ue&&ue.m(s,null),R(r,g),R(r,k),R(k,I),R(I,S),R(k,F),W&&W.m(k,null),R(r,Z),te&&te.m(r,null),R(r,se),Se[$].m(r,null),R(r,ee),z=!0},p(de,xe){de[10]?fe&&(fe.d(1),fe=null):fe||(fe=Xi(),fe.c(),fe.m(o,c)),(!z||xe&8)&&l!==(l=de[9].name+"")&&Oe(d,l),de[12]!==void 0&&de[10]?ue?ue.p(de,xe):(ue=Qi(de),ue.c(),ue.m(s,null)):ue&&(ue.d(1),ue=null),(!z||xe&8)&&A!==(A=de[9].description+"")&&Oe(S,A),de[13]&&de[10]?W?W.p(de,xe):(W=Zi(de),W.c(),W.m(k,null)):W&&(W.d(1),W=null),de[11]&&de[10]?te?te.p(de,xe):(te=eo(de),te.c(),te.m(r,se)):te&&(te.d(1),te=null);let Ae=$;$=Ve(de),$===Ae?Se[$].p(de,xe):(hn(),Ue(Se[Ae],1,1,()=>{Se[Ae]=null}),pn(),M=Se[$],M?M.p(de,xe):(M=Se[$]=ye[$](de),M.c()),Me(M,1),M.m(r,ee)),(!z||xe&8&&U!==(U="card bg-[#ffffffa6] p-8 "+(de[10]?"":"opacity-60")))&&N(r,"class",U)},i(de){z||(Me(M),z=!0)},o(de){Ue(M),z=!1},d(de){de&&K(r),fe&&fe.d(),ue&&ue.d(),W&&W.d(),te&&te.d(),Se[$].d()}}}function $a(u){let r,s,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',c,l,d,p,g,k=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn ↗</a></p>`,I,A,S,F;const Z=[Ya,Va],se=[];function $(U,z){return U[4]?0:1}l=$(u),d=se[l]=Z[l](u);function M(U){u[8](U)}let ee={duration:u[1],levelId:u[2]};return u[0]!==void 0&&(ee.show=u[0]),A=new qa({props:ee}),Lr.push(()=>Vr(A,"show",M)),{c(){r=Q("div"),s=Q("div"),s.innerHTML=o,c=ge(),d.c(),p=ge(),g=Q("div"),g.innerHTML=k,I=ge(),xt(A.$$.fragment),this.h()},l(U){r=X(U,"DIV",{class:!0});var z=le(r);s=X(z,"DIV",{class:!0,"data-svelte-h":!0}),Le(s)!=="svelte-50yq01"&&(s.innerHTML=o),c=_e(z),d.l(z),p=_e(z),g=X(z,"DIV",{class:!0,"data-svelte-h":!0}),Le(g)!=="svelte-dgw8za"&&(g.innerHTML=k),z.forEach(K),I=_e(U),kt(A.$$.fragment,U),this.h()},h(){N(s,"class","space-y-6 text-center mt-10 mb-8"),N(g,"class","text-center text-sm text-gray-500 mt-40"),N(r,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(U,z){ne(U,r,z),R(r,s),R(r,c),se[l].m(r,null),R(r,p),R(r,g),ne(U,I,z),wt(A,U,z),F=!0},p(U,[z]){let fe=l;l=$(U),l===fe?se[l].p(U,z):(hn(),Ue(se[fe],1,1,()=>{se[fe]=null}),pn(),d=se[l],d?d.p(U,z):(d=se[l]=Z[l](U),d.c()),Me(d,1),d.m(r,p));const ue={};z&2&&(ue.duration=U[1]),z&4&&(ue.levelId=U[2]),!S&&z&1&&(S=!0,ue.show=U[0],Ur(()=>S=!1)),A.$set(ue)},i(U){F||(Me(d),Me(A.$$.fragment,U),F=!0)},o(U){Ue(d),Ue(A.$$.fragment,U),F=!1},d(U){U&&(K(r),K(I)),se[l].d(),bt(A,U)}}}function Xa(u,r,s){let o=!1,c=Ne.ONE_MINUTE,l=null,d=[],p=!0;const g=async()=>{await ra(),s(0,o=!0)},k=(S,F,Z,se)=>s(3,F[Z].level.selectedDuration=se,d),I=S=>{s(2,l=S.id),s(1,c=S.selectedDuration??S.minDuration),g()};function A(S){o=S,s(0,o)}return u.$$.update=()=>{u.$$.dirty&1&&(o||(s(4,p=!0),ba().then(S=>{s(3,d=S),S.forEach(({level:F})=>{F.selectedDuration=F.minDuration}),s(4,p=!1)}).catch(S=>{console.error("Failed to reload level statuses:",S),s(4,p=!1)})))},[o,c,l,d,p,g,k,I,A]}class ds extends _t{constructor(r){super(),gt(this,r,Xa,$a,yt,{})}}export{ds as component};
