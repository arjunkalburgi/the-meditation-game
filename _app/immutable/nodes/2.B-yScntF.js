var Uo=Object.defineProperty;var Vo=(u,n,a)=>n in u?Uo(u,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[n]=a;var Si=(u,n,a)=>Vo(u,typeof n!="symbol"?n+"":n,a);import{B as Yo,s as bt,n as Be,d as A,Z as qt,r as Fr,a as Pe,i as ee,b as R,U as ct,m as Ho,w as N,x as _t,c as X,e as ce,f as J,g as ve,h as Q,t as Z,j as ye,q as Lr,_ as zo,$ as Go,a0 as Un,a1 as Vn,a2 as io,k as Gn,a3 as Wo,y as Jn,C as gt,a4 as Ur,a5 as Ne,P as Bt,o as Wn,a6 as Ii,a7 as Xo,u as Qo}from"../chunks/Bem1OcWY.js";import{S as wt,i as kt,f as Vr,d as xt,t as Le,h as He,a as Ae,m as Tt,e as Et,b as St,g as fn,c as dn}from"../chunks/BqmXtoC9.js";import{p as Xe}from"../chunks/CmP4wuhm.js";import{b as $o,d as Ci,w as zn}from"../chunks/C3BhjjfM.js";function $e(u){return(u==null?void 0:u.length)!==void 0?u:Array.from(u)}function ze(u,{delay:n=0,duration:a=400,easing:o=Yo}={}){const c=+getComputedStyle(u).opacity;return{delay:n,duration:a,easing:o,css:l=>`opacity: ${l*c}`}}var Me=(u=>(u[u.ONE_MINUTE=60]="ONE_MINUTE",u[u.TWO_MINUTES=120]="TWO_MINUTES",u[u.FIVE_MINUTES=300]="FIVE_MINUTES",u[u.TEN_MINUTES=600]="TEN_MINUTES",u[u.FIFTEEN_MINUTES=900]="FIFTEEN_MINUTES",u[u.THIRTY_MINUTES=1800]="THIRTY_MINUTES",u[u.SIXTY_MINUTES=3600]="SIXTY_MINUTES",u))(Me||{});const Nr={60:"1 minute",120:"2 minutes",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes",3600:"60 minutes"};var Oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jo(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var oo={exports:{}};(function(u,n){(function(a,o){u.exports=o()})(Oi,function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function c(e,t,r){for(var i,s=0,f=t.length;s<f;s++)!i&&s in t||((i=i||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Oi,d=Object.keys,p=Array.isArray;function y(e,t){return typeof t!="object"||d(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var x=Object.getPrototypeOf,C={}.hasOwnProperty;function O(e,t){return C.call(e,t)}function b(e,t){typeof t=="function"&&(t=t(x(e))),(typeof Reflect>"u"?d:Reflect.ownKeys)(t).forEach(function(r){z(e,r,t[r])})}var B=Object.defineProperty;function z(e,t,r,i){B(e,t,y(r&&O(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},i))}function te(e){return{from:function(t){return e.prototype=Object.create(t.prototype),z(e.prototype,"constructor",e),{extend:b.bind(null,e.prototype)}}}}var V=Object.getOwnPropertyDescriptor,M=[].slice;function ae(e,t,r){return M.call(e,t,r)}function W(e,t){return t(e)}function ie(e){if(!e)throw new Error("Assertion Failed")}function we(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function se(e,t){if(typeof t=="string"&&O(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],i=0,s=t.length;i<s;++i){var f=se(e,t[i]);r.push(f)}return r}var h=t.indexOf(".");if(h!==-1){var m=e[t.substr(0,h)];return m==null?void 0:se(m,t.substr(h+1))}}function ne(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){ie(typeof r!="string"&&"length"in r);for(var i=0,s=t.length;i<s;++i)ne(e,t[i],r[i])}else{var f,h,m=t.indexOf(".");m!==-1?(f=t.substr(0,m),(h=t.substr(m+1))===""?r===void 0?p(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=r:ne(m=!(m=e[f])||!O(e,f)?e[f]={}:m,h,r)):r===void 0?p(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function oe(e){var t,r={};for(t in e)O(e,t)&&(r[t]=e[t]);return r}var _e=[].concat;function ke(e){return _e.apply([],e)}var Ct="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ke([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),De=new Set(Ct.map(function(e){return l[e]})),Ie=null;function Ge(e){return Ie=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var i=Ie.get(r);if(i)return i;if(p(r)){i=[],Ie.set(r,i);for(var s=0,f=r.length;s<f;++s)i.push(t(r[s]))}else if(De.has(r.constructor))i=r;else{var h,m=x(r);for(h in i=m===Object.prototype?{}:Object.create(m),Ie.set(r,i),r)O(r,h)&&(i[h]=t(r[h]))}return i}(e),Ie=null,e}var Qe={}.toString;function Se(e){return Qe.call(e).slice(8,-1)}var re=typeof Symbol<"u"?Symbol.iterator:"@@iterator",de=typeof re=="symbol"?function(e){var t;return e!=null&&(t=e[re])&&t.apply(e)}:function(){return null};function le(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var pe={};function Te(e){var t,r,i,s;if(arguments.length===1){if(p(e))return e.slice();if(this===pe&&typeof e=="string")return[e];if(s=de(e)){for(r=[];!(i=s.next()).done;)r.push(i.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var at=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Qt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],et=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Qt),hn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function tt(e,t){this.name=e,this.message=t}function Hr(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,i,s){return s.indexOf(r)===i}).join(`
`)}function pn(e,t,r,i){this.failures=t,this.failedKeys=i,this.successCount=r,this.message=Hr(e,t)}function Ft(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=Hr(e,this.failures)}te(tt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),te(pn).from(tt),te(Ft).from(tt);var Zn=et.reduce(function(e,t){return e[t]=t+"Error",e},{}),co=tt,fe=et.reduce(function(e,t){var r=t+"Error";function i(s,f){this.name=r,s?typeof s=="string"?(this.message="".concat(s).concat(f?`
 `+f:""),this.inner=f||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=hn[t]||r,this.inner=null)}return te(i).from(co),e[t]=i,e},{});fe.Syntax=SyntaxError,fe.Type=TypeError,fe.Range=RangeError;var zr=Qt.reduce(function(e,t){return e[t+"Error"]=fe[t],e},{}),mn=et.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=fe[t]),e},{});function Ce(){}function Wt(e){return e}function fo(e,t){return e==null||e===Wt?t:function(r){return t(e(r))}}function It(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ho(e,t){return e===Ce?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var f=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?It(i,this.onsuccess):i),s&&(this.onerror=this.onerror?It(s,this.onerror):s),f!==void 0?f:r}}function po(e,t){return e===Ce?t:function(){e.apply(this,arguments);var r=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?It(r,this.onsuccess):r),i&&(this.onerror=this.onerror?It(i,this.onerror):i)}}function mo(e,t){return e===Ce?t:function(r){var i=e.apply(this,arguments);y(r,i);var s=this.onsuccess,f=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?It(s,this.onsuccess):s),f&&(this.onerror=this.onerror?It(f,this.onerror):f),i===void 0?r===void 0?void 0:r:y(i,r)}}function vo(e,t){return e===Ce?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function er(e,t){return e===Ce?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var i=this,s=arguments.length,f=new Array(s);s--;)f[s]=arguments[s];return r.then(function(){return t.apply(i,f)})}return t.apply(this,arguments)}}mn.ModifyError=pn,mn.DexieError=tt,mn.BulkError=Ft;var nt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Gr(e){nt=e}var Xt={},Wr=100,Ct=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,x(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,x(t),e]}(),Qt=Ct[0],et=Ct[1],Ct=Ct[2],et=et&&et.then,Ot=Qt&&Qt.constructor,tr=!!Ct,$t=function(e,t){Jt.push([e,t]),vn&&(queueMicrotask(_o),vn=!1)},nr=!0,vn=!0,Pt=[],yn=[],rr=Wt,ft={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ce,pgp:!1,env:{},finalize:Ce},ue=ft,Jt=[],Dt=0,_n=[];function G(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ue;if(typeof e!="function"){if(e!==Xt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&or(this,this._value))}this._state=null,this._value=null,++t.ref,function r(i,s){try{s(function(f){if(i._state===null){if(f===i)throw new TypeError("A promise cannot be resolved with itself.");var h=i._lib&&Lt();f&&typeof f.then=="function"?r(i,function(m,_){f instanceof G?f._then(m,_):f.then(m,_)}):(i._state=!0,i._value=f,Qr(i)),h&&Ut()}},or.bind(null,i))}catch(f){or(i,f)}}(this,e)}var ir={get:function(){var e=ue,t=kn;function r(i,s){var f=this,h=!e.global&&(e!==ue||t!==kn),m=h&&!ht(),_=new G(function(w,E){ar(f,new Xr(Jr(i,e,h,m),Jr(s,e,h,m),w,E,e))});return this._consoleTask&&(_._consoleTask=this._consoleTask),_}return r.prototype=Xt,r},set:function(e){z(this,"then",e&&e.prototype===Xt?ir:{get:function(){return e},set:ir.set})}};function Xr(e,t,r,i,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=i,this.psd=s}function or(e,t){var r,i;yn.push(t),e._state===null&&(r=e._lib&&Lt(),t=rr(t),e._state=!1,e._value=t,i=e,Pt.some(function(s){return s._value===i._value})||Pt.push(i),Qr(e),r&&Ut())}function Qr(e){var t=e._listeners;e._listeners=[];for(var r=0,i=t.length;r<i;++r)ar(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),Dt===0&&(++Dt,$t(function(){--Dt==0&&sr()},[]))}function ar(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Dt,$t(yo,[r,e,t])}else e._listeners.push(t)}function yo(e,t,r){try{var i,s=t._value;!t._state&&yn.length&&(yn=[]),i=nt&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),t._state||yn.indexOf(s)!==-1||function(f){for(var h=Pt.length;h;)if(Pt[--h]._value===f._value)return Pt.splice(h,1)}(t),r.resolve(i)}catch(f){r.reject(f)}finally{--Dt==0&&sr(),--r.psd.ref||r.psd.finalize()}}function _o(){jt(ft,function(){Lt()&&Ut()})}function Lt(){var e=nr;return vn=nr=!1,e}function Ut(){var e,t,r;do for(;0<Jt.length;)for(e=Jt,Jt=[],r=e.length,t=0;t<r;++t){var i=e[t];i[0].apply(null,i[1])}while(0<Jt.length);vn=nr=!0}function sr(){var e=Pt;Pt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=_n.slice(0),r=t.length;r;)t[--r]()}function gn(e){return new G(Xt,!1,e)}function je(e,t){var r=ue;return function(){var i=Lt(),s=ue;try{return pt(r,!0),e.apply(this,arguments)}catch(f){t&&t(f)}finally{pt(s,!1),i&&Ut()}}}b(G.prototype,{then:ir,_then:function(e,t){ar(this,new Xr(null,null,e,t,ue))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(i){return(i instanceof t?r:gn)(i)}):this.then(null,function(i){return(i&&i.name===t?r:gn)(i)})},finally:function(e){return this.then(function(t){return G.resolve(e()).then(function(){return t})},function(t){return G.resolve(e()).then(function(){return gn(t)})})},timeout:function(e,t){var r=this;return e<1/0?new G(function(i,s){var f=setTimeout(function(){return s(new fe.Timeout(t))},e);r.then(i,s).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&z(G.prototype,Symbol.toStringTag,"Dexie.Promise"),ft.env=$r(),b(G,{all:function(){var e=Te.apply(null,arguments).map(xn);return new G(function(t,r){e.length===0&&t([]);var i=e.length;e.forEach(function(s,f){return G.resolve(s).then(function(h){e[f]=h,--i||t(e)},r)})})},resolve:function(e){return e instanceof G?e:e&&typeof e.then=="function"?new G(function(t,r){e.then(t,r)}):new G(Xt,!0,e)},reject:gn,race:function(){var e=Te.apply(null,arguments).map(xn);return new G(function(t,r){e.map(function(i){return G.resolve(i).then(t,r)})})},PSD:{get:function(){return ue},set:function(e){return ue=e}},totalEchoes:{get:function(){return kn}},newPSD:dt,usePSD:jt,scheduler:{get:function(){return $t},set:function(e){$t=e}},rejectionMapper:{get:function(){return rr},set:function(e){rr=e}},follow:function(e,t){return new G(function(r,i){return dt(function(s,f){var h=ue;h.unhandleds=[],h.onunhandled=f,h.finalize=It(function(){var m,_=this;m=function(){_.unhandleds.length===0?s():f(_.unhandleds[0])},_n.push(function w(){m(),_n.splice(_n.indexOf(w),1)}),++Dt,$t(function(){--Dt==0&&sr()},[])},h.finalize),e()},t,r,i)})}}),Ot&&(Ot.allSettled&&z(G,"allSettled",function(){var e=Te.apply(null,arguments).map(xn);return new G(function(t){e.length===0&&t([]);var r=e.length,i=new Array(r);e.forEach(function(s,f){return G.resolve(s).then(function(h){return i[f]={status:"fulfilled",value:h}},function(h){return i[f]={status:"rejected",reason:h}}).then(function(){return--r||t(i)})})})}),Ot.any&&typeof AggregateError<"u"&&z(G,"any",function(){var e=Te.apply(null,arguments).map(xn);return new G(function(t,r){e.length===0&&r(new AggregateError([]));var i=e.length,s=new Array(i);e.forEach(function(f,h){return G.resolve(f).then(function(m){return t(m)},function(m){s[h]=m,--i||r(new AggregateError(s))})})})}),Ot.withResolvers&&(G.withResolvers=Ot.withResolvers));var qe={awaits:0,echoes:0,id:0},go=0,bn=[],wn=0,kn=0,bo=0;function dt(e,t,r,i){var s=ue,f=Object.create(s);return f.parent=s,f.ref=0,f.global=!1,f.id=++bo,ft.env,f.env=tr?{Promise:G,PromiseProp:{value:G,configurable:!0,writable:!0},all:G.all,race:G.race,allSettled:G.allSettled,any:G.any,resolve:G.resolve,reject:G.reject}:{},t&&y(f,t),++s.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},i=jt(f,e,r,i),f.ref===0&&f.finalize(),i}function Vt(){return qe.id||(qe.id=++go),++qe.awaits,qe.echoes+=Wr,qe.id}function ht(){return!!qe.awaits&&(--qe.awaits==0&&(qe.id=0),qe.echoes=qe.awaits*Wr,!0)}function xn(e){return qe.echoes&&e&&e.constructor===Ot?(Vt(),e.then(function(t){return ht(),t},function(t){return ht(),Ke(t)})):e}function wo(){var e=bn[bn.length-1];bn.pop(),pt(e,!1)}function pt(e,t){var r,i=ue;(t?!qe.echoes||wn++&&e===ue:!wn||--wn&&e===ue)||queueMicrotask(t?(function(s){++kn,qe.echoes&&--qe.echoes!=0||(qe.echoes=qe.awaits=qe.id=0),bn.push(ue),pt(s,!0)}).bind(null,e):wo),e!==ue&&(ue=e,i===ft&&(ft.env=$r()),tr&&(r=ft.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(l,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function $r(){var e=l.Promise;return tr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function jt(e,t,r,i,s){var f=ue;try{return pt(e,!0),t(r,i,s)}finally{pt(f,!1)}}function Jr(e,t,r,i){return typeof e!="function"?e:function(){var s=ue;r&&Vt(),pt(t,!0);try{return e.apply(this,arguments)}finally{pt(s,!1),i&&queueMicrotask(ht)}}}function ur(e){Promise===Ot&&qe.echoes===0?wn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+et).indexOf("[native code]")===-1&&(Vt=ht=Ce);var Ke=G.reject,Kt="￿",st="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Zr="String expected.",Yt=[],Tn="__dbnames",lr="readonly",cr="readwrite";function Rt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ei={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function En(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Ge(t))[e],t}}function ti(){throw fe.Type()}function xe(e,t){try{var r=ni(e),i=ni(t);if(r!==i)return r==="Array"?1:i==="Array"?-1:r==="binary"?1:i==="binary"?-1:r==="string"?1:i==="string"?-1:r==="Date"?1:i!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(s,f){for(var h=s.length,m=f.length,_=h<m?h:m,w=0;w<_;++w)if(s[w]!==f[w])return s[w]<f[w]?-1:1;return h===m?0:h<m?-1:1}(ri(e),ri(t));case"Array":return function(s,f){for(var h=s.length,m=f.length,_=h<m?h:m,w=0;w<_;++w){var E=xe(s[w],f[w]);if(E!==0)return E}return h===m?0:h<m?-1:1}(e,t)}}catch{}return NaN}function ni(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Se(e),e==="ArrayBuffer"?"binary":e)}function ri(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ii=(Oe.prototype._trans=function(e,t,r){var i=this._tx||ue.trans,s=this.name,f=nt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(w,E,v){if(!v.schema[s])throw new fe.NotFound("Table "+s+" not part of transaction");return t(v.idbtrans,v)}var m=Lt();try{var _=i&&i.db._novip===this.db._novip?i===ue.trans?i._promise(e,h,r):dt(function(){return i._promise(e,h,r)},{trans:i,transless:ue.transless||ue}):function w(E,v,I,g){if(E.idbdb&&(E._state.openComplete||ue.letThrough||E._vip)){var T=E._createTransaction(v,I,E._dbSchema);try{T.create(),E._state.PR1398_maxLoop=3}catch(S){return S.name===Zn.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return w(E,v,I,g)})):Ke(S)}return T._promise(v,function(S,k){return dt(function(){return ue.trans=T,g(S,k,T)})}).then(function(S){if(v==="readwrite")try{T.idbtrans.commit()}catch{}return v==="readonly"?S:T._completion.then(function(){return S})})}if(E._state.openComplete)return Ke(new fe.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return Ke(new fe.DatabaseClosed);E.open().catch(Ce)}return E._state.dbReadyPromise.then(function(){return w(E,v,I,g)})}(this.db,e,[this.name],h);return f&&(_._consoleTask=f,_=_.catch(function(w){return console.trace(w),Ke(w)})),_}finally{m&&Ut()}},Oe.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Ke(new fe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(s){return r.hook.reading.fire(s)})}).then(t)},Oe.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(p(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=d(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&t.every(function(w){return 0<=m.keyPath.indexOf(w)})){for(var _=0;_<t.length;++_)if(t.indexOf(m.keyPath[_])===-1)return!1;return!0}return!1}).sort(function(m,_){return m.keyPath.length-_.keyPath.length})[0];if(r&&this.db._maxKey!==Kt){var f=r.keyPath.slice(0,t.length);return this.where(f).equals(f.map(function(_){return e[_]}))}!r&&nt&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function s(m,_){return xe(m,_)===0}var h=t.reduce(function(v,_){var w=v[0],E=v[1],v=i[_],I=e[_];return[w||v,w||!v?Rt(E,v&&v.multi?function(g){return g=se(g,_),p(g)&&g.some(function(T){return s(I,T)})}:function(g){return s(I,se(g,_))}):E]},[null,null]),f=h[0],h=h[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(h):r?this.filter(h):this.where(t).equals("")},Oe.prototype.filter=function(e){return this.toCollection().and(e)},Oe.prototype.count=function(e){return this.toCollection().count(e)},Oe.prototype.offset=function(e){return this.toCollection().offset(e)},Oe.prototype.limit=function(e){return this.toCollection().limit(e)},Oe.prototype.each=function(e){return this.toCollection().each(e)},Oe.prototype.toArray=function(e){return this.toCollection().toArray(e)},Oe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Oe.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,p(e)?"[".concat(e.join("+"),"]"):e))},Oe.prototype.reverse=function(){return this.toCollection().reverse()},Oe.prototype.mapToClass=function(e){var t,r=this.db,i=this.name;function s(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ti&&(function(_,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function E(){this.constructor=_}a(_,w),_.prototype=w===null?Object.create(w):(E.prototype=w.prototype,new E)}(s,t=e),Object.defineProperty(s.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),s.prototype.table=function(){return i},e=s);for(var f=new Set,h=e.prototype;h;h=x(h))Object.getOwnPropertyNames(h).forEach(function(_){return f.add(_)});function m(_){if(!_)return _;var w,E=Object.create(e.prototype);for(w in _)if(!f.has(w))try{E[w]=_[w]}catch{}return E}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),e},Oe.prototype.defineClass=function(){return this.mapToClass(function(e){y(this,e)})},Oe.prototype.add=function(e,t){var r=this,i=this.schema.primKey,s=i.auto,f=i.keyPath,h=e;return f&&s&&(h=En(f)(e)),this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(m){return m.numFailures?G.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{ne(e,f,m)}catch{}return m})},Oe.prototype.update=function(e,t){return typeof e!="object"||p(e)?this.where(":id").equals(e).modify(t):(e=se(e,this.schema.primKey.keyPath),e===void 0?Ke(new fe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Oe.prototype.put=function(e,t){var r=this,i=this.schema.primKey,s=i.auto,f=i.keyPath,h=e;return f&&s&&(h=En(f)(e)),this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(m){return m.numFailures?G.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{ne(e,f,m)}catch{}return m})},Oe.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?G.reject(r.failures[0]):void 0})},Oe.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:ei})}).then(function(t){return t.numFailures?G.reject(t.failures[0]):void 0})},Oe.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(s){return t.hook.reading.fire(s)})})})},Oe.prototype.bulkAdd=function(e,t,r){var i=this,s=Array.isArray(t)?t:void 0,f=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var w=i.schema.primKey,m=w.auto,w=w.keyPath;if(w&&s)throw new fe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new fe.InvalidArgument("Arguments objects and keys must have the same length");var _=e.length,w=w&&m?e.map(En(w)):e;return i.core.mutate({trans:h,type:"add",keys:s,values:w,wantResults:f}).then(function(T){var v=T.numFailures,I=T.results,g=T.lastResult,T=T.failures;if(v===0)return f?I:g;throw new Ft("".concat(i.name,".bulkAdd(): ").concat(v," of ").concat(_," operations failed"),T)})})},Oe.prototype.bulkPut=function(e,t,r){var i=this,s=Array.isArray(t)?t:void 0,f=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var w=i.schema.primKey,m=w.auto,w=w.keyPath;if(w&&s)throw new fe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new fe.InvalidArgument("Arguments objects and keys must have the same length");var _=e.length,w=w&&m?e.map(En(w)):e;return i.core.mutate({trans:h,type:"put",keys:s,values:w,wantResults:f}).then(function(T){var v=T.numFailures,I=T.results,g=T.lastResult,T=T.failures;if(v===0)return f?I:g;throw new Ft("".concat(i.name,".bulkPut(): ").concat(v," of ").concat(_," operations failed"),T)})})},Oe.prototype.bulkUpdate=function(e){var t=this,r=this.core,i=e.map(function(h){return h.key}),s=e.map(function(h){return h.changes}),f=[];return this._trans("readwrite",function(h){return r.getMany({trans:h,keys:i,cache:"clone"}).then(function(m){var _=[],w=[];e.forEach(function(v,I){var g=v.key,T=v.changes,S=m[I];if(S){for(var k=0,P=Object.keys(T);k<P.length;k++){var D=P[k],j=T[D];if(D===t.schema.primKey.keyPath){if(xe(j,g)!==0)throw new fe.Constraint("Cannot update primary key in bulkUpdate()")}else ne(S,D,j)}f.push(I),_.push(g),w.push(S)}});var E=_.length;return r.mutate({trans:h,type:"put",keys:_,values:w,updates:{keys:i,changeSpecs:s}}).then(function(v){var I=v.numFailures,g=v.failures;if(I===0)return E;for(var T=0,S=Object.keys(g);T<S.length;T++){var k,P=S[T],D=f[Number(P)];D!=null&&(k=g[P],delete g[P],g[D]=k)}throw new Ft("".concat(t.name,".bulkUpdate(): ").concat(I," of ").concat(E," operations failed"),g)})})})},Oe.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e})}).then(function(h){var s=h.numFailures,f=h.lastResult,h=h.failures;if(s===0)return f;throw new Ft("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(r," operations failed"),h)})},Oe);function Oe(){}function Zt(e){function t(h,m){if(m){for(var _=arguments.length,w=new Array(_-1);--_;)w[_-1]=arguments[_];return r[h].subscribe.apply(null,w),e}if(typeof h=="string")return r[h]}var r={};t.addEventType=f;for(var i=1,s=arguments.length;i<s;++i)f(arguments[i]);return t;function f(h,m,_){if(typeof h!="object"){var w;m=m||vo;var E={subscribers:[],fire:_=_||Ce,subscribe:function(v){E.subscribers.indexOf(v)===-1&&(E.subscribers.push(v),E.fire=m(E.fire,v))},unsubscribe:function(v){E.subscribers=E.subscribers.filter(function(I){return I!==v}),E.fire=E.subscribers.reduce(m,_)}};return r[h]=t[h]=E}d(w=h).forEach(function(v){var I=w[v];if(p(I))f(v,w[v][0],w[v][1]);else{if(I!=="asap")throw new fe.InvalidArgument("Invalid event config");var g=f(v,Wt,function(){for(var T=arguments.length,S=new Array(T);T--;)S[T]=arguments[T];g.subscribers.forEach(function(k){we(function(){k.apply(null,S)})})})}})}}function en(e,t){return te(t).from({prototype:e}),t}function Ht(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function fr(e,t){e.filter=Rt(e.filter,t)}function dr(e,t,r){var i=e.replayFilter;e.replayFilter=i?function(){return Rt(i(),t())}:t,e.justLimit=r&&!i}function Sn(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new fe.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function oi(e,t,r){var i=Sn(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function In(e,t,r,i){var s=e.replayFilter?Rt(e.filter,e.replayFilter()):e.filter;if(e.or){var f={},h=function(m,_,w){var E,v;s&&!s(_,w,function(I){return _.stop(I)},function(I){return _.fail(I)})||((v=""+(E=_.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(E)),O(f,v)||(f[v]=!0,t(m,_,w)))};return Promise.all([e.or._iterate(h,r),ai(oi(e,i,r),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return ai(oi(e,i,r),Rt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function ai(e,t,r,i){var s=je(i?function(f,h,m){return r(i(f),h,m)}:r);return e.then(function(f){if(f)return f.start(function(){var h=function(){return f.continue()};t&&!t(f,function(m){return h=m},function(m){f.stop(m),h=Ce},function(m){f.fail(m),h=Ce})||s(f.value,f,function(m){return h=m}),h()})})}var tn=(si.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var r=t.add;if(p(r))return c(c([],p(e)?e:[],!0),r).sort();if(typeof r=="number")return(Number(e)||0)+r;if(typeof r=="bigint")try{return BigInt(e)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(t.remove!==void 0){var i=t.remove;if(p(i))return p(e)?e.filter(function(s){return!i.includes(s)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return r=(r=t.replacePrefix)===null||r===void 0?void 0:r[0],r&&typeof e=="string"&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},si);function si(e){this["@@propmod"]=e}var ko=(Ee.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,Ke.bind(null,r.error)):r.table._trans("readonly",e).then(t)},Ee.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ke.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Ee.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Rt(t.algorithm,e)},Ee.prototype._iterate=function(e,t){return In(this._ctx,e,t,this._ctx.table.core)},Ee.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&y(r,e),t._ctx=r,t},Ee.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ee.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return In(t,e,r,t.table.core)})},Ee.prototype.count=function(e){var t=this;return this._read(function(r){var i=t._ctx,s=i.table.core;if(Ht(i,!0))return s.count({trans:r,query:{index:Sn(i,s.schema),range:i.range}}).then(function(h){return Math.min(h,i.limit)});var f=0;return In(i,function(){return++f,!1},r,s).then(function(){return f})}).then(e)},Ee.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),i=r[0],s=r.length-1;function f(_,w){return w?f(_[r[w]],w-1):_[i]}var h=this._ctx.dir==="next"?1:-1;function m(_,w){return xe(f(_,s),f(w,s))*h}return this.toArray(function(_){return _.sort(m)}).then(t)},Ee.prototype.toArray=function(e){var t=this;return this._read(function(r){var i=t._ctx;if(i.dir==="next"&&Ht(i,!0)&&0<i.limit){var s=i.valueMapper,f=Sn(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:f,range:i.range}}).then(function(m){return m=m.result,s?m.map(s):m})}var h=[];return In(i,function(m){return h.push(m)},r,i.table.core).then(function(){return h})},e)},Ee.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ht(t)?dr(t,function(){var r=e;return function(i,s){return r===0||(r===1?--r:s(function(){i.advance(r),r=0}),!1)}}):dr(t,function(){var r=e;return function(){return--r<0}})),this},Ee.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),dr(this._ctx,function(){var t=e;return function(r,i,s){return--t<=0&&i(s),0<=t}},!0),this},Ee.prototype.until=function(e,t){return fr(this._ctx,function(r,i,s){return!e(r.value)||(i(s),t)}),this},Ee.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},Ee.prototype.last=function(e){return this.reverse().first(e)},Ee.prototype.filter=function(e){var t;return fr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=Rt(t.isMatch,e),this},Ee.prototype.and=function(e){return this.filter(e)},Ee.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Ee.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ee.prototype.desc=function(){return this.reverse()},Ee.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.key,i)})},Ee.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Ee.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},Ee.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,s){r.push(s.key)}).then(function(){return r}).then(e)},Ee.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Ht(t,!0)&&0<t.limit)return this._read(function(i){var s=Sn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)},Ee.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Ee.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},Ee.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Ee.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return fr(this._ctx,function(s){var i=s.primaryKey.toString(),s=O(t,i);return t[i]=!0,!s}),this},Ee.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(i){var s,f,h;h=typeof e=="function"?e:(s=d(e),f=s.length,function(k){for(var P=!1,D=0;D<f;++D){var j=s[D],K=e[j],q=se(k,j);K instanceof tn?(ne(k,j,K.execute(q)),P=!0):q!==K&&(ne(k,j,K),P=!0)}return P});var m=r.table.core,v=m.schema.primaryKey,_=v.outbound,w=v.extractKey,E=200,v=t.db._options.modifyChunkSize;v&&(E=typeof v=="object"?v[m.name]||v["*"]||200:v);function I(k,j){var D=j.failures,j=j.numFailures;T+=k-j;for(var K=0,q=d(D);K<q.length;K++){var Y=q[K];g.push(D[Y])}}var g=[],T=0,S=[];return t.clone().primaryKeys().then(function(k){function P(j){var K=Math.min(E,k.length-j);return m.getMany({trans:i,keys:k.slice(j,j+K),cache:"immutable"}).then(function(q){for(var Y=[],F=[],L=_?[]:null,H=[],U=0;U<K;++U){var $=q[U],me={value:Ge($),primKey:k[j+U]};h.call(me,me.value,me)!==!1&&(me.value==null?H.push(k[j+U]):_||xe(w($),w(me.value))===0?(F.push(me.value),_&&L.push(k[j+U])):(H.push(k[j+U]),Y.push(me.value)))}return Promise.resolve(0<Y.length&&m.mutate({trans:i,type:"add",values:Y}).then(function(ge){for(var be in ge.failures)H.splice(parseInt(be),1);I(Y.length,ge)})).then(function(){return(0<F.length||D&&typeof e=="object")&&m.mutate({trans:i,type:"put",keys:L,values:F,criteria:D,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<j}).then(function(ge){return I(F.length,ge)})}).then(function(){return(0<H.length||D&&e===hr)&&m.mutate({trans:i,type:"delete",keys:H,criteria:D,isAdditionalChunk:0<j}).then(function(ge){return I(H.length,ge)})}).then(function(){return k.length>j+K&&P(j+E)})})}var D=Ht(r)&&r.limit===1/0&&(typeof e!="function"||e===hr)&&{index:r.index,range:r.range};return P(0).then(function(){if(0<g.length)throw new pn("Error modifying one or more objects",g,T,S);return k.length})})})},Ee.prototype.delete=function(){var e=this._ctx,t=e.range;return Ht(e)&&(e.isPrimKey||t.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,s=t;return e.table.core.count({trans:r,query:{index:i,range:s}}).then(function(f){return e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(function(h){var m=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new pn("Could not delete some values",Object.keys(m).map(function(_){return m[_]}),f-h);return f-h})})}):this.modify(hr)},Ee);function Ee(){}var hr=function(e,t){return t.value=null};function xo(e,t){return e<t?-1:e===t?0:1}function To(e,t){return t<e?-1:e===t?0:1}function Je(e,t,r){return e=e instanceof li?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function zt(e){return new e.Collection(e,function(){return ui("")}).limit(0)}function Cn(e,t,r,i){var s,f,h,m,_,w,E,v=r.length;if(!r.every(function(T){return typeof T=="string"}))return Je(e,Zr);function I(T){s=T==="next"?function(k){return k.toUpperCase()}:function(k){return k.toLowerCase()},f=T==="next"?function(k){return k.toLowerCase()}:function(k){return k.toUpperCase()},h=T==="next"?xo:To;var S=r.map(function(k){return{lower:f(k),upper:s(k)}}).sort(function(k,P){return h(k.lower,P.lower)});m=S.map(function(k){return k.upper}),_=S.map(function(k){return k.lower}),E=(w=T)==="next"?"":i}I("next"),e=new e.Collection(e,function(){return mt(m[0],_[v-1]+i)}),e._ondirectionchange=function(T){I(T)};var g=0;return e._addAlgorithm(function(T,S,k){var P=T.key;if(typeof P!="string")return!1;var D=f(P);if(t(D,_,g))return!0;for(var j=null,K=g;K<v;++K){var q=function(Y,F,L,H,U,$){for(var me=Math.min(Y.length,H.length),ge=-1,be=0;be<me;++be){var Ze=F[be];if(Ze!==H[be])return U(Y[be],L[be])<0?Y.substr(0,be)+L[be]+L.substr(be+1):U(Y[be],H[be])<0?Y.substr(0,be)+H[be]+L.substr(be+1):0<=ge?Y.substr(0,ge)+F[ge]+L.substr(ge+1):null;U(Y[be],Ze)<0&&(ge=be)}return me<H.length&&$==="next"?Y+L.substr(Y.length):me<Y.length&&$==="prev"?Y.substr(0,L.length):ge<0?null:Y.substr(0,ge)+H[ge]+L.substr(ge+1)}(P,D,m[K],_[K],h,w);q===null&&j===null?g=K+1:(j===null||0<h(j,q))&&(j=q)}return S(j!==null?function(){T.continue(j+E)}:k),!1}),e}function mt(e,t,r,i){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:i}}function ui(e){return{type:1,lower:e,upper:e}}var li=(Object.defineProperty(Fe.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Fe.prototype.between=function(e,t,r,i){r=r!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||i)&&(!r||!i)?zt(this):new this.Collection(this,function(){return mt(e,t,!r,!i)})}catch{return Je(this,st)}},Fe.prototype.equals=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return ui(e)})},Fe.prototype.above=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return mt(e,void 0,!0)})},Fe.prototype.aboveOrEqual=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return mt(e,void 0,!1)})},Fe.prototype.below=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return mt(void 0,e,!1,!0)})},Fe.prototype.belowOrEqual=function(e){return e==null?Je(this,st):new this.Collection(this,function(){return mt(void 0,e)})},Fe.prototype.startsWith=function(e){return typeof e!="string"?Je(this,Zr):this.between(e,e+Kt,!0,!0)},Fe.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Cn(this,function(t,r){return t.indexOf(r[0])===0},[e],Kt)},Fe.prototype.equalsIgnoreCase=function(e){return Cn(this,function(t,r){return t===r[0]},[e],"")},Fe.prototype.anyOfIgnoreCase=function(){var e=Te.apply(pe,arguments);return e.length===0?zt(this):Cn(this,function(t,r){return r.indexOf(t)!==-1},e,"")},Fe.prototype.startsWithAnyOfIgnoreCase=function(){var e=Te.apply(pe,arguments);return e.length===0?zt(this):Cn(this,function(t,r){return r.some(function(i){return t.indexOf(i)===0})},e,Kt)},Fe.prototype.anyOf=function(){var e=this,t=Te.apply(pe,arguments),r=this._cmp;try{t.sort(r)}catch{return Je(this,st)}if(t.length===0)return zt(this);var i=new this.Collection(this,function(){return mt(t[0],t[t.length-1])});i._ondirectionchange=function(f){r=f==="next"?e._ascending:e._descending,t.sort(r)};var s=0;return i._addAlgorithm(function(f,h,m){for(var _=f.key;0<r(_,t[s]);)if(++s===t.length)return h(m),!1;return r(_,t[s])===0||(h(function(){f.continue(t[s])}),!1)}),i},Fe.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Fe.prototype.noneOf=function(){var e=Te.apply(pe,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Je(this,st)}var t=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Fe.prototype.inAnyRange=function(P,t){var r=this,i=this._cmp,s=this._ascending,f=this._descending,h=this._min,m=this._max;if(P.length===0)return zt(this);if(!P.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&s(D[0],D[1])<=0}))return Je(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",fe.InvalidArgument);var _=!t||t.includeLowers!==!1,w=t&&t.includeUppers===!0,E,v=s;function I(D,j){return v(D[0],j[0])}try{(E=P.reduce(function(D,j){for(var K=0,q=D.length;K<q;++K){var Y=D[K];if(i(j[0],Y[1])<0&&0<i(j[1],Y[0])){Y[0]=h(Y[0],j[0]),Y[1]=m(Y[1],j[1]);break}}return K===q&&D.push(j),D},[])).sort(I)}catch{return Je(this,st)}var g=0,T=w?function(D){return 0<s(D,E[g][1])}:function(D){return 0<=s(D,E[g][1])},S=_?function(D){return 0<f(D,E[g][0])}:function(D){return 0<=f(D,E[g][0])},k=T,P=new this.Collection(this,function(){return mt(E[0][0],E[E.length-1][1],!_,!w)});return P._ondirectionchange=function(D){v=D==="next"?(k=T,s):(k=S,f),E.sort(I)},P._addAlgorithm(function(D,j,K){for(var q,Y=D.key;k(Y);)if(++g===E.length)return j(K),!1;return!T(q=Y)&&!S(q)||(r._cmp(Y,E[g][1])===0||r._cmp(Y,E[g][0])===0||j(function(){v===s?D.continue(E[g][0]):D.continue(E[g][1])}),!1)}),P},Fe.prototype.startsWithAnyOf=function(){var e=Te.apply(pe,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?zt(this):this.inAnyRange(e.map(function(t){return[t,t+Kt]})):Je(this,"startsWithAnyOf() only works with strings")},Fe);function Fe(){}function rt(e){return je(function(t){return nn(t),e(t.target.error),!1})}function nn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var rn="storagemutated",pr="x-storagemutated-1",vt=Zt(null,rn),Eo=(it.prototype._lock=function(){return ie(!ue.global),++this._reculock,this._reculock!==1||ue.global||(ue.lockOwnerFor=this),this},it.prototype._unlock=function(){if(ie(!ue.global),--this._reculock==0)for(ue.global||(ue.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{jt(e[1],e[0])}catch{}}return this},it.prototype._locked=function(){return this._reculock&&ue.lockOwnerFor!==this},it.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(ie(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new fe.DatabaseClosed(i);case"MissingAPIError":throw new fe.MissingAPI(i.message,i);default:throw new fe.OpenFailed(i)}if(!this.active)throw new fe.TransactionInactive;return ie(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=je(function(s){nn(s),t._reject(e.error)}),e.onabort=je(function(s){nn(s),t.active&&t._reject(new fe.Abort(e.error)),t.active=!1,t.on("abort").fire(s)}),e.oncomplete=je(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&vt.storagemutated.fire(e.mutatedParts)}),this},it.prototype._promise=function(e,t,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return Ke(new fe.ReadOnly("Transaction is readonly"));if(!this.active)return Ke(new fe.TransactionInactive);if(this._locked())return new G(function(f,h){i._blockedFuncs.push([function(){i._promise(e,t,r).then(f,h)},ue])});if(r)return dt(function(){var f=new G(function(h,m){i._lock();var _=t(h,m,i);_&&_.then&&_.then(h,m)});return f.finally(function(){return i._unlock()}),f._lib=!0,f});var s=new G(function(f,h){var m=t(f,h,i);m&&m.then&&m.then(f,h)});return s._lib=!0,s},it.prototype._root=function(){return this.parent?this.parent._root():this},it.prototype.waitFor=function(e){var t,r=this._root(),i=G.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return i}):(r._waitingFor=i,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function f(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=f)}());var s=r._waitingFor;return new G(function(f,h){i.then(function(m){return r._waitingQueue.push(je(f.bind(null,m)))},function(m){return r._waitingQueue.push(je(h.bind(null,m)))}).finally(function(){r._waitingFor===s&&(r._waitingFor=null)})})},it.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new fe.Abort))},it.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(O(t,e))return t[e];var r=this.schema[e];if(!r)throw new fe.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},it);function it(){}function mr(e,t,r,i,s,f,h){return{name:e,keyPath:t,unique:r,multi:i,auto:s,compound:f,src:(r&&!h?"&":"")+(i?"*":"")+(s?"++":"")+ci(t)}}function ci(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function vr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(i=function(s){return[s.name,s]},r.reduce(function(s,f,h){return h=i(f,h),h&&(s[h[0]]=h[1]),s},{}))};var i}var on=function(e){try{return e.only([[]]),on=function(){return[[]]},[[]]}catch{return on=function(){return Kt},Kt}};function yr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return se(r,t)}:function(r){return se(r,e)};var t}function fi(e){return[].slice.call(e)}var So=0;function an(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Io(e,t,_){function i(k){if(k.type===3)return null;if(k.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var g=k.lower,T=k.upper,S=k.lowerOpen,k=k.upperOpen;return g===void 0?T===void 0?null:t.upperBound(T,!!k):T===void 0?t.lowerBound(g,!!S):t.bound(g,T,!!S,!!k)}function s(I){var g,T=I.name;return{name:T,schema:I,mutate:function(S){var k=S.trans,P=S.type,D=S.keys,j=S.values,K=S.range;return new Promise(function(q,Y){q=je(q);var F=k.objectStore(T),L=F.keyPath==null,H=P==="put"||P==="add";if(!H&&P!=="delete"&&P!=="deleteRange")throw new Error("Invalid operation type: "+P);var U,$=(D||j||{length:1}).length;if(D&&j&&D.length!==j.length)throw new Error("Given keys array must have same length as given values array.");if($===0)return q({numFailures:0,failures:{},results:[],lastResult:void 0});function me(We){++Ze,nn(We)}var ge=[],be=[],Ze=0;if(P==="deleteRange"){if(K.type===4)return q({numFailures:Ze,failures:be,results:[],lastResult:void 0});K.type===3?ge.push(U=F.clear()):ge.push(U=F.delete(i(K)))}else{var L=H?L?[j,D]:[j,null]:[D,null],he=L[0],Ve=L[1];if(H)for(var Ye=0;Ye<$;++Ye)ge.push(U=Ve&&Ve[Ye]!==void 0?F[P](he[Ye],Ve[Ye]):F[P](he[Ye])),U.onerror=me;else for(Ye=0;Ye<$;++Ye)ge.push(U=F[P](he[Ye])),U.onerror=me}function Ln(We){We=We.target.result,ge.forEach(function(Nt,Ar){return Nt.error!=null&&(be[Ar]=Nt.error)}),q({numFailures:Ze,failures:be,results:P==="delete"?D:ge.map(function(Nt){return Nt.result}),lastResult:We})}U.onerror=function(We){me(We),Ln(We)},U.onsuccess=Ln})},getMany:function(S){var k=S.trans,P=S.keys;return new Promise(function(D,j){D=je(D);for(var K,q=k.objectStore(T),Y=P.length,F=new Array(Y),L=0,H=0,U=function(ge){ge=ge.target,F[ge._pos]=ge.result,++H===L&&D(F)},$=rt(j),me=0;me<Y;++me)P[me]!=null&&((K=q.get(P[me]))._pos=me,K.onsuccess=U,K.onerror=$,++L);L===0&&D(F)})},get:function(S){var k=S.trans,P=S.key;return new Promise(function(D,j){D=je(D);var K=k.objectStore(T).get(P);K.onsuccess=function(q){return D(q.target.result)},K.onerror=rt(j)})},query:(g=w,function(S){return new Promise(function(k,P){k=je(k);var D,j,K,L=S.trans,q=S.values,Y=S.limit,U=S.query,F=Y===1/0?void 0:Y,H=U.index,U=U.range,L=L.objectStore(T),H=H.isPrimaryKey?L:L.index(H.name),U=i(U);if(Y===0)return k({result:[]});g?((F=q?H.getAll(U,F):H.getAllKeys(U,F)).onsuccess=function($){return k({result:$.target.result})},F.onerror=rt(P)):(D=0,j=!q&&"openKeyCursor"in H?H.openKeyCursor(U):H.openCursor(U),K=[],j.onsuccess=function($){var me=j.result;return me?(K.push(q?me.value:me.primaryKey),++D===Y?k({result:K}):void me.continue()):k({result:K})},j.onerror=rt(P))})}),openCursor:function(S){var k=S.trans,P=S.values,D=S.query,j=S.reverse,K=S.unique;return new Promise(function(q,Y){q=je(q);var H=D.index,F=D.range,L=k.objectStore(T),L=H.isPrimaryKey?L:L.index(H.name),H=j?K?"prevunique":"prev":K?"nextunique":"next",U=!P&&"openKeyCursor"in L?L.openKeyCursor(i(F),H):L.openCursor(i(F),H);U.onerror=rt(Y),U.onsuccess=je(function($){var me,ge,be,Ze,he=U.result;he?(he.___id=++So,he.done=!1,me=he.continue.bind(he),ge=(ge=he.continuePrimaryKey)&&ge.bind(he),be=he.advance.bind(he),Ze=function(){throw new Error("Cursor not stopped")},he.trans=k,he.stop=he.continue=he.continuePrimaryKey=he.advance=function(){throw new Error("Cursor not started")},he.fail=je(Y),he.next=function(){var Ve=this,Ye=1;return this.start(function(){return Ye--?Ve.continue():Ve.stop()}).then(function(){return Ve})},he.start=function(Ve){function Ye(){if(U.result)try{Ve()}catch(We){he.fail(We)}else he.done=!0,he.start=function(){throw new Error("Cursor behind last entry")},he.stop()}var Ln=new Promise(function(We,Nt){We=je(We),U.onerror=rt(Nt),he.fail=Nt,he.stop=function(Ar){he.stop=he.continue=he.continuePrimaryKey=he.advance=Ze,We(Ar)}});return U.onsuccess=je(function(We){U.onsuccess=Ye,Ye()}),he.continue=me,he.continuePrimaryKey=ge,he.advance=be,Ye(),Ln},q(he)):q(null)},Y)})},count:function(S){var k=S.query,P=S.trans,D=k.index,j=k.range;return new Promise(function(K,q){var Y=P.objectStore(T),F=D.isPrimaryKey?Y:Y.index(D.name),Y=i(j),F=Y?F.count(Y):F.count();F.onsuccess=je(function(L){return K(L.target.result)}),F.onerror=rt(q)})}}}var f,h,m,E=(h=_,m=fi((f=e).objectStoreNames),{schema:{name:f.name,tables:m.map(function(I){return h.objectStore(I)}).map(function(I){var g=I.keyPath,k=I.autoIncrement,T=p(g),S={},k={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g==null,compound:T,keyPath:g,autoIncrement:k,unique:!0,extractKey:yr(g)},indexes:fi(I.indexNames).map(function(P){return I.index(P)}).map(function(K){var D=K.name,j=K.unique,q=K.multiEntry,K=K.keyPath,q={name:D,compound:p(K),keyPath:K,unique:j,multiEntry:q,extractKey:yr(K)};return S[an(K)]=q}),getIndexByKeyPath:function(P){return S[an(P)]}};return S[":id"]=k.primaryKey,g!=null&&(S[an(g)]=k.primaryKey),k})},hasGetAll:0<m.length&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),_=E.schema,w=E.hasGetAll,E=_.tables.map(s),v={};return E.forEach(function(I){return v[I.name]=I}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(I){if(!v[I])throw new Error("Table '".concat(I,"' not found"));return v[I]},MIN_KEY:-1/0,MAX_KEY:on(t),schema:_}}function Co(e,t,r,i){var s=r.IDBKeyRange;return r.indexedDB,{dbcore:(i=Io(t,s,i),e.dbcore.reduce(function(f,h){return h=h.create,o(o({},f),h(f))},i))}}function On(e,i){var r=i.db,i=Co(e._middlewares,r,e._deps,i);e.core=i.dbcore,e.tables.forEach(function(s){var f=s.name;e.core.schema.tables.some(function(h){return h.name===f})&&(s.core=e.core.table(f),e[f]instanceof e.Table&&(e[f].core=s.core))})}function Pn(e,t,r,i){r.forEach(function(s){var f=i[s];t.forEach(function(h){var m=function _(w,E){return V(w,E)||(w=x(w))&&_(w,E)}(h,s);(!m||"value"in m&&m.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?z(h,s,{get:function(){return this.table(s)},set:function(_){B(this,s,{value:_,writable:!0,configurable:!0,enumerable:!0})}}):h[s]=new e.Table(s,f))})})}function _r(e,t){t.forEach(function(r){for(var i in r)r[i]instanceof e.Table&&delete r[i]})}function Oo(e,t){return e._cfg.version-t._cfg.version}function Po(e,t,r,i){var s=e._dbSchema;r.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=vr("$meta",hi("")[0],[]),e._storeNames.push("$meta"));var f=e._createTransaction("readwrite",e._storeNames,s);f.create(r),f._completion.catch(i);var h=f._reject.bind(f),m=ue.transless||ue;dt(function(){return ue.trans=f,ue.transless=m,t!==0?(On(e,r),w=t,((_=f).storeNames.includes("$meta")?_.table("$meta").get("version").then(function(E){return E??w}):G.resolve(w)).then(function(E){return I=E,g=f,T=r,S=[],E=(v=e)._versions,k=v._dbSchema=jn(0,v.idbdb,T),(E=E.filter(function(P){return P._cfg.version>=I})).length!==0?(E.forEach(function(P){S.push(function(){var D=k,j=P._cfg.dbschema;Kn(v,D,T),Kn(v,j,T),k=v._dbSchema=j;var K=gr(D,j);K.add.forEach(function(H){br(T,H[0],H[1].primKey,H[1].indexes)}),K.change.forEach(function(H){if(H.recreate)throw new fe.Upgrade("Not yet support for changing primary key");var U=T.objectStore(H.name);H.add.forEach(function($){return Dn(U,$)}),H.change.forEach(function($){U.deleteIndex($.name),Dn(U,$)}),H.del.forEach(function($){return U.deleteIndex($)})});var q=P._cfg.contentUpgrade;if(q&&P._cfg.version>I){On(v,T),g._memoizedTables={};var Y=oe(j);K.del.forEach(function(H){Y[H]=D[H]}),_r(v,[v.Transaction.prototype]),Pn(v,[v.Transaction.prototype],d(Y),Y),g.schema=Y;var F,L=at(q);return L&&Vt(),K=G.follow(function(){var H;(F=q(g))&&L&&(H=ht.bind(null,null),F.then(H,H))}),F&&typeof F.then=="function"?G.resolve(F):K.then(function(){return F})}}),S.push(function(D){var j,K,q=P._cfg.dbschema;j=q,K=D,[].slice.call(K.db.objectStoreNames).forEach(function(Y){return j[Y]==null&&K.db.deleteObjectStore(Y)}),_r(v,[v.Transaction.prototype]),Pn(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),g.schema=v._dbSchema}),S.push(function(D){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===P._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(j){return j!=="$meta"})):D.objectStore("$meta").put(P._cfg.version,"version"))})}),function P(){return S.length?G.resolve(S.shift()(g.idbtrans)).then(P):G.resolve()}().then(function(){di(k,T)})):G.resolve();var v,I,g,T,S,k}).catch(h)):(d(s).forEach(function(E){br(r,E,s[E].primKey,s[E].indexes)}),On(e,r),void G.follow(function(){return e.on.populate.fire(f)}).catch(h));var _,w})}function Do(e,t){di(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=jn(0,e.idbdb,t);Kn(e,e._dbSchema,t);for(var i=0,s=gr(r,e._dbSchema).change;i<s.length;i++){var f=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=t.objectStore(h.name);h.add.forEach(function(_){nt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(_.src)),Dn(m,_)})}(s[i]);if(typeof f=="object")return f.value}}function gr(e,t){var r,i={del:[],add:[],change:[]};for(r in e)t[r]||i.del.push(r);for(r in t){var s=e[r],f=t[r];if(s){var h={name:r,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||s.primKey.auto!==f.primKey.auto)h.recreate=!0,i.change.push(h);else{var m=s.idxByName,_=f.idxByName,w=void 0;for(w in m)_[w]||h.del.push(w);for(w in _){var E=m[w],v=_[w];E?E.src!==v.src&&h.change.push(v):h.add.push(v)}(0<h.del.length||0<h.add.length||0<h.change.length)&&i.change.push(h)}}else i.add.push([r,f])}return i}function br(e,t,r,i){var s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return i.forEach(function(f){return Dn(s,f)}),s}function di(e,t){d(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(nt&&console.debug("Dexie: Creating missing table",r),br(t,r,e[r].primKey,e[r].indexes))})}function Dn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function jn(e,t,r){var i={};return ae(t.objectStoreNames,0).forEach(function(s){for(var f=r.objectStore(s),h=mr(ci(w=f.keyPath),w||"",!0,!1,!!f.autoIncrement,w&&typeof w!="string",!0),m=[],_=0;_<f.indexNames.length;++_){var E=f.index(f.indexNames[_]),w=E.keyPath,E=mr(E.name,w,!!E.unique,!!E.multiEntry,!1,w&&typeof w!="string",!1);m.push(E)}i[s]=vr(s,h,m)}),i}function Kn(e,t,r){for(var i=r.db.objectStoreNames,s=0;s<i.length;++s){var f=i[s],h=r.objectStore(f);e._hasGetAll="getAll"in h;for(var m=0;m<h.indexNames.length;++m){var _=h.indexNames[m],w=h.index(_).keyPath,E=typeof w=="string"?w:"["+ae(w).join("+")+"]";!t[f]||(w=t[f].idxByName[E])&&(w.name=_,delete t[f].idxByName[E],t[f].idxByName[_]=w)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function hi(e){return e.split(",").map(function(t,r){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),s=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return mr(i,s||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),p(s),r===0)})}var jo=(Rn.prototype._parseStoresSpec=function(e,t){d(e).forEach(function(r){if(e[r]!==null){var i=hi(e[r]),s=i.shift();if(s.unique=!0,s.multi)throw new fe.Schema("Primary key cannot be multi-valued");i.forEach(function(f){if(f.auto)throw new fe.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new fe.Schema("Index must have a name and cannot be an empty string")}),t[r]=vr(r,s,i)}})},Rn.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?y(this._cfg.storesSource,r):r;var r=t._versions,i={},s={};return r.forEach(function(f){y(i,f._cfg.storesSource),s=f._cfg.dbschema={},f._parseStoresSpec(i,s)}),t._dbSchema=s,_r(t,[t._allTables,t,t.Transaction.prototype]),Pn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],d(s),s),t._storeNames=d(s),this},Rn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=er(this._cfg.contentUpgrade||Ce,e),this},Rn);function Rn(){}function wr(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new ut(Tn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function kr(e){return e&&typeof e.databases=="function"}function xr(e){return dt(function(){return ue.letThrough=!0,e()})}function Tr(e){return!("from"in e)}var Ue=function(e,t){if(!this){var r=new Ue;return e&&"d"in e&&y(r,e),r}y(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function sn(e,t,r){var i=xe(t,r);if(!isNaN(i)){if(0<i)throw RangeError();if(Tr(e))return y(e,{from:t,to:r,d:1});var s=e.l,i=e.r;if(xe(r,e.from)<0)return s?sn(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},mi(e);if(0<xe(t,e.to))return i?sn(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},mi(e);xe(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<xe(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,s&&!e.l&&un(e,s),i&&r&&un(e,i)}}function un(e,t){Tr(t)||function r(i,_){var f=_.from,h=_.to,m=_.l,_=_.r;sn(i,f,h),m&&r(i,m),_&&r(i,_)}(e,t)}function pi(e,t){var r=An(t),i=r.next();if(i.done)return!1;for(var s=i.value,f=An(e),h=f.next(s.from),m=h.value;!i.done&&!h.done;){if(xe(m.from,s.to)<=0&&0<=xe(m.to,s.from))return!0;xe(s.from,m.from)<0?s=(i=r.next(m.from)).value:m=(h=f.next(s.from)).value}return!1}function An(e){var t=Tr(e)?null:{s:0,n:e};return{next:function(r){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&xe(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||xe(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mi(e){var t,r,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),s=1<i?"r":i<-1?"l":"";s&&(t=s=="r"?"l":"r",r=o({},e),i=e[s],e.from=i.from,e.to=i.to,e[s]=i[s],r[s]=i[t],(e[t]=r).d=vi(r)),e.d=vi(e)}function vi(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function Mn(e,t){return d(t).forEach(function(r){e[r]?un(e[r],t[r]):e[r]=function i(s){var f,h,m={};for(f in s)O(s,f)&&(h=s[f],m[f]=!h||typeof h!="object"||De.has(h.constructor)?h:i(h));return m}(t[r])}),e}function Er(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&pi(t[r],e[r])})}b(Ue.prototype,((et={add:function(e){return un(this,e),this},addKey:function(e){return sn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return sn(t,r,r)}),this},hasKey:function(e){var t=An(this).next(e).value;return t&&xe(t.from,e)<=0&&0<=xe(t.to,e)}})[re]=function(){return An(this)},et));var At={},Sr={},Ir=!1;function Nn(e){Mn(Sr,e),Ir||(Ir=!0,setTimeout(function(){Ir=!1,Cr(Sr,!(Sr={}))},0))}function Cr(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var i=0,s=Object.values(At);i<s.length;i++)yi(h=s[i],e,r,t);else for(var f in e){var h,m=/^idb\:\/\/(.*)\/(.*)\//.exec(f);m&&(f=m[1],m=m[2],(h=At["idb://".concat(f,"/").concat(m)])&&yi(h,e,r,t))}r.forEach(function(_){return _()})}function yi(e,t,r,i){for(var s=[],f=0,h=Object.entries(e.queries.query);f<h.length;f++){for(var m=h[f],_=m[0],w=[],E=0,v=m[1];E<v.length;E++){var I=v[E];Er(t,I.obsSet)?I.subscribers.forEach(function(k){return r.add(k)}):i&&w.push(I)}i&&s.push([_,w])}if(i)for(var g=0,T=s;g<T.length;g++){var S=T[g],_=S[0],w=S[1];e.queries.query[_]=w}}function Ko(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ke(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,s=Math.round(10*e.verno),f=!1;function h(){if(t.openCanceller!==i)throw new fe.DatabaseClosed("db.open() was cancelled")}function m(){return new G(function(I,g){if(h(),!r)throw new fe.MissingAPI;var T=e.name,S=t.autoSchema||!s?r.open(T):r.open(T,s);if(!S)throw new fe.MissingAPI;S.onerror=rt(g),S.onblocked=je(e._fireOnBlocked),S.onupgradeneeded=je(function(k){var P;E=S.transaction,t.autoSchema&&!e._options.allowEmptyDB?(S.onerror=nn,E.abort(),S.result.close(),(P=r.deleteDatabase(T)).onsuccess=P.onerror=je(function(){g(new fe.NoSuchDatabase("Database ".concat(T," doesnt exist")))})):(E.onerror=rt(g),k=k.oldVersion>Math.pow(2,62)?0:k.oldVersion,v=k<1,e.idbdb=S.result,f&&Do(e,E),Po(e,k/10,E,g))},g),S.onsuccess=je(function(){E=null;var k,P,D,j,K,q=e.idbdb=S.result,Y=ae(q.objectStoreNames);if(0<Y.length)try{var F=q.transaction((j=Y).length===1?j[0]:j,"readonly");if(t.autoSchema)P=q,D=F,(k=e).verno=P.version/10,D=k._dbSchema=jn(0,P,D),k._storeNames=ae(P.objectStoreNames,0),Pn(k,[k._allTables],d(D),D);else if(Kn(e,e._dbSchema,F),((K=gr(jn(0,(K=e).idbdb,F),K._dbSchema)).add.length||K.change.some(function(L){return L.add.length||L.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),q.close(),s=q.version+1,f=!0,I(m());On(e,F)}catch{}Yt.push(e),q.onversionchange=je(function(L){t.vcFired=!0,e.on("versionchange").fire(L)}),q.onclose=je(function(L){e.on("close").fire(L)}),v&&(K=e._deps,F=T,q=K.indexedDB,K=K.IDBKeyRange,kr(q)||F===Tn||wr(q,K).put({name:F}).catch(Ce)),I()},g)}).catch(function(I){switch(I==null?void 0:I.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<s)return s=0,m()}return G.reject(I)})}var _,w=t.dbReadyResolve,E=null,v=!1;return G.race([i,(typeof navigator>"u"?G.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function g(){return indexedDB.databases().finally(I)}_=setInterval(g,100),g()}).finally(function(){return clearInterval(_)}):Promise.resolve()).then(m)]).then(function(){return h(),t.onReadyBeingFired=[],G.resolve(xr(function(){return e.on.ready.fire(e.vip)})).then(function I(){if(0<t.onReadyBeingFired.length){var g=t.onReadyBeingFired.reduce(er,Ce);return t.onReadyBeingFired=[],G.resolve(xr(function(){return g(e.vip)})).then(I)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(I){t.dbOpenError=I;try{E&&E.abort()}catch{}return i===t.openCanceller&&e._close(),Ke(I)}).finally(function(){t.openComplete=!0,w()}).then(function(){var I;return v&&(I={},e.tables.forEach(function(g){g.schema.indexes.forEach(function(T){T.name&&(I["idb://".concat(e.name,"/").concat(g.name,"/").concat(T.name)]=new Ue(-1/0,[[[]]]))}),I["idb://".concat(e.name,"/").concat(g.name,"/")]=I["idb://".concat(e.name,"/").concat(g.name,"/:dels")]=new Ue(-1/0,[[[]]])}),vt(rn).fire(I),Cr(I,!0)),e})}function Or(e){function t(f){return e.next(f)}var r=s(t),i=s(function(f){return e.throw(f)});function s(f){return function(_){var m=f(_),_=m.value;return m.done?_:_&&typeof _.then=="function"?_.then(r,i):p(_)?Promise.all(_).then(r,i):r(_)}}return s(t)()}function Bn(e,t,r){for(var i=p(e)?e.slice():[e],s=0;s<r;++s)i.push(t);return i}var Ro={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var r=e.table(t),i=r.schema,s={},f=[];function h(v,I,g){var T=an(v),S=s[T]=s[T]||[],k=v==null?0:typeof v=="string"?1:v.length,P=0<I,P=o(o({},g),{name:P?"".concat(T,"(virtual-from:").concat(g.name,")"):g.name,lowLevelIndex:g,isVirtual:P,keyTail:I,keyLength:k,extractKey:yr(v),unique:!P&&g.unique});return S.push(P),P.isPrimaryKey||f.push(P),1<k&&h(k===2?v[0]:v.slice(0,k-1),I+1,g),S.sort(function(D,j){return D.keyTail-j.keyTail}),P}t=h(i.primaryKey.keyPath,0,i.primaryKey),s[":id"]=[t];for(var m=0,_=i.indexes;m<_.length;m++){var w=_[m];h(w.keyPath,0,w)}function E(v){var I,g=v.query.index;return g.isVirtual?o(o({},v),{query:{index:g.lowLevelIndex,range:(I=v.query.range,g=g.keyTail,{type:I.type===1?2:I.type,lower:Bn(I.lower,I.lowerOpen?e.MAX_KEY:e.MIN_KEY,g),lowerOpen:!0,upper:Bn(I.upper,I.upperOpen?e.MIN_KEY:e.MAX_KEY,g),upperOpen:!0})}}):v}return o(o({},r),{schema:o(o({},i),{primaryKey:t,indexes:f,getIndexByKeyPath:function(v){return(v=s[an(v)])&&v[0]}}),count:function(v){return r.count(E(v))},query:function(v){return r.query(E(v))},openCursor:function(v){var I=v.query.index,g=I.keyTail,T=I.isVirtual,S=I.keyLength;return T?r.openCursor(E(v)).then(function(P){return P&&k(P)}):r.openCursor(v);function k(P){return Object.create(P,{continue:{value:function(D){D!=null?P.continue(Bn(D,v.reverse?e.MAX_KEY:e.MIN_KEY,g)):v.unique?P.continue(P.key.slice(0,S).concat(v.reverse?e.MIN_KEY:e.MAX_KEY,g)):P.continue()}},continuePrimaryKey:{value:function(D,j){P.continuePrimaryKey(Bn(D,e.MAX_KEY,g),j)}},primaryKey:{get:function(){return P.primaryKey}},key:{get:function(){var D=P.key;return S===1?D[0]:D.slice(0,S)}},value:{get:function(){return P.value}}})}}})}})}};function Pr(e,t,r,i){return r=r||{},i=i||"",d(e).forEach(function(s){var f,h,m;O(t,s)?(f=e[s],h=t[s],typeof f=="object"&&typeof h=="object"&&f&&h?(m=Se(f))!==Se(h)?r[i+s]=t[s]:m==="Object"?Pr(f,h,r,i+s+"."):f!==h&&(r[i+s]=t[s]):f!==h&&(r[i+s]=t[s])):r[i+s]=void 0}),d(t).forEach(function(s){O(e,s)||(r[i+s]=t[s])}),r}function Dr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ao={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var r=e.table(t),i=r.schema.primaryKey;return o(o({},r),{mutate:function(s){var f=ue.trans,h=f.table(t).hook,m=h.deleting,_=h.creating,w=h.updating;switch(s.type){case"add":if(_.fire===Ce)break;return f._promise("readwrite",function(){return E(s)},!0);case"put":if(_.fire===Ce&&w.fire===Ce)break;return f._promise("readwrite",function(){return E(s)},!0);case"delete":if(m.fire===Ce)break;return f._promise("readwrite",function(){return E(s)},!0);case"deleteRange":if(m.fire===Ce)break;return f._promise("readwrite",function(){return function v(I,g,T){return r.query({trans:I,values:!1,query:{index:i,range:g},limit:T}).then(function(S){var k=S.result;return E({type:"delete",keys:k,trans:I}).then(function(P){return 0<P.numFailures?Promise.reject(P.failures[0]):k.length<T?{failures:[],numFailures:0,lastResult:void 0}:v(I,o(o({},g),{lower:k[k.length-1],lowerOpen:!0}),T)})})}(s.trans,s.range,1e4)},!0)}return r.mutate(s);function E(v){var I,g,T,S=ue.trans,k=v.keys||Dr(i,v);if(!k)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?o(o({},v),{keys:k}):o({},v)).type!=="delete"&&(v.values=c([],v.values)),v.keys&&(v.keys=c([],v.keys)),I=r,T=k,((g=v).type==="add"?Promise.resolve([]):I.getMany({trans:g.trans,keys:T,cache:"immutable"})).then(function(P){var D=k.map(function(j,K){var q,Y,F,L=P[K],H={onerror:null,onsuccess:null};return v.type==="delete"?m.fire.call(H,j,L,S):v.type==="add"||L===void 0?(q=_.fire.call(H,j,v.values[K],S),j==null&&q!=null&&(v.keys[K]=j=q,i.outbound||ne(v.values[K],i.keyPath,j))):(q=Pr(L,v.values[K]),(Y=w.fire.call(H,q,j,L,S))&&(F=v.values[K],Object.keys(Y).forEach(function(U){O(F,U)?F[U]=Y[U]:ne(F,U,Y[U])}))),H});return r.mutate(v).then(function(j){for(var K=j.failures,q=j.results,Y=j.numFailures,j=j.lastResult,F=0;F<k.length;++F){var L=(q||k)[F],H=D[F];L==null?H.onerror&&H.onerror(K[F]):H.onsuccess&&H.onsuccess(v.type==="put"&&P[F]?v.values[F]:L)}return{failures:K,results:q,numFailures:Y,lastResult:j}}).catch(function(j){return D.forEach(function(K){return K.onerror&&K.onerror(j)}),Promise.reject(j)})})}}})}})}};function _i(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var i=[],s=0,f=0;s<t.keys.length&&f<e.length;++s)xe(t.keys[s],e[f])===0&&(i.push(r?Ge(t.values[s]):t.values[s]),++f);return i.length===e.length?i:null}catch{return null}}var Mo={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return o(o({},r),{getMany:function(i){if(!i.cache)return r.getMany(i);var s=_i(i.keys,i.trans._cache,i.cache==="clone");return s?G.resolve(s):r.getMany(i).then(function(f){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?Ge(f):f},f})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),r.mutate(i)}})}}}};function gi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function bi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var No={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new Ue(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(i,s,f){if(ue.subscr&&s!=="readonly")throw new fe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ue.querier));return e.transaction(i,s,f)},table:function(i){var s=e.table(i),f=s.schema,h=f.primaryKey,v=f.indexes,m=h.extractKey,_=h.outbound,w=h.autoIncrement&&v.filter(function(g){return g.compound&&g.keyPath.includes(h.keyPath)}),E=o(o({},s),{mutate:function(g){function T(U){return U="idb://".concat(t,"/").concat(i,"/").concat(U),j[U]||(j[U]=new Ue)}var S,k,P,D=g.trans,j=g.mutatedParts||(g.mutatedParts={}),K=T(""),q=T(":dels"),Y=g.type,H=g.type==="deleteRange"?[g.range]:g.type==="delete"?[g.keys]:g.values.length<50?[Dr(h,g).filter(function(U){return U}),g.values]:[],F=H[0],L=H[1],H=g.trans._cache;return p(F)?(K.addKeys(F),(H=Y==="delete"||F.length===L.length?_i(F,H):null)||q.addKeys(F),(H||L)&&(S=T,k=H,P=L,f.indexes.forEach(function(U){var $=S(U.name||"");function me(be){return be!=null?U.extractKey(be):null}function ge(be){return U.multiEntry&&p(be)?be.forEach(function(Ze){return $.addKey(Ze)}):$.addKey(be)}(k||P).forEach(function(be,Ve){var he=k&&me(k[Ve]),Ve=P&&me(P[Ve]);xe(he,Ve)!==0&&(he!=null&&ge(he),Ve!=null&&ge(Ve))})}))):F?(L={from:(L=F.lower)!==null&&L!==void 0?L:e.MIN_KEY,to:(L=F.upper)!==null&&L!==void 0?L:e.MAX_KEY},q.add(L),K.add(L)):(K.add(r),q.add(r),f.indexes.forEach(function(U){return T(U.name).add(r)})),s.mutate(g).then(function(U){return!F||g.type!=="add"&&g.type!=="put"||(K.addKeys(U.results),w&&w.forEach(function($){for(var me=g.values.map(function(he){return $.extractKey(he)}),ge=$.keyPath.findIndex(function(he){return he===h.keyPath}),be=0,Ze=U.results.length;be<Ze;++be)me[be][ge]=U.results[be];T($.name).addKeys(me)})),D.mutatedParts=Mn(D.mutatedParts||{},j),U})}}),v=function(T){var S=T.query,T=S.index,S=S.range;return[T,new Ue((T=S.lower)!==null&&T!==void 0?T:e.MIN_KEY,(S=S.upper)!==null&&S!==void 0?S:e.MAX_KEY)]},I={get:function(g){return[h,new Ue(g.key)]},getMany:function(g){return[h,new Ue().addKeys(g.keys)]},count:v,query:v,openCursor:v};return d(I).forEach(function(g){E[g]=function(T){var S=ue.subscr,k=!!S,P=gi(ue,s)&&bi(g,T)?T.obsSet={}:S;if(k){var D=function(L){return L="idb://".concat(t,"/").concat(i,"/").concat(L),P[L]||(P[L]=new Ue)},j=D(""),K=D(":dels"),S=I[g](T),k=S[0],S=S[1];if((g==="query"&&k.isPrimaryKey&&!T.values?K:D(k.name||"")).add(S),!k.isPrimaryKey){if(g!=="count"){var q=g==="query"&&_&&T.values&&s.query(o(o({},T),{values:!1}));return s[g].apply(this,arguments).then(function(L){if(g==="query"){if(_&&T.values)return q.then(function(me){return me=me.result,j.addKeys(me),L});var H=T.values?L.result.map(m):L.result;(T.values?j:K).addKeys(H)}else if(g==="openCursor"){var U=L,$=T.values;return U&&Object.create(U,{key:{get:function(){return K.addKey(U.primaryKey),U.key}},primaryKey:{get:function(){var me=U.primaryKey;return K.addKey(me),me}},value:{get:function(){return $&&j.addKey(U.primaryKey),U.value}}})}return L})}K.add(r)}}return s[g].apply(this,arguments)}}),E}})}};function wi(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===i?null:(t=o({},t),p(t.keys)&&(t.keys=t.keys.filter(function(s,f){return!(f in r.failures)})),"values"in t&&p(t.values)&&(t.values=t.values.filter(function(s,f){return!(f in r.failures)})),t)}function jr(e,t){return r=e,((i=t).lower===void 0||(i.lowerOpen?0<xe(r,i.lower):0<=xe(r,i.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?xe(e,t.upper)<0:xe(e,t.upper)<=0));var r,i}function ki(e,t,I,i,s,f){if(!I||I.length===0)return e;var h=t.query.index,m=h.multiEntry,_=t.query.range,w=i.schema.primaryKey.extractKey,E=h.extractKey,v=(h.lowLevelIndex||h).extractKey,I=I.reduce(function(g,T){var S=g,k=[];if(T.type==="add"||T.type==="put")for(var P=new Ue,D=T.values.length-1;0<=D;--D){var j,K=T.values[D],q=w(K);P.hasKey(q)||(j=E(K),(m&&p(j)?j.some(function(U){return jr(U,_)}):jr(j,_))&&(P.addKey(q),k.push(K)))}switch(T.type){case"add":var Y=new Ue().addKeys(t.values?g.map(function($){return w($)}):g),S=g.concat(t.values?k.filter(function($){return $=w($),!Y.hasKey($)&&(Y.addKey($),!0)}):k.map(function($){return w($)}).filter(function($){return!Y.hasKey($)&&(Y.addKey($),!0)}));break;case"put":var F=new Ue().addKeys(T.values.map(function($){return w($)}));S=g.filter(function($){return!F.hasKey(t.values?w($):$)}).concat(t.values?k:k.map(function($){return w($)}));break;case"delete":var L=new Ue().addKeys(T.keys);S=g.filter(function($){return!L.hasKey(t.values?w($):$)});break;case"deleteRange":var H=T.range;S=g.filter(function($){return!jr(w($),H)})}return S},e);return I===e?e:(I.sort(function(g,T){return xe(v(g),v(T))||xe(w(g),w(T))}),t.limit&&t.limit<1/0&&(I.length>t.limit?I.length=t.limit:e.length===t.limit&&I.length<t.limit&&(s.dirty=!0)),f?Object.freeze(I):I)}function xi(e,t){return xe(e.lower,t.lower)===0&&xe(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Bo(e,t){return function(r,i,s,f){if(r===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((i=xe(r,i))===0){if(s&&f)return 0;if(s)return 1;if(f)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,i,s,f){if(r===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((i=xe(r,i))===0){if(s&&f)return 0;if(s)return-1;if(f)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function qo(e,t,r,i){e.subscribers.add(r),i.addEventListener("abort",function(){var s,f;e.subscribers.delete(r),e.subscribers.size===0&&(s=e,f=t,setTimeout(function(){s.subscribers.size===0&&le(f,s)},3e3))})}var Fo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(r,i,s){var f,h,m=e.transaction(r,i,s);return i==="readwrite"&&(h=(f=new AbortController).signal,s=function(_){return function(){if(f.abort(),i==="readwrite"){for(var w=new Set,E=0,v=r;E<v.length;E++){var I=v[E],g=At["idb://".concat(t,"/").concat(I)];if(g){var T=e.table(I),S=g.optimisticOps.filter(function($){return $.trans===m});if(m._explicit&&_&&m.mutatedParts)for(var k=0,P=Object.values(g.queries.query);k<P.length;k++)for(var D=0,j=(Y=P[k]).slice();D<j.length;D++)Er((F=j[D]).obsSet,m.mutatedParts)&&(le(Y,F),F.subscribers.forEach(function($){return w.add($)}));else if(0<S.length){g.optimisticOps=g.optimisticOps.filter(function($){return $.trans!==m});for(var K=0,q=Object.values(g.queries.query);K<q.length;K++)for(var Y,F,L,H=0,U=(Y=q[K]).slice();H<U.length;H++)(F=U[H]).res!=null&&m.mutatedParts&&(_&&!F.dirty?(L=Object.isFrozen(F.res),L=ki(F.res,F.req,S,T,F,L),F.dirty?(le(Y,F),F.subscribers.forEach(function($){return w.add($)})):L!==F.res&&(F.res=L,F.promise=G.resolve({result:L}))):(F.dirty&&le(Y,F),F.subscribers.forEach(function($){return w.add($)})))}}}w.forEach(function($){return $()})}}},m.addEventListener("abort",s(!1),{signal:h}),m.addEventListener("error",s(!1),{signal:h}),m.addEventListener("complete",s(!0),{signal:h})),m},table:function(r){var i=e.table(r),s=i.schema.primaryKey;return o(o({},i),{mutate:function(f){var h=ue.trans;if(s.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return i.mutate(f);var m=At["idb://".concat(t,"/").concat(r)];return m?(h=i.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||Dr(s,f).some(function(_){return _==null}))?(m.optimisticOps.push(f),f.mutatedParts&&Nn(f.mutatedParts),h.then(function(_){0<_.numFailures&&(le(m.optimisticOps,f),(_=wi(0,f,_))&&m.optimisticOps.push(_),f.mutatedParts&&Nn(f.mutatedParts))}),h.catch(function(){le(m.optimisticOps,f),f.mutatedParts&&Nn(f.mutatedParts)})):h.then(function(_){var w=wi(0,o(o({},f),{values:f.values.map(function(E,v){var I;return _.failures[v]?E:(E=(I=s.keyPath)!==null&&I!==void 0&&I.includes(".")?Ge(E):o({},E),ne(E,s.keyPath,_.results[v]),E)})}),_);m.optimisticOps.push(w),queueMicrotask(function(){return f.mutatedParts&&Nn(f.mutatedParts)})}),h):i.mutate(f)},query:function(f){if(!gi(ue,i)||!bi("query",f))return i.query(f);var h=((w=ue.trans)===null||w===void 0?void 0:w.db._options.cache)==="immutable",v=ue,m=v.requery,_=v.signal,w=function(T,S,k,P){var D=At["idb://".concat(T,"/").concat(S)];if(!D)return[];if(!(S=D.queries[k]))return[null,!1,D,null];var j=S[(P.query?P.query.index.name:null)||""];if(!j)return[null,!1,D,null];switch(k){case"query":var K=j.find(function(q){return q.req.limit===P.limit&&q.req.values===P.values&&xi(q.req.query.range,P.query.range)});return K?[K,!0,D,j]:[j.find(function(q){return("limit"in q.req?q.req.limit:1/0)>=P.limit&&(!P.values||q.req.values)&&Bo(q.req.query.range,P.query.range)}),!1,D,j];case"count":return K=j.find(function(q){return xi(q.req.query.range,P.query.range)}),[K,!!K,D,j]}}(t,r,"query",f),E=w[0],v=w[1],I=w[2],g=w[3];return E&&v?E.obsSet=f.obsSet:(v=i.query(f).then(function(T){var S=T.result;if(E&&(E.res=S),h){for(var k=0,P=S.length;k<P;++k)Object.freeze(S[k]);Object.freeze(S)}else T.result=Ge(S);return T}).catch(function(T){return g&&E&&le(g,E),Promise.reject(T)}),E={obsSet:f.obsSet,promise:v,subscribers:new Set,type:"query",req:f,dirty:!1},g?g.push(E):(g=[E],(I=I||(At["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=g)),qo(E,g,m,_),E.promise.then(function(T){return{result:ki(T.result,f,I==null?void 0:I.optimisticOps,i,E,h)}})}})}})}};function qn(e,t){return new Proxy(e,{get:function(r,i,s){return i==="db"?t:Reflect.get(r,i,s)}})}var ut=(Re.prototype.version=function(e){if(isNaN(e)||e<.1)throw new fe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new fe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(Oo),r.stores({}),this._state.autoSchema=!1,r)},Re.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ue.letThrough||this._vip)?e():new G(function(r,i){if(t._state.openComplete)return i(new fe.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new fe.DatabaseClosed);t.open().catch(Ce)}t._state.dbReadyPromise.then(r,i)}).then(e)},Re.prototype.use=function(e){var t=e.stack,r=e.create,i=e.level,s=e.name;return s&&this.unuse({stack:t,name:s}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:i??10,name:s}),e.sort(function(f,h){return f.level-h.level}),this},Re.prototype.unuse=function(e){var t=e.stack,r=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(s){return i?s.create!==i:!!r&&s.name!==r})),this},Re.prototype.open=function(){var e=this;return jt(ft,function(){return Ko(e)})},Re.prototype._close=function(){var e=this._state,t=Yt.indexOf(this);if(0<=t&&Yt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new G(function(r){e.dbReadyResolve=r}),e.openCanceller=new G(function(r,i){e.cancelOpen=i}))},Re.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new fe.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new fe.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},Re.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",i=this._state;return new G(function(s,f){function h(){t.close(e);var m=t._deps.indexedDB.deleteDatabase(t.name);m.onsuccess=je(function(){var _,w,E;_=t._deps,w=t.name,E=_.indexedDB,_=_.IDBKeyRange,kr(E)||w===Tn||wr(E,_).delete(w).catch(Ce),s()}),m.onerror=rt(f),m.onblocked=t._fireOnBlocked}if(r)throw new fe.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(h):h()})},Re.prototype.backendDB=function(){return this.idbdb},Re.prototype.isOpen=function(){return this.idbdb!==null},Re.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Re.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Re.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Re.prototype,"tables",{get:function(){var e=this;return d(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Re.prototype.transaction=function(){var e=(function(t,r,i){var s=arguments.length;if(s<2)throw new fe.InvalidArgument("Too few arguments");for(var f=new Array(s-1);--s;)f[s-1]=arguments[s];return i=f.pop(),[t,ke(f),i]}).apply(this,arguments);return this._transaction.apply(this,e)},Re.prototype._transaction=function(e,t,r){var i=this,s=ue.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);var f,h,m=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(w){if(w=w instanceof i.Table?w.name:w,typeof w!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return w}),e=="r"||e===lr)f=lr;else{if(e!="rw"&&e!=cr)throw new fe.InvalidArgument("Invalid transaction mode: "+e);f=cr}if(s){if(s.mode===lr&&f===cr){if(!m)throw new fe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&h.forEach(function(w){if(s&&s.storeNames.indexOf(w)===-1){if(!m)throw new fe.SubTransaction("Table "+w+" not included in parent transaction.");s=null}}),m&&s&&!s.active&&(s=null)}}catch(w){return s?s._promise(null,function(E,v){v(w)}):Ke(w)}var _=(function w(E,v,I,g,T){return G.resolve().then(function(){var S=ue.transless||ue,k=E._createTransaction(v,I,E._dbSchema,g);if(k.explicit=!0,S={trans:k,transless:S},g)k.idbtrans=g.idbtrans;else try{k.create(),k.idbtrans._explicit=!0,E._state.PR1398_maxLoop=3}catch(j){return j.name===Zn.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return w(E,v,I,null,T)})):Ke(j)}var P,D=at(T);return D&&Vt(),S=G.follow(function(){var j;(P=T.call(k,k))&&(D?(j=ht.bind(null,null),P.then(j,j)):typeof P.next=="function"&&typeof P.throw=="function"&&(P=Or(P)))},S),(P&&typeof P.then=="function"?G.resolve(P).then(function(j){return k.active?j:Ke(new fe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):S.then(function(){return P})).then(function(j){return g&&k._resolve(),k._completion.then(function(){return j})}).catch(function(j){return k._reject(j),Ke(j)})})}).bind(null,this,f,h,s,r);return s?s._promise(f,_,"lock"):ue.trans?jt(ue.transless,function(){return i._whenReady(_)}):this._whenReady(_)},Re.prototype.table=function(e){if(!O(this._allTables,e))throw new fe.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Re);function Re(e,t){var r=this;this._middlewares={},this.verno=0;var i=Re.dependencies;this._options=t=o({addons:Re.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,f,h,m,_,w={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ce,dbReadyPromise:null,cancelOpen:Ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};w.dbReadyPromise=new G(function(v){w.dbReadyResolve=v}),w.openCanceller=new G(function(v,I){w.cancelOpen=I}),this._state=w,this.name=e,this.on=Zt(this,"populate","blocked","versionchange","close",{ready:[er,Ce]}),this.on.ready.subscribe=W(this.on.ready.subscribe,function(v){return function(I,g){Re.vip(function(){var T,S=r._state;S.openComplete?(S.dbOpenError||G.resolve().then(I),g&&v(I)):S.onReadyBeingFired?(S.onReadyBeingFired.push(I),g&&v(I)):(v(I),T=r,g||v(function k(){T.on.ready.unsubscribe(I),T.on.ready.unsubscribe(k)}))})}}),this.Collection=(s=this,en(ko.prototype,function(P,k){this.db=s;var g=ei,T=null;if(k)try{g=k()}catch(D){T=D}var S=P._ctx,k=S.table,P=k.hook.reading.fire;this._ctx={table:k,index:S.index,isPrimKey:!S.index||k.schema.primKey.keyPath&&S.index===k.schema.primKey.name,range:g,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:T,or:S.or,valueMapper:P!==Wt?P:null}})),this.Table=(f=this,en(ii.prototype,function(v,I,g){this.db=f,this._tx=g,this.name=v,this.schema=I,this.hook=f._allTables[v]?f._allTables[v].hook:Zt(null,{creating:[ho,Ce],reading:[fo,Wt],updating:[mo,Ce],deleting:[po,Ce]})})),this.Transaction=(h=this,en(Eo.prototype,function(v,I,g,T,S){var k=this;this.db=h,this.mode=v,this.storeNames=I,this.schema=g,this.chromeTransactionDurability=T,this.idbtrans=null,this.on=Zt(this,"complete","error","abort"),this.parent=S||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new G(function(P,D){k._resolve=P,k._reject=D}),this._completion.then(function(){k.active=!1,k.on.complete.fire()},function(P){var D=k.active;return k.active=!1,k.on.error.fire(P),k.parent?k.parent._reject(P):D&&k.idbtrans&&k.idbtrans.abort(),Ke(P)})})),this.Version=(m=this,en(jo.prototype,function(v){this.db=m,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(_=this,en(li.prototype,function(v,I,g){if(this.db=_,this._ctx={table:v,index:I===":id"?null:I,or:g},this._cmp=this._ascending=xe,this._descending=function(T,S){return xe(S,T)},this._max=function(T,S){return 0<xe(T,S)?T:S},this._min=function(T,S){return xe(T,S)<0?T:S},this._IDBKeyRange=_._deps.IDBKeyRange,!this._IDBKeyRange)throw new fe.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=on(t.IDBKeyRange),this._createTransaction=function(v,I,g,T){return new r.Transaction(v,I,g,r._options.chromeTransactionDurability,T)},this._fireOnBlocked=function(v){r.on("blocked").fire(v),Yt.filter(function(I){return I.name===r.name&&I!==r&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(v)})},this.use(Mo),this.use(Fo),this.use(No),this.use(Ro),this.use(Ao);var E=new Proxy(this,{get:function(v,I,g){if(I==="_vip")return!0;if(I==="table")return function(S){return qn(r.table(S),E)};var T=Reflect.get(v,I,g);return T instanceof ii?qn(T,E):I==="tables"?T.map(function(S){return qn(S,E)}):I==="_createTransaction"?function(){return qn(T.apply(this,arguments),E)}:T}});this.vip=E,i.forEach(function(v){return v(r)})}var Fn,et=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Lo=(Kr.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},Kr.prototype[et]=function(){return this},Kr);function Kr(e){this._subscribe=e}try{Fn={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Fn={indexedDB:null,IDBKeyRange:null}}function Ti(e){var t,r=!1,i=new Lo(function(s){var f=at(e),h,m=!1,_={},w={},E={get closed(){return m},unsubscribe:function(){m||(m=!0,h&&h.abort(),v&&vt.storagemutated.unsubscribe(g))}};s.start&&s.start(E);var v=!1,I=function(){return ur(T)},g=function(S){Mn(_,S),Er(w,_)&&I()},T=function(){var S,k,P;!m&&Fn.indexedDB&&(_={},S={},h&&h.abort(),h=new AbortController,P=function(D){var j=Lt();try{f&&Vt();var K=dt(e,D);return K=f?K.finally(ht):K}finally{j&&Ut()}}(k={subscr:S,signal:h.signal,requery:I,querier:e,trans:null}),Promise.resolve(P).then(function(D){r=!0,t=D,m||k.signal.aborted||(_={},function(j){for(var K in j)if(O(j,K))return;return 1}(w=S)||v||(vt(rn,g),v=!0),ur(function(){return!m&&s.next&&s.next(D)}))},function(D){r=!1,["DatabaseClosedError","AbortError"].includes(D==null?void 0:D.name)||m||ur(function(){m||s.error&&s.error(D)})}))};return setTimeout(I,0),E});return i.hasValue=function(){return r},i.getValue=function(){return t},i}var Mt=ut;function Rr(e){var t=yt;try{yt=!0,vt.storagemutated.fire(e),Cr(e,!0)}finally{yt=t}}b(Mt,o(o({},mn),{delete:function(e){return new Mt(e,{addons:[]}).delete()},exists:function(e){return new Mt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Mt.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(kr(r)?Promise.resolve(r.databases()).then(function(i){return i.map(function(s){return s.name}).filter(function(s){return s!==Tn})}):wr(r,t).toCollection().primaryKeys()).then(e)}catch{return Ke(new fe.MissingAPI)}var t,r},defineClass:function(){return function(e){y(this,e)}},ignoreTransaction:function(e){return ue.trans?jt(ue.transless,e):e()},vip:xr,async:function(e){return function(){try{var t=Or(e.apply(this,arguments));return t&&typeof t.then=="function"?t:G.resolve(t)}catch(r){return Ke(r)}}},spawn:function(e,t,r){try{var i=Or(e.apply(r,t||[]));return i&&typeof i.then=="function"?i:G.resolve(i)}catch(s){return Ke(s)}},currentTransaction:{get:function(){return ue.trans||null}},waitFor:function(e,t){return t=G.resolve(typeof e=="function"?Mt.ignoreTransaction(e):e).timeout(t||6e4),ue.trans?ue.trans.waitFor(t):t},Promise:G,debug:{get:function(){return nt},set:function(e){Gr(e)}},derive:te,extend:y,props:b,override:W,Events:Zt,on:vt,liveQuery:Ti,extendObservabilitySet:Mn,getByKeyPath:se,setByKeyPath:ne,delByKeyPath:function(e,t){typeof t=="string"?ne(e,t,void 0):"length"in t&&[].map.call(t,function(r){ne(e,r,void 0)})},shallowClone:oe,deepClone:Ge,getObjectDiff:Pr,cmp:xe,asap:we,minKey:-1/0,addons:[],connections:Yt,errnames:Zn,dependencies:Fn,cache:At,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),Mt.maxKey=on(Mt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(vt(rn,function(e){yt||(e=new CustomEvent(pr,{detail:e}),yt=!0,dispatchEvent(e),yt=!1)}),addEventListener(pr,function(e){e=e.detail,yt||Rr(e)}));var Gt,yt=!1,Ei=function(){};return typeof BroadcastChannel<"u"&&((Ei=function(){(Gt=new BroadcastChannel(pr)).onmessage=function(e){return e.data&&Rr(e.data)}})(),typeof Gt.unref=="function"&&Gt.unref(),vt(rn,function(e){yt||Gt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!ut.disableBfCache&&e.persisted){nt&&console.debug("Dexie: handling persisted pagehide"),Gt!=null&&Gt.close();for(var t=0,r=Yt;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ut.disableBfCache&&e.persisted&&(nt&&console.debug("Dexie: handling persisted pageshow"),Ei(),Rr({all:new Ue(-1/0,[[]])}))})),G.rejectionMapper=function(e,t){return!e||e instanceof tt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!zr[e.name]?e:(t=new zr[e.name](t||e.message,e),"stack"in e&&z(t,"stack",{get:function(){return this.inner.stack}}),t)},Gr(nt),o(ut,Object.freeze({__proto__:null,Dexie:ut,liveQuery:Ti,Entity:ti,cmp:xe,PropModification:tn,replacePrefix:function(e,t){return new tn({replacePrefix:[e,t]})},add:function(e){return new tn({add:e})},remove:function(e){return new tn({remove:e})},default:ut,RangeSet:Ue,mergeRanges:un,rangesOverlap:pi}),{default:ut}),ut})})(oo);var Zo=oo.exports;const Br=Jo(Zo),Pi=Symbol.for("Dexie"),Xn=globalThis[Pi]||(globalThis[Pi]=Br);if(Br.semVer!==Xn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Br.semVer} and ${Xn.semVer}`);const{liveQuery:is,mergeRanges:os,rangesOverlap:as,RangeSet:ss,cmp:us,Entity:ls,PropModification:cs,replacePrefix:fs,add:ds,remove:hs}=Xn;class ea extends Xn{constructor(){super("MeditationGameDB");Si(this,"sessions");this.version(1).stores({sessions:"++id, levelId, timestamp"})}}const ln=new ea,cn=[{id:"L1",name:"Level 1",minDuration:Me.ONE_MINUTE,maxDuration:Me.FIVE_MINUTES,description:"Sit. Breathe. Notice the mind.",instructions:["Sit comfortably","Focus on the feeling of breath through your nose","Tap when you notice the mind has wandered","Gently return to the breath each time"],completionTasks:[{id:"complete_2_sessions",description:"Complete 2 sessions"},{id:"tap_once",description:"Tap to mark at least one distraction"},{id:"no_early_exit",description:"Complete a session without ending early"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["complete_2_sessions","tap_once","no_early_exit"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_2_sessions","tap_once","no_early_exit","max_duration"]}}]},{id:"L2",name:"Level 2",minDuration:Me.TWO_MINUTES,maxDuration:Me.TEN_MINUTES,description:"Let go of counting and images.",instructions:["Focus on the breath through your nose","Don’t count, visualize, or repeat words","Tap when your mind wanders","Return to the breath, without mental help"],completionTasks:[{id:"complete_3_sessions",description:"Complete 3 sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"session_under_5_taps",description:"Complete a session with 5 taps or fewer"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["complete_3_sessions","improve_tap_count_2_sessions","session_under_5_taps","max_duration"]}}]},{id:"L3",name:"Level 3",minDuration:Me.FIVE_MINUTES,maxDuration:Me.FIFTEEN_MINUTES,description:"Observe thoughts as they arise.",instructions:["Focus on the breath through your nose","Don’t use any counting or mental images","Tap when distracted, then silently observe the thought","Label it if you can (e.g. “planning,” “judging”)","Let it go and return to the breath"],completionTasks:[{id:"two_sessions_under_8_taps",description:"Complete 2 sessions with 8 or fewer taps"},{id:"one_min_no_taps",description:"Go one full minute without tapping during a session"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"singleSession",requirement:{type:"minTasks",count:2,from:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_8_taps","one_min_no_taps","max_duration"]}}]},{id:"L4",name:"Level 4",minDuration:Me.FIVE_MINUTES,maxDuration:Me.FIFTEEN_MINUTES,description:"Notice how you react to yourself.",instructions:["Keep observing the breath","No counting or images","Tap when distracted, observe the thought","Then notice how you feel about getting distracted","If there’s frustration or judgment, notice that too — and let it go"],completionTasks:[{id:"two_sessions_under_5_taps",description:"Have 2 sessions in a row with 5 taps or fewer"},{id:"one_min_no_taps_twice",description:"Go 1 minute without a tap in 2 separate sessions"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:2,from:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["two_sessions_under_5_taps","one_min_no_taps_twice","improve_tap_count_2_sessions","max_duration"]}}]},{id:"L5",name:"Level 5",minDuration:Me.TEN_MINUTES,maxDuration:Me.THIRTY_MINUTES,description:"Everything changes. Keep observing.",instructions:["Keep observing breath and distractions","Tap when the mind wanders, observe the thought, notice your reaction","Then remember: everything changes — including this","Let the distraction and your reaction pass","Return to the breath with calm awareness"],completionTasks:[{id:"session_with_3_or_fewer_taps",description:"Have one session with 3 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"two_min_no_taps",description:"Go 2 minutes without tapping"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["session_with_3_or_fewer_taps","improve_tap_count_2_sessions","two_min_no_taps","max_duration"]}}]},{id:"L6",name:"Level 6",minDuration:Me.FIFTEEN_MINUTES,maxDuration:Me.SIXTY_MINUTES,description:"Sit still. Stay with discomfort.",instructions:["Observe breath, distractions, and reactions as before","Sit still in your chosen posture for the full session","If discomfort arises, don’t shift — just observe it","Notice the discomfort, let it change, and return to breath","Everything will pass"],completionTasks:[{id:"three_min_no_taps",description:"Go 3 minutes without a tap"},{id:"session_with_2_or_fewer_taps",description:"Have a session with 2 or fewer taps"},{id:"improve_tap_count_2_sessions",description:"Improve your tap count in 2 sessions"},{id:"distractions_early_on",description:"Finish a sit with multiple distractions early on"},{id:"max_duration",description:"Complete a session with max duration"}],starRules:[{stars:1,scope:"cumulative",requirement:{type:"minTasks",count:1,from:"all"}},{stars:2,scope:"cumulative",requirement:{type:"minTasks",count:3,from:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions"]}},{stars:3,scope:"cumulative",requirement:{type:"specificTasks",taskIds:["three_min_no_taps","session_with_2_or_fewer_taps","improve_tap_count_2_sessions","distractions_early_on","max_duration"]}}]}];function Di(u,n,a){const o=u.slice();return o[9]=n[a],o[11]=a,o}function ji(u){let n,a,o=u[9]+"";return{c(){n=Q("p"),a=new Go(!1),this.h()},l(c){n=X(c,"P",{class:!0,style:!0});var l=ce(n);a=zo(l,!1),l.forEach(A),this.h()},h(){a.a=null,N(n,"class","text-lg max-w-sm fade-in svelte-1quun7c"),_t(n,"animation-delay",u[11]+"s")},m(c,l){ee(c,n,l),a.m(o,n)},p:Be,d(c){c&&A(n)}}}function ta(u){let n,a,o,c,l,d,p,y,x,C,O,b=Nr[u[1]]+"",B,z,te,V=$e(u[2]),M=[];for(let ae=0;ae<V.length;ae+=1)M[ae]=ji(Di(u,V,ae));return{c(){n=Q("div"),a=Q("button"),o=Z("Exit Meditation"),c=ye();for(let ae=0;ae<M.length;ae+=1)M[ae].c();l=ye(),d=Q("div"),p=Q("button"),y=Z("Start meditation countdown"),x=ye(),C=Q("i"),O=Z("Meditating for "),B=Z(b),this.h()},l(ae){n=X(ae,"DIV",{class:!0});var W=ce(n);a=X(W,"BUTTON",{class:!0,style:!0});var ie=ce(a);o=J(ie,"Exit Meditation"),ie.forEach(A),c=ve(W);for(let oe=0;oe<M.length;oe+=1)M[oe].l(W);l=ve(W),d=X(W,"DIV",{class:!0});var we=ce(d);p=X(we,"BUTTON",{class:!0,style:!0});var se=ce(p);y=J(se,"Start meditation countdown"),se.forEach(A),x=ve(we),C=X(we,"I",{class:!0,style:!0});var ne=ce(C);O=J(ne,"Meditating for "),B=J(ne,b),ne.forEach(A),we.forEach(A),W.forEach(A),this.h()},h(){N(a,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 fade-in svelte-1quun7c"),_t(a,"animation-delay",u[2].length+"s"),N(p,"class","btn variant-filled px-4 py-2 mt-8 fade-in svelte-1quun7c"),_t(p,"animation-delay",u[2].length+"s"),N(C,"class","text-sm text-gray-500 fade-in svelte-1quun7c"),_t(C,"animation-delay",u[2].length+"s"),N(d,"class","flex flex-col items-center space-y-4"),N(n,"class","w-full h-full flex flex-col justify-center items-center px-6 space-y-6 text-center relative")},m(ae,W){ee(ae,n,W),R(n,a),R(a,o),R(n,c);for(let ie=0;ie<M.length;ie+=1)M[ie]&&M[ie].m(n,null);R(n,l),R(n,d),R(d,p),R(p,y),R(d,x),R(d,C),R(C,O),R(C,B),z||(te=[ct(a,"click",u[3]),ct(p,"click",function(){Ho(u[0])&&u[0].apply(this,arguments)})],z=!0)},p(ae,[W]){if(u=ae,W&4){V=$e(u[2]);let ie;for(ie=0;ie<V.length;ie+=1){const we=Di(u,V,ie);M[ie]?M[ie].p(we,W):(M[ie]=ji(we),M[ie].c(),M[ie].m(n,l))}for(;ie<M.length;ie+=1)M[ie].d(1);M.length=V.length}W&2&&b!==(b=Nr[u[1]]+"")&&Pe(B,b)},i:Be,o:Be,d(ae){ae&&A(n),qt(M,ae),z=!1,Fr(te)}}}function na(u,n,a){let{nextStep:o}=n,{closeModal:c}=n,{duration:l}=n,{levelId:d="L1"}=n;const p=cn.find(b=>b.id===d),y=["1. Feel the air move through your nose as you breathe","2. <b>Tap anywhere on the screen</b> when you lose focus","3. <b>Exit meditation</b> to end early","4. Relax and have fun"],x=(p==null?void 0:p.instructions)||y;let C=0;Lr(()=>{Xe.capture("instructions_viewed",{level:d});const b=setInterval(()=>{C<x.length+1?C+=1:clearInterval(b)},1e3)});const O=()=>{Xe.capture("instructions_exit",{instructions_viewed:C,level:d}),c()};return u.$$set=b=>{"nextStep"in b&&a(0,o=b.nextStep),"closeModal"in b&&a(4,c=b.closeModal),"duration"in b&&a(1,l=b.duration),"levelId"in b&&a(5,d=b.levelId)},[o,l,x,O,c,d]}class ra extends wt{constructor(n){super(),kt(this,n,na,ta,bt,{nextStep:0,closeModal:4,duration:1,levelId:5})}}const ia=u=>{const n=u%60;return(u/60>1?`${Math.floor(u/60)}:`:"")+`${n<10?"0":""}${n}`};function Qn(u){const n=u/60;return Number.isInteger(n)?n:Math.round(n*10)/10}let Mr=null,Yn=null;const Ki=`${$o}/sounds/gong.mp4`;function Yr(){return Mr||(Mr=new(window.AudioContext||window.webkitAudioContext)),Mr}async function ao(){try{const u=Yr();u.state==="suspended"&&await u.resume()}catch(u){Xe.capture("audio_context_resume_failed",{error:String(u),user_agent:navigator.userAgent})}}async function so(){if(Yn)return Yn;try{const u=Yr(),n=await fetch(Ki),a=n.headers.get("Content-Type"),o=n.headers.get("Content-Length"),c=await n.arrayBuffer();try{return Yn=await u.decodeAudioData(c),Yn}catch(l){throw Xe.capture("audio_buffer_decode_failed",{status:n.status,ok:n.ok,content_type:a,content_length:o,error:String(l),byte_length:c.byteLength,url:Ki,language:navigator.language}),l}}catch(u){throw Xe.capture("audio_buffer_load_failed",{error:String(u),user_agent:navigator.userAgent}),u}}async function oa(){try{await ao(),await so()}catch(u){Xe.capture("audio_preload_failed",{error:String(u),user_agent:navigator.userAgent})}}function aa(u){let n,a,o,c,l,d;return{c(){n=Vn("svg"),a=Vn("circle"),o=Vn("circle"),l=Vn("text"),d=Z(u[1]),this.h()},l(p){n=Un(p,"svg",{class:!0,viewBox:!0});var y=ce(n);a=Un(y,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),ce(a).forEach(A),o=Un(y,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,transform:!0}),ce(o).forEach(A),l=Un(y,"text",{x:!0,y:!0,"font-size":!0,"text-anchor":!0,fill:!0});var x=ce(l);d=J(x,u[1]),x.forEach(A),y.forEach(A),this.h()},h(){N(a,"cx","50"),N(a,"cy","50"),N(a,"r","40"),N(a,"stroke","lightgray"),N(a,"stroke-width","5"),N(a,"fill","none"),N(o,"cx","50"),N(o,"cy","50"),N(o,"r","40"),N(o,"stroke","blue"),N(o,"stroke-width","5"),N(o,"fill","none"),N(o,"stroke-dasharray","251.2"),N(o,"stroke-dashoffset",c=251.2*u[0]),N(o,"transform","rotate(-90 50 50)"),N(l,"x","50"),N(l,"y","55"),N(l,"font-size","14"),N(l,"text-anchor","middle"),N(l,"fill","gray"),N(n,"class","w-32 h-32"),N(n,"viewBox","0 0 100 100")},m(p,y){ee(p,n,y),R(n,a),R(n,o),R(n,l),R(l,d)},p(p,[y]){y&1&&c!==(c=251.2*p[0])&&N(o,"stroke-dashoffset",c),y&2&&Pe(d,p[1])},i:Be,o:Be,d(p){p&&A(n)}}}function sa(u,n,a){let o,c,{duration:l}=n,{startTimestamp:d}=n;const p=io();let y=zn(l),x=null,C;const O=Ci(y,V=>ia(V));Gn(u,O,V=>a(1,c=V));const b=Ci(y,V=>V/l);Gn(u,b,V=>a(0,o=V));const B=async()=>{try{const V=Yr();await ao();const M=await so(),ae=V.createBufferSource();ae.buffer=M,ae.connect(V.destination),ae.start(0)}catch(V){Xe.capture("audio_play_failed",{error:String(V),user_agent:navigator.userAgent,language:navigator.language})}},z=()=>{clearInterval(C),B(),p("complete")},te=async V=>{try{if(!("wakeLock"in navigator))return;V?x=await navigator.wakeLock.request("screen"):x&&(await x.release(),x=null)}catch(M){console.error(`Wake Lock ${V?"request":"release"} failed:`,M)}};return Lr(()=>{a(4,d=Date.now()),C=setInterval(()=>{y.update(V=>V>0?V-1:(z(),0))},1e3),te(!0)}),Wo(()=>{clearInterval(C),te(!1)}),u.$$set=V=>{"duration"in V&&a(5,l=V.duration),"startTimestamp"in V&&a(4,d=V.startTimestamp)},[o,c,O,b,d,l]}class uo extends wt{constructor(n){super(),kt(this,n,sa,aa,bt,{duration:5,startTimestamp:4})}}function ua(u){let n,a,o,c="Your meditation starts in:",l,d,p,y,x,C="Exit Meditation",O,b,B,z;function te(M){u[6](M)}let V={duration:la};return u[0]!==void 0&&(V.startTimestamp=u[0]),d=new uo({props:V}),Jn.push(()=>Vr(d,"startTimestamp",te)),d.$on("complete",u[1]),{c(){n=Q("div"),a=Q("div"),o=Q("p"),o.textContent=c,l=ye(),St(d.$$.fragment),y=ye(),x=Q("button"),x.textContent=C,this.h()},l(M){n=X(M,"DIV",{class:!0});var ae=ce(n);a=X(ae,"DIV",{class:!0});var W=ce(a);o=X(W,"P",{class:!0,"data-svelte-h":!0}),Ne(o)!=="svelte-1tp8zka"&&(o.textContent=c),l=ve(W),Et(d.$$.fragment,W),W.forEach(A),y=ve(ae),x=X(ae,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(x)!=="svelte-hy6wnc"&&(x.textContent=C),ae.forEach(A),this.h()},h(){N(o,"class","text-lg mt-4 text-center"),N(a,"class","absolute flex flex-col items-center pointer-events-auto"),N(x,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(n,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(M,ae){ee(M,n,ae),R(n,a),R(a,o),R(a,l),Tt(d,a,null),R(n,y),R(n,x),b=!0,B||(z=ct(x,"click",u[2]),B=!0)},p(M,[ae]){const W={};!p&&ae&1&&(p=!0,W.startTimestamp=M[0],Ur(()=>p=!1)),d.$set(W)},i(M){b||(Ae(d.$$.fragment,M),M&&gt(()=>{b&&(O||(O=He(x,ze,{},!0)),O.run(1))}),b=!0)},o(M){Le(d.$$.fragment,M),M&&(O||(O=He(x,ze,{},!1)),O.run(0)),b=!1},d(M){M&&A(n),xt(d),M&&O&&O.end(),B=!1,z()}}}const la=10;function ca(u,n,a){let{nextStep:o}=n,{closeModal:c}=n,{levelId:l="L1"}=n,d=0;Xe.capture("countdown_started",{level:l});const p=()=>{Xe.capture("countdown_complete",{level:l}),o()},y=()=>{Xe.capture("countdown_exit",{duration_counteddown:(Date.now()-d)/1e3,level:l}),c()};function x(C){d=C,a(0,d)}return u.$$set=C=>{"nextStep"in C&&a(3,o=C.nextStep),"closeModal"in C&&a(4,c=C.closeModal),"levelId"in C&&a(5,l=C.levelId)},[d,p,y,o,c,l,x]}class fa extends wt{constructor(n){super(),kt(this,n,ca,ua,bt,{nextStep:3,closeModal:4,levelId:5})}}function da(u){let n,a;return{c(){n=Q("br"),a=Q("br")},l(o){n=X(o,"BR",{}),a=X(o,"BR",{})},m(o,c){ee(o,n,c),ee(o,a,c)},p:Be,d(o){o&&(A(n),A(a))}}}function ha(u){let n,a,o;return{c(){n=Q("i"),a=Z(u[2]),o=Z(" distraction"),this.h()},l(c){n=X(c,"I",{class:!0});var l=ce(n);a=J(l,u[2]),o=J(l," distraction"),l.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(c,l){ee(c,n,l),R(n,a),R(n,o)},p(c,l){l&4&&Pe(a,c[2])},d(c){c&&A(n)}}}function pa(u){let n,a,o;return{c(){n=Q("i"),a=Z(u[2]),o=Z(" distractions"),this.h()},l(c){n=X(c,"I",{class:!0});var l=ce(n);a=J(l,u[2]),o=J(l," distractions"),l.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(c,l){ee(c,n,l),R(n,a),R(n,o)},p(c,l){l&4&&Pe(a,c[2])},d(c){c&&A(n)}}}function Ri(u){let n;return{c(){n=Q("div"),this.h()},l(a){n=X(a,"DIV",{class:!0,style:!0}),ce(n).forEach(A),this.h()},h(){N(n,"class","ripple svelte-1wv6db6"),_t(n,"top",u[3].y+"px"),_t(n,"left",u[3].x+"px")},m(a,o){ee(a,n,o)},p(a,o){o&8&&_t(n,"top",a[3].y+"px"),o&8&&_t(n,"left",a[3].x+"px")},d(a){a&&A(n)}}}function ma(u){let n,a,o,c,l,d,p="Tap anywhere on the screen to record your distractions",y,x,C,O,b,B="Exit Meditation",z,te,V,M;function ae(oe){u[11](oe)}let W={duration:u[0]};u[1]!==void 0&&(W.startTimestamp=u[1]),o=new uo({props:W}),Jn.push(()=>Vr(o,"startTimestamp",ae)),o.$on("complete",u[8]);function ie(oe,_e){return oe[2]>1||oe[2]==0?pa:oe[2]==1?ha:da}let we=ie(u),se=we(u),ne=u[3]&&Ri(u);return{c(){n=Q("div"),a=Q("div"),St(o.$$.fragment),l=ye(),d=Q("p"),d.textContent=p,y=ye(),se.c(),x=ye(),C=Q("button"),ne&&ne.c(),O=ye(),b=Q("button"),b.textContent=B,this.h()},l(oe){n=X(oe,"DIV",{class:!0});var _e=ce(n);a=X(_e,"DIV",{class:!0});var ke=ce(a);Et(o.$$.fragment,ke),l=ve(ke),d=X(ke,"P",{class:!0,"data-svelte-h":!0}),Ne(d)!=="svelte-1uyhl39"&&(d.textContent=p),y=ve(ke),se.l(ke),ke.forEach(A),x=ve(_e),C=X(_e,"BUTTON",{class:!0});var De=ce(C);ne&&ne.l(De),De.forEach(A),O=ve(_e),b=X(_e,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(b)!=="svelte-hy6wnc"&&(b.textContent=B),_e.forEach(A),this.h()},h(){N(d,"class","text-lg mt-4 text-center"),N(a,"class","absolute flex flex-col items-center pointer-events-auto p-6"),N(C,"class","absolute inset-0 w-full h-full bg-transparent pointer-events-auto relative overflow-hidden"),N(b,"class","absolute top-4 left-1/2 transform -translate-x-1/2 btn variant-outlined px-4 py-2 pointer-events-auto"),N(n,"class","w-full h-full flex flex-col items-center justify-center relative pointer-events-none")},m(oe,_e){ee(oe,n,_e),R(n,a),Tt(o,a,null),R(a,l),R(a,d),R(a,y),se.m(a,null),R(n,x),R(n,C),ne&&ne.m(C,null),R(n,O),R(n,b),te=!0,V||(M=[ct(C,"click",u[6]),ct(b,"click",u[7])],V=!0)},p(oe,[_e]){const ke={};_e&1&&(ke.duration=oe[0]),!c&&_e&2&&(c=!0,ke.startTimestamp=oe[1],Ur(()=>c=!1)),o.$set(ke),we===(we=ie(oe))&&se?se.p(oe,_e):(se.d(1),se=we(oe),se&&(se.c(),se.m(a,null))),oe[3]?ne?ne.p(oe,_e):(ne=Ri(oe),ne.c(),ne.m(C,null)):ne&&(ne.d(1),ne=null)},i(oe){te||(Ae(o.$$.fragment,oe),oe&&gt(()=>{te&&(z||(z=He(b,ze,{},!0)),z.run(1))}),te=!0)},o(oe){Le(o.$$.fragment,oe),oe&&(z||(z=He(b,ze,{},!1)),z.run(0)),te=!1},d(oe){oe&&A(n),xt(o),se.d(),ne&&ne.d(),oe&&z&&z.end(),V=!1,Fr(M)}}}function va(u,n,a){let o,c,{nextStep:l}=n,{duration:d}=n,{levelId:p="L1"}=n;const y=io();let x=0;const C=zn(0);Gn(u,C,M=>a(2,o=M));const O=zn([]),b=zn(null);Gn(u,b,M=>a(3,c=M));const B=M=>{const ae=(Date.now()-x)/1e3;C.update(ne=>ne+1),O.update(ne=>[...ne,ae]),console.log(`Click ${Bt(C)} recorded at ${ae} seconds`),Xe.capture("game_tap",{timestamp:ae,total_taps:Bt(C),level:p,button:"distracted"});const{clientX:W,clientY:ie,currentTarget:we}=M,se=we.getBoundingClientRect();b.set({x:W-se.left,y:ie-se.top}),setTimeout(()=>b.set(null),600)},z=()=>{const M=(Date.now()-x)/1e3;Xe.capture("meditation_exit",{duration_meditated:M,total_taps:Bt(O).length,level:p}),y("complete",{clickTimestamps:Bt(O),durationMeditated:M,completed:d-M<5}),l()},te=()=>{console.log("Meditation complete! Click data:",Bt(O)),Xe.capture("meditation_completed",{duration:d,total_taps:Bt(O).length,level:p}),y("complete",{clickTimestamps:Bt(O),durationMeditated:d,completed:!0}),l()};function V(M){x=M,a(1,x)}return u.$$set=M=>{"nextStep"in M&&a(9,l=M.nextStep),"duration"in M&&a(0,d=M.duration),"levelId"in M&&a(10,p=M.levelId)},[d,x,o,c,C,b,B,z,te,l,p,V]}class ya extends wt{constructor(n){super(),kt(this,n,va,ma,bt,{nextStep:9,duration:0,levelId:10})}}function _a(u){const n=Math.floor(u.durationMeditated/60),a=u.clickTimestamps.length,o=u.newStarRating-u.previousStarRating,c="https://www.arjunkalburgi.com/the-meditation-game/?utm_source=share",l=u.levelId.replace(/^\D+/g,""),d=Object.entries(u.completionTaskResults).map(p=>p[1]?"✅":"🔲").join("");return o>0?`Major win! 🧘‍♂️  I just earned a new ⭐ in The Meditation Game!
I did a ${n}‑min meditation with only ${a} distractions.
I'm at ${"⭐".repeat(u.newStarRating)} on Level ${l} (${d})!
Learn and practice meditation here: ${c}`:u.isNewPersonalBest?`Mini‑win in The Meditation Game: my new personal best!
${n}‑min sit • only ${a} ${a===1?"mind-wander":"mind-wanders"} • ${"⭐".repeat(u.newStarRating)} on Level ${l} (${d})
Learn and practice meditation here: ${c}`:`Sharing todays practice in The Meditation Game.
I did a ${n}‑min meditation with only ${a} distractions.
I'm at ${"⭐".repeat(u.newStarRating)} on Level ${l} (${d}).
Learn and practice meditation here: ${c}`}function ga(u){return u.newStarRating-u.previousStarRating>0?"A":u.isNewPersonalBest?"B":"C"}function lo(u){return u.filter(n=>n.completed).sort((n,a)=>a.duration!==n.duration?a.duration-n.duration:n.tapCount!==a.tapCount?n.tapCount-a.tapCount:a.timestamp-n.timestamp)[0]??null}function ba(u,n,a){const{scope:o,requirement:c}=u;return o==="cumulative"?Ai(c,n):a.some(l=>Ai(c,l))}function Ai(u,n){if(u.type==="minTasks"){const{count:a,from:o}=u;return o==="all"?n.size>=a:o.filter(l=>n.has(l)).length>=a}return u.type==="specificTasks"?u.taskIds.every(a=>n.has(a)):!1}function qr(u,n,a){const o=[...u].sort((c,l)=>l.stars-c.stars);for(const c of o)if(ba(c,n,a))return c.stars;return 0}function wa(u){if(u.length<2)return 0;const n=[...u].sort((o,c)=>o.timestamp-c.timestamp);let a=0;for(let o=1;o<n.length;o++){const c=n[o-1],l=n[o],d=c.tapCount/Math.max(c.duration,1),p=l.tapCount/Math.max(l.duration,1);(p<d||Math.abs(p-d)<=.005&&l.duration>c.duration)&&a++}return a}function Hn(u){if(!u.tapTimestamps||u.tapTimestamps.length===0)return u.duration/60;const n=[];n.push(u.tapTimestamps[0]);for(let o=1;o<u.tapTimestamps.length;o++)n.push(u.tapTimestamps[o]-u.tapTimestamps[o-1]);const a=u.tapTimestamps[u.tapTimestamps.length-1];return n.push(u.duration-a),Math.max(...n)}const Mi=(u,n)=>u.filter(n).length,lt=(u,n)=>u.some(n),ot={tap_once:u=>({completed:lt(u,n=>n.tapCount>=1),info:""}),no_early_exit:u=>({completed:lt(u,n=>n.completed===!0),info:""}),session_under_5_taps:u=>({completed:lt(u,n=>n.tapCount<=5),info:""}),session_with_2_or_fewer_taps:u=>({completed:lt(u,n=>n.tapCount<=2),info:""}),session_with_3_or_fewer_taps:u=>({completed:lt(u,n=>n.tapCount<=3),info:""}),distractions_early_on:u=>({completed:lt(u,n=>{var a;return(((a=n.tapTimestamps)==null?void 0:a.filter(o=>o<=60).length)??0)>=2}),info:""}),complete_2_sessions:u=>({completed:u.length>=2,info:u.length===0||u.length>=2?"":"(1/2 complete)"}),complete_3_sessions:u=>({completed:u.length>=3,info:u.length===0||u.length>=3?"":`(${u.length}/3 complete)`}),two_sessions_under_5_taps:u=>{let n=0;for(let a=u.length-1;a>=0;a--)if(u[a].tapCount<=5){if(n++,n===2)break}else n=0;return{completed:n===2,info:u.length===0||n===2?"":`(${Math.min(n,1)}/2 complete)`}},two_sessions_under_8_taps:u=>{const n=Mi(u,a=>a.tapCount<=8);return{completed:n>=2,info:u.length===0||n>=2?"":`(${n}/2 complete)`}},one_min_no_taps:u=>({completed:lt(u,n=>Hn(n)>=60),info:""}),one_min_no_taps_twice:u=>{const n=Mi(u,a=>Hn(a)>=60);return{completed:n>=2,info:u.length===0||n>=2?"":`(${n}/2 complete)`}},two_min_no_taps:u=>({completed:lt(u,n=>Hn(n)>=120),info:""}),three_min_no_taps:u=>({completed:lt(u,n=>Hn(n)>=180),info:""}),improve_tap_count_2_sessions:u=>{const n=wa(u);return{completed:n>=2,info:u.length===0||n>=2?"":`(${n}/2 complete)`}},max_duration:(u,n)=>({completed:u.some(a=>a.duration>=n.maxDuration),info:""})};async function $n(u){const n=cn.find(c=>c.id===u);if(!n)return{};const a=await ln.sessions.where("levelId").equals(u).toArray(),o={};for(const c of n.completionTasks){const l=ot[c.id];if(!l){console.warn(`Missing evaluator for task '${c.id}' in level '${u}'`),o[c.id]={completed:!1};continue}o[c.id]={...c,...l(a,n)}}return o}async function ka(){var n;const u=[];for(let a=0;a<cn.length;a++){const o=cn[a],c=await ln.sessions.where("levelId").equals(o.id).toArray(),l=a===0||(((n=u[a-1])==null?void 0:n.starRating)??0)>1;let d=null,p,y=null;if(l){d=await $n(o.id);const x=new Set(Object.entries(d).filter(([O,b])=>b.completed).map(([O])=>O)),C=c.map(O=>new Set(o.completionTasks.filter(b=>{var B;return(B=ot[b.id])==null?void 0:B.call(ot,[O],o).completed}).map(b=>b.id)));p=qr(o.starRules,x,C),y=lo(c)}u.push({level:o,isUnlocked:l,taskCompletion:d,starRating:p,bestSession:y})}return u}function Ni(u,n,a){const o=u.slice();return o[9]=n[a][0],o[10]=n[a][1],o}function Bi(u,n,a){const o=u.slice();return o[9]=n[a],o[14]=a,o}function qi(u){let n;function a(l,d){return l[0].newStarRating===3?Ta:xa}let o=a(u),c=o(u);return{c(){n=Q("p"),c.c(),this.h()},l(l){n=X(l,"P",{class:!0});var d=ce(n);c.l(d),d.forEach(A),this.h()},h(){N(n,"class","mt-2 text-lg text-accent-foreground font-semibold animate-fade-in svelte-tnqxsb")},m(l,d){ee(l,n,d),c.m(n,null)},p(l,d){o===(o=a(l))&&c?c.p(l,d):(c.d(1),c=o(l),c&&(c.c(),c.m(n,null)))},d(l){l&&A(n),c.d()}}}function xa(u){let n,a=u[0].newStarRating-u[0].previousStarRating+"",o,c;return{c(){n=Z("You earned +"),o=Z(a),c=Z(" ⭐ — keep going!")},l(l){n=J(l,"You earned +"),o=J(l,a),c=J(l," ⭐ — keep going!")},m(l,d){ee(l,n,d),ee(l,o,d),ee(l,c,d)},p(l,d){d&1&&a!==(a=l[0].newStarRating-l[0].previousStarRating+"")&&Pe(o,a)},d(l){l&&(A(n),A(o),A(c))}}}function Ta(u){let n;return{c(){n=Z("You've mastered this level! ✨")},l(a){n=J(a,"You've mastered this level! ✨")},m(a,o){ee(a,n,o)},p:Be,d(a){a&&A(n)}}}function Fi(u){let n,a=u[14]<u[0].newStarRating?"⭐":"☆",o,c;return{c(){n=Q("span"),o=Z(a),c=ye(),this.h()},l(l){n=X(l,"SPAN",{class:!0});var d=ce(n);o=J(d,a),c=ve(d),d.forEach(A),this.h()},h(){N(n,"class","text-xl")},m(l,d){ee(l,n,d),R(n,o),R(n,c)},p(l,d){d&1&&a!==(a=l[14]<l[0].newStarRating?"⭐":"☆")&&Pe(o,a)},d(l){l&&A(n)}}}function Ea(u){let n,a="You completed your meditation distraction-free!";return{c(){n=Q("p"),n.textContent=a,this.h()},l(o){n=X(o,"P",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-j87uf1"&&(n.textContent=a),this.h()},h(){N(n,"class","text-lg mt-4")},m(o,c){ee(o,n,c)},p:Be,d(o){o&&A(n)}}}function Sa(u){let n,a,o,c,l,d=Number(u[3])===1?"":"s",p,y;function x(b,B){return b[0].isNewPersonalBest&&b[0].personalBest?Ca:Ia}let C=x(u),O=C(u);return{c(){O.c(),n=ye(),a=Q("p"),o=Z("That's about "),c=Z(u[3]),l=Z(" distraction"),p=Z(d),y=Z(" per minute."),this.h()},l(b){O.l(b),n=ve(b),a=X(b,"P",{class:!0});var B=ce(a);o=J(B,"That's about "),c=J(B,u[3]),l=J(B," distraction"),p=J(B,d),y=J(B," per minute."),B.forEach(A),this.h()},h(){N(a,"class","text-lg mt-2")},m(b,B){O.m(b,B),ee(b,n,B),ee(b,a,B),R(a,o),R(a,c),R(a,l),R(a,p),R(a,y)},p(b,B){C===(C=x(b))&&O?O.p(b,B):(O.d(1),O=C(b),O&&(O.c(),O.m(n.parentNode,n)))},d(b){b&&(A(n),A(a)),O.d(b)}}}function Ia(u){let n,a,o=u[4](u[0].durationMeditated)+"",c,l,d,p,y=u[2]===1?"":"s",x,C;return{c(){n=Q("p"),a=Z("You meditated for "),c=Z(o),l=Z(" and recorded "),d=Z(u[2]),p=Z(" distraction"),x=Z(y),C=Z("."),this.h()},l(O){n=X(O,"P",{class:!0});var b=ce(n);a=J(b,"You meditated for "),c=J(b,o),l=J(b," and recorded "),d=J(b,u[2]),p=J(b," distraction"),x=J(b,y),C=J(b,"."),b.forEach(A),this.h()},h(){N(n,"class","text-lg mt-4")},m(O,b){ee(O,n,b),R(n,a),R(n,c),R(n,l),R(n,d),R(n,p),R(n,x),R(n,C)},p(O,b){b&1&&o!==(o=O[4](O[0].durationMeditated)+"")&&Pe(c,o)},d(O){O&&A(n)}}}function Ca(u){let n,a,o,c,l=u[2]?"":"s",d,p,y=u[4](u[0].durationMeditated)+"",x,C;return{c(){n=Q("p"),a=Z("New personal best 🎉 — "),o=Z(u[2]),c=Z(" tap"),d=Z(l),p=Z(" over "),x=Z(y),C=Z("."),this.h()},l(O){n=X(O,"P",{class:!0});var b=ce(n);a=J(b,"New personal best 🎉 — "),o=J(b,u[2]),c=J(b," tap"),d=J(b,l),p=J(b," over "),x=J(b,y),C=J(b,"."),b.forEach(A),this.h()},h(){N(n,"class","text-lg mt-4 text-green-600")},m(O,b){ee(O,n,b),R(n,a),R(n,o),R(n,c),R(n,d),R(n,p),R(n,x),R(n,C)},p(O,b){b&1&&y!==(y=O[4](O[0].durationMeditated)+"")&&Pe(x,y)},d(O){O&&A(n)}}}function Li(u){let n,a,o=u[0].personalBest.tapCount+"",c,l,d=Qn(u[0].personalBest.duration)+"",p,y;return{c(){n=Q("p"),a=Z("Best so far: "),c=Z(o),l=Z(" taps · "),p=Z(d),y=Z(" min."),this.h()},l(x){n=X(x,"P",{class:!0});var C=ce(n);a=J(C,"Best so far: "),c=J(C,o),l=J(C," taps · "),p=J(C,d),y=J(C," min."),C.forEach(A),this.h()},h(){N(n,"class","mt-4 text-muted-foreground")},m(x,C){ee(x,n,C),R(n,a),R(n,c),R(n,l),R(n,p),R(n,y)},p(x,C){C&1&&o!==(o=x[0].personalBest.tapCount+"")&&Pe(c,o),C&1&&d!==(d=Qn(x[0].personalBest.duration)+"")&&Pe(p,d)},d(x){x&&A(n)}}}function Ui(u){let n,a,o=u[0].newlyCompletedTasks.length>0&&Vi(u),c=$e(Object.entries(u[1])),l=[];for(let d=0;d<c.length;d+=1)l[d]=Yi(Ni(u,c,d));return{c(){o&&o.c(),n=ye(),a=Q("ul");for(let d=0;d<l.length;d+=1)l[d].c();this.h()},l(d){o&&o.l(d),n=ve(d),a=X(d,"UL",{class:!0});var p=ce(a);for(let y=0;y<l.length;y+=1)l[y].l(p);p.forEach(A),this.h()},h(){N(a,"class","mt-2 space-y-1 text-left max-h-40 overflow-y-auto")},m(d,p){o&&o.m(d,p),ee(d,n,p),ee(d,a,p);for(let y=0;y<l.length;y+=1)l[y]&&l[y].m(a,null)},p(d,p){if(d[0].newlyCompletedTasks.length>0?o?o.p(d,p):(o=Vi(d),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null),p&3){c=$e(Object.entries(d[1]));let y;for(y=0;y<c.length;y+=1){const x=Ni(d,c,y);l[y]?l[y].p(x,p):(l[y]=Yi(x),l[y].c(),l[y].m(a,null))}for(;y<l.length;y+=1)l[y].d(1);l.length=c.length}},d(d){d&&(A(n),A(a)),o&&o.d(d),qt(l,d)}}}function Vi(u){let n,a,o=u[0].newlyCompletedTasks.length+"",c,l,d=u[0].newlyCompletedTasks.length===1?"":"s",p,y;return{c(){n=Q("p"),a=Z("Nice! You just completed "),c=Z(o),l=Z(" new task"),p=Z(d),y=Z("."),this.h()},l(x){n=X(x,"P",{class:!0});var C=ce(n);a=J(C,"Nice! You just completed "),c=J(C,o),l=J(C," new task"),p=J(C,d),y=J(C,"."),C.forEach(A),this.h()},h(){N(n,"class","mt-2 text-sm text-accent-foreground")},m(x,C){ee(x,n,C),R(n,a),R(n,c),R(n,l),R(n,p),R(n,y)},p(x,C){C&1&&o!==(o=x[0].newlyCompletedTasks.length+"")&&Pe(c,o),C&1&&d!==(d=x[0].newlyCompletedTasks.length===1?"":"s")&&Pe(p,d)},d(x){x&&A(n)}}}function Oa(u){let n,a=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){n=Z("🔲 "),o=Z(a),c=ye(),d=Z(l)},l(p){n=J(p,"🔲 "),o=J(p,a),c=ve(p),d=J(p,l)},m(p,y){ee(p,n,y),ee(p,o,y),ee(p,c,y),ee(p,d,y)},p(p,y){y&2&&a!==(a=p[10].description+"")&&Pe(o,a),y&2&&l!==(l=p[10].info+"")&&Pe(d,l)},d(p){p&&(A(n),A(o),A(c),A(d))}}}function Pa(u){let n,a=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){n=Z("✅ "),o=Z(a),c=ye(),d=Z(l)},l(p){n=J(p,"✅ "),o=J(p,a),c=ve(p),d=J(p,l)},m(p,y){ee(p,n,y),ee(p,o,y),ee(p,c,y),ee(p,d,y)},p(p,y){y&2&&a!==(a=p[10].description+"")&&Pe(o,a),y&2&&l!==(l=p[10].info+"")&&Pe(d,l)},d(p){p&&(A(n),A(o),A(c),A(d))}}}function Da(u){let n,a=u[10].description+"",o,c,l=u[10].info+"",d;return{c(){n=Z("✅ 🆕🏆 "),o=Z(a),c=ye(),d=Z(l)},l(p){n=J(p,"✅ 🆕🏆 "),o=J(p,a),c=ve(p),d=J(p,l)},m(p,y){ee(p,n,y),ee(p,o,y),ee(p,c,y),ee(p,d,y)},p(p,y){y&2&&a!==(a=p[10].description+"")&&Pe(o,a),y&2&&l!==(l=p[10].info+"")&&Pe(d,l)},d(p){p&&(A(n),A(o),A(c),A(d))}}}function Yi(u){let n,a,o,c;function l(...x){return u[8](u[10],...x)}function d(x,C){return C&3&&(o=null),o==null&&(o=!!x[0].newlyCompletedTasks.some(l)),o?Da:x[10].completed?Pa:Oa}let p=d(u,-1),y=p(u);return{c(){n=Q("li"),a=Q("span"),y.c(),c=ye(),this.h()},l(x){n=X(x,"LI",{class:!0});var C=ce(n);a=X(C,"SPAN",{class:!0});var O=ce(a);y.l(O),O.forEach(A),c=ve(C),C.forEach(A),this.h()},h(){N(a,"class","mr-2"),N(n,"class","flex items-center")},m(x,C){ee(x,n,C),R(n,a),y.m(a,null),R(n,c)},p(x,C){u=x,p===(p=d(u,C))&&y?y.p(u,C):(y.d(1),y=p(u),y&&(y.c(),y.m(a,null)))},d(x){x&&A(n),y.d()}}}function ja(u){let n,a,o="Great practice!",c,l,d,p,y,x,C,O="Level tasks",b,B,z,te,V="Share",M,ae,W,ie="Exit",we,se,ne=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p>`,oe,_e,ke=u[0].newStarRating>u[0].previousStarRating&&qi(u),De=$e(Array(3)),Ie=[];for(let le=0;le<De.length;le+=1)Ie[le]=Fi(Bi(u,De,le));function Ge(le,pe){return le[0].clickTimestamps.length>0?Sa:Ea}let Qe=Ge(u),Se=Qe(u),re=u[0].personalBest&&!u[0].isNewPersonalBest&&Li(u),de=u[1]&&Ui(u);return{c(){n=Q("div"),a=Q("h2"),a.textContent=o,c=ye(),ke&&ke.c(),l=ye(),d=Q("div");for(let le=0;le<Ie.length;le+=1)Ie[le].c();p=ye(),Se.c(),y=ye(),re&&re.c(),x=ye(),C=Q("h3"),C.textContent=O,b=ye(),de&&de.c(),B=ye(),z=Q("div"),te=Q("button"),te.textContent=V,M=ye(),ae=Q("div"),W=Q("button"),W.textContent=ie,we=ye(),se=Q("div"),se.innerHTML=ne,this.h()},l(le){n=X(le,"DIV",{class:!0});var pe=ce(n);a=X(pe,"H2",{class:!0,"data-svelte-h":!0}),Ne(a)!=="svelte-1untj5h"&&(a.textContent=o),c=ve(pe),ke&&ke.l(pe),l=ve(pe),d=X(pe,"DIV",{class:!0});var Te=ce(d);for(let tt=0;tt<Ie.length;tt+=1)Ie[tt].l(Te);Te.forEach(A),p=ve(pe),Se.l(pe),y=ve(pe),re&&re.l(pe),x=ve(pe),C=X(pe,"H3",{class:!0,"data-svelte-h":!0}),Ne(C)!=="svelte-8ylw1a"&&(C.textContent=O),b=ve(pe),de&&de.l(pe),B=ve(pe),z=X(pe,"DIV",{class:!0});var at=ce(z);te=X(at,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(te)!=="svelte-1wlydhx"&&(te.textContent=V),at.forEach(A),M=ve(pe),ae=X(pe,"DIV",{class:!0});var hn=ce(ae);W=X(hn,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(W)!=="svelte-1t5v3tb"&&(W.textContent=ie),hn.forEach(A),we=ve(pe),se=X(pe,"DIV",{class:!0,"data-svelte-h":!0}),Ne(se)!=="svelte-oheyom"&&(se.innerHTML=ne),pe.forEach(A),this.h()},h(){N(a,"class","text-2xl font-bold"),N(d,"class","mt-2 flex items-center space-x-1"),N(C,"class","mt-6 font-semibold"),N(te,"class","btn variant-filled px-4 py-2"),N(z,"class","mt-6 flex space-x-4"),N(W,"class","btn variant-outlined px-4 py-2"),N(ae,"class","mt-6 flex space-x-4"),N(se,"class","absolute bottom-6 text-center text-sm text-gray-500"),N(n,"class","w-full h-full flex flex-col justify-center items-center p-6")},m(le,pe){ee(le,n,pe),R(n,a),R(n,c),ke&&ke.m(n,null),R(n,l),R(n,d);for(let Te=0;Te<Ie.length;Te+=1)Ie[Te]&&Ie[Te].m(d,null);R(n,p),Se.m(n,null),R(n,y),re&&re.m(n,null),R(n,x),R(n,C),R(n,b),de&&de.m(n,null),R(n,B),R(n,z),R(z,te),R(n,M),R(n,ae),R(ae,W),R(n,we),R(n,se),oe||(_e=[ct(te,"click",u[5]),ct(W,"click",u[6])],oe=!0)},p(le,[pe]){if(le[0].newStarRating>le[0].previousStarRating?ke?ke.p(le,pe):(ke=qi(le),ke.c(),ke.m(n,l)):ke&&(ke.d(1),ke=null),pe&1){De=$e(Array(3));let Te;for(Te=0;Te<De.length;Te+=1){const at=Bi(le,De,Te);Ie[Te]?Ie[Te].p(at,pe):(Ie[Te]=Fi(at),Ie[Te].c(),Ie[Te].m(d,null))}for(;Te<Ie.length;Te+=1)Ie[Te].d(1);Ie.length=De.length}Qe===(Qe=Ge(le))&&Se?Se.p(le,pe):(Se.d(1),Se=Qe(le),Se&&(Se.c(),Se.m(n,y))),le[0].personalBest&&!le[0].isNewPersonalBest?re?re.p(le,pe):(re=Li(le),re.c(),re.m(n,x)):re&&(re.d(1),re=null),le[1]?de?de.p(le,pe):(de=Ui(le),de.c(),de.m(n,B)):de&&(de.d(1),de=null)},i:Be,o:Be,d(le){le&&A(n),ke&&ke.d(),qt(Ie,le),Se.d(),re&&re.d(),de&&de.d(),oe=!1,Fr(_e)}}}function Ka(u,n,a){let{closeModal:o}=n,{meditationResults:c}=n;const l=c.clickTimestamps.length,d=l>0?(l/(c.durationMeditated/60)).toFixed(1):"0";let p={};Lr(async()=>{c!=null&&c.levelId&&a(1,p=await $n(c.levelId))});const y=b=>{const B=Math.floor(b/60),z=Math.round(b%60*100)/100;return B===0?z+" second"+(z===1?"":"s"):B+" minute"+(B===1?"":"s")+(z>0?" and "+z+" second"+(z===1?"":"s"):"")},x=()=>{if(navigator.share){const b=c.newStarRating-c.previousStarRating,B=ga(c);Xe.capture("results_shared",{total_taps:l,distractionRate:d,level:c.levelId,stars_gained:b,tasks_completed:c.newlyCompletedTasks.length,template_used:B,personal_best:c.isNewPersonalBest});const z=_a(c);navigator.share({text:z}).catch(te=>console.error("Sharing failed",te))}else console.log("Web Share API not supported")},C=()=>{Xe.capture("results_exit",{shared:navigator.share!==void 0,stars_gained:c.newStarRating-c.previousStarRating,tasks_completed:c.newlyCompletedTasks.length}),o()},O=(b,B)=>B===b.id;return u.$$set=b=>{"closeModal"in b&&a(7,o=b.closeModal),"meditationResults"in b&&a(0,c=b.meditationResults)},[c,p,l,d,y,x,C,o,O]}class Ra extends wt{constructor(n){super(),kt(this,n,Ka,ja,bt,{closeModal:7,meditationResults:0})}}function Hi(u){let n,a,o,c,l,d,p;const y=[Ba,Na,Ma,Aa],x=[];function C(O,b){return O[3]===1?0:O[3]===2?1:O[3]===3?2:3}return o=C(u),c=x[o]=y[o](u),{c(){n=Q("div"),a=Q("div"),c.c(),this.h()},l(O){n=X(O,"DIV",{class:!0});var b=ce(n);a=X(b,"DIV",{class:!0});var B=ce(a);c.l(B),B.forEach(A),b.forEach(A),this.h()},h(){N(a,"class","fixed inset-0 bg-white flex flex-col items-center justify-center"),N(n,"class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50")},m(O,b){ee(O,n,b),R(n,a),x[o].m(a,null),p=!0},p(O,b){let B=o;o=C(O),o===B?x[o].p(O,b):(fn(),Le(x[B],1,1,()=>{x[B]=null}),dn(),c=x[o],c?c.p(O,b):(c=x[o]=y[o](O),c.c()),Ae(c,1),c.m(a,null))},i(O){p||(Ae(c),O&&gt(()=>{p&&(l||(l=He(a,ze,{duration:500},!0)),l.run(1))}),O&&gt(()=>{p&&(d||(d=He(n,ze,{duration:500},!0)),d.run(1))}),p=!0)},o(O){Le(c),O&&(l||(l=He(a,ze,{duration:500},!1)),l.run(0)),O&&(d||(d=He(n,ze,{duration:500},!1)),d.run(0)),p=!1},d(O){O&&A(n),x[o].d(),O&&l&&l.end(),O&&d&&d.end()}}}function Aa(u){let n,a,o,c;return a=new Ra({props:{closeModal:u[5],meditationResults:u[4]}}),{c(){n=Q("div"),St(a.$$.fragment),this.h()},l(l){n=X(l,"DIV",{class:!0});var d=ce(n);Et(a.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){ee(l,n,d),Tt(a,n,null),c=!0},p(l,d){const p={};d&16&&(p.meditationResults=l[4]),a.$set(p)},i(l){c||(Ae(a.$$.fragment,l),l&&gt(()=>{c&&(o||(o=He(n,ze,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Le(a.$$.fragment,l),l&&(o||(o=He(n,ze,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),xt(a),l&&o&&o.end()}}}function Ma(u){let n,a,o,c;return a=new ya({props:{duration:u[1],nextStep:u[7],levelId:u[2]}}),a.$on("complete",u[8]),{c(){n=Q("div"),St(a.$$.fragment),this.h()},l(l){n=X(l,"DIV",{class:!0});var d=ce(n);Et(a.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){ee(l,n,d),Tt(a,n,null),c=!0},p(l,d){const p={};d&2&&(p.duration=l[1]),d&4&&(p.levelId=l[2]),a.$set(p)},i(l){c||(Ae(a.$$.fragment,l),l&&gt(()=>{c&&(o||(o=He(n,ze,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Le(a.$$.fragment,l),l&&(o||(o=He(n,ze,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),xt(a),l&&o&&o.end()}}}function Na(u){let n,a,o,c;return a=new fa({props:{nextStep:u[7],closeModal:u[5],levelId:u[2]}}),{c(){n=Q("div"),St(a.$$.fragment),this.h()},l(l){n=X(l,"DIV",{class:!0});var d=ce(n);Et(a.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){ee(l,n,d),Tt(a,n,null),c=!0},p(l,d){const p={};d&4&&(p.levelId=l[2]),a.$set(p)},i(l){c||(Ae(a.$$.fragment,l),l&&gt(()=>{c&&(o||(o=He(n,ze,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Le(a.$$.fragment,l),l&&(o||(o=He(n,ze,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),xt(a),l&&o&&o.end()}}}function Ba(u){let n,a,o,c;return a=new ra({props:{nextStep:u[7],duration:u[1],closeModal:u[5],levelId:u[2]}}),{c(){n=Q("div"),St(a.$$.fragment),this.h()},l(l){n=X(l,"DIV",{class:!0});var d=ce(n);Et(a.$$.fragment,d),d.forEach(A),this.h()},h(){N(n,"class","absolute inset-0 flex flex-col")},m(l,d){ee(l,n,d),Tt(a,n,null),c=!0},p(l,d){const p={};d&2&&(p.duration=l[1]),d&4&&(p.levelId=l[2]),a.$set(p)},i(l){c||(Ae(a.$$.fragment,l),l&&gt(()=>{c&&(o||(o=He(n,ze,{duration:300},!0)),o.run(1))}),c=!0)},o(l){Le(a.$$.fragment,l),l&&(o||(o=He(n,ze,{duration:300},!1)),o.run(0)),c=!1},d(l){l&&A(n),xt(a),l&&o&&o.end()}}}function qa(u){let n,a,o=u[0]&&Hi(u);return{c(){o&&o.c(),n=Wn()},l(c){o&&o.l(c),n=Wn()},m(c,l){o&&o.m(c,l),ee(c,n,l),a=!0},p(c,[l]){c[0]?o?(o.p(c,l),l&1&&Ae(o,1)):(o=Hi(c),o.c(),Ae(o,1),o.m(n.parentNode,n)):o&&(fn(),Le(o,1,1,()=>{o=null}),dn())},i(c){a||(Ae(o),a=!0)},o(c){Le(o),a=!1},d(c){c&&A(n),o&&o.d(c)}}}function Fa(u,n,a){let{show:o=!1}=n,{duration:c=Me.ONE_MINUTE}=n,{levelId:l=null}=n,d=1,p;const y=()=>{a(0,o=!1),a(3,d=1)},x=async b=>{const{clickTimestamps:B,durationMeditated:z,completed:te}=b.detail,V=l||"L1",M=cn.find(re=>re.id===V);if(!M)return;const ae=await ln.sessions.where("levelId").equals(V).toArray(),W=await $n(V),ie=new Set(Object.entries(W).filter(([re,de])=>de.completed).map(([re])=>re)),we=ae.map(re=>new Set(M.completionTasks.filter(de=>{var le;return(le=ot[de.id])==null?void 0:le.call(ot,[re],M).completed}).map(de=>de.id))),se=qr(M.starRules,ie,we),ne={levelId:V,duration:z,tapCount:B.length,tapTimestamps:B,timestamp:Date.now(),completed:te};await ln.sessions.add(ne);const oe=await $n(V),_e=new Set(Object.entries(oe).filter(([re,de])=>de.completed).map(([re])=>re)),ke=Object.entries(oe).filter(([re,de])=>{var le;return de.completed&&!((le=W[re])!=null&&le.completed)}).map(([re])=>re),De=await ln.sessions.where("levelId").equals(V).toArray(),Ie=De.map(re=>new Set(M.completionTasks.filter(de=>{var le;return(le=ot[de.id])==null?void 0:le.call(ot,[re],M).completed}).map(de=>de.id))),Ge=qr(M.starRules,_e,Ie),Qe=lo(De),Se=Qe&&Qe.tapCount===B.length&&Qe.duration===z;a(4,p={...b.detail,levelId:V,previousStarRating:se,newStarRating:Ge,newlyCompletedTasks:ke,completionTaskResults:Object.fromEntries(Object.entries(oe).map(([re,de])=>[re,de.completed])),isNewPersonalBest:Se||!1,personalBest:Qe}),C()},C=()=>setTimeout(()=>a(3,d++,d),300),O=b=>x(b);return u.$$set=b=>{"show"in b&&a(0,o=b.show),"duration"in b&&a(1,c=b.duration),"levelId"in b&&a(2,l=b.levelId)},[o,c,l,d,p,y,x,C,O]}class La extends wt{constructor(n){super(),kt(this,n,Fa,qa,bt,{show:0,duration:1,levelId:2})}}function zi(u,n,a){const o=u.slice();return o[6]=n[a],o}function Gi(u){let n,a=Nr[u[6]]+"",o;return{c(){n=Q("option"),o=Z(a),this.h()},l(c){n=X(c,"OPTION",{});var l=ce(n);o=J(l,a),l.forEach(A),this.h()},h(){n.__value=u[6],Xo(n,n.__value)},m(c,l){ee(c,n,l),R(n,o)},p:Be,d(c){c&&A(n)}}}function Ua(u){let n,a,o="Select Meditation Duration",c,l,d,p,y=$e(u[2]),x=[];for(let C=0;C<y.length;C+=1)x[C]=Gi(zi(u,y,C));return{c(){n=Q("div"),a=Q("label"),a.textContent=o,c=ye(),l=Q("select");for(let C=0;C<x.length;C+=1)x[C].c();this.h()},l(C){n=X(C,"DIV",{class:!0});var O=ce(n);a=X(O,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Ne(a)!=="svelte-g1prfd"&&(a.textContent=o),c=ve(O),l=X(O,"SELECT",{id:!0,class:!0});var b=ce(l);for(let B=0;B<x.length;B+=1)x[B].l(b);b.forEach(A),O.forEach(A),this.h()},h(){N(a,"for","duration"),N(a,"class","text-md font-medium"),N(l,"id","duration"),N(l,"class","select select-bordered w-full max-w-xs"),N(n,"class","flex flex-col items-start gap-1")},m(C,O){ee(C,n,O),R(n,a),R(n,c),R(n,l);for(let b=0;b<x.length;b+=1)x[b]&&x[b].m(l,null);Ii(l,u[1]),d||(p=ct(l,"change",u[5]),d=!0)},p(C,[O]){if(O&4){y=$e(C[2]);let b;for(b=0;b<y.length;b+=1){const B=zi(C,y,b);x[b]?x[b].p(B,O):(x[b]=Gi(B),x[b].c(),x[b].m(l,null))}for(;b<x.length;b+=1)x[b].d(1);x.length=y.length}O&6&&Ii(l,C[1])},i:Be,o:Be,d(C){C&&A(n),qt(x,C),d=!1,p()}}}function Va(u,n,a){let{onDurationChange:o}=n,{minDuration:c=Me.ONE_MINUTE}=n,{maxDuration:l=Me.SIXTY_MINUTES}=n,{selectedDuration:d=c??Me.ONE_MINUTE}=n;const p=Object.values(Me).filter(x=>typeof x=="number").filter(x=>x>=c&&x<=l),y=x=>o(Number(x.currentTarget.value));return u.$$set=x=>{"onDurationChange"in x&&a(0,o=x.onDurationChange),"minDuration"in x&&a(3,c=x.minDuration),"maxDuration"in x&&a(4,l=x.maxDuration),"selectedDuration"in x&&a(1,d=x.selectedDuration)},[o,d,p,c,l,y]}class Ya extends wt{constructor(n){super(),kt(this,n,Va,Ua,bt,{onDurationChange:0,minDuration:3,maxDuration:4,selectedDuration:1})}}function Wi(u,n,a){const o=u.slice();return o[11]=n[a].level,o[12]=n[a].isUnlocked,o[13]=n[a].taskCompletion,o[14]=n[a].starRating,o[15]=n[a].bestSession,o[16]=n,o[17]=a,o}function Xi(u,n,a){const o=u.slice();return o[18]=n[a][0],o[19]=n[a][1],o}function Qi(u,n,a){const o=u.slice();return o[18]=n[a],o[17]=a,o}function Ha(u){let n,a,o=$e(u[1]),c=[];for(let d=0;d<o.length;d+=1)c[d]=ro(Wi(u,o,d));const l=d=>Le(c[d],1,1,()=>{c[d]=null});return{c(){n=Q("div");for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){n=X(d,"DIV",{class:!0});var p=ce(n);for(let y=0;y<c.length;y+=1)c[y].l(p);p.forEach(A),this.h()},h(){N(n,"class","flex flex-col gap-6 mt-8 max-w-3xl mx-auto w-full")},m(d,p){ee(d,n,p);for(let y=0;y<c.length;y+=1)c[y]&&c[y].m(n,null);a=!0},p(d,p){if(p&122){o=$e(d[1]);let y;for(y=0;y<o.length;y+=1){const x=Wi(d,o,y);c[y]?(c[y].p(x,p),Ae(c[y],1)):(c[y]=ro(x),c[y].c(),Ae(c[y],1),c[y].m(n,null))}for(fn(),y=o.length;y<c.length;y+=1)l(y);dn()}},i(d){if(!a){for(let p=0;p<o.length;p+=1)Ae(c[p]);a=!0}},o(d){c=c.filter(Boolean);for(let p=0;p<c.length;p+=1)Le(c[p]);a=!1},d(d){d&&A(n),qt(c,d)}}}function za(u){let n,a='<div class="loading loading-spinner loading-lg"></div>';return{c(){n=Q("div"),n.innerHTML=a,this.h()},l(o){n=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-1mgfhb9"&&(n.innerHTML=a),this.h()},h(){N(n,"class","flex justify-center items-center mt-8")},m(o,c){ee(o,n,c)},p:Be,i:Be,o:Be,d(o){o&&A(n)}}}function $i(u){let n,a="🔒";return{c(){n=Q("span"),n.textContent=a,this.h()},l(o){n=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-19hy9gc"&&(n.textContent=a),this.h()},h(){N(n,"class","text-2xl")},m(o,c){ee(o,n,c)},d(o){o&&A(n)}}}function Ji(u){let n,a=$e(Array(3)),o=[];for(let c=0;c<a.length;c+=1)o[c]=Zi(Qi(u,a,c));return{c(){n=Q("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){n=X(c,"DIV",{class:!0});var l=ce(n);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(A),this.h()},h(){N(n,"class","flex items-center")},m(c,l){ee(c,n,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(c,l){if(l&2){a=$e(Array(3));let d;for(d=0;d<a.length;d+=1){const p=Qi(c,a,d);o[d]?o[d].p(p,l):(o[d]=Zi(p),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=a.length}},d(c){c&&A(n),qt(o,c)}}}function Ga(u){let n,a="★";return{c(){n=Q("span"),n.textContent=a,this.h()},l(o){n=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-1tpxw7h"&&(n.textContent=a),this.h()},h(){N(n,"class","text-2xl text-gray-300")},m(o,c){ee(o,n,c)},d(o){o&&A(n)}}}function Wa(u){let n,a="⭐";return{c(){n=Q("span"),n.textContent=a,this.h()},l(o){n=X(o,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-1jlkvsx"&&(n.textContent=a),this.h()},h(){N(n,"class","text-2xl")},m(o,c){ee(o,n,c)},d(o){o&&A(n)}}}function Zi(u){let n;function a(l,d){return l[17]<l[14]?Wa:Ga}let o=a(u),c=o(u);return{c(){c.c(),n=Wn()},l(l){c.l(l),n=Wn()},m(l,d){c.m(l,d),ee(l,n,d)},p(l,d){o!==(o=a(l))&&(c.d(1),c=o(l),c&&(c.c(),c.m(n.parentNode,n)))},d(l){l&&A(n),c.d(l)}}}function eo(u){let n,a,o=u[15].tapCount+"",c,l,d=Qn(u[15].duration)+"",p,y;return{c(){n=Q("p"),a=Z("Your best: "),c=Z(o),l=Z(" taps · "),p=Z(d),y=Z(" min"),this.h()},l(x){n=X(x,"P",{class:!0});var C=ce(n);a=J(C,"Your best: "),c=J(C,o),l=J(C," taps · "),p=J(C,d),y=J(C," min"),C.forEach(A),this.h()},h(){N(n,"class","text-sm text-gray-500")},m(x,C){ee(x,n,C),R(n,a),R(n,c),R(n,l),R(n,p),R(n,y)},p(x,C){C&2&&o!==(o=x[15].tapCount+"")&&Pe(c,o),C&2&&d!==(d=Qn(x[15].duration)+"")&&Pe(p,d)},d(x){x&&A(n)}}}function to(u){let n,a=$e(Object.entries(u[13])),o=[];for(let c=0;c<a.length;c+=1)o[c]=no(Xi(u,a,c));return{c(){n=Q("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){n=X(c,"DIV",{class:!0});var l=ce(n);for(let d=0;d<o.length;d+=1)o[d].l(l);l.forEach(A),this.h()},h(){N(n,"class","space-y-0")},m(c,l){ee(c,n,l);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(c,l){if(l&2){a=$e(Object.entries(c[13]));let d;for(d=0;d<a.length;d+=1){const p=Xi(c,a,d);o[d]?o[d].p(p,l):(o[d]=no(p),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=a.length}},d(c){c&&A(n),qt(o,c)}}}function no(u){let n,a,o=u[19].completed?"✅":"🔲",c,l,d=u[19].description+"",p,y,x=u[19].info+"",C,O;return{c(){n=Q("div"),a=Q("span"),c=Z(o),l=ye(),p=Z(d),y=ye(),C=Z(x),O=ye(),this.h()},l(b){n=X(b,"DIV",{class:!0});var B=ce(n);a=X(B,"SPAN",{class:!0});var z=ce(a);c=J(z,o),l=ve(z),p=J(z,d),y=ve(z),C=J(z,x),z.forEach(A),O=ve(B),B.forEach(A),this.h()},h(){N(a,"class","mr-2 text-sm text-gray-500"),N(n,"class","flex items-center")},m(b,B){ee(b,n,B),R(n,a),R(a,c),R(a,l),R(a,p),R(a,y),R(a,C),R(n,O)},p(b,B){B&2&&o!==(o=b[19].completed?"✅":"🔲")&&Pe(c,o),B&2&&d!==(d=b[19].description+"")&&Pe(p,d),B&2&&x!==(x=b[19].info+"")&&Pe(C,x)},d(b){b&&A(n)}}}function Xa(u){let n,a='<p class="text-sm text-gray-500">Achieve 2 stars in previous levels to unlock</p>';return{c(){n=Q("div"),n.innerHTML=a,this.h()},l(o){n=X(o,"DIV",{class:!0,"data-svelte-h":!0}),Ne(n)!=="svelte-agxr37"&&(n.innerHTML=a),this.h()},h(){N(n,"class","space-y-4 mt-8")},m(o,c){ee(o,n,c)},p:Be,i:Be,o:Be,d(o){o&&A(n)}}}function Qa(u){let n,a,o,c,l="Start meditation",d,p,y;function x(...O){return u[7](u[11],u[16],u[17],...O)}a=new Ya({props:{selectedDuration:u[11].selectedDuration,onDurationChange:x,minDuration:u[11].minDuration,maxDuration:u[11].maxDuration}});function C(){return u[8](u[11])}return{c(){n=Q("div"),St(a.$$.fragment),o=ye(),c=Q("button"),c.textContent=l,this.h()},l(O){n=X(O,"DIV",{class:!0});var b=ce(n);Et(a.$$.fragment,b),o=ve(b),c=X(b,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(c)!=="svelte-egxc4d"&&(c.textContent=l),b.forEach(A),this.h()},h(){N(c,"class","btn variant-filled w-full"),N(n,"class","space-y-6 mt-8")},m(O,b){ee(O,n,b),Tt(a,n,null),R(n,o),R(n,c),d=!0,p||(y=ct(c,"click",C),p=!0)},p(O,b){u=O;const B={};b&2&&(B.selectedDuration=u[11].selectedDuration),b&2&&(B.onDurationChange=x),b&2&&(B.minDuration=u[11].minDuration),b&2&&(B.maxDuration=u[11].maxDuration),a.$set(B)},i(O){d||(Ae(a.$$.fragment,O),d=!0)},o(O){Le(a.$$.fragment,O),d=!1},d(O){O&&A(n),xt(a),p=!1,y()}}}function ro(u){let n,a,o,c,l=u[11].name+"",d,p,y,x,C,O=u[11].description+"",b,B,z,te,V,M,ae,W,ie=u[17],we,se=!u[12]&&$i(),ne=u[14]!==void 0&&u[12]&&Ji(u),oe=u[15]&&u[12]&&eo(u),_e=u[13]&&u[12]&&to(u);const ke=[Qa,Xa],De=[];function Ie(Se,re){return Se[12]?0:1}V=Ie(u),M=De[V]=ke[V](u);const Ge=()=>u[9](n,ie),Qe=()=>u[9](null,ie);return{c(){n=Q("div"),a=Q("div"),o=Q("h3"),se&&se.c(),c=ye(),d=Z(l),p=ye(),ne&&ne.c(),y=ye(),x=Q("div"),C=Q("p"),b=Z(O),B=ye(),oe&&oe.c(),z=ye(),_e&&_e.c(),te=ye(),M.c(),ae=ye(),this.h()},l(Se){n=X(Se,"DIV",{class:!0});var re=ce(n);a=X(re,"DIV",{class:!0});var de=ce(a);o=X(de,"H3",{class:!0});var le=ce(o);se&&se.l(le),c=ve(le),d=J(le,l),le.forEach(A),p=ve(de),ne&&ne.l(de),de.forEach(A),y=ve(re),x=X(re,"DIV",{class:!0});var pe=ce(x);C=X(pe,"P",{class:!0});var Te=ce(C);b=J(Te,O),Te.forEach(A),B=ve(pe),oe&&oe.l(pe),pe.forEach(A),z=ve(re),_e&&_e.l(re),te=ve(re),M.l(re),ae=ve(re),re.forEach(A),this.h()},h(){N(o,"class","text-lg font-bold"),N(a,"class","flex justify-between items-center mb-2"),N(C,"class","text-sm text-muted-foreground mb-2"),N(x,"class","mb-2"),N(n,"class",W="card bg-[#ffffffa6] p-8 "+(u[12]?"":"opacity-60"))},m(Se,re){ee(Se,n,re),R(n,a),R(a,o),se&&se.m(o,null),R(o,c),R(o,d),R(a,p),ne&&ne.m(a,null),R(n,y),R(n,x),R(x,C),R(C,b),R(x,B),oe&&oe.m(x,null),R(n,z),_e&&_e.m(n,null),R(n,te),De[V].m(n,null),R(n,ae),Ge(),we=!0},p(Se,re){u=Se,u[12]?se&&(se.d(1),se=null):se||(se=$i(),se.c(),se.m(o,c)),(!we||re&2)&&l!==(l=u[11].name+"")&&Pe(d,l),u[14]!==void 0&&u[12]?ne?ne.p(u,re):(ne=Ji(u),ne.c(),ne.m(a,null)):ne&&(ne.d(1),ne=null),(!we||re&2)&&O!==(O=u[11].description+"")&&Pe(b,O),u[15]&&u[12]?oe?oe.p(u,re):(oe=eo(u),oe.c(),oe.m(x,null)):oe&&(oe.d(1),oe=null),u[13]&&u[12]?_e?_e.p(u,re):(_e=to(u),_e.c(),_e.m(n,te)):_e&&(_e.d(1),_e=null);let de=V;V=Ie(u),V===de?De[V].p(u,re):(fn(),Le(De[de],1,1,()=>{De[de]=null}),dn(),M=De[V],M?M.p(u,re):(M=De[V]=ke[V](u),M.c()),Ae(M,1),M.m(n,ae)),(!we||re&2&&W!==(W="card bg-[#ffffffa6] p-8 "+(u[12]?"":"opacity-60")))&&N(n,"class",W),ie!==u[17]&&(Qe(),ie=u[17],Ge())},i(Se){we||(Ae(M),we=!0)},o(Se){Le(M),we=!1},d(Se){Se&&A(n),se&&se.d(),ne&&ne.d(),oe&&oe.d(),_e&&_e.d(),De[V].d(),Qe()}}}function $a(u){let n,a,o='<h1 class="h2">Welcome to <br/>The Meditation Game!</h1> <p>Learn how to meditate through gameplay</p>',c,l,d,p,y,x=`<p>Learn to meditate for real at 
			<a href="https://www.dhamma.org" target="_blank" class="text-blue-500 underline">dhamma.org ↗</a></p> <p class="mt-2">This app was made by Arjun Kalburgi, PM with 5 years experience. 
			Hire him to build your 0-1 consumer products! 
			<a href="https://www.linkedin.com/in/arjunkalburgi" target="_blank" class="text-blue-500 underline">View LinkedIn ↗</a></p>`,C,O,b,B;const z=[za,Ha],te=[];function V(W,ie){return W[2]?0:1}l=V(u),d=te[l]=z[l](u);function M(W){u[10](W)}let ae={duration:u[4],levelId:u[5]};return u[0]!==void 0&&(ae.show=u[0]),O=new La({props:ae}),Jn.push(()=>Vr(O,"show",M)),{c(){n=Q("div"),a=Q("div"),a.innerHTML=o,c=ye(),d.c(),p=ye(),y=Q("div"),y.innerHTML=x,C=ye(),St(O.$$.fragment),this.h()},l(W){n=X(W,"DIV",{class:!0});var ie=ce(n);a=X(ie,"DIV",{class:!0,"data-svelte-h":!0}),Ne(a)!=="svelte-50yq01"&&(a.innerHTML=o),c=ve(ie),d.l(ie),p=ve(ie),y=X(ie,"DIV",{class:!0,"data-svelte-h":!0}),Ne(y)!=="svelte-dgw8za"&&(y.innerHTML=x),ie.forEach(A),C=ve(W),Et(O.$$.fragment,W),this.h()},h(){N(a,"class","space-y-6 text-center mt-10 mb-8"),N(y,"class","text-center text-sm text-gray-500 mt-40"),N(n,"class","h-full mx-auto flex flex-col p-6 mt-6")},m(W,ie){ee(W,n,ie),R(n,a),R(n,c),te[l].m(n,null),R(n,p),R(n,y),ee(W,C,ie),Tt(O,W,ie),B=!0},p(W,[ie]){let we=l;l=V(W),l===we?te[l].p(W,ie):(fn(),Le(te[we],1,1,()=>{te[we]=null}),dn(),d=te[l],d?d.p(W,ie):(d=te[l]=z[l](W),d.c()),Ae(d,1),d.m(n,p));const se={};ie&16&&(se.duration=W[4]),ie&32&&(se.levelId=W[5]),!b&&ie&1&&(b=!0,se.show=W[0],Ur(()=>b=!1)),O.$set(se)},i(W){B||(Ae(d),Ae(O.$$.fragment,W),B=!0)},o(W){Le(d),Le(O.$$.fragment,W),B=!1},d(W){W&&(A(n),A(C)),te[l].d(),xt(O,W)}}}function Ja(u,n,a){let o=!1,c=Me.ONE_MINUTE,l=null,d=[],p=!0,y=[];const x=async()=>{await oa(),a(0,o=!0)},C=(z,te,V,M)=>{localStorage.setItem("preferredDuration"+z.id,M.toString()),a(1,te[V].level.selectedDuration=M,d)},O=z=>{a(5,l=z.id),a(4,c=z.selectedDuration??z.minDuration),x()};function b(z,te){Jn[z?"unshift":"push"](()=>{y[te]=z,a(3,y)})}function B(z){o=z,a(0,o)}return u.$$.update=()=>{var z;if(u.$$.dirty&1&&(o||(a(2,p=!0),ka().then(te=>{a(1,d=te),te.forEach(({level:V})=>{const M=localStorage.getItem("preferredDuration"+V.id);V.selectedDuration=M?parseInt(M):V.minDuration}),a(2,p=!1)}).catch(te=>{console.error("Failed to reload level statuses:",te),a(2,p=!1)}))),u.$$.dirty&14&&!p){const te=(z=[...d].map((V,M)=>({i:M,rating:V.starRating??0})).find(({rating:V})=>V<3))==null?void 0:z.i;te!==void 0&&Qo().then(()=>{var V;(V=y[te])==null||V.scrollIntoView({behavior:"smooth",block:"center"})})}},[o,d,p,y,c,l,x,C,O,b,B]}class ps extends wt{constructor(n){super(),kt(this,n,Ja,$a,bt,{})}}export{ps as component};
